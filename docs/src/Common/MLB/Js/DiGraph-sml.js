if ((typeof(tools$0DiGraph$1)) == "undefined") {tools$0DiGraph$1 = {};
};
(function(){tools$0DiGraph$1.eq_graphnode$1146 = function(v$1150,v$1147){var v$1148 = v$1147[0];
var v$1149 = v$1147[1];
switch (v$1149[0]) { case 0: {var v$1151 = v$1148[1];
var v$1152 = v$1149[1];
if (v$1151[0] == v$1152[0]) {if (v$1150([v$1151[1],v$1152[1]])) {var t$1853;
var fix$1850 = {};
fix$1850.$eq_list = function(v$1161,v$1162){lab$eq_list: while (true) {if (v$1161 == null) {return (v$1162 == null)?true:false;
} else {if (v$1162 == null) {return false;
} else {var v$1163 = v$1161;
var v$1164 = v$1162;
if (v$1163[0] == v$1164[0]) {var t$1851 = v$1163[1];
var t$1852 = v$1164[1];
var v$1161 = t$1851;
var v$1162 = t$1852;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$1159 = fix$1850.$eq_list;
t$1853 = (eq_list$1159(v$1151[2],v$1152[2]));
return t$1853?(v$1151[3] == v$1152[3]):false;
} else {return false;
};
} else {return false;
};
 break; }default: {return false;
} };
};
tools$0DiGraph$1.mk_graph$83 = function(v$85){return null;
};
tools$0DiGraph$1.add_node_to_graph$86 = function(v$87){return v$87;
};
tools$0DiGraph$1.mk_node$88 = function(info$91){var t$1856 = tools$0UnionFindPoly$1.mkElement$135;
var t$1855;
var t$1854;
var v$93 = [false];
t$1854 = [[0],info$91,null,v$93];
t$1855 = [0,t$1854];
return t$1856(t$1855);
};
tools$0DiGraph$1.mk_edge$96 = function(v$116,v$117){var v$106 = tools$0UnionFindPoly$1.find_info$86(v$116);
var v$111 = v$106[1];
var v$112 = v$111[1];
var v$113 = v$111[2];
var v$114 = v$111[3];
var v$115 = v$111[0];
return tools$0UnionFindPoly$1.set_info$112(v$116,[0,[v$115,v$112,[v$117,v$113],v$114]]);
};
tools$0DiGraph$1.add_edges$118 = function(v$138,v$139){var v$128 = tools$0UnionFindPoly$1.find_info$86(v$138);
var v$133 = v$128[1];
var v$134 = v$133[1];
var v$135 = v$133[2];
var v$136 = v$133[3];
var v$137 = v$133[0];
return tools$0UnionFindPoly$1.set_info$112(v$138,[0,[v$137,v$134,basis$0List$1.s$n$686(v$139,v$135),v$136]]);
};
tools$0DiGraph$1.eq_nodes$140 = function(v$145,v$146){return tools$0UnionFindPoly$1.eq_Elements$128(v$145,v$146);
};
tools$0DiGraph$1.union$147 = function(info_combine$150,v$154){var v$181 = v$154[0];
var v$182 = v$154[1];
return tools$0UnionFindPoly$1.union$139(function(v$1168){var v$1169 = v$1168[0];
var v$1170 = v$1169[1];
var v$1171 = v$1170[1];
var v$1172 = v$1170[2];
var v$1173 = v$1168[1];
var v$1174 = v$1173[1];
var v$1175 = v$1174[1];
var v$1176 = v$1174[2];
var v$1177 = v$1174[0];
var v$1178 = v$1174[3];
return [0,[v$1177,info_combine$150([v$1171,v$1175]),basis$0List$1.s$n$686(v$1172,v$1176),v$1178]];
},[v$181,v$182]);
};
tools$0DiGraph$1.union_left$183 = function(info_combine$186,v$190){var v$217 = v$190[0];
var v$218 = v$190[1];
return tools$0UnionFindPoly$1.union$139(function(v$1179){var v$1180 = v$1179[0];
var v$1181 = v$1180[1];
var v$1182 = v$1181[1];
var v$1183 = v$1181[2];
var v$1184 = v$1181[3];
var v$1185 = v$1181[0];
var v$1186 = v$1179[1];
var v$1187 = v$1186[1];
var v$1188 = v$1187[1];
return [0,[v$1185,info_combine$186([v$1182,v$1188]),v$1183,v$1184]];
},[v$217,v$218]);
};
tools$0DiGraph$1.find_info$219 = function(n$222){return (tools$0UnionFindPoly$1.find_info$86(n$222))[1][1];
};
tools$0DiGraph$1.find_rep_and_info$228 = function(n$231){var v$235 = tools$0UnionFindPoly$1.find_rep_and_info$99(n$231);
return [v$235[0],v$235[1][1][1]];
};
tools$0DiGraph$1.union_graph$240 = function(v$243,v$246){if (v$246 == null) {return tools$0Crash$1.impossible$59("DiGraph.union_graph");
} else {var v$259 = v$246;
var v$260 = v$259[0];
var v$261 = v$259[1];
var fix$1857 = {};
fix$1857.$foldl = function(v$1191,v$1192){lab$foldl: while (true) {if (v$1192 == null) {return v$1191;
} else {var v$1193 = v$1192;
var v$1194 = v$1193[0];
var v$1195 = v$1193[1];
var t$1861 = tools$0UnionFindPoly$1.union$139((function(env$1860){return function(v$1808){var v$1858 = env$1860[0];
var v$1859 = env$1860[1];
var v$1809 = v$1808[0];
var v$1810 = v$1809[1];
var v$1811 = v$1810[1];
var v$1812 = v$1810[2];
var v$1813 = v$1808[1];
var v$1814 = v$1813[1];
var v$1815 = v$1814[1];
var v$1816 = v$1814[2];
var v$1817 = v$1814[0];
var v$1818 = v$1814[3];
return [0,[v$1817,v$1859([v$1811,v$1815]),v$1858(v$1812,v$1816),v$1818]];
};
})([basis$0List$1.s$n$686,v$243]),[v$1194,v$1191]);
var t$1862 = v$1195;
var v$1191 = t$1861;
var v$1192 = t$1862;
continue lab$foldl;
};
};
};
var foldl$1190 = fix$1857.$foldl;
return foldl$1190(v$260,v$261);
};
};
tools$0DiGraph$1.set_info$263 = function(n$266,info$$269){var v$275 = tools$0UnionFindPoly$1.find_info$86(n$266);
var v$280 = v$275[1];
var v$282 = v$280[2];
var v$283 = v$280[3];
var v$284 = v$280[0];
return tools$0UnionFindPoly$1.set_info$112(n$266,[0,[v$284,info$$269,v$282,v$283]]);
};
tools$0DiGraph$1.out_of_node$285 = function(n$288){return (tools$0UnionFindPoly$1.find_info$86(n$288))[1][2];
};
tools$0DiGraph$1.find_visited$316 = function(n$319){return (tools$0UnionFindPoly$1.find_info$86(n$319))[1][3];
};
tools$0DiGraph$1.unvisit$382 = function(g$385){var fix$1863 = {};
fix$1863.$app = function(v$1219){lab$app: while (true) {if (v$1219 == null) {return 0;
} else {var v$1220 = v$1219;
var v$1221 = v$1220[0];
var v$1222 = v$1220[1];
((tools$0UnionFindPoly$1.find_info$86(v$1221))[1][3][0] = false,0);
var t$1864 = v$1222;
var v$1219 = t$1864;
continue lab$app;
};
};
};
var app$1218 = fix$1863.$app;
return app$1218(g$385);
};
tools$0DiGraph$1.union_without_edge_duplication$396 = function(info_combine$399,visit_children$402,v$406){var v$468 = v$406[0];
var v$469 = v$406[1];
var visited_nodes$407 = [null];
var fix$1865 = {};
fix$1865.$onto = function(v$420,v$1821){lab$onto: while (true) {if (v$420 == null) {return v$1821;
} else {var v$435 = v$420;
var v$436 = v$435[0];
var v$437 = v$435[1];
var t$1867 = v$437;
var t$1866;
var r$422 = (tools$0UnionFindPoly$1.find_info$86(v$436))[1][3];
if (r$422[0]) {t$1866 = v$1821;
} else {(r$422[0] = true,0);
(visited_nodes$407[0] = [v$436,visited_nodes$407[0]],0);
t$1866 = ((visit_children$402((tools$0UnionFindPoly$1.find_info$86(v$436))[1][1]))?(fix$1865.$onto((tools$0UnionFindPoly$1.find_info$86(v$436))[1][2],v$1821)):[v$436,v$1821]);
};
var t$1868 = t$1867;
var t$1869 = t$1866;
var v$420 = t$1868;
var v$1821 = t$1869;
continue lab$onto;
};
};
};
var onto$408 = fix$1865.$onto;
return tools$0UnionFindPoly$1.union$139(function(v$1276){var v$1277 = v$1276[0];
var v$1278 = v$1277[1];
var v$1279 = v$1278[1];
var v$1280 = v$1278[2];
var v$1281 = v$1276[1];
var v$1282 = v$1281[1];
var v$1283 = v$1282[1];
var v$1284 = v$1282[2];
var v$1285 = v$1282[0];
var v$1286 = v$1282[3];
var t$1875;
var t$1874 = v$1285;
var t$1873 = info_combine$399([v$1279,v$1283]);
var t$1870;
var result$1287 = onto$408(v$1280,onto$408(v$1284,null));
var g$1288 = visited_nodes$407[0];
var fix$1871 = {};
fix$1871.$app = function(v$1290){lab$app: while (true) {if (v$1290 == null) {return 0;
} else {var v$1291 = v$1290;
var v$1292 = v$1291[0];
var v$1293 = v$1291[1];
((tools$0UnionFindPoly$1.find_info$86(v$1292))[1][3][0] = false,0);
var t$1872 = v$1293;
var v$1290 = t$1872;
continue lab$app;
};
};
};
var app$1289 = fix$1871.$app;
app$1289(g$1288);
t$1870 = result$1287;
t$1875 = [t$1874,t$1873,t$1870,v$1286];
return [0,t$1875];
},[v$468,v$469]);
};
tools$0DiGraph$1.layout_node$470 = function(layout_info$473,n$476){var v$479 = tools$0UnionFindPoly$1.find_info$86(n$476);
var v$480 = v$479[1];
var v$481 = v$480[1];
return layout_info$473(v$481);
};
var pu_boolref$504 = pickle$0pickle$1.refOneGen$1282(pickle$0pickle$1.bool$732);
var pu_intref$505 = pickle$0pickle$1.refOneGen$1282(pickle$0pickle$1.int$729);
tools$0DiGraph$1.pu$506 = function(v$568,v$567,v$569){return function(pu_info$514){var dummy$515;
var t$1876;
var v$517 = [false];
t$1876 = [[0],v$568,null,v$517];
dummy$515 = [0,t$1876];
var pu_node$526 = (pickle$0pickle$1.cache$2484("DiGraph.node"))(function(x$1317){var x$1841 = tools$0UnionFindPoly$1.pu$194(dummy$515,x$1317);
return v$569(pickle$0pickle$1.nameGen$2624("DiGraph.node",x$1841));
});
var pu_graph$527 = (pickle$0pickle$1.cache$2484("DiGraph.graph"))(function(x$1325){var x$1845 = pu_node$526(x$1325);
var v$1846 = pickle$0pickle$1.listGen$2109(x$1845);
return pickle$0pickle$1.nameGen$2624("DiGraph.graph",v$1846);
});
var pu_graphnode$528 = pickle$0pickle$1.dataGen$1488(["DiGraph.graphnode",function(v$1333){return 0;
},[function(pu$1334){return pickle$0pickle$1.maybeNewHash$2065(function(v$1335){var v$1336 = v$1335[1];
var v$1337 = v$1336[1];
return v$567(v$1337);
},pickle$0pickle$1.con1$2014(function(v$1338){return [0,[v$1338[2],v$1338[0],v$1338[3],v$1338[1]]];
},function(v$1339){var v$1340 = v$1339[1];
return [v$1340[1],v$1340[3],v$1340[0],v$1340[2]];
},pickle$0pickle$1.tup4Gen0$2377(pu_info$514,pu_boolref$504,pu_intref$505,pu_graph$527(pu$1334))));
},null]]);
return [pu_node$526(pu_graphnode$528),pu_graph$527(pu_graphnode$528)];
};
};
tools$0DiGraph$1.nodes$570 = function(g$573){return g$573;
};
var fix$1877 = {};
fix$1877.$visit_all = function(n$578){var r$579 = (tools$0UnionFindPoly$1.find_info$86(n$578))[1][3];
if (r$579[0]) {return 0;
} else {(r$579[0] = true,0);
return fix$1877.$visit_all$((tools$0UnionFindPoly$1.find_info$86(n$578))[1][2]);
};
};
fix$1877.$visit_all$ = function(v$588){if (v$588 == null) {return 0;
} else {var v$597 = v$588;
var v$598 = v$597[0];
var v$599 = v$597[1];
fix$1877.$visit_all(v$598);
return fix$1877.$visit_all$(v$599);
};
};
tools$0DiGraph$1.visit_all$575 = fix$1877.$visit_all;
var visit_all$$574 = fix$1877.$visit_all$;
var fix$1878 = {};
fix$1878.$unvisit_all = function(n$604){var r$605 = (tools$0UnionFindPoly$1.find_info$86(n$604))[1][3];
if (r$605[0]) {(r$605[0] = false,0);
return fix$1878.$unvisit_all$((tools$0UnionFindPoly$1.find_info$86(n$604))[1][2]);
} else {return 0;
};
};
fix$1878.$unvisit_all$ = function(v$614){if (v$614 == null) {return 0;
} else {var v$623 = v$614;
var v$624 = v$623[0];
var v$625 = v$623[1];
fix$1878.$unvisit_all(v$624);
return fix$1878.$unvisit_all$(v$625);
};
};
tools$0DiGraph$1.unvisit_all$601 = fix$1878.$unvisit_all;
var unvisit_all$$600 = fix$1878.$unvisit_all$;
tools$0DiGraph$1.bottom_up_dfs$626 = function(g$629){var fix$1879 = {};
fix$1879.$search = function(v$643,v$644){var r$636 = (tools$0UnionFindPoly$1.find_info$86(v$643))[1][3];
if (r$636[0]) {return v$644;
} else {(r$636[0] = true,0);
return fix$1879.$search$((tools$0UnionFindPoly$1.find_info$86(v$643))[1][2],[v$643,v$644]);
};
};
fix$1879.$search$ = function(v$656,v$1822){if (v$656 == null) {return v$1822;
} else {var v$658 = v$656;
var v$659 = v$658[0];
var v$660 = v$658[1];
return fix$1879.$search$(v$660,fix$1879.$search(v$659,v$1822));
};
};
var search$631 = fix$1879.$search;
var search$$630 = fix$1879.$search$;
var result$662 = search$$630(g$629,null);
var fix$1880 = {};
fix$1880.$app = function(v$1355){lab$app: while (true) {if (v$1355 == null) {return 0;
} else {var v$1356 = v$1355;
var v$1357 = v$1356[0];
var v$1358 = v$1356[1];
((tools$0UnionFindPoly$1.find_info$86(v$1357))[1][3][0] = false,0);
var t$1881 = v$1358;
var v$1355 = t$1881;
continue lab$app;
};
};
};
var app$1354 = fix$1880.$app;
app$1354(result$662);
return result$662;
};
tools$0DiGraph$1.dfs$665 = function(g$668){return basis$0List$1.rev$257(tools$0DiGraph$1.bottom_up_dfs$626(g$668));
};
tools$0DiGraph$1.subgraph$669 = function(l$672){return basis$0List$1.rev$257(tools$0DiGraph$1.bottom_up_dfs$626(l$672));
};
tools$0DiGraph$1.topsort$673 = function(l$676){var fix$1882 = {};
fix$1882.$search$ = function(v$1823,v$690){if (v$690 == null) {return v$1823;
} else {var v$693 = v$690;
var v$694 = v$693[0];
var v$695 = v$693[1];
return fix$1882.$search$(fix$1882.$search(v$694,v$1823),v$695);
};
};
fix$1882.$search = function(v$707,v$708){var r$700 = (tools$0UnionFindPoly$1.find_info$86(v$707))[1][3];
if (r$700[0]) {return v$708;
} else {(r$700[0] = true,0);
return [v$707,fix$1882.$search$(v$708,(tools$0UnionFindPoly$1.find_info$86(v$707))[1][2])];
};
};
var search$$678 = fix$1882.$search$;
var search$677 = fix$1882.$search;
var result$709 = search$$678(null,l$676);
var fix$1883 = {};
fix$1883.$app = function(v$1371){lab$app: while (true) {if (v$1371 == null) {return 0;
} else {var v$1372 = v$1371;
var v$1373 = v$1372[0];
var v$1374 = v$1372[1];
((tools$0UnionFindPoly$1.find_info$86(v$1373))[1][3][0] = false,0);
var t$1884 = v$1374;
var v$1371 = t$1884;
continue lab$app;
};
};
};
var app$1370 = fix$1883.$app;
app$1370(result$709);
return result$709;
};
var en$EmptyStack$712 = new String("EmptyStack");
var exn$EmptyStack$712 = [en$EmptyStack$712];
tools$0DiGraph$1.scc$750 = function(layout_info$753,g$756){var scc_list$757 = [null];
var fix$1885 = {};
fix$1885.$min_list = function(v$1824,v$770){lab$min_list: while (true) {if (v$770 == null) {return v$1824;
} else {var v$777 = v$770;
var v$778 = v$777[0];
var v$779 = v$777[1];
if (v$778 < v$1824) {var t$1886 = v$778;
var t$1887 = v$779;
var v$1824 = t$1886;
var v$770 = t$1887;
continue lab$min_list;
} else {var t$1888 = v$1824;
var t$1889 = v$779;
var v$1824 = t$1888;
var v$770 = t$1889;
continue lab$min_list;
};
};
};
};
var min_list$758 = fix$1885.$min_list;
var count$791 = [1];
var stack$796 = [null];
var fix$1890 = {};
fix$1890.$lowlink = function(n$800){((tools$0UnionFindPoly$1.find_info$86(n$800))[1][3][0] = true,0);
((tools$0UnionFindPoly$1.find_info$86(n$800))[1][0][0] = count$791[0],0);
(count$791[0] = (SmlPrims.chk_ovf_i32(count$791[0] + 1)),0);
(stack$796[0] = [n$800,stack$796[0]],0);
var low$809 = (tools$0UnionFindPoly$1.find_info$86(n$800))[1][0][0];
var low$810 = min_list$758(low$809,basis$0List$1.map$697(function(w$813){if ((tools$0UnionFindPoly$1.find_info$86(w$813))[1][3][0]) {var v$1774 = (tools$0UnionFindPoly$1.find_info$86(w$813))[1][0][0];
return (v$1774 == 0)?low$809:((low$809 < v$1774)?low$809:v$1774);
} else {return fix$1890.$lowlink(w$813);
};
},(tools$0UnionFindPoly$1.find_info$86(n$800))[1][2]));
var fix$1897 = {};
fix$1897.$loop = function(v$820){lab$loop: while (true) {var x$821;
var res$1421;
try {res$1421 = (basis$0List$1.hd$676(stack$796[0]));
} catch(v$1898) {res$1421 = (((function(env$1899){return function(Hd$1423){throw exn$EmptyStack$712;
};
})([]))(v$1898));
};
try {(stack$796[0] = (basis$0List$1.tl$677(stack$796[0])),0);
0;
} catch(v$1900) {((function(env$1901){return function(Tl$1426){throw exn$EmptyStack$712;
};
})([]))(v$1900);
};
x$821 = res$1421;
((tools$0UnionFindPoly$1.find_info$86(x$821))[1][0][0] = 0,0);
(scc_list$757[0] = [[x$821,basis$0List$1.hd$676(scc_list$757[0])],basis$0List$1.tl$677(scc_list$757[0])],0);
if (tools$0UnionFindPoly$1.eq_Elements$128(x$821,n$800)) {return 0;
} else {var t$1902 = 0;
var v$820 = t$1902;
continue lab$loop;
};
};
};
var loop$818 = fix$1897.$loop;
if (low$810 == (tools$0UnionFindPoly$1.find_info$86(n$800))[1][0][0]) {(scc_list$757[0] = [null,scc_list$757[0]],0);
loop$818(0);
} else {0;
};
return low$810;
};
var lowlink$797 = fix$1890.$lowlink;
var fix$1891 = {};
fix$1891.$app = function(v$1441){lab$app: while (true) {if (v$1441 == null) {return 0;
} else {var v$1442 = v$1441;
var v$1443 = v$1442[0];
var v$1444 = v$1442[1];
((tools$0UnionFindPoly$1.find_info$86(v$1443))[1][0][0] = 0,0);
var t$1892 = v$1444;
var v$1441 = t$1892;
continue lab$app;
};
};
};
var app$1440 = fix$1891.$app;
app$1440(g$756);
var fix$1893 = {};
fix$1893.$app = function(v$1456){lab$app: while (true) {if (v$1456 == null) {return 0;
} else {var v$1457 = v$1456;
var v$1458 = v$1457[0];
var v$1459 = v$1457[1];
if ((tools$0UnionFindPoly$1.find_info$86(v$1458))[1][3][0]) {0;
} else {lowlink$797(v$1458);
0;
};
var t$1894 = v$1459;
var v$1456 = t$1894;
continue lab$app;
};
};
};
var app$1455 = fix$1893.$app;
app$1455(g$756);
var fix$1895 = {};
fix$1895.$app = function(v$1466){lab$app: while (true) {if (v$1466 == null) {return 0;
} else {var v$1467 = v$1466;
var v$1468 = v$1467[0];
var v$1469 = v$1467[1];
((tools$0UnionFindPoly$1.find_info$86(v$1468))[1][3][0] = false,0);
var t$1896 = v$1469;
var v$1466 = t$1896;
continue lab$app;
};
};
};
var app$1465 = fix$1895.$app;
app$1465(g$756);
return basis$0List$1.rev$682(scc_list$757[0]);
};
tools$0DiGraph$1.bottom_up_eval$853 = function(f$856,g$859){var fix$1903 = {};
fix$1903.$search = function(n$863){var r$864 = (tools$0UnionFindPoly$1.find_info$86(n$863))[1][3];
if (r$864[0]) {return 0;
} else {var ns$869 = (tools$0UnionFindPoly$1.find_info$86(n$863))[1][2];
(r$864[0] = true,0);
return f$856([(tools$0UnionFindPoly$1.find_info$86(n$863))[1][1],basis$0List$1.map$697(function(n$$874){fix$1903.$search(n$$874);
return (tools$0UnionFindPoly$1.find_info$86(n$$874))[1][1];
},ns$869)]);
};
};
var search$860 = fix$1903.$search;
var fix$1904 = {};
fix$1904.$app = function(v$1484){lab$app: while (true) {if (v$1484 == null) {return 0;
} else {var v$1485 = v$1484;
var v$1486 = v$1485[0];
var v$1487 = v$1485[1];
search$860(v$1486);
var t$1905 = v$1487;
var v$1484 = t$1905;
continue lab$app;
};
};
};
var app$1483 = fix$1904.$app;
app$1483(g$859);
var fix$1906 = {};
fix$1906.$app = function(v$1490){lab$app: while (true) {if (v$1490 == null) {return 0;
} else {var v$1491 = v$1490;
var v$1492 = v$1491[0];
var v$1493 = v$1491[1];
((tools$0UnionFindPoly$1.find_info$86(v$1492))[1][3][0] = false,0);
var t$1907 = v$1493;
var v$1490 = t$1907;
continue lab$app;
};
};
};
var app$1489 = fix$1906.$app;
return app$1489(g$859);
};
tools$0DiGraph$1.quotient$917 = function(layout_info$920,info_combine$923,g$926){var g$$927 = basis$0List$1.map$697(function(v$1837){return tools$0DiGraph$1.union_graph$240(info_combine$923,v$1837);
},tools$0DiGraph$1.scc$750(layout_info$920,g$926));
var fix$1908 = {};
fix$1908.$do_children = function(xs$1578){lab$do_children: while (true) {if (xs$1578 == null) {return null;
} else {var v$1579 = xs$1578;
var v$1580 = v$1579[0];
var v$1581 = v$1579[1];
var r$1582 = (tools$0UnionFindPoly$1.find_info$86(v$1580))[1][3];
if (r$1582[0]) {var t$1909 = v$1581;
var xs$1578 = t$1909;
continue lab$do_children;
} else {(r$1582[0] = true,0);
return [v$1580,fix$1908.$do_children(v$1581)];
};
};
};
};
var do_children$1577 = fix$1908.$do_children;
var fix$1910 = {};
fix$1910.$app = function(v$1586){lab$app: while (true) {if (v$1586 == null) {return 0;
} else {var v$1587 = v$1586;
var v$1588 = v$1587[0];
var v$1589 = v$1587[1];
var children$1591 = (tools$0UnionFindPoly$1.find_info$86(v$1588))[1][2];
var fix$1911 = {};
fix$1911.$app = function(v$1593){lab$app: while (true) {if (v$1593 == null) {return 0;
} else {var v$1594 = v$1593;
var v$1595 = v$1594[0];
var v$1596 = v$1594[1];
((tools$0UnionFindPoly$1.find_info$86(v$1595))[1][3][0] = false,0);
var t$1912 = v$1596;
var v$1593 = t$1912;
continue lab$app;
};
};
};
var app$1592 = fix$1911.$app;
app$1592(children$1591);
((tools$0UnionFindPoly$1.find_info$86(v$1588))[1][3][0] = true,0);
var newout$1599 = do_children$1577(children$1591);
var v$1600 = tools$0UnionFindPoly$1.find_info$86(v$1588);
var v$1601 = v$1600[1];
var v$1602 = v$1601[1];
var v$1603 = v$1601[3];
var v$1604 = v$1601[0];
tools$0UnionFindPoly$1.set_info$112(v$1588,[0,[v$1604,v$1602,newout$1599,v$1603]]);
var t$1913 = v$1589;
var v$1586 = t$1913;
continue lab$app;
};
};
};
var app$1585 = fix$1910.$app;
app$1585(g$$927);
var fix$1914 = {};
fix$1914.$app = function(v$1607){lab$app: while (true) {if (v$1607 == null) {return 0;
} else {var v$1608 = v$1607;
var v$1609 = v$1608[0];
var v$1610 = v$1608[1];
((tools$0UnionFindPoly$1.find_info$86(v$1609))[1][3][0] = false,0);
var t$1915 = v$1610;
var v$1607 = t$1915;
continue lab$app;
};
};
};
var app$1606 = fix$1914.$app;
app$1606(g$$927);
return g$$927;
};
tools$0DiGraph$1.graft$930 = function(v$973,v$974){var fix$1916 = {};
fix$1916.$accum = function(v$949,v$1825,v$1826){lab$accum: while (true) {if (v$949 == null) {return [v$1825,v$1826];
} else {var v$956 = v$949;
var v$957 = v$956[0];
var v$958 = v$956[1];
if ((tools$0UnionFindPoly$1.find_info$86(v$957))[1][3][0]) {var t$1917 = v$958;
var t$1918 = v$1825;
var t$1919 = v$1826;
var v$949 = t$1917;
var v$1825 = t$1918;
var v$1826 = t$1919;
continue lab$accum;
} else {var t$1920 = v$958;
var t$1921 = [v$957,v$1825];
var t$1922 = [v$957,v$1826];
var v$949 = t$1920;
var v$1825 = t$1921;
var v$1826 = t$1922;
continue lab$accum;
};
};
};
};
var accum$935 = fix$1916.$accum;
var v$968;
var t$1926 = accum$935;
var t$1925 = v$973;
var t$1924 = null;
var t$1923;
tools$0DiGraph$1.visit_all$575(v$974);
t$1923 = (tools$0UnionFindPoly$1.find_info$86(v$974))[1][2];
v$968 = (t$1926(t$1925,t$1924,t$1923));
var v$969 = v$968[0];
var v$970 = v$968[1];
var v$1620 = tools$0UnionFindPoly$1.find_info$86(v$974);
var v$1621 = v$1620[1];
var v$1622 = v$1621[1];
var v$1623 = v$1621[3];
var v$1624 = v$1621[0];
tools$0UnionFindPoly$1.set_info$112(v$974,[0,[v$1624,v$1622,v$970,v$1623]]);
tools$0DiGraph$1.unvisit_all$601(v$974);
return [v$974,v$969];
};
tools$0DiGraph$1.multi_graft$975 = function(bound_to_free$978,l$981){return basis$0List$1.map$697(function(v$1637){var v$1638 = v$1637[0];
var v$1639 = v$1637[1];
var fix$1927 = {};
fix$1927.$accum = function(v$1642,v$1827){lab$accum: while (true) {if (v$1642 == null) {return v$1827;
} else {var v$1643 = v$1642;
var v$1644 = v$1643[0];
var v$1645 = v$1643[1];
var v$1647 = v$1827[0];
var v$1648 = v$1827[1];
var v$1649 = bound_to_free$978(v$1644);
switch (v$1649[0]) { case 0: {var v$1650 = v$1649[1];
if ((tools$0UnionFindPoly$1.find_info$86(v$1650))[1][3][0]) {var t$1928 = v$1645;
var t$1929 = [v$1647,v$1648];
var v$1642 = t$1928;
var v$1827 = t$1929;
continue lab$accum;
} else {var t$1930 = v$1645;
var t$1931 = [[v$1650,v$1647],[v$1650,v$1648]];
var v$1642 = t$1930;
var v$1827 = t$1931;
continue lab$accum;
};
 break; }default: {var t$1932 = v$1645;
var t$1933 = fix$1927.$accum((tools$0UnionFindPoly$1.find_info$86(v$1644))[1][2],v$1827);
var v$1642 = t$1932;
var v$1827 = t$1933;
continue lab$accum;
} };
};
};
};
var accum$1640 = fix$1927.$accum;
var v$1653;
var t$1938 = accum$1640;
var t$1937 = (tools$0UnionFindPoly$1.find_info$86(v$1638))[1][2];
var t$1936;
var t$1935 = null;
var t$1934;
tools$0DiGraph$1.visit_all$575(v$1639);
t$1934 = (tools$0UnionFindPoly$1.find_info$86(v$1639))[1][2];
t$1936 = [t$1935,t$1934];
v$1653 = (t$1938(t$1937,t$1936));
var v$1656 = v$1653[0];
var v$1657 = v$1653[1];
var v$1660 = tools$0UnionFindPoly$1.find_info$86(v$1639);
var v$1661 = v$1660[1];
var v$1662 = v$1661[1];
var v$1663 = v$1661[3];
var v$1664 = v$1661[0];
tools$0UnionFindPoly$1.set_info$112(v$1639,[0,[v$1664,v$1662,v$1657,v$1663]]);
tools$0DiGraph$1.unvisit_all$601(v$1639);
return [v$1639,v$1656];
},l$981);
};
tools$0DiGraph$1.layout_graph$1035 = function(layout_info$1038,g$1041){var t$1939;
var v$1045 = [0,","];
t$1939 = [basis$0List$1.map$697(function(n$1666){var v$1667 = (tools$0UnionFindPoly$1.find_info$86(n$1666))[1][2];
if (v$1667 == null) {var v$1671 = tools$0UnionFindPoly$1.find_info$86(n$1666);
var v$1672 = v$1671[1];
var v$1673 = v$1672[1];
return layout_info$1038(v$1673);
} else {var t$1940;
var v$1674 = [1];
var t$1947;
var t$1946;
var t$1945;
var v$1677 = tools$0UnionFindPoly$1.find_info$86(n$1666);
var v$1678 = v$1677[1];
var v$1679 = v$1678[1];
t$1945 = (layout_info$1038(v$1679));
var t$1944;
var t$1943;
var t$1942;
var t$1941;
var v$1680 = [0,","];
t$1941 = [basis$0List$1.map$697(function(n$1682){var v$1683 = tools$0UnionFindPoly$1.find_info$86(n$1682);
var v$1684 = v$1683[1];
var v$1685 = v$1684[1];
return layout_info$1038(v$1685);
},v$1667),v$1680,")",2,"("];
t$1942 = [0,t$1941];
t$1943 = [t$1942,null];
t$1944 = t$1943;
t$1946 = [t$1945,t$1944];
t$1947 = t$1946;
t$1940 = [t$1947,v$1674,"",0,""];
return [0,t$1940];
};
},g$1041),v$1045,"]",1,"["];
return [0,t$1939];
};
tools$0DiGraph$1.layout_nodes_deep$1047 = function(layout_info$1050,g$1053){var fix$1948 = {};
fix$1948.$layout = function(n$1074){lab$layout: while (true) {if ((tools$0UnionFindPoly$1.find_info$86(n$1074))[1][3][0]) {var t$1949;
var v$1082 = [1];
var t$1952;
var t$1951;
var t$1950;
var v$1691 = tools$0UnionFindPoly$1.find_info$86(n$1074);
var v$1692 = v$1691[1];
var v$1693 = v$1692[1];
t$1950 = (layout_info$1050(v$1693));
t$1951 = [t$1950,null];
t$1952 = t$1951;
t$1949 = [t$1952,v$1082,"",1,"@"];
return [0,t$1949];
} else {((tools$0UnionFindPoly$1.find_info$86(n$1074))[1][3][0] = true,0);
if ((tools$0UnionFindPoly$1.find_info$86(n$1074))[1][2] == null) {var v$1701 = tools$0UnionFindPoly$1.find_info$86(n$1074);
var v$1702 = v$1701[1];
var v$1703 = v$1702[1];
return layout_info$1050(v$1703);
} else {var t$1953;
var v$1098 = [1];
var t$1962;
var t$1961;
var t$1960;
var v$1706 = tools$0UnionFindPoly$1.find_info$86(n$1074);
var v$1707 = v$1706[1];
var v$1708 = v$1707[1];
t$1960 = (layout_info$1050(v$1708));
var t$1959;
var t$1958;
var t$1957;
var t$1954;
var v$1093 = [0,","];
t$1954 = [basis$0List$1.map$697((function(env$1956){return function(v$1847){var v$1955 = env$1956[0];
return v$1955(v$1847);
};
})([fix$1948.$layout]),(tools$0UnionFindPoly$1.find_info$86(n$1074))[1][2]),v$1093,")",1,"("];
t$1957 = [0,t$1954];
t$1958 = [t$1957,null];
t$1959 = t$1958;
t$1961 = [t$1960,t$1959];
t$1962 = t$1961;
t$1953 = [t$1962,v$1098,"",0,""];
return [0,t$1953];
};
};
};
};
var layout$1071 = fix$1948.$layout;
var t$1969;
var t$1967;
if (g$1053 == null) {var t$1966;
var v$1714 = [0,","];
t$1966 = [basis$0List$1.map$697(function(v$1849){return layout$1071(v$1849);
},g$1053),v$1714,"]",1,"["];
t$1967 = [0,t$1966];
} else {var v$1107 = g$1053;
if (v$1107[1] == null) {var v$1109 = v$1107[0];
t$1967 = (layout$1071(v$1109));
} else {var t$1968;
var v$1712 = [0,","];
t$1968 = [basis$0List$1.map$697(function(v$1848){return layout$1071(v$1848);
},g$1053),v$1712,"]",1,"["];
t$1967 = [0,t$1968];
};
};
var t$1965;
var fix$1963 = {};
fix$1963.$app = function(v$1717){lab$app: while (true) {if (v$1717 == null) {return 0;
} else {var v$1718 = v$1717;
var v$1719 = v$1718[0];
var v$1720 = v$1718[1];
tools$0DiGraph$1.unvisit_all$601(v$1719);
var t$1964 = v$1720;
var v$1717 = t$1964;
continue lab$app;
};
};
};
var app$1716 = fix$1963.$app;
t$1965 = (app$1716(g$1053));
t$1969 = [t$1967,t$1965];
return t$1969[0];
};
tools$0DiGraph$1.layout_nodes$1116 = function(l$1119){return function(v$1839){return tools$0DiGraph$1.layout_graph$1035(l$1119,v$1839);
};
};
return 0;
})();
