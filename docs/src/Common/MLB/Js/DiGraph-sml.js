if ((typeof(tools$0DiGraph$1)) == "undefined") {tools$0DiGraph$1 = {};
};
(function(){tools$0DiGraph$1.eq_graphnode$1163 = function(v$1167,v$1164){var v$1165 = v$1164[0];
var v$1166 = v$1164[1];
switch (v$1166[0]) { case 0: {var v$1168 = v$1165[1];
var v$1169 = v$1166[1];
if (v$1168[0] == v$1169[0]) {if (v$1167([v$1168[1],v$1169[1]])) {var t$1896;
var fix$1893 = {};
fix$1893.$eq_list = function(v$1178,v$1179){lab$eq_list: while (true) {if (v$1178 == null) {return (v$1179 == null)?true:false;
} else {if (v$1179 == null) {return false;
} else {var v$1180 = v$1178;
var v$1181 = v$1179;
if (v$1180[0] == v$1181[0]) {var t$1894 = v$1180[1];
var t$1895 = v$1181[1];
var v$1178 = t$1894;
var v$1179 = t$1895;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$1176 = fix$1893.$eq_list;
t$1896 = (eq_list$1176(v$1168[2],v$1169[2]));
return t$1896?(v$1168[3] == v$1169[3]):false;
} else {return false;
};
} else {return false;
};
 break; }default: {return false;
} };
};
tools$0DiGraph$1.mk_graph$83 = function(v$85){return null;
};
tools$0DiGraph$1.add_node_to_graph$86 = function(v$87){return v$87;
};
tools$0DiGraph$1.mk_node$88 = function(info$91){var t$1899 = tools$0UnionFindPoly$1.mkElement$135;
var t$1898;
var t$1897;
var v$93 = [false];
t$1897 = [[0],info$91,null,v$93];
t$1898 = [0,t$1897];
return t$1899(t$1898);
};
tools$0DiGraph$1.mk_edge$96 = function(v$116,v$117){var v$106 = tools$0UnionFindPoly$1.find_info$86(v$116);
var v$111 = v$106[1];
var v$112 = v$111[1];
var v$113 = v$111[2];
var v$114 = v$111[3];
var v$115 = v$111[0];
return tools$0UnionFindPoly$1.set_info$112(v$116,[0,[v$115,v$112,[v$117,v$113],v$114]]);
};
tools$0DiGraph$1.add_edges$118 = function(v$138,v$139){var v$128 = tools$0UnionFindPoly$1.find_info$86(v$138);
var v$133 = v$128[1];
var v$134 = v$133[1];
var v$135 = v$133[2];
var v$136 = v$133[3];
var v$137 = v$133[0];
return tools$0UnionFindPoly$1.set_info$112(v$138,[0,[v$137,v$134,basis$0List$1.s$n$686(v$139,v$135),v$136]]);
};
tools$0DiGraph$1.eq_nodes$140 = function(v$145,v$146){return tools$0UnionFindPoly$1.eq_Elements$128(v$145,v$146);
};
tools$0DiGraph$1.union$147 = function(info_combine$150,v$154){var v$181 = v$154[0];
var v$182 = v$154[1];
return tools$0UnionFindPoly$1.union$139(function(v$1185){var v$1186 = v$1185[0];
var v$1187 = v$1186[1];
var v$1188 = v$1187[1];
var v$1189 = v$1187[2];
var v$1190 = v$1185[1];
var v$1191 = v$1190[1];
var v$1192 = v$1191[1];
var v$1193 = v$1191[2];
var v$1194 = v$1191[0];
var v$1195 = v$1191[3];
return [0,[v$1194,info_combine$150([v$1188,v$1192]),basis$0List$1.s$n$686(v$1189,v$1193),v$1195]];
},[v$181,v$182]);
};
tools$0DiGraph$1.union_left$183 = function(info_combine$186,v$190){var v$217 = v$190[0];
var v$218 = v$190[1];
return tools$0UnionFindPoly$1.union$139(function(v$1196){var v$1197 = v$1196[0];
var v$1198 = v$1197[1];
var v$1199 = v$1198[1];
var v$1200 = v$1198[2];
var v$1201 = v$1198[3];
var v$1202 = v$1198[0];
var v$1203 = v$1196[1];
var v$1204 = v$1203[1];
var v$1205 = v$1204[1];
return [0,[v$1202,info_combine$186([v$1199,v$1205]),v$1200,v$1201]];
},[v$217,v$218]);
};
tools$0DiGraph$1.find$219 = function(n$222){return tools$0UnionFindPoly$1.find$66(n$222);
};
tools$0DiGraph$1.find_info$223 = function(n$226){return (tools$0UnionFindPoly$1.find_info$86(n$226))[1][1];
};
tools$0DiGraph$1.find_rep_and_info$232 = function(n$235){var v$239 = tools$0UnionFindPoly$1.find_rep_and_info$99(n$235);
return [v$239[0],v$239[1][1][1]];
};
tools$0DiGraph$1.union_graph$244 = function(v$247,v$250){if (v$250 == null) {return tools$0Crash$1.impossible$59("DiGraph.union_graph");
} else {var v$263 = v$250;
var v$264 = v$263[0];
var v$265 = v$263[1];
var n$1206;
var fix$1900 = {};
fix$1900.$foldl = function(v$1209,v$1210){lab$foldl: while (true) {if (v$1210 == null) {return v$1209;
} else {var v$1211 = v$1210;
var v$1212 = v$1211[0];
var v$1213 = v$1211[1];
var t$1904 = tools$0UnionFindPoly$1.union$139((function(env$1903){return function(v$1851){var v$1901 = env$1903[0];
var v$1902 = env$1903[1];
var v$1852 = v$1851[0];
var v$1853 = v$1852[1];
var v$1854 = v$1853[1];
var v$1855 = v$1853[2];
var v$1856 = v$1851[1];
var v$1857 = v$1856[1];
var v$1858 = v$1857[1];
var v$1859 = v$1857[2];
var v$1860 = v$1857[0];
var v$1861 = v$1857[3];
return [0,[v$1860,v$1902([v$1854,v$1858]),v$1901(v$1855,v$1859),v$1861]];
};
})([basis$0List$1.s$n$686,v$247]),[v$1212,v$1209]);
var t$1905 = v$1213;
var v$1209 = t$1904;
var v$1210 = t$1905;
continue lab$foldl;
};
};
};
var foldl$1208 = fix$1900.$foldl;
n$1206 = (foldl$1208(v$264,v$265));
return tools$0UnionFindPoly$1.find$66(n$1206);
};
};
tools$0DiGraph$1.set_info$267 = function(n$270,info$$273){var v$279 = tools$0UnionFindPoly$1.find_info$86(n$270);
var v$284 = v$279[1];
var v$286 = v$284[2];
var v$287 = v$284[3];
var v$288 = v$284[0];
return tools$0UnionFindPoly$1.set_info$112(n$270,[0,[v$288,info$$273,v$286,v$287]]);
};
tools$0DiGraph$1.out_of_node$289 = function(n$292){return (tools$0UnionFindPoly$1.find_info$86(n$292))[1][2];
};
tools$0DiGraph$1.find_visited$320 = function(n$323){return (tools$0UnionFindPoly$1.find_info$86(n$323))[1][3];
};
tools$0DiGraph$1.unvisit$386 = function(g$389){var fix$1906 = {};
fix$1906.$app = function(v$1237){lab$app: while (true) {if (v$1237 == null) {return 0;
} else {var v$1238 = v$1237;
var v$1239 = v$1238[0];
var v$1240 = v$1238[1];
((tools$0UnionFindPoly$1.find_info$86(v$1239))[1][3][0] = false,0);
var t$1907 = v$1240;
var v$1237 = t$1907;
continue lab$app;
};
};
};
var app$1236 = fix$1906.$app;
return app$1236(g$389);
};
tools$0DiGraph$1.union_without_edge_duplication$400 = function(info_combine$403,visit_children$406,v$410){var v$473 = v$410[0];
var v$474 = v$410[1];
var visited_nodes$411 = [null];
var fix$1908 = {};
fix$1908.$onto = function(v$424,v$1864){lab$onto: while (true) {if (v$424 == null) {return v$1864;
} else {var v$440 = v$424;
var v$441 = v$440[0];
var v$442 = v$440[1];
var t$1910 = v$442;
var t$1909;
var n$426 = tools$0UnionFindPoly$1.find$66(v$441);
var r$427 = (tools$0UnionFindPoly$1.find_info$86(n$426))[1][3];
if (r$427[0]) {t$1909 = v$1864;
} else {(r$427[0] = true,0);
(visited_nodes$411[0] = [n$426,visited_nodes$411[0]],0);
t$1909 = ((visit_children$406((tools$0UnionFindPoly$1.find_info$86(n$426))[1][1]))?(fix$1908.$onto((tools$0UnionFindPoly$1.find_info$86(n$426))[1][2],v$1864)):[n$426,v$1864]);
};
var t$1911 = t$1910;
var t$1912 = t$1909;
var v$424 = t$1911;
var v$1864 = t$1912;
continue lab$onto;
};
};
};
var onto$412 = fix$1908.$onto;
return tools$0UnionFindPoly$1.union$139(function(v$1295){var v$1296 = v$1295[0];
var v$1297 = v$1296[1];
var v$1298 = v$1297[1];
var v$1299 = v$1297[2];
var v$1300 = v$1295[1];
var v$1301 = v$1300[1];
var v$1302 = v$1301[1];
var v$1303 = v$1301[2];
var v$1304 = v$1301[0];
var v$1305 = v$1301[3];
var t$1918;
var t$1917 = v$1304;
var t$1916 = info_combine$403([v$1298,v$1302]);
var t$1913;
var result$1306 = onto$412(v$1299,onto$412(v$1303,null));
var g$1307 = visited_nodes$411[0];
var fix$1914 = {};
fix$1914.$app = function(v$1309){lab$app: while (true) {if (v$1309 == null) {return 0;
} else {var v$1310 = v$1309;
var v$1311 = v$1310[0];
var v$1312 = v$1310[1];
((tools$0UnionFindPoly$1.find_info$86(v$1311))[1][3][0] = false,0);
var t$1915 = v$1312;
var v$1309 = t$1915;
continue lab$app;
};
};
};
var app$1308 = fix$1914.$app;
app$1308(g$1307);
t$1913 = result$1306;
t$1918 = [t$1917,t$1916,t$1913,v$1305];
return [0,t$1918];
},[v$473,v$474]);
};
tools$0DiGraph$1.layout_node$475 = function(layout_info$478,n$481){var v$484 = tools$0UnionFindPoly$1.find_info$86(n$481);
var v$485 = v$484[1];
var v$486 = v$485[1];
return layout_info$478(v$486);
};
var pu_boolref$509 = pickle$0pickle$1.refOneGen$1282(pickle$0pickle$1.bool$732);
var pu_intref$510 = pickle$0pickle$1.refOneGen$1282(pickle$0pickle$1.int$729);
tools$0DiGraph$1.pu$511 = function(v$573,v$572,v$574){return function(pu_info$519){var dummy$520;
var t$1919;
var v$522 = [false];
t$1919 = [[0],v$573,null,v$522];
dummy$520 = [0,t$1919];
var pu_node$531 = (pickle$0pickle$1.cache$2484("DiGraph.node"))(function(x$1336){var x$1884 = tools$0UnionFindPoly$1.pu$194(dummy$520,x$1336);
return v$574(pickle$0pickle$1.nameGen$2624("DiGraph.node",x$1884));
});
var pu_graph$532 = (pickle$0pickle$1.cache$2484("DiGraph.graph"))(function(x$1344){var x$1888 = pu_node$531(x$1344);
var v$1889 = pickle$0pickle$1.listGen$2109(x$1888);
return pickle$0pickle$1.nameGen$2624("DiGraph.graph",v$1889);
});
var pu_graphnode$533 = pickle$0pickle$1.dataGen$1488(["DiGraph.graphnode",function(v$1352){return 0;
},[function(pu$1353){return pickle$0pickle$1.maybeNewHash$2065(function(v$1354){var v$1355 = v$1354[1];
var v$1356 = v$1355[1];
return v$572(v$1356);
},pickle$0pickle$1.con1$2014(function(v$1357){return [0,[v$1357[2],v$1357[0],v$1357[3],v$1357[1]]];
},function(v$1358){var v$1359 = v$1358[1];
return [v$1359[1],v$1359[3],v$1359[0],v$1359[2]];
},pickle$0pickle$1.tup4Gen0$2377(pu_info$519,pu_boolref$509,pu_intref$510,pu_graph$532(pu$1353))));
},null]]);
return [pu_node$531(pu_graphnode$533),pu_graph$532(pu_graphnode$533)];
};
};
tools$0DiGraph$1.nodes$575 = function(g$578){return g$578;
};
var fix$1920 = {};
fix$1920.$visit_all = function(n$583){var n$584 = tools$0UnionFindPoly$1.find$66(n$583);
var r$585 = (tools$0UnionFindPoly$1.find_info$86(n$584))[1][3];
if (r$585[0]) {return 0;
} else {(r$585[0] = true,0);
return fix$1920.$visit_all$((tools$0UnionFindPoly$1.find_info$86(n$584))[1][2]);
};
};
fix$1920.$visit_all$ = function(v$594){if (v$594 == null) {return 0;
} else {var v$603 = v$594;
var v$604 = v$603[0];
var v$605 = v$603[1];
fix$1920.$visit_all(v$604);
return fix$1920.$visit_all$(v$605);
};
};
tools$0DiGraph$1.visit_all$580 = fix$1920.$visit_all;
var visit_all$$579 = fix$1920.$visit_all$;
var fix$1921 = {};
fix$1921.$unvisit_all = function(n$610){var n$611 = tools$0UnionFindPoly$1.find$66(n$610);
var r$612 = (tools$0UnionFindPoly$1.find_info$86(n$611))[1][3];
if (r$612[0]) {(r$612[0] = false,0);
return fix$1921.$unvisit_all$((tools$0UnionFindPoly$1.find_info$86(n$611))[1][2]);
} else {return 0;
};
};
fix$1921.$unvisit_all$ = function(v$621){if (v$621 == null) {return 0;
} else {var v$630 = v$621;
var v$631 = v$630[0];
var v$632 = v$630[1];
fix$1921.$unvisit_all(v$631);
return fix$1921.$unvisit_all$(v$632);
};
};
tools$0DiGraph$1.unvisit_all$607 = fix$1921.$unvisit_all;
var unvisit_all$$606 = fix$1921.$unvisit_all$;
tools$0DiGraph$1.bottom_up_dfs$633 = function(g$636){var fix$1922 = {};
fix$1922.$search = function(v$651,v$652){var n$643 = tools$0UnionFindPoly$1.find$66(v$651);
var r$644 = (tools$0UnionFindPoly$1.find_info$86(n$643))[1][3];
if (r$644[0]) {return v$652;
} else {(r$644[0] = true,0);
return fix$1922.$search$((tools$0UnionFindPoly$1.find_info$86(n$643))[1][2],[n$643,v$652]);
};
};
fix$1922.$search$ = function(v$664,v$1865){if (v$664 == null) {return v$1865;
} else {var v$666 = v$664;
var v$667 = v$666[0];
var v$668 = v$666[1];
return fix$1922.$search$(v$668,fix$1922.$search(v$667,v$1865));
};
};
var search$638 = fix$1922.$search;
var search$$637 = fix$1922.$search$;
var result$670 = search$$637(g$636,null);
var fix$1923 = {};
fix$1923.$app = function(v$1377){lab$app: while (true) {if (v$1377 == null) {return 0;
} else {var v$1378 = v$1377;
var v$1379 = v$1378[0];
var v$1380 = v$1378[1];
((tools$0UnionFindPoly$1.find_info$86(v$1379))[1][3][0] = false,0);
var t$1924 = v$1380;
var v$1377 = t$1924;
continue lab$app;
};
};
};
var app$1376 = fix$1923.$app;
app$1376(result$670);
return result$670;
};
tools$0DiGraph$1.dfs$673 = function(g$676){return basis$0List$1.rev$257(tools$0DiGraph$1.bottom_up_dfs$633(g$676));
};
tools$0DiGraph$1.subgraph$677 = function(l$680){return basis$0List$1.rev$257(tools$0DiGraph$1.bottom_up_dfs$633(l$680));
};
tools$0DiGraph$1.topsort$681 = function(l$684){var fix$1925 = {};
fix$1925.$search$ = function(v$1866,v$698){if (v$698 == null) {return v$1866;
} else {var v$701 = v$698;
var v$702 = v$701[0];
var v$703 = v$701[1];
return fix$1925.$search$(fix$1925.$search(v$702,v$1866),v$703);
};
};
fix$1925.$search = function(v$716,v$717){var n$708 = tools$0UnionFindPoly$1.find$66(v$716);
var r$709 = (tools$0UnionFindPoly$1.find_info$86(n$708))[1][3];
if (r$709[0]) {return v$717;
} else {(r$709[0] = true,0);
return [n$708,fix$1925.$search$(v$717,(tools$0UnionFindPoly$1.find_info$86(n$708))[1][2])];
};
};
var search$$686 = fix$1925.$search$;
var search$685 = fix$1925.$search;
var result$718 = search$$686(null,l$684);
var fix$1926 = {};
fix$1926.$app = function(v$1394){lab$app: while (true) {if (v$1394 == null) {return 0;
} else {var v$1395 = v$1394;
var v$1396 = v$1395[0];
var v$1397 = v$1395[1];
((tools$0UnionFindPoly$1.find_info$86(v$1396))[1][3][0] = false,0);
var t$1927 = v$1397;
var v$1394 = t$1927;
continue lab$app;
};
};
};
var app$1393 = fix$1926.$app;
app$1393(result$718);
return result$718;
};
var en$EmptyStack$721 = new String("EmptyStack");
var exn$EmptyStack$721 = [en$EmptyStack$721];
tools$0DiGraph$1.scc$759 = function(layout_info$762,g$765){var scc_list$766 = [null];
var fix$1928 = {};
fix$1928.$min_list = function(v$1867,v$779){lab$min_list: while (true) {if (v$779 == null) {return v$1867;
} else {var v$786 = v$779;
var v$787 = v$786[0];
var v$788 = v$786[1];
if (v$787 < v$1867) {var t$1929 = v$787;
var t$1930 = v$788;
var v$1867 = t$1929;
var v$779 = t$1930;
continue lab$min_list;
} else {var t$1931 = v$1867;
var t$1932 = v$788;
var v$1867 = t$1931;
var v$779 = t$1932;
continue lab$min_list;
};
};
};
};
var min_list$767 = fix$1928.$min_list;
var count$800 = [1];
var stack$805 = [null];
var fix$1933 = {};
fix$1933.$lowlink = function(n$809){var n$810 = tools$0UnionFindPoly$1.find$66(n$809);
((tools$0UnionFindPoly$1.find_info$86(n$810))[1][3][0] = true,0);
((tools$0UnionFindPoly$1.find_info$86(n$810))[1][0][0] = count$800[0],0);
(count$800[0] = (SmlPrims.chk_ovf_i32(count$800[0] + 1)),0);
(stack$805[0] = [n$810,stack$805[0]],0);
var low$819 = (tools$0UnionFindPoly$1.find_info$86(n$810))[1][0][0];
var low$820 = min_list$767(low$819,basis$0List$1.map$697(function(w$823){var w$824 = tools$0UnionFindPoly$1.find$66(w$823);
if ((tools$0UnionFindPoly$1.find_info$86(w$824))[1][3][0]) {var v$1817 = (tools$0UnionFindPoly$1.find_info$86(w$824))[1][0][0];
return (v$1817 == 0)?low$819:((low$819 < v$1817)?low$819:v$1817);
} else {return fix$1933.$lowlink(w$824);
};
},(tools$0UnionFindPoly$1.find_info$86(n$810))[1][2]));
var fix$1940 = {};
fix$1940.$loop = function(v$831){lab$loop: while (true) {var x$832;
var res$1446;
try {res$1446 = (basis$0List$1.hd$676(stack$805[0]));
} catch(v$1941) {res$1446 = (((function(env$1942){return function(Hd$1448){throw exn$EmptyStack$721;
};
})([]))(v$1941));
};
try {(stack$805[0] = (basis$0List$1.tl$677(stack$805[0])),0);
0;
} catch(v$1943) {((function(env$1944){return function(Tl$1451){throw exn$EmptyStack$721;
};
})([]))(v$1943);
};
x$832 = res$1446;
((tools$0UnionFindPoly$1.find_info$86(x$832))[1][0][0] = 0,0);
(scc_list$766[0] = [[x$832,basis$0List$1.hd$676(scc_list$766[0])],basis$0List$1.tl$677(scc_list$766[0])],0);
if (tools$0UnionFindPoly$1.eq_Elements$128(x$832,n$810)) {return 0;
} else {var t$1945 = 0;
var v$831 = t$1945;
continue lab$loop;
};
};
};
var loop$829 = fix$1940.$loop;
if (low$820 == (tools$0UnionFindPoly$1.find_info$86(n$810))[1][0][0]) {(scc_list$766[0] = [null,scc_list$766[0]],0);
loop$829(0);
} else {0;
};
return low$820;
};
var lowlink$806 = fix$1933.$lowlink;
var fix$1934 = {};
fix$1934.$app = function(v$1466){lab$app: while (true) {if (v$1466 == null) {return 0;
} else {var v$1467 = v$1466;
var v$1468 = v$1467[0];
var v$1469 = v$1467[1];
((tools$0UnionFindPoly$1.find_info$86(v$1468))[1][0][0] = 0,0);
var t$1935 = v$1469;
var v$1466 = t$1935;
continue lab$app;
};
};
};
var app$1465 = fix$1934.$app;
app$1465(g$765);
var fix$1936 = {};
fix$1936.$app = function(v$1482){lab$app: while (true) {if (v$1482 == null) {return 0;
} else {var v$1483 = v$1482;
var v$1484 = v$1483[0];
var v$1485 = v$1483[1];
var n$1490 = tools$0UnionFindPoly$1.find$66(v$1484);
if ((tools$0UnionFindPoly$1.find_info$86(n$1490))[1][3][0]) {0;
} else {lowlink$806(n$1490);
0;
};
var t$1937 = v$1485;
var v$1482 = t$1937;
continue lab$app;
};
};
};
var app$1481 = fix$1936.$app;
app$1481(g$765);
var fix$1938 = {};
fix$1938.$app = function(v$1495){lab$app: while (true) {if (v$1495 == null) {return 0;
} else {var v$1496 = v$1495;
var v$1497 = v$1496[0];
var v$1498 = v$1496[1];
((tools$0UnionFindPoly$1.find_info$86(v$1497))[1][3][0] = false,0);
var t$1939 = v$1498;
var v$1495 = t$1939;
continue lab$app;
};
};
};
var app$1494 = fix$1938.$app;
app$1494(g$765);
return basis$0List$1.rev$682(scc_list$766[0]);
};
tools$0DiGraph$1.bottom_up_eval$865 = function(f$868,g$871){var fix$1946 = {};
fix$1946.$search = function(n$875){var n$876 = tools$0UnionFindPoly$1.find$66(n$875);
var r$877 = (tools$0UnionFindPoly$1.find_info$86(n$876))[1][3];
if (r$877[0]) {return 0;
} else {var ns$882 = (tools$0UnionFindPoly$1.find_info$86(n$876))[1][2];
(r$877[0] = true,0);
return f$868([(tools$0UnionFindPoly$1.find_info$86(n$876))[1][1],basis$0List$1.map$697(function(n$$887){fix$1946.$search(n$$887);
return (tools$0UnionFindPoly$1.find_info$86(n$$887))[1][1];
},ns$882)]);
};
};
var search$872 = fix$1946.$search;
var fix$1947 = {};
fix$1947.$app = function(v$1514){lab$app: while (true) {if (v$1514 == null) {return 0;
} else {var v$1515 = v$1514;
var v$1516 = v$1515[0];
var v$1517 = v$1515[1];
search$872(v$1516);
var t$1948 = v$1517;
var v$1514 = t$1948;
continue lab$app;
};
};
};
var app$1513 = fix$1947.$app;
app$1513(g$871);
var fix$1949 = {};
fix$1949.$app = function(v$1520){lab$app: while (true) {if (v$1520 == null) {return 0;
} else {var v$1521 = v$1520;
var v$1522 = v$1521[0];
var v$1523 = v$1521[1];
((tools$0UnionFindPoly$1.find_info$86(v$1522))[1][3][0] = false,0);
var t$1950 = v$1523;
var v$1520 = t$1950;
continue lab$app;
};
};
};
var app$1519 = fix$1949.$app;
return app$1519(g$871);
};
tools$0DiGraph$1.quotient$931 = function(layout_info$934,info_combine$937,g$940){var g$$941 = basis$0List$1.map$697(function(v$1880){return tools$0DiGraph$1.union_graph$244(info_combine$937,v$1880);
},tools$0DiGraph$1.scc$759(layout_info$934,g$940));
var fix$1951 = {};
fix$1951.$do_children = function(xs$1609){lab$do_children: while (true) {if (xs$1609 == null) {return null;
} else {var v$1610 = xs$1609;
var v$1611 = v$1610[0];
var v$1612 = v$1610[1];
var n$1613 = tools$0UnionFindPoly$1.find$66(v$1611);
var r$1615 = (tools$0UnionFindPoly$1.find_info$86(n$1613))[1][3];
if (r$1615[0]) {var t$1952 = v$1612;
var xs$1609 = t$1952;
continue lab$do_children;
} else {(r$1615[0] = true,0);
return [n$1613,fix$1951.$do_children(v$1612)];
};
};
};
};
var do_children$1608 = fix$1951.$do_children;
var fix$1953 = {};
fix$1953.$app = function(v$1619){lab$app: while (true) {if (v$1619 == null) {return 0;
} else {var v$1620 = v$1619;
var v$1621 = v$1620[0];
var v$1622 = v$1620[1];
var children$1624 = (tools$0UnionFindPoly$1.find_info$86(v$1621))[1][2];
var fix$1954 = {};
fix$1954.$app = function(v$1626){lab$app: while (true) {if (v$1626 == null) {return 0;
} else {var v$1627 = v$1626;
var v$1628 = v$1627[0];
var v$1629 = v$1627[1];
((tools$0UnionFindPoly$1.find_info$86(v$1628))[1][3][0] = false,0);
var t$1955 = v$1629;
var v$1626 = t$1955;
continue lab$app;
};
};
};
var app$1625 = fix$1954.$app;
app$1625(children$1624);
((tools$0UnionFindPoly$1.find_info$86(v$1621))[1][3][0] = true,0);
var newout$1632 = do_children$1608(children$1624);
var v$1633 = tools$0UnionFindPoly$1.find_info$86(v$1621);
var v$1634 = v$1633[1];
var v$1635 = v$1634[1];
var v$1636 = v$1634[3];
var v$1637 = v$1634[0];
tools$0UnionFindPoly$1.set_info$112(v$1621,[0,[v$1637,v$1635,newout$1632,v$1636]]);
var t$1956 = v$1622;
var v$1619 = t$1956;
continue lab$app;
};
};
};
var app$1618 = fix$1953.$app;
app$1618(g$$941);
var fix$1957 = {};
fix$1957.$app = function(v$1640){lab$app: while (true) {if (v$1640 == null) {return 0;
} else {var v$1641 = v$1640;
var v$1642 = v$1641[0];
var v$1643 = v$1641[1];
((tools$0UnionFindPoly$1.find_info$86(v$1642))[1][3][0] = false,0);
var t$1958 = v$1643;
var v$1640 = t$1958;
continue lab$app;
};
};
};
var app$1639 = fix$1957.$app;
app$1639(g$$941);
return g$$941;
};
tools$0DiGraph$1.graft$944 = function(v$988,v$989){var n2$949 = tools$0UnionFindPoly$1.find$66(v$989);
var fix$1959 = {};
fix$1959.$accum = function(v$964,v$1868,v$1869){lab$accum: while (true) {if (v$964 == null) {return [v$1868,v$1869];
} else {var v$971 = v$964;
var v$972 = v$971[0];
var v$973 = v$971[1];
if ((tools$0UnionFindPoly$1.find_info$86(v$972))[1][3][0]) {var t$1960 = v$973;
var t$1961 = v$1868;
var t$1962 = v$1869;
var v$964 = t$1960;
var v$1868 = t$1961;
var v$1869 = t$1962;
continue lab$accum;
} else {var t$1963 = v$973;
var t$1964 = [v$972,v$1868];
var t$1965 = [v$972,v$1869];
var v$964 = t$1963;
var v$1868 = t$1964;
var v$1869 = t$1965;
continue lab$accum;
};
};
};
};
var accum$950 = fix$1959.$accum;
var v$983;
var t$1969 = accum$950;
var t$1968 = v$988;
var t$1967 = null;
var t$1966;
tools$0DiGraph$1.visit_all$580(n2$949);
t$1966 = (tools$0UnionFindPoly$1.find_info$86(n2$949))[1][2];
v$983 = (t$1969(t$1968,t$1967,t$1966));
var v$984 = v$983[0];
var v$985 = v$983[1];
var v$1654 = tools$0UnionFindPoly$1.find_info$86(n2$949);
var v$1655 = v$1654[1];
var v$1656 = v$1655[1];
var v$1657 = v$1655[3];
var v$1658 = v$1655[0];
tools$0UnionFindPoly$1.set_info$112(n2$949,[0,[v$1658,v$1656,v$985,v$1657]]);
tools$0DiGraph$1.unvisit_all$607(n2$949);
return [n2$949,v$984];
};
tools$0DiGraph$1.multi_graft$990 = function(bound_to_free$993,l$996){return basis$0List$1.map$697(function(v$1674){var v$1675 = v$1674[0];
var v$1676 = v$1674[1];
var m$1677 = tools$0UnionFindPoly$1.find$66(v$1676);
var fix$1970 = {};
fix$1970.$accum = function(v$1681,v$1870){lab$accum: while (true) {if (v$1681 == null) {return v$1870;
} else {var v$1682 = v$1681;
var v$1683 = v$1682[0];
var v$1684 = v$1682[1];
var v$1686 = v$1870[0];
var v$1687 = v$1870[1];
var child$1688 = tools$0UnionFindPoly$1.find$66(v$1683);
var v$1690 = bound_to_free$993(child$1688);
switch (v$1690[0]) { case 0: {var v$1691 = v$1690[1];
if ((tools$0UnionFindPoly$1.find_info$86(v$1691))[1][3][0]) {var t$1971 = v$1684;
var t$1972 = [v$1686,v$1687];
var v$1681 = t$1971;
var v$1870 = t$1972;
continue lab$accum;
} else {var t$1973 = v$1684;
var t$1974 = [[v$1691,v$1686],[v$1691,v$1687]];
var v$1681 = t$1973;
var v$1870 = t$1974;
continue lab$accum;
};
 break; }default: {var t$1975 = v$1684;
var t$1976 = fix$1970.$accum((tools$0UnionFindPoly$1.find_info$86(child$1688))[1][2],v$1870);
var v$1681 = t$1975;
var v$1870 = t$1976;
continue lab$accum;
} };
};
};
};
var accum$1679 = fix$1970.$accum;
var v$1694;
var t$1981 = accum$1679;
var t$1980;
var n$1695 = tools$0UnionFindPoly$1.find$66(v$1675);
t$1980 = (tools$0UnionFindPoly$1.find_info$86(n$1695))[1][2];
var t$1979;
var t$1978 = null;
var t$1977;
tools$0DiGraph$1.visit_all$580(m$1677);
t$1977 = (tools$0UnionFindPoly$1.find_info$86(m$1677))[1][2];
t$1979 = [t$1978,t$1977];
v$1694 = (t$1981(t$1980,t$1979));
var v$1698 = v$1694[0];
var v$1699 = v$1694[1];
var v$1702 = tools$0UnionFindPoly$1.find_info$86(m$1677);
var v$1703 = v$1702[1];
var v$1704 = v$1703[1];
var v$1705 = v$1703[3];
var v$1706 = v$1703[0];
tools$0UnionFindPoly$1.set_info$112(m$1677,[0,[v$1706,v$1704,v$1699,v$1705]]);
tools$0DiGraph$1.unvisit_all$607(m$1677);
return [m$1677,v$1698];
},l$996);
};
tools$0DiGraph$1.layout_graph$1051 = function(layout_info$1054,g$1057){var t$1982;
var v$1061 = [0,","];
t$1982 = [basis$0List$1.map$697(function(n$1708){var v$1709 = (tools$0UnionFindPoly$1.find_info$86(n$1708))[1][2];
if (v$1709 == null) {var v$1713 = tools$0UnionFindPoly$1.find_info$86(n$1708);
var v$1714 = v$1713[1];
var v$1715 = v$1714[1];
return layout_info$1054(v$1715);
} else {var t$1983;
var v$1716 = [1];
var t$1990;
var t$1989;
var t$1988;
var v$1719 = tools$0UnionFindPoly$1.find_info$86(n$1708);
var v$1720 = v$1719[1];
var v$1721 = v$1720[1];
t$1988 = (layout_info$1054(v$1721));
var t$1987;
var t$1986;
var t$1985;
var t$1984;
var v$1722 = [0,","];
t$1984 = [basis$0List$1.map$697(function(n$1724){var v$1725 = tools$0UnionFindPoly$1.find_info$86(n$1724);
var v$1726 = v$1725[1];
var v$1727 = v$1726[1];
return layout_info$1054(v$1727);
},v$1709),v$1722,")",2,"("];
t$1985 = [0,t$1984];
t$1986 = [t$1985,null];
t$1987 = t$1986;
t$1989 = [t$1988,t$1987];
t$1990 = t$1989;
t$1983 = [t$1990,v$1716,"",0,""];
return [0,t$1983];
};
},g$1057),v$1061,"]",1,"["];
return [0,t$1982];
};
tools$0DiGraph$1.layout_nodes_deep$1063 = function(layout_info$1066,g$1069){var fix$1991 = {};
fix$1991.$layout = function(n$1090){lab$layout: while (true) {var n$1091 = tools$0UnionFindPoly$1.find$66(n$1090);
if ((tools$0UnionFindPoly$1.find_info$86(n$1091))[1][3][0]) {var t$1992;
var v$1099 = [1];
var t$1995;
var t$1994;
var t$1993;
var v$1734 = tools$0UnionFindPoly$1.find_info$86(n$1091);
var v$1735 = v$1734[1];
var v$1736 = v$1735[1];
t$1993 = (layout_info$1066(v$1736));
t$1994 = [t$1993,null];
t$1995 = t$1994;
t$1992 = [t$1995,v$1099,"",1,"@"];
return [0,t$1992];
} else {((tools$0UnionFindPoly$1.find_info$86(n$1091))[1][3][0] = true,0);
if ((tools$0UnionFindPoly$1.find_info$86(n$1091))[1][2] == null) {var v$1744 = tools$0UnionFindPoly$1.find_info$86(n$1091);
var v$1745 = v$1744[1];
var v$1746 = v$1745[1];
return layout_info$1066(v$1746);
} else {var t$1996;
var v$1115 = [1];
var t$2005;
var t$2004;
var t$2003;
var v$1749 = tools$0UnionFindPoly$1.find_info$86(n$1091);
var v$1750 = v$1749[1];
var v$1751 = v$1750[1];
t$2003 = (layout_info$1066(v$1751));
var t$2002;
var t$2001;
var t$2000;
var t$1997;
var v$1110 = [0,","];
t$1997 = [basis$0List$1.map$697((function(env$1999){return function(v$1890){var v$1998 = env$1999[0];
return v$1998(v$1890);
};
})([fix$1991.$layout]),(tools$0UnionFindPoly$1.find_info$86(n$1091))[1][2]),v$1110,")",1,"("];
t$2000 = [0,t$1997];
t$2001 = [t$2000,null];
t$2002 = t$2001;
t$2004 = [t$2003,t$2002];
t$2005 = t$2004;
t$1996 = [t$2005,v$1115,"",0,""];
return [0,t$1996];
};
};
};
};
var layout$1087 = fix$1991.$layout;
var t$2012;
var t$2010;
if (g$1069 == null) {var t$2009;
var v$1757 = [0,","];
t$2009 = [basis$0List$1.map$697(function(v$1892){return layout$1087(v$1892);
},g$1069),v$1757,"]",1,"["];
t$2010 = [0,t$2009];
} else {var v$1124 = g$1069;
if (v$1124[1] == null) {var v$1126 = v$1124[0];
t$2010 = (layout$1087(v$1126));
} else {var t$2011;
var v$1755 = [0,","];
t$2011 = [basis$0List$1.map$697(function(v$1891){return layout$1087(v$1891);
},g$1069),v$1755,"]",1,"["];
t$2010 = [0,t$2011];
};
};
var t$2008;
var fix$2006 = {};
fix$2006.$app = function(v$1760){lab$app: while (true) {if (v$1760 == null) {return 0;
} else {var v$1761 = v$1760;
var v$1762 = v$1761[0];
var v$1763 = v$1761[1];
tools$0DiGraph$1.unvisit_all$607(v$1762);
var t$2007 = v$1763;
var v$1760 = t$2007;
continue lab$app;
};
};
};
var app$1759 = fix$2006.$app;
t$2008 = (app$1759(g$1069));
t$2012 = [t$2010,t$2008];
return t$2012[0];
};
tools$0DiGraph$1.layout_nodes$1133 = function(l$1136){return function(v$1882){return tools$0DiGraph$1.layout_graph$1051(l$1136,v$1882);
};
};
return 0;
})();
