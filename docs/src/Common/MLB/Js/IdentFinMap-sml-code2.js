if ((typeof(syntax_objects$0IdentFinMap$1$2)) == "undefined") {syntax_objects$0IdentFinMap$1$2 = {};
};
(function(){syntax_objects$0IdentFinMap$1$2.eq_bal$1366 = function(v$1368,v$1369){switch (v$1368) { case 0: {switch (v$1369) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1369) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1369) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
var fix$2043 = {};
fix$2043.$eq_tree = function(v$1374,v$1375,v$1371){lab$eq_tree: while (true) {var v$1372 = v$1371[0];
var v$1373 = v$1371[1];
if (v$1372 == null) {return (v$1373 == null)?true:false;
} else {if (v$1373 == null) {return false;
} else {var v$1376 = v$1372;
var v$1377 = v$1373;
if (v$1374([v$1376[0],v$1377[0]])) {if (v$1375([v$1376[1],v$1377[1]])) {if (fix$2043.$eq_tree(v$1374,v$1375,[v$1376[2],v$1377[2]])) {var t$2044 = v$1374;
var t$2045 = v$1375;
var t$2046 = [v$1376[3],v$1377[3]];
var v$1374 = t$2044;
var v$1375 = t$2045;
var v$1371 = t$2046;
continue lab$eq_tree;
} else {return false;
};
} else {return false;
};
} else {return false;
};
};
};
};
};
syntax_objects$0IdentFinMap$1$2.eq_tree$1370 = fix$2043.$eq_tree;
syntax_objects$0IdentFinMap$1$2.die$97 = function(s$100){return tools$0Crash$1.impossible$59("OrderFinMap." + s$100);
};
syntax_objects$0IdentFinMap$1$2.s$j$101 = function(v$106,v$107){return syntax_objects$0IdentFinMap$1$1.lt$55(v$106,v$107);
};
syntax_objects$0IdentFinMap$1$2.lt$108 = function(v$1381,v$1382){return syntax_objects$0IdentFinMap$1$1.lt$55(v$1381,v$1382);
};
syntax_objects$0IdentFinMap$1$2.eq$109 = function(v$118,v$119){return ((syntax_objects$0IdentFinMap$1$1.lt$55(v$118,v$119))?true:(syntax_objects$0IdentFinMap$1$1.lt$55(v$119,v$118)))?false:true;
};
syntax_objects$0IdentFinMap$1$2.empty$125 = function(v$2042){return null;
};
syntax_objects$0IdentFinMap$1$2.singleton$126 = function(v$2034,v$2035){return [v$2034,v$2035,null,null,2];
};
syntax_objects$0IdentFinMap$1$2.isEmpty$133 = function(v$136){return (v$136 == null)?true:false;
};
syntax_objects$0IdentFinMap$1$2.lookup$141 = function(t$144,key$147){var fix$2047 = {};
fix$2047.$search = function(v$151){lab$search: while (true) {if (v$151 == null) {return [1];
} else {var v$168 = v$151;
var v$169 = v$168[0];
var v$170 = v$168[1];
var v$171 = v$168[2];
var v$172 = v$168[3];
if (syntax_objects$0IdentFinMap$1$1.lt$55(key$147,v$169)) {var t$2048 = v$171;
var v$151 = t$2048;
continue lab$search;
} else {if (syntax_objects$0IdentFinMap$1$1.lt$55(v$169,key$147)) {var t$2049 = v$172;
var v$151 = t$2049;
continue lab$search;
} else {return [0,v$170];
};
};
};
};
};
var search$148 = fix$2047.$search;
return search$148(t$144);
};
syntax_objects$0IdentFinMap$1$2.en$Impossible$173 = new String("Impossible");
syntax_objects$0IdentFinMap$1$2.impossible$174 = function(s$177){throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMap" + s$177];
};
var en$ALREADYTHERE$178 = new String("ALREADYTHERE");
var exn$ALREADYTHERE$178 = [en$ALREADYTHERE$178];
syntax_objects$0IdentFinMap$1$2.add$401 = function(v$410,v$411,v$412){try {var fix$2051 = {};
fix$2051.$ins = function(v$1467){if (v$1467 == null) {return [true,[v$410,v$411,null,null,2]];
} else {var v$1468 = v$1467;
var v$1469 = v$1468[0];
var v$1470 = v$1468[1];
var v$1471 = v$1468[2];
var v$1472 = v$1468[3];
var v$1473 = v$1468[4];
if (syntax_objects$0IdentFinMap$1$1.lt$55(v$410,v$1469)) {var v$1477 = fix$2051.$ins(v$1471);
var v$1478 = v$1477[0];
var v$1479 = v$1477[1];
switch (v$1473) { case 2: {return v$1478?[true,[v$1469,v$1470,v$1479,v$1472,1]]:[false,[v$1469,v$1470,v$1479,v$1472,2]];
 break; }case 0: {return v$1478?[false,[v$1469,v$1470,v$1479,v$1472,2]]:[false,[v$1469,v$1470,v$1479,v$1472,0]];
 break; }default: {if (v$1478) {var v$1481;
if (v$1479 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLfinmap 1"];
} else {v$1481 = v$1479;
};
var v$1484 = v$1481[0];
var v$1485 = v$1481[1];
var v$1486 = v$1481[2];
var v$1487 = v$1481[3];
var v$1488 = v$1481[4];
var t$2052;
var v$1853 = 1;
switch (v$1488) { case 0: {switch (v$1853) { case 0: {t$2052 = true;
 break; }default: {t$2052 = false;
} };
 break; }case 1: {switch (v$1853) { case 1: {t$2052 = true;
 break; }default: {t$2052 = false;
} };
 break; }case 2: {switch (v$1853) { case 2: {t$2052 = true;
 break; }default: {t$2052 = false;
} };
 break; } };
if (t$2052) {return [false,[v$1484,v$1485,v$1486,[v$1469,v$1470,v$1487,v$1472,2],2]];
} else {var v$1496;
if (v$1487 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLfinmap 2"];
} else {v$1496 = v$1487;
};
var v$1499 = v$1496[0];
var v$1500 = v$1496[1];
var v$1501 = v$1496[2];
var v$1502 = v$1496[3];
var v$1503 = v$1496[4];
var t$2073 = false;
var t$2072;
var t$2071;
var t$2070 = v$1499;
var t$2069 = v$1500;
var t$2068;
var t$2067;
var t$2066 = v$1484;
var t$2065 = v$1485;
var t$2064 = v$1486;
var t$2063 = v$1501;
var t$2062;
var t$2061;
var v$1859 = 0;
switch (v$1503) { case 0: {switch (v$1859) { case 0: {t$2061 = true;
 break; }default: {t$2061 = false;
} };
 break; }case 1: {switch (v$1859) { case 1: {t$2061 = true;
 break; }default: {t$2061 = false;
} };
 break; }case 2: {switch (v$1859) { case 2: {t$2061 = true;
 break; }default: {t$2061 = false;
} };
 break; } };
t$2062 = (t$2061?1:2);
t$2067 = [t$2066,t$2065,t$2064,t$2063,t$2062];
t$2068 = t$2067;
var t$2060;
var t$2059;
var t$2058 = v$1469;
var t$2057 = v$1470;
var t$2056 = v$1502;
var t$2055 = v$1472;
var t$2054;
var t$2053;
var v$1863 = 1;
switch (v$1503) { case 0: {switch (v$1863) { case 0: {t$2053 = true;
 break; }default: {t$2053 = false;
} };
 break; }case 1: {switch (v$1863) { case 1: {t$2053 = true;
 break; }default: {t$2053 = false;
} };
 break; }case 2: {switch (v$1863) { case 2: {t$2053 = true;
 break; }default: {t$2053 = false;
} };
 break; } };
t$2054 = (t$2053?0:2);
t$2059 = [t$2058,t$2057,t$2056,t$2055,t$2054];
t$2060 = t$2059;
t$2071 = [t$2070,t$2069,t$2068,t$2060,2];
t$2072 = t$2071;
return [t$2073,t$2072];
};
} else {return [false,[v$1469,v$1470,v$1479,v$1472,1]];
};
} };
} else {if (syntax_objects$0IdentFinMap$1$1.lt$55(v$1469,v$410)) {var v$1521 = fix$2051.$ins(v$1472);
var v$1522 = v$1521[0];
var v$1523 = v$1521[1];
switch (v$1473) { case 2: {return v$1522?[true,[v$1469,v$1470,v$1471,v$1523,0]]:[false,[v$1469,v$1470,v$1471,v$1523,2]];
 break; }case 1: {return v$1522?[false,[v$1469,v$1470,v$1471,v$1523,2]]:[false,[v$1469,v$1470,v$1471,v$1523,1]];
 break; }default: {if (v$1522) {var v$1525;
if (v$1523 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLfinmap 3"];
} else {v$1525 = v$1523;
};
var v$1528 = v$1525[0];
var v$1529 = v$1525[1];
var v$1530 = v$1525[2];
var v$1531 = v$1525[3];
var v$1532 = v$1525[4];
var t$2074;
var v$1873 = 0;
switch (v$1532) { case 0: {switch (v$1873) { case 0: {t$2074 = true;
 break; }default: {t$2074 = false;
} };
 break; }case 1: {switch (v$1873) { case 1: {t$2074 = true;
 break; }default: {t$2074 = false;
} };
 break; }case 2: {switch (v$1873) { case 2: {t$2074 = true;
 break; }default: {t$2074 = false;
} };
 break; } };
if (t$2074) {return [false,[v$1528,v$1529,[v$1469,v$1470,v$1471,v$1530,2],v$1531,2]];
} else {var v$1540;
if (v$1530 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLfinmap 4"];
} else {v$1540 = v$1530;
};
var v$1543 = v$1540[0];
var v$1544 = v$1540[1];
var v$1545 = v$1540[2];
var v$1546 = v$1540[3];
var v$1547 = v$1540[4];
var t$2095 = false;
var t$2094;
var t$2093;
var t$2092 = v$1543;
var t$2091 = v$1544;
var t$2090;
var t$2089;
var t$2088 = v$1469;
var t$2087 = v$1470;
var t$2086 = v$1471;
var t$2085 = v$1545;
var t$2084;
var t$2083;
var v$1879 = 0;
switch (v$1547) { case 0: {switch (v$1879) { case 0: {t$2083 = true;
 break; }default: {t$2083 = false;
} };
 break; }case 1: {switch (v$1879) { case 1: {t$2083 = true;
 break; }default: {t$2083 = false;
} };
 break; }case 2: {switch (v$1879) { case 2: {t$2083 = true;
 break; }default: {t$2083 = false;
} };
 break; } };
t$2084 = (t$2083?1:2);
t$2089 = [t$2088,t$2087,t$2086,t$2085,t$2084];
t$2090 = t$2089;
var t$2082;
var t$2081;
var t$2080 = v$1528;
var t$2079 = v$1529;
var t$2078 = v$1546;
var t$2077 = v$1531;
var t$2076;
var t$2075;
var v$1883 = 1;
switch (v$1547) { case 0: {switch (v$1883) { case 0: {t$2075 = true;
 break; }default: {t$2075 = false;
} };
 break; }case 1: {switch (v$1883) { case 1: {t$2075 = true;
 break; }default: {t$2075 = false;
} };
 break; }case 2: {switch (v$1883) { case 2: {t$2075 = true;
 break; }default: {t$2075 = false;
} };
 break; } };
t$2076 = (t$2075?0:2);
t$2081 = [t$2080,t$2079,t$2078,t$2077,t$2076];
t$2082 = t$2081;
t$2093 = [t$2092,t$2091,t$2090,t$2082,2];
t$2094 = t$2093;
return [t$2095,t$2094];
};
} else {return [false,[v$1469,v$1470,v$1471,v$1523,0]];
};
} };
} else {throw exn$ALREADYTHERE$178;
};
};
};
};
var ins$1466 = fix$2051.$ins;
return (ins$1466(v$412))[1];
} catch(v$2050) {return (function(ALREADYTHERE$409){var t$2096 = ALREADYTHERE$409;
if (t$2096[0] == en$ALREADYTHERE$178) {var fix$2097 = {};
fix$2097.$repl = function(v$1586){if (v$1586 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLupdate.repl"];
} else {var v$1589 = v$1586;
var v$1590 = v$1589[0];
var v$1591 = v$1589[1];
var v$1592 = v$1589[2];
var v$1593 = v$1589[3];
var v$1594 = v$1589[4];
return (syntax_objects$0IdentFinMap$1$1.lt$55(v$410,v$1590))?[v$1590,v$1591,fix$2097.$repl(v$1592),v$1593,v$1594]:((syntax_objects$0IdentFinMap$1$1.lt$55(v$1590,v$410))?[v$1590,v$1591,v$1592,fix$2097.$repl(v$1593),v$1594]:[v$1590,v$411,v$1592,v$1593,v$1594]);
};
};
var repl$1585 = fix$2097.$repl;
return repl$1585(v$412);
} else {throw ALREADYTHERE$409;
};
})(v$2050);
};
};
var fix$2098 = {};
fix$2098.$plus = function(v$431,v$432){lab$plus: while (true) {if (v$432 == null) {return v$431;
} else {var v$426 = v$432;
var v$427 = v$426[0];
var v$428 = v$426[1];
var v$429 = v$426[2];
var v$430 = v$426[3];
var t$2099 = fix$2098.$plus(syntax_objects$0IdentFinMap$1$2.add$401(v$427,v$428,v$431),v$429);
var t$2100 = v$430;
var v$431 = t$2099;
var v$432 = t$2100;
continue lab$plus;
};
};
};
syntax_objects$0IdentFinMap$1$2.plus$413 = fix$2098.$plus;
var en$NOTFOUND$433 = new String("NOTFOUND");
var exn$NOTFOUND$433 = [en$NOTFOUND$433];
var delete$434 = function(v$719,v$720){var balance1$439 = function(v$442){if (v$442 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMap(balance1 on an empty map)"];
} else {var v$512 = v$442;
var v$513 = v$512[0];
var v$514 = v$512[1];
var v$515 = v$512[2];
var v$516 = v$512[3];
switch (v$512[4]) { case 1: {return [[v$513,v$514,v$515,v$516,2],true];
 break; }case 2: {return [[v$513,v$514,v$515,v$516,0],false];
 break; }default: {var v$499;
if (v$516 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLfinmap 5"];
} else {v$499 = v$516;
};
var v$500 = v$499[0];
var v$501 = v$499[1];
var v$502 = v$499[2];
var v$503 = v$499[3];
switch (v$499[4]) { case 1: {var v$486;
if (v$502 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLfinmap 6"];
} else {v$486 = v$502;
};
var v$487 = v$486[0];
var v$488 = v$486[1];
var v$489 = v$486[2];
var v$490 = v$486[3];
var v$491 = v$486[4];
var t$2120;
var t$2119;
var t$2118 = v$487;
var t$2117 = v$488;
var t$2116;
var t$2115;
var t$2114 = v$513;
var t$2113 = v$514;
var t$2112 = v$515;
var t$2111 = v$489;
var t$2110;
var t$2109;
var v$1901 = 0;
switch (v$491) { case 0: {switch (v$1901) { case 0: {t$2109 = true;
 break; }default: {t$2109 = false;
} };
 break; }case 1: {switch (v$1901) { case 1: {t$2109 = true;
 break; }default: {t$2109 = false;
} };
 break; }case 2: {switch (v$1901) { case 2: {t$2109 = true;
 break; }default: {t$2109 = false;
} };
 break; } };
t$2110 = (t$2109?1:2);
t$2115 = [t$2114,t$2113,t$2112,t$2111,t$2110];
t$2116 = t$2115;
var t$2108;
var t$2107;
var t$2106 = v$500;
var t$2105 = v$501;
var t$2104 = v$490;
var t$2103 = v$503;
var t$2102;
var t$2101;
var v$1903 = 1;
switch (v$491) { case 0: {switch (v$1903) { case 0: {t$2101 = true;
 break; }default: {t$2101 = false;
} };
 break; }case 1: {switch (v$1903) { case 1: {t$2101 = true;
 break; }default: {t$2101 = false;
} };
 break; }case 2: {switch (v$1903) { case 2: {t$2101 = true;
 break; }default: {t$2101 = false;
} };
 break; } };
t$2102 = (t$2101?0:2);
t$2107 = [t$2106,t$2105,t$2104,t$2103,t$2102];
t$2108 = t$2107;
t$2119 = [t$2118,t$2117,t$2116,t$2108,2];
t$2120 = t$2119;
return [t$2120,true];
 break; }case 2: {return [[v$500,v$501,[v$513,v$514,v$515,v$502,0],v$503,1],false];
 break; }default: {return [[v$500,v$501,[v$513,v$514,v$515,v$502,2],v$503,2],true];
} };
} };
};
};
var balance2$518 = function(v$521){if (v$521 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMap(balance2 on an empty map)"];
} else {var v$591 = v$521;
var v$592 = v$591[0];
var v$593 = v$591[1];
var v$594 = v$591[2];
var v$595 = v$591[3];
switch (v$591[4]) { case 0: {return [[v$592,v$593,v$594,v$595,2],true];
 break; }case 2: {return [[v$592,v$593,v$594,v$595,1],false];
 break; }default: {var v$578;
if (v$594 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLfinmap 7"];
} else {v$578 = v$594;
};
var v$579 = v$578[0];
var v$580 = v$578[1];
var v$581 = v$578[2];
var v$582 = v$578[3];
switch (v$578[4]) { case 0: {var v$565;
if (v$582 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapAVLfinmap 8"];
} else {v$565 = v$582;
};
var v$566 = v$565[0];
var v$567 = v$565[1];
var v$568 = v$565[2];
var v$569 = v$565[3];
var v$570 = v$565[4];
var t$2140;
var t$2139;
var t$2138 = v$566;
var t$2137 = v$567;
var t$2136;
var t$2135;
var t$2134 = v$579;
var t$2133 = v$580;
var t$2132 = v$581;
var t$2131 = v$568;
var t$2130;
var t$2129;
var v$1913 = 0;
switch (v$570) { case 0: {switch (v$1913) { case 0: {t$2129 = true;
 break; }default: {t$2129 = false;
} };
 break; }case 1: {switch (v$1913) { case 1: {t$2129 = true;
 break; }default: {t$2129 = false;
} };
 break; }case 2: {switch (v$1913) { case 2: {t$2129 = true;
 break; }default: {t$2129 = false;
} };
 break; } };
t$2130 = (t$2129?1:2);
t$2135 = [t$2134,t$2133,t$2132,t$2131,t$2130];
t$2136 = t$2135;
var t$2128;
var t$2127;
var t$2126 = v$592;
var t$2125 = v$593;
var t$2124 = v$569;
var t$2123 = v$595;
var t$2122;
var t$2121;
var v$1911 = 1;
switch (v$570) { case 0: {switch (v$1911) { case 0: {t$2121 = true;
 break; }default: {t$2121 = false;
} };
 break; }case 1: {switch (v$1911) { case 1: {t$2121 = true;
 break; }default: {t$2121 = false;
} };
 break; }case 2: {switch (v$1911) { case 2: {t$2121 = true;
 break; }default: {t$2121 = false;
} };
 break; } };
t$2122 = (t$2121?0:2);
t$2127 = [t$2126,t$2125,t$2124,t$2123,t$2122];
t$2128 = t$2127;
t$2139 = [t$2138,t$2137,t$2136,t$2128,2];
t$2140 = t$2139;
return [t$2140,true];
 break; }case 2: {return [[v$579,v$580,v$581,[v$592,v$593,v$582,v$595,1],0],false];
 break; }default: {return [[v$579,v$580,v$581,[v$592,v$593,v$582,v$595,2],2],true];
} };
} };
};
};
var fix$2141 = {};
fix$2141.$remove_rightmost = function(v$600){if (v$600 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMap(remove_rightmost on empty map)"];
} else {var v$616 = v$600;
var v$617 = v$616[3];
if (v$617 == null) {return [v$616[2],v$616[0],v$616[1],true];
} else {var v$642 = v$616[0];
var v$643 = v$616[1];
var v$644 = v$616[2];
var v$645 = v$616[4];
var v$637 = fix$2141.$remove_rightmost(v$617);
var v$638 = v$637[0];
var v$639 = v$637[1];
var v$640 = v$637[2];
if (v$637[3]) {var v$634 = balance2$518([v$642,v$643,v$644,v$638,v$645]);
return [v$634[0],v$639,v$640,v$634[1]];
} else {return [[v$642,v$643,v$644,v$638,v$645],v$639,v$640,false];
};
};
};
};
var remove_rightmost$597 = fix$2141.$remove_rightmost;
var fix$2142 = {};
fix$2142.$del = function(v$649){if (v$649 == null) {throw exn$NOTFOUND$433;
} else {var v$709 = v$649;
var v$710 = v$709[0];
var v$711 = v$709[1];
var v$712 = v$709[2];
var v$713 = v$709[3];
var v$714 = v$709[4];
if (syntax_objects$0IdentFinMap$1$1.lt$55(v$719,v$710)) {var v$670 = fix$2142.$del(v$712);
var v$671 = v$670[0];
if (v$670[1]) {return balance1$439([v$710,v$711,v$671,v$713,v$714]);
} else {return [[v$710,v$711,v$671,v$713,v$714],false];
};
} else {if (syntax_objects$0IdentFinMap$1$1.lt$55(v$710,v$719)) {var v$684 = fix$2142.$del(v$713);
var v$685 = v$684[0];
if (v$684[1]) {return balance2$518([v$710,v$711,v$712,v$685,v$714]);
} else {return [[v$710,v$711,v$712,v$685,v$714],false];
};
} else {if (v$713 == null) {return [v$712,true];
} else {if (v$712 == null) {return [v$713,true];
} else {var v$704 = remove_rightmost$597(v$712);
var v$705 = v$704[0];
var v$706 = v$704[1];
var v$707 = v$704[2];
if (v$704[3]) {return balance1$439([v$706,v$707,v$705,v$713,v$714]);
} else {return [[v$706,v$707,v$705,v$713,v$714],false];
};
};
};
};
};
};
};
var del$646 = fix$2142.$del;
return (del$646(v$720))[0];
};
syntax_objects$0IdentFinMap$1$2.remove$721 = function(v$729,v$730){try {return [0,delete$434(v$729,v$730)];
} catch(v$2143) {return (function(NOTFOUND$728){var t$2144 = NOTFOUND$728;
if (t$2144[0] == en$NOTFOUND$433) {return [1];
} else {throw NOTFOUND$728;
};
})(v$2143);
};
};
syntax_objects$0IdentFinMap$1$2.delete$731 = function(v$739,v$740){try {return delete$434(v$739,v$740);
} catch(v$2145) {return (function(NOTFOUND$738){var t$2146 = NOTFOUND$738;
if (t$2146[0] == en$NOTFOUND$433) {return v$740;
} else {throw NOTFOUND$738;
};
})(v$2145);
};
};
syntax_objects$0IdentFinMap$1$2.dom$741 = function(m$744){var fix$2147 = {};
fix$2147.$dom$ = function(v$748,v$751){lab$dom$: while (true) {if (v$748 == null) {return v$751;
} else {var v$763 = v$748;
var v$764 = v$763[0];
var v$765 = v$763[2];
var v$766 = v$763[3];
var t$2148 = v$765;
var t$2149 = [v$764,fix$2147.$dom$(v$766,v$751)];
var v$748 = t$2148;
var v$751 = t$2149;
continue lab$dom$;
};
};
};
var dom$$745 = fix$2147.$dom$;
return dom$$745(m$744,null);
};
syntax_objects$0IdentFinMap$1$2.range$768 = function(m$771){var fix$2150 = {};
fix$2150.$ran = function(v$775,v$778){lab$ran: while (true) {if (v$775 == null) {return v$778;
} else {var v$790 = v$775;
var v$791 = v$790[1];
var v$792 = v$790[2];
var v$793 = v$790[3];
var t$2151 = v$792;
var t$2152 = [v$791,fix$2150.$ran(v$793,v$778)];
var v$775 = t$2151;
var v$778 = t$2152;
continue lab$ran;
};
};
};
var ran$772 = fix$2150.$ran;
return ran$772(m$771,null);
};
syntax_objects$0IdentFinMap$1$2.list$795 = function(m$798){var fix$2153 = {};
fix$2153.$li = function(v$802,v$805){lab$li: while (true) {if (v$802 == null) {return v$805;
} else {var v$818 = v$802;
var v$819 = v$818[0];
var v$820 = v$818[1];
var v$821 = v$818[2];
var v$822 = v$818[3];
var t$2154 = v$821;
var t$2155 = [[v$819,v$820],fix$2153.$li(v$822,v$805)];
var v$802 = t$2154;
var v$805 = t$2155;
continue lab$li;
};
};
};
var li$799 = fix$2153.$li;
return li$799(m$798,null);
};
var fix$2156 = {};
fix$2156.$composemap = function(f$827,t$830){if (t$830 == null) {return null;
} else {var v$841 = t$830;
var v$842 = v$841[0];
var v$843 = v$841[1];
var v$844 = v$841[2];
var v$845 = v$841[3];
var v$846 = v$841[4];
var l$$840 = fix$2156.$composemap(f$827,v$844);
return [v$842,f$827(v$843),l$$840,fix$2156.$composemap(f$827,v$845),v$846];
};
};
syntax_objects$0IdentFinMap$1$2.composemap$824 = fix$2156.$composemap;
var fix$2157 = {};
fix$2157.$ComposeMap = function(f$850,t$853){if (t$853 == null) {return null;
} else {var v$864 = t$853;
var v$865 = v$864[0];
var v$866 = v$864[1];
var v$867 = v$864[2];
var v$868 = v$864[3];
var v$869 = v$864[4];
var l$$863 = fix$2157.$ComposeMap(f$850,v$867);
return [v$865,f$850([v$865,v$866]),l$$863,fix$2157.$ComposeMap(f$850,v$868),v$869];
};
};
syntax_objects$0IdentFinMap$1$2.ComposeMap$847 = fix$2157.$ComposeMap;
syntax_objects$0IdentFinMap$1$2.fold$870 = function(f$873,e$876,t$879){var fix$2158 = {};
fix$2158.$fold$ = function(v$883,v$886){lab$fold$: while (true) {if (v$883 == null) {return v$886;
} else {var v$898 = v$883;
var v$899 = v$898[1];
var v$900 = v$898[2];
var v$901 = v$898[3];
var t$2159 = v$901;
var t$2160 = f$873([v$899,fix$2158.$fold$(v$900,v$886)]);
var v$883 = t$2159;
var v$886 = t$2160;
continue lab$fold$;
};
};
};
var fold$$880 = fix$2158.$fold$;
return fold$$880(t$879,e$876);
};
syntax_objects$0IdentFinMap$1$2.Fold$903 = function(f$906,e$909,t$912){var fix$2161 = {};
fix$2161.$fold$ = function(v$916,v$919){lab$fold$: while (true) {if (v$916 == null) {return v$919;
} else {var v$932 = v$916;
var v$933 = v$932[0];
var v$934 = v$932[1];
var v$935 = v$932[2];
var v$936 = v$932[3];
var t$2162 = v$936;
var t$2163 = f$906([[v$933,v$934],fix$2161.$fold$(v$935,v$919)]);
var v$916 = t$2162;
var v$919 = t$2163;
continue lab$fold$;
};
};
};
var fold$$913 = fix$2161.$fold$;
return fold$$913(t$912,e$909);
};
syntax_objects$0IdentFinMap$1$2.filter$938 = function(f$941,t$944){var fix$2164 = {};
fix$2164.$fold$ = function(v$1653,v$1654){lab$fold$: while (true) {if (v$1653 == null) {return v$1654;
} else {var v$1657 = v$1653;
var v$1658 = v$1657[0];
var v$1659 = v$1657[1];
var v$1660 = v$1657[2];
var v$1661 = v$1657[3];
var t$2166 = v$1661;
var t$2165;
var v$2025 = fix$2164.$fold$(v$1660,v$1654);
t$2165 = ((f$941([v$1658,v$1659]))?(syntax_objects$0IdentFinMap$1$2.add$401(v$1658,v$1659,v$2025)):v$2025);
var t$2167 = t$2166;
var t$2168 = t$2165;
var v$1653 = t$2167;
var v$1654 = t$2168;
continue lab$fold$;
};
};
};
var fold$$1652 = fix$2164.$fold$;
return fold$$1652(t$944,syntax_objects$0IdentFinMap$1$2.empty$125(0));
};
var fix$2169 = {};
fix$2169.$addList = function(v$961,v$964){lab$addList: while (true) {if (v$961 == null) {return v$964;
} else {var v$976 = v$961;
var v$977 = v$976[0];
var v$978 = v$977[0];
var v$979 = v$977[1];
var v$980 = v$976[1];
var t$2170 = v$980;
var t$2171 = syntax_objects$0IdentFinMap$1$2.add$401(v$978,v$979,v$964);
var v$961 = t$2170;
var v$964 = t$2171;
continue lab$addList;
};
};
};
syntax_objects$0IdentFinMap$1$2.addList$958 = fix$2169.$addList;
syntax_objects$0IdentFinMap$1$2.fromList$982 = function(l$985){return syntax_objects$0IdentFinMap$1$2.addList$958(l$985,syntax_objects$0IdentFinMap$1$2.empty$125(0));
};
syntax_objects$0IdentFinMap$1$2.fromSortedList$986 = function(l$989){var fix$2172 = {};
fix$2172.$build = function(v$1018,v$2036){switch (v$1018) { case 0: {return [v$2036,null];
 break; }default: {var n$$1020 = SmlPrims.div_i32(v$1018,2,CompilerInitial.exn$Div$47);
var v$1051 = fix$2172.$build(n$$1020,v$2036);
var v$1052 = v$1051[0];
var v$1053 = v$1051[1];
var v$1034;
if (v$1052 == null) {throw [syntax_objects$0IdentFinMap$1$2.en$Impossible$173,"OrderFinMapbuild"];
} else {var v$1046 = v$1052;
var v$1047 = v$1046[0];
v$1034 = [v$1047[0],v$1047[1],v$1046[1]];
};
var v$1035 = v$1034[0];
var v$1036 = v$1034[1];
var v$1037 = v$1034[2];
var v$1031 = fix$2172.$build(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$1018 - n$$1020)) - 1),v$1037);
return [v$1031[0],[v$1035,v$1036,v$1053,v$1031[1]]];
} };
};
var build$1007 = fix$2172.$build;
var fix$2173 = {};
fix$2173.$mk_avl = function(v$1069){if (v$1069 == null) {return [null,0];
} else {var v$1098 = v$1069;
var v$1099 = v$1098[0];
var v$1100 = v$1098[1];
var v$1101 = v$1098[2];
var v$1102 = v$1098[3];
var v$1095 = fix$2173.$mk_avl(v$1101);
var v$1096 = v$1095[0];
var v$1097 = v$1095[1];
var v$1092 = fix$2173.$mk_avl(v$1102);
var v$1093 = v$1092[0];
var v$1094 = v$1092[1];
return [[v$1099,v$1100,v$1096,v$1093,(v$1097 == v$1094)?2:((v$1097 > v$1094)?1:0)],SmlPrims.chk_ovf_i32(1 + ((v$1097 > v$1094)?v$1097:v$1094))];
};
};
var mk_avl$1066 = fix$2173.$mk_avl;
var t$2182;
var t$2181 = mk_avl$1066;
var t$2180;
var t$2179;
var t$2178 = build$1007;
var t$2177;
var fix$2174 = {};
fix$2174.$acc = function(v$1670,v$1671){lab$acc: while (true) {if (v$1670 == null) {return v$1671;
} else {var v$1672 = v$1670;
var v$1673 = v$1672[1];
var t$2175 = v$1673;
var t$2176 = SmlPrims.chk_ovf_i32(v$1671 + 1);
var v$1670 = t$2175;
var v$1671 = t$2176;
continue lab$acc;
};
};
};
var acc$1669 = fix$2174.$acc;
t$2177 = (acc$1669(l$989,0));
t$2179 = (t$2178(t$2177,l$989));
t$2180 = t$2179[1];
t$2182 = (t$2181(t$2180));
return t$2182[0];
};
syntax_objects$0IdentFinMap$1$2.mergeMap$1111 = function(f$1114,t1$1117,t2$1120){var fix$2183 = {};
fix$2183.$merge = function(v$1141,v$2037){if (v$1141 == null) {return v$2037;
} else {if (v$2037 == null) {return v$1141;
} else {var v$1152 = v$1141;
var v$1153 = v$1152[0];
var v$1154 = v$1153[0];
var v$1155 = v$1153[1];
var v$1156 = v$1152[1];
var v$1157 = v$2037;
var v$1158 = v$1157[0];
var v$1159 = v$1158[0];
var v$1160 = v$1158[1];
var v$1161 = v$1157[1];
return (syntax_objects$0IdentFinMap$1$1.lt$55(v$1154,v$1159))?[[v$1154,v$1155],fix$2183.$merge(v$1156,v$2037)]:((syntax_objects$0IdentFinMap$1$1.lt$55(v$1159,v$1154))?[[v$1159,v$1160],fix$2183.$merge(v$1141,v$1161)]:[[v$1154,f$1114([v$1155,v$1160])],fix$2183.$merge(v$1156,v$1161)]);
};
};
};
var merge$1121 = fix$2183.$merge;
var t$2194 = syntax_objects$0IdentFinMap$1$2.fromSortedList$986;
var t$2193;
var t$2192 = merge$1121;
var t$2191;
var fix$2188 = {};
fix$2188.$li = function(v$1682,v$1683){lab$li: while (true) {if (v$1682 == null) {return v$1683;
} else {var v$1686 = v$1682;
var v$1687 = v$1686[0];
var v$1688 = v$1686[1];
var v$1689 = v$1686[2];
var v$1690 = v$1686[3];
var t$2189 = v$1689;
var t$2190 = [[v$1687,v$1688],fix$2188.$li(v$1690,v$1683)];
var v$1682 = t$2189;
var v$1683 = t$2190;
continue lab$li;
};
};
};
var li$1681 = fix$2188.$li;
t$2191 = (li$1681(t1$1117,null));
var t$2187;
var fix$2184 = {};
fix$2184.$li = function(v$1694,v$1695){lab$li: while (true) {if (v$1694 == null) {return v$1695;
} else {var v$1698 = v$1694;
var v$1699 = v$1698[0];
var v$1700 = v$1698[1];
var v$1701 = v$1698[2];
var v$1702 = v$1698[3];
var t$2185 = v$1701;
var t$2186 = [[v$1699,v$1700],fix$2184.$li(v$1702,v$1695)];
var v$1694 = t$2185;
var v$1695 = t$2186;
continue lab$li;
};
};
};
var li$1693 = fix$2184.$li;
t$2187 = (li$1693(t2$1120,null));
t$2193 = (t$2192(t$2191,t$2187));
return t$2194(t$2193);
};
var fix$2195 = {};
fix$2195.$oneForWhich = function(f$1165,t$1168){lab$oneForWhich: while (true) {if (t$1168 == null) {return [1];
} else {var v$1188 = t$1168;
var v$1189 = v$1188[0];
var v$1190 = v$1188[1];
var v$1191 = v$1188[2];
var v$1192 = v$1188[3];
if (f$1165([v$1189,v$1190])) {return [0,[v$1189,v$1190]];
} else {var v$1185 = fix$2195.$oneForWhich(f$1165,v$1191);
switch (v$1185[0]) { case 0: {var v$1187 = v$1185[1];
return [0,v$1187];
 break; }default: {var t$2196 = f$1165;
var t$2197 = v$1192;
var f$1165 = t$2196;
var t$1168 = t$2197;
continue lab$oneForWhich;
} };
};
};
};
};
syntax_objects$0IdentFinMap$1$2.oneForWhich$1162 = fix$2195.$oneForWhich;
syntax_objects$0IdentFinMap$1$2.en$Restrict$1193 = new String("Restrict");
syntax_objects$0IdentFinMap$1$2.restrict$1194 = function(v$1213,v$1214,v$1215){var fix$2198 = {};
fix$2198.$foldl = function(v$1708,v$1709){lab$foldl: while (true) {if (v$1709 == null) {return v$1708;
} else {var v$1710 = v$1709;
var v$1711 = v$1710[0];
var v$1712 = v$1710[1];
var t$2202;
var v$1990;
var fix$2199 = {};
fix$2199.$search = function(v$1992){lab$search: while (true) {if (v$1992 == null) {return [1];
} else {var v$1993 = v$1992;
var v$1994 = v$1993[0];
var v$1995 = v$1993[1];
var v$1996 = v$1993[2];
var v$1997 = v$1993[3];
if (syntax_objects$0IdentFinMap$1$1.lt$55(v$1711,v$1994)) {var t$2200 = v$1996;
var v$1992 = t$2200;
continue lab$search;
} else {if (syntax_objects$0IdentFinMap$1$1.lt$55(v$1994,v$1711)) {var t$2201 = v$1997;
var v$1992 = t$2201;
continue lab$search;
} else {return [0,v$1995];
};
};
};
};
};
var search$1991 = fix$2199.$search;
v$1990 = (search$1991(v$1214));
switch (v$1990[0]) { case 0: {var v$1998 = v$1990[1];
t$2202 = (syntax_objects$0IdentFinMap$1$2.add$401(v$1711,v$1998,v$1708));
 break; }default: {throw [syntax_objects$0IdentFinMap$1$2.en$Restrict$1193,v$1213(v$1711)];
} };
var t$2203 = t$2202;
var t$2204 = v$1712;
var v$1708 = t$2203;
var v$1709 = t$2204;
continue lab$foldl;
};
};
};
var foldl$1707 = fix$2198.$foldl;
return foldl$1707(syntax_objects$0IdentFinMap$1$2.empty$125(0),v$1215);
};
syntax_objects$0IdentFinMap$1$2.enrich$1216 = function(en$1219,v$1223){var v$1244 = v$1223[0];
var v$1245 = v$1223[1];
var fix$2205 = {};
fix$2205.$fold$ = function(v$1732,v$1733){lab$fold$: while (true) {if (v$1732 == null) {return v$1733;
} else {var v$1736 = v$1732;
var v$1737 = v$1736[0];
var v$1738 = v$1736[1];
var v$1739 = v$1736[2];
var v$1740 = v$1736[3];
var t$2210 = v$1740;
var t$2209;
if (fix$2205.$fold$(v$1739,v$1733)) {var v$2003;
var fix$2206 = {};
fix$2206.$search = function(v$2005){lab$search: while (true) {if (v$2005 == null) {return [1];
} else {var v$2006 = v$2005;
var v$2007 = v$2006[0];
var v$2008 = v$2006[1];
var v$2009 = v$2006[2];
var v$2010 = v$2006[3];
if (syntax_objects$0IdentFinMap$1$1.lt$55(v$1737,v$2007)) {var t$2207 = v$2009;
var v$2005 = t$2207;
continue lab$search;
} else {if (syntax_objects$0IdentFinMap$1$1.lt$55(v$2007,v$1737)) {var t$2208 = v$2010;
var v$2005 = t$2208;
continue lab$search;
} else {return [0,v$2008];
};
};
};
};
};
var search$2004 = fix$2206.$search;
v$2003 = (search$2004(v$1244));
switch (v$2003[0]) { case 0: {var v$2011 = v$2003[1];
t$2209 = (en$1219([v$2011,v$1738]));
 break; }default: {t$2209 = false;
} };
} else {t$2209 = false;
};
var t$2211 = t$2210;
var t$2212 = t$2209;
var v$1732 = t$2211;
var v$1733 = t$2212;
continue lab$fold$;
};
};
};
var fold$$1731 = fix$2205.$fold$;
return fold$$1731(v$1245,true);
};
syntax_objects$0IdentFinMap$1$2.layoutMap$1246 = function(v$1279,v$1281,v$1280,v$1278){return function(layoutDom$1255){return function(layoutRan$1258){return function(m$1261){var t$2220;
var t$2219;
var t$2218 = basis$0List$1.map$697;
var t$2217 = function(v$1265){var v$1271 = v$1265[0];
var v$1272 = v$1265[1];
return [0,[[layoutDom$1255(v$1271),[layoutRan$1258(v$1272),null]],[0,v$1279],"",3,""]];
};
var t$2216;
var fix$2213 = {};
fix$2213.$li = function(v$1759,v$1760){lab$li: while (true) {if (v$1759 == null) {return v$1760;
} else {var v$1763 = v$1759;
var v$1764 = v$1763[0];
var v$1765 = v$1763[1];
var v$1766 = v$1763[2];
var v$1767 = v$1763[3];
var t$2214 = v$1766;
var t$2215 = [[v$1764,v$1765],fix$2213.$li(v$1767,v$1760)];
var v$1759 = t$2214;
var v$1760 = t$2215;
continue lab$li;
};
};
};
var li$1758 = fix$2213.$li;
t$2216 = (li$1758(m$1261,null));
t$2219 = (t$2218(t$2217,t$2216));
t$2220 = [t$2219,[0,v$1280],v$1281,3,v$1278];
return [0,t$2220];
};
};
};
};
syntax_objects$0IdentFinMap$1$2.reportMap$1282 = function(f$1285,t$1288){var t$2228 = tools$0Report$1.flatten$87;
var t$2227;
var t$2226 = basis$0List$1.map$697;
var t$2225 = f$1285;
var t$2224;
var fix$2221 = {};
fix$2221.$li = function(v$1771,v$1772){lab$li: while (true) {if (v$1771 == null) {return v$1772;
} else {var v$1775 = v$1771;
var v$1776 = v$1775[0];
var v$1777 = v$1775[1];
var v$1778 = v$1775[2];
var v$1779 = v$1775[3];
var t$2222 = v$1778;
var t$2223 = [[v$1776,v$1777],fix$2221.$li(v$1779,v$1772)];
var v$1771 = t$2222;
var v$1772 = t$2223;
continue lab$li;
};
};
};
var li$1770 = fix$2221.$li;
t$2224 = (li$1770(t$1288,null));
t$2227 = (t$2226(t$2225,t$2224));
return t$2228(t$2227);
};
syntax_objects$0IdentFinMap$1$2.reportMapSORTED$1289 = function(f$1781,t$1782){var t$2236 = tools$0Report$1.flatten$87;
var t$2235;
var t$2234 = basis$0List$1.map$697;
var t$2233 = f$1781;
var t$2232;
var fix$2229 = {};
fix$2229.$li = function(v$1785,v$1786){lab$li: while (true) {if (v$1785 == null) {return v$1786;
} else {var v$1789 = v$1785;
var v$1790 = v$1789[0];
var v$1791 = v$1789[1];
var v$1792 = v$1789[2];
var v$1793 = v$1789[3];
var t$2230 = v$1792;
var t$2231 = [[v$1790,v$1791],fix$2229.$li(v$1793,v$1786)];
var v$1785 = t$2230;
var v$1786 = t$2231;
continue lab$li;
};
};
};
var li$1784 = fix$2229.$li;
t$2232 = (li$1784(t$1782,null));
t$2235 = (t$2234(t$2233,t$2232));
return t$2236(t$2235);
};
syntax_objects$0IdentFinMap$1$2.pu_bal$1290 = pickle$0pickle$1.enumGen$2158(function(v$1795){var v$1796 = v$1795[0];
var v$1797 = v$1795[1];
switch (v$1796) { case 0: {switch (v$1797) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1797) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1797) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderFinMap.bal",[1,[2,[0,null]]]]);
syntax_objects$0IdentFinMap$1$2.pu$1291 = function(pu_dom$1294,pu_r$1297){var fun_E$1306;
var v$2040 = null;
fun_E$1306 = (function(v$2041){return pickle$0pickle$1.con0$1988(v$2040,v$2041);
});
return pickle$0pickle$1.dataGen$1488(["OrderFinMap.map",function(v$1811){return (v$1811 == null)?0:1;
},[fun_E$1306,[function(pu$1812){return pickle$0pickle$1.con1$2014(function(v$1813){var v$1814 = v$1813[0];
return [v$1814[0],v$1814[1],v$1814[2],v$1814[3],v$1813[1]];
},function(v$1815){if (v$1815 == null) {return tools$0Crash$1.impossible$59("OrderFinMap.pu.fun_N");
} else {var v$1816 = v$1815;
return [[v$1816[0],v$1816[1],v$1816[2],v$1816[3]],v$1816[4]];
};
},pickle$0pickle$1.pairGen0$983((pickle$0pickle$1.convert0$2299(function(v$1824){var v$1825 = v$1824[0];
var v$1826 = v$1825[0];
var v$1827 = v$1825[1];
var v$1828 = v$1824[1];
return [v$1826,v$1827,v$1828[0],v$1828[1]];
},function(v$1829){return [[v$1829[0],v$1829[1]],[v$1829[2],v$1829[3]]];
}))(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.pairGen0$983(pu_dom$1294,pu_r$1297),pickle$0pickle$1.pairGen0$983(pu$1812,pu$1812))),syntax_objects$0IdentFinMap$1$2.pu_bal$1290));
},null]]]);
};
return 0;
})();
