if ((typeof(tools$0UnionFindPoly$1)) == "undefined") {tools$0UnionFindPoly$1 = {};
};
(function(){tools$0UnionFindPoly$1.eq_ElementNode$268 = function(v$272,v$269){var v$270 = v$269[0];
var v$271 = v$269[1];
switch (v$270[0]) { case 0: {switch (v$271[0]) { case 0: {return v$270[1] == v$271[1];
 break; }default: {return false;
} };
 break; }case 1: {switch (v$271[0]) { case 1: {var v$276 = v$270[1];
var v$277 = v$271[1];
return (v$272([v$276[0],v$277[0]]))?(v$276[1] == v$277[1]):false;
 break; }default: {return false;
} };
 break; } };
};
var fix$404 = {};
fix$404.$find = function(e$69){lab$find: while (true) {var v$74 = e$69[0];
switch (v$74[0]) { case 0: {var v$85 = v$74[1];
var v$80 = v$85[0];
switch (v$80[0]) { case 0: {var v$84 = v$80[1];
(e$69[0] = [0,v$84],0);
var t$405 = v$84;
var e$69 = t$405;
continue lab$find;
 break; }default: {return v$85;
} };
 break; }default: {return e$69;
} };
};
};
tools$0UnionFindPoly$1.find$66 = fix$404.$find;
tools$0UnionFindPoly$1.find_info$86 = function(e$89){var e$90 = tools$0UnionFindPoly$1.find$66(e$89);
var v$95 = e$90[0];
switch (v$95[0]) { case 1: {return v$95[1][0];
 break; }default: {basis$0General$1.print$163("UnionFindPoly.find_info.impossible");
throw [basis$0Initial$1.en$Fail$54,"UnionFindPoly.find_info.impossible"];
} };
};
tools$0UnionFindPoly$1.find_rep_and_info$99 = function(e$102){var e$103 = tools$0UnionFindPoly$1.find$66(e$102);
var v$108 = e$103[0];
switch (v$108[0]) { case 1: {return [e$103,v$108[1][0]];
 break; }default: {basis$0General$1.print$163("UnionFindPoly.find_rep_and_info.impossible");
throw [basis$0Initial$1.en$Fail$54,"UnionFindPoly.find_rep_and_info.impossible"];
} };
};
tools$0UnionFindPoly$1.set_info$112 = function(e$115,i$118){var e$119 = tools$0UnionFindPoly$1.find$66(e$115);
var v$124 = e$119[0];
switch (v$124[0]) { case 1: {return (e$119[0] = [1,[i$118,v$124[1][1]]],0);
 break; }default: {basis$0General$1.print$163("UnionFindPoly.set_info.impossible");
throw [basis$0Initial$1.en$Fail$54,"UnionFindPoly.set_info.impossible"];
} };
};
tools$0UnionFindPoly$1.eq_Elements$128 = function(v$133,v$134){return (tools$0UnionFindPoly$1.find$66(v$133)) == (tools$0UnionFindPoly$1.find$66(v$134));
};
tools$0UnionFindPoly$1.mkElement$135 = function(info$138){return [[1,[info$138,[0]]]];
};
tools$0UnionFindPoly$1.union$139 = function(info_combine$142,v$146){var v$191 = v$146[0];
var v$192 = v$146[1];
var e$147 = tools$0UnionFindPoly$1.find$66(v$191);
var e$$148 = tools$0UnionFindPoly$1.find$66(v$192);
var v$373 = e$147[0];
var v$374 = e$$148[0];
switch (v$373[0]) { case 1: {switch (v$374[0]) { case 1: {var v$184 = v$373[1];
var v$185 = v$184[0];
var v$186 = v$184[1];
var v$187 = v$374[1];
var v$188 = v$187[0];
var v$189 = v$187[1];
if (v$186[0] < v$189[0]) {(e$$148[0] = [1,[info_combine$142([v$185,v$188]),v$189]],0);
(e$147[0] = [0,e$$148],0);
return e$$148;
} else {if (v$189[0] < v$186[0]) {(e$147[0] = [1,[info_combine$142([v$185,v$188]),v$186]],0);
(e$$148[0] = [0,e$147],0);
return e$147;
} else {(v$189[0] = (SmlPrims.chk_ovf_i32(v$189[0] + 1)),0);
(e$$148[0] = [1,[info_combine$142([v$185,v$188]),v$189]],0);
(e$147[0] = [0,e$$148],0);
return e$$148;
};
};
 break; }default: {basis$0General$1.print$163("UnionFindPoly.union.impossible");
throw [basis$0Initial$1.en$Fail$54,"UnionFindPoly.union.impossible"];
} };
 break; }default: {basis$0General$1.print$163("UnionFindPoly.union.impossible");
throw [basis$0Initial$1.en$Fail$54,"UnionFindPoly.union.impossible"];
} };
};
var pu_intref$193 = pickle$0pickle$1.refOneGen$1282(pickle$0pickle$1.int$729);
tools$0UnionFindPoly$1.pu$194 = function(dummy$197,pu_a$200){var dummy$201 = [1,[dummy$197,[0]]];
var pu_Element$202 = (pickle$0pickle$1.cache$2484("Element"))(function(pu$205){var pu$206 = pickle$0pickle$1.refEqGen$1057(function(v$327){var v$328 = v$327[0];
var v$329 = v$327[1];
return (tools$0UnionFindPoly$1.find$66(v$328)) == (tools$0UnionFindPoly$1.find$66(v$329));
},dummy$201,pu$205);
return pickle$0pickle$1.convert$2342([function(a$209){return a$209;
},function(a$212){return tools$0UnionFindPoly$1.find$66(a$212);
}],pu$206);
});
var pu$241 = pickle$0pickle$1.dataGen$1488(["UnionFindPoly.ElementNode",function(v$342){switch (v$342[0]) { case 1: {return 0;
 break; }default: {return 1;
} };
},[function(pu$343){return pickle$0pickle$1.con1$2014(function(v$344){return [1,v$344];
},function(v$345){switch (v$345[0]) { case 1: {return v$345[1];
 break; }default: {basis$0General$1.print$163("UnionFindPoly.pu.fun_EQR");
throw [basis$0Initial$1.en$Fail$54,"UnionFindPoly.pu.fun_EQR"];
} };
},pickle$0pickle$1.pairGen0$983(pu_a$200,pu_intref$193));
},[function(pu$349){return pickle$0pickle$1.con1$2014(function(v$350){return [0,v$350];
},function(v$351){basis$0General$1.print$163("UnionFindPoly.pu.fun_LINK");
throw [basis$0Initial$1.en$Fail$54,"UnionFindPoly.pu.fun_LINK"];
},pu_Element$202(pu$349));
},null]]]);
return pu_Element$202(pu$241);
};
return 0;
})();
