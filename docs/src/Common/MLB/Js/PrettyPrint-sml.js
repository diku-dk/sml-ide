if ((typeof(tools$0PrettyPrint$1)) == "undefined") {tools$0PrettyPrint$1 = {};
};
(function(){tools$0PrettyPrint$1.eq_childsep$1128 = function(v$1130,v$1131){switch (v$1130[0]) { case 0: {switch (v$1131[0]) { case 0: {return v$1130[1] == v$1131[1];
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1131[0]) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1131[0]) { case 2: {return v$1130[1] == v$1131[1];
 break; }default: {return false;
} };
 break; } };
};
var fix$1697 = {};
fix$1697.$eq_StringTree = function(v$1140,v$1141){switch (v$1140[0]) { case 0: {switch (v$1141[0]) { case 0: {var v$1142 = v$1140[1];
var v$1143 = v$1141[1];
var t$1827;
var fix$1824 = {};
fix$1824.$eq_list = function(v$1175,v$1176){lab$eq_list: while (true) {if (v$1175 == null) {return (v$1176 == null)?true:false;
} else {if (v$1176 == null) {return false;
} else {var v$1177 = v$1175;
var v$1178 = v$1176;
if (fix$1697.$eq_StringTree(v$1177[0],v$1178[0])) {var t$1825 = v$1177[1];
var t$1826 = v$1178[1];
var v$1175 = t$1825;
var v$1176 = t$1826;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$1173 = fix$1824.$eq_list;
t$1827 = (eq_list$1173(v$1142[0],v$1143[0]));
if (t$1827) {var t$1823;
var v$1501 = v$1142[1];
var v$1502 = v$1143[1];
switch (v$1501[0]) { case 0: {switch (v$1502[0]) { case 0: {t$1823 = (v$1501[1] == v$1502[1]);
 break; }default: {t$1823 = false;
} };
 break; }case 1: {switch (v$1502[0]) { case 1: {t$1823 = true;
 break; }default: {t$1823 = false;
} };
 break; }case 2: {switch (v$1502[0]) { case 2: {t$1823 = (v$1501[1] == v$1502[1]);
 break; }default: {t$1823 = false;
} };
 break; } };
return t$1823?((v$1142[2] == v$1143[2])?((v$1142[3] == v$1143[3])?(v$1142[4] == v$1143[4]):false):false):false;
} else {return false;
};
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1141[0]) { case 1: {return v$1140[1] == v$1141[1];
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1141[0]) { case 2: {var v$1151 = v$1140[1];
var v$1152 = v$1141[1];
var t$1822;
var fix$1819 = {};
fix$1819.$eq_list = function(v$1192,v$1193){lab$eq_list: while (true) {if (v$1192 == null) {return (v$1193 == null)?true:false;
} else {if (v$1193 == null) {return false;
} else {var v$1194 = v$1192;
var v$1195 = v$1193;
if (fix$1697.$eq_StringTree(v$1194[0],v$1195[0])) {var t$1820 = v$1194[1];
var t$1821 = v$1195[1];
var v$1192 = t$1820;
var v$1193 = t$1821;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$1190 = fix$1819.$eq_list;
t$1822 = (eq_list$1190(v$1151[0],v$1152[0]));
if (t$1822) {var t$1818;
var v$1519 = v$1151[1];
var v$1520 = v$1152[1];
switch (v$1519[0]) { case 0: {switch (v$1520[0]) { case 0: {t$1818 = (v$1519[1] == v$1520[1]);
 break; }default: {t$1818 = false;
} };
 break; }case 1: {switch (v$1520[0]) { case 1: {t$1818 = true;
 break; }default: {t$1818 = false;
} };
 break; }case 2: {switch (v$1520[0]) { case 2: {t$1818 = (v$1519[1] == v$1520[1]);
 break; }default: {t$1818 = false;
} };
 break; } };
return t$1818?((v$1151[2] == v$1152[2])?(v$1151[3] == v$1152[3]):false):false;
} else {return false;
};
 break; }default: {return false;
} };
 break; } };
};
tools$0PrettyPrint$1.eq_StringTree$1138 = fix$1697.$eq_StringTree;
var fix$1698 = {};
fix$1698.$eq_minipage = function(v$1158,v$1159){lab$eq_minipage: while (true) {switch (v$1158[0]) { case 0: {switch (v$1159[0]) { case 0: {var v$1160 = v$1158[1];
var v$1161 = v$1159[1];
if (fix$1698.$eq_minipage(v$1160[0],v$1161[0])) {var t$1704 = v$1160[1];
var t$1705 = v$1161[1];
var v$1158 = t$1704;
var v$1159 = t$1705;
continue lab$eq_minipage;
} else {return false;
};
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1159[0]) { case 1: {var v$1163 = v$1158[1];
var v$1164 = v$1159[1];
var fix$1701 = {};
fix$1701.$eq_list = function(v$1210,v$1211){lab$eq_list: while (true) {if (v$1210 == null) {return (v$1211 == null)?true:false;
} else {if (v$1211 == null) {return false;
} else {var v$1212 = v$1210;
var v$1213 = v$1211;
if (v$1212[0] == v$1213[0]) {var t$1702 = v$1212[1];
var t$1703 = v$1213[1];
var v$1210 = t$1702;
var v$1211 = t$1703;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$1208 = fix$1701.$eq_list;
return eq_list$1208(v$1163,v$1164);
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1159[0]) { case 2: {var v$1166 = v$1158[1];
var v$1167 = v$1159[1];
if (v$1166[0] == v$1167[0]) {var t$1699 = v$1166[1];
var t$1700 = v$1167[1];
var v$1158 = t$1699;
var v$1159 = t$1700;
continue lab$eq_minipage;
} else {return false;
};
 break; }default: {return false;
} };
 break; } };
};
};
tools$0PrettyPrint$1.eq_minipage$1156 = fix$1698.$eq_minipage;
tools$0PrettyPrint$1.raggedRight$64 = [true];
tools$0PrettyPrint$1.colwidth$65 = [100];
var fix$1706 = {};
fix$1706.$intersperce = function(v$123,v$126,v$129){if (v$129 == null) {return null;
} else {var v$151 = v$129;
var v$152 = v$151[1];
if (v$152 == null) {return [v$151[0],null];
} else {if (v$123) {return [v$151[0] + v$126,fix$1706.$intersperce(true,v$126,v$152)];
} else {var v$160 = v$151[0];
var v$161 = v$152;
var v$162 = v$161[0];
var v$163 = v$161[1];
return [v$160,fix$1706.$intersperce(false,v$126,[v$126 + v$162,v$163])];
};
};
};
};
var intersperce$120 = fix$1706.$intersperce;
tools$0PrettyPrint$1.layoutAtom$189 = function(f$192,x$195){return [1,f$192(x$195)];
};
tools$0PrettyPrint$1.layout_opt$196 = function(v$199,v$202){switch (v$202[0]) { case 0: {var v$213 = v$202[1];
return v$199(v$213);
 break; }default: {return [1,"_|_"];
} };
};
tools$0PrettyPrint$1.layout_pair$215 = function(layout_x$218,layout_y$221,v$225){var v$231 = v$225[0];
var v$232 = v$225[1];
var t$1707;
var v$228 = [0,","];
t$1707 = [[layout_x$218(v$231),[layout_y$221(v$232),null]],v$228,")",1,"("];
return [0,t$1707];
};
tools$0PrettyPrint$1.layout_list$233 = function(layout$236,xs$239){var t$1708;
var v$243 = [0,", "];
t$1708 = [basis$0List$1.map$697(layout$236,xs$239),v$243,"]",1,"["];
return [0,t$1708];
};
tools$0PrettyPrint$1.layout_together$245 = function(children$248,indent$251){return [0,[children$248,[1],"",indent$251,""]];
};
var en$FlatString$257 = new String("FlatString");
var exn$FlatString$257 = [en$FlatString$257];
var fix$1709 = {};
fix$1709.$fold = function(v$277,v$280){var v$304 = v$280[0];
switch (v$304[0]) { case 1: {var v$316 = v$304[1];
var v$317 = v$280[1];
return v$277([v$316,v$317]);
 break; }case 0: {var v$307 = v$304[1];
var v$308 = v$307[4];
var v$309 = v$307[2];
var v$311 = v$307[0];
var v$312 = v$307[1];
var v$313 = v$280[1];
return v$277([v$309,fix$1709.$foldChildren(v$277,[v$311,v$312,v$277([v$308,v$313])])]);
 break; }default: {var v$319 = v$304[1];
var v$320 = v$319[3];
var v$321 = v$319[2];
var v$322 = v$319[0];
var v$323 = v$319[1];
var v$324 = v$280[1];
return v$277([v$321,fix$1709.$foldChildren(v$277,[v$322,v$323,v$277([v$320,v$324])])]);
} };
};
fix$1709.$foldChildren = function(v$327,v$330){var v$362 = v$330[0];
if (v$362 == null) {return v$330[2];
} else {var v$366 = v$362;
var v$367 = v$366[1];
if (v$367 == null) {var v$369 = v$366[0];
var v$370 = v$330[2];
return fix$1709.$fold(v$327,[v$369,v$370]);
} else {var v$371 = v$330[1];
switch (v$371[0]) { case 1: {var v$378 = v$366[0];
var v$379 = v$330[2];
return fix$1709.$foldChildren(v$327,[v$367,[1],fix$1709.$fold(v$327,[v$378,v$379])]);
 break; }case 0: {var v$374 = v$366[0];
var v$375 = v$371[1];
var v$376 = v$330[2];
return fix$1709.$foldChildren(v$327,[v$367,[0,v$375],v$327([v$375,fix$1709.$fold(v$327,[v$374,v$376])])]);
 break; }default: {var v$381 = v$366[0];
var v$382 = v$371[1];
var v$383 = v$330[2];
return fix$1709.$foldChildren(v$327,[v$367,[2,v$382],v$327([v$382,fix$1709.$fold(v$327,[v$381,v$383])])]);
} };
};
};
};
var fold$274 = fix$1709.$fold;
var foldChildren$273 = fix$1709.$foldChildren;
tools$0PrettyPrint$1.flatten1$389 = function(x$1224){return SmlPrims.concat(basis$0List$1.rev$682(fold$274(function(v$1611){return v$1611;
},[x$1224,null])));
};
tools$0PrettyPrint$1.oneLiner$401 = function(f$404,x$407){var x$1612 = f$404(x$407);
return SmlPrims.concat(basis$0List$1.rev$682(fold$274(function(v$1614){return v$1614;
},[x$1612,null])));
};
var pilePages$411;
var b$1236 = [1,null];
pilePages$411 = (function(c$1237){var fix$1710 = {};
fix$1710.$foldr = function(v$1239){if (v$1239 == null) {return b$1236;
} else {var v$1240 = v$1239;
var v$1241 = v$1240[0];
var v$1242 = v$1240[1];
var v$1615 = [v$1241,fix$1710.$foldr(v$1242)];
return [0,v$1615];
};
};
var foldr$1238 = fix$1710.$foldr;
return foldr$1238(c$1237);
});
var fix$1711 = {};
fix$1711.$blanks = function(n$441){return (n$441 <= 0)?"":(" " + (fix$1711.$blanks(SmlPrims.chk_ovf_i32(n$441 - 1))));
};
var blanks$438 = fix$1711.$blanks;
var get_first_line$453 = function(m$456){var fix$1712 = {};
fix$1712.$loop = function(v$497,v$498){lab$loop: while (true) {switch (v$498[0]) { case 1: {var v$481 = v$498[1];
if (v$481 == null) {return [1];
} else {var v$482 = v$481;
var v$483 = v$482[0];
var v$484 = v$482[1];
var t$1717;
var t$1716 = (blanks$438(v$497)) + v$483;
var t$1715;
var m$1249 = [1,v$484];
switch (m$1249[0]) { case 1: {t$1715 = [2,[v$497,m$1249]];
 break; }case 2: {var v$1250 = m$1249[1];
var v$1251 = v$1250[0];
var v$1252 = v$1250[1];
t$1715 = [2,[SmlPrims.chk_ovf_i32(v$497 + v$1251),v$1252]];
 break; }default: {t$1715 = [2,[v$497,m$1249]];
} };
t$1717 = [t$1716,t$1715];
return [0,t$1717];
};
 break; }case 2: {var v$477 = v$498[1];
var v$478 = v$477[0];
var v$479 = v$477[1];
var t$1713 = SmlPrims.chk_ovf_i32(v$497 + v$478);
var t$1714 = v$479;
var v$497 = t$1713;
var v$498 = t$1714;
continue lab$loop;
 break; }default: {var v$494 = v$498[1];
var v$495 = v$494[0];
var v$496 = v$494[1];
var v$490 = fix$1712.$loop(v$497,v$495);
switch (v$490[0]) { case 1: {var t$1718 = v$497;
var t$1719 = v$496;
var v$497 = t$1718;
var v$498 = t$1719;
continue lab$loop;
 break; }default: {var v$491 = v$490[1];
var t$1725;
var t$1724 = v$491[0];
var t$1723;
var t$1722;
var t$1721 = v$491[1];
var t$1720;
switch (v$496[0]) { case 1: {t$1720 = [2,[v$497,v$496]];
 break; }case 2: {var v$1255 = v$496[1];
var v$1256 = v$1255[0];
var v$1257 = v$1255[1];
t$1720 = [2,[SmlPrims.chk_ovf_i32(v$497 + v$1256),v$1257]];
 break; }default: {t$1720 = [2,[v$497,v$496]];
} };
t$1722 = [t$1721,t$1720];
t$1723 = [0,t$1722];
t$1725 = [t$1724,t$1723];
return [0,t$1725];
} };
} };
};
};
var loop$457 = fix$1712.$loop;
return loop$457(0,m$456);
};
var smash$549 = function(v$587,v$588,v$589){var en$No$555 = new String("No");
var exn$No$555 = [en$No$555];
var fix$1726 = {};
fix$1726.$try = function(v$573,v$1679){if (v$573 == null) {return v$1679;
} else {if (v$1679 == null) {return v$573;
} else {var v$577 = v$1679;
switch (v$577[0]) { case 32: {var v$579 = v$573;
var v$580 = v$579[0];
var v$581 = v$579[1];
var v$582 = v$577[1];
return [v$580,fix$1726.$try(v$581,v$582)];
 break; }default: {throw exn$No$555;
} };
};
};
};
var try$556 = fix$1726.$try;
try {var t$1742;
var t$1741;
var t$1740;
var t$1739;
var t$1738;
var t$1737;
var t$1736 = try$556;
var t$1735;
var fix$1732 = {};
fix$1732.$h = function(v$1275,v$1276){lab$h: while (true) {if (v$1275 < 0) {return v$1276;
} else {var t$1733 = SmlPrims.chk_ovf_i32(v$1275 - 1);
var t$1734 = [v$587.charCodeAt(v$1275),v$1276];
var v$1275 = t$1733;
var v$1276 = t$1734;
continue lab$h;
};
};
};
var h$1273 = fix$1732.$h;
t$1735 = (h$1273(SmlPrims.chk_ovf_i32(v$587.length - 1),null));
var t$1731;
var fix$1728 = {};
fix$1728.$h = function(v$1280,v$1281){lab$h: while (true) {if (v$1280 < 0) {return v$1281;
} else {var t$1729 = SmlPrims.chk_ovf_i32(v$1280 - 1);
var t$1730 = [v$588.charCodeAt(v$1280),v$1281];
var v$1280 = t$1729;
var v$1281 = t$1730;
continue lab$h;
};
};
};
var h$1278 = fix$1728.$h;
t$1731 = (h$1278(SmlPrims.chk_ovf_i32(v$588.length - 1),null));
t$1737 = (t$1736(t$1735,t$1731));
t$1738 = (SmlPrims.implode(t$1737));
t$1739 = [t$1738,null];
t$1740 = t$1739;
t$1741 = [1,t$1740];
t$1742 = [t$1741,v$589];
return [0,t$1742];
} catch(v$1727) {return (function(No$586){var t$1743 = No$586;
if (t$1743[0] == en$No$555) {return [0,[[1,[v$587,[v$588,null]]],v$589]];
} else {throw No$586;
};
})(v$1727);
};
};
var botRightConcat$606 = function(s$609,m$612){var v$618;
var fix$1744 = {};
fix$1744.$loop = function(v$1285,v$1286){lab$loop: while (true) {switch (v$1286[0]) { case 1: {var v$1287 = v$1286[1];
var v$1288 = basis$0List$1.rev$682(v$1287);
if (v$1288 == null) {return [1];
} else {var v$1289 = v$1288;
var v$1290 = v$1289[0];
var v$1291 = v$1289[1];
var t$1749;
var t$1748 = (blanks$438(v$1285)) + v$1290;
var t$1747;
var m$1296 = [1,basis$0List$1.rev$682(v$1291)];
switch (m$1296[0]) { case 1: {t$1747 = [2,[v$1285,m$1296]];
 break; }case 2: {var v$1297 = m$1296[1];
var v$1298 = v$1297[0];
var v$1299 = v$1297[1];
t$1747 = [2,[SmlPrims.chk_ovf_i32(v$1285 + v$1298),v$1299]];
 break; }default: {t$1747 = [2,[v$1285,m$1296]];
} };
t$1749 = [t$1748,t$1747];
return [0,t$1749];
};
 break; }case 2: {var v$1300 = v$1286[1];
var v$1301 = v$1300[0];
var v$1302 = v$1300[1];
var t$1745 = SmlPrims.chk_ovf_i32(v$1285 + v$1301);
var t$1746 = v$1302;
var v$1285 = t$1745;
var v$1286 = t$1746;
continue lab$loop;
 break; }default: {var v$1303 = v$1286[1];
var v$1304 = v$1303[0];
var v$1305 = v$1303[1];
var v$1306 = fix$1744.$loop(v$1285,v$1305);
switch (v$1306[0]) { case 1: {var t$1750 = v$1285;
var t$1751 = v$1304;
var v$1285 = t$1750;
var v$1286 = t$1751;
continue lab$loop;
 break; }default: {var v$1307 = v$1306[1];
var v$1308 = v$1307[0];
var v$1309 = v$1307[1];
var t$1756;
var t$1755 = v$1308;
var t$1754;
var t$1753;
var t$1752;
switch (v$1304[0]) { case 1: {t$1752 = [2,[v$1285,v$1304]];
 break; }case 2: {var v$1312 = v$1304[1];
var v$1313 = v$1312[0];
var v$1314 = v$1312[1];
t$1752 = [2,[SmlPrims.chk_ovf_i32(v$1285 + v$1313),v$1314]];
 break; }default: {t$1752 = [2,[v$1285,v$1304]];
} };
t$1753 = [t$1752,v$1309];
t$1754 = [0,t$1753];
t$1756 = [t$1755,t$1754];
return [0,t$1756];
} };
} };
};
};
var loop$1283 = fix$1744.$loop;
v$618 = (loop$1283(0,m$612));
switch (v$618[0]) { case 1: {return [1,null];
 break; }default: {var v$619 = v$618[1];
return [0,[v$619[1],[1,[v$619[0] + s$609,null]]]];
} };
};
var fix$1757 = {};
fix$1757.$print = function(v$646,v$649){switch (v$649[0]) { case 1: {var v$719 = v$649[1];
return ((v$719.length <= v$646)?true:tools$0PrettyPrint$1.raggedRight$64[0])?[1,[v$719,null]]:[1,["...",null]];
 break; }case 2: {var v$704 = v$649[1];
var v$705 = v$704[3];
var v$706 = v$704[2];
var v$707 = v$704[0];
var v$708 = v$704[1];
var width$$673 = tools$0PrettyPrint$1.raggedRight$64[0]?tools$0PrettyPrint$1.colwidth$65[0]:v$646;
if ((SmlPrims.chk_ovf_i32(width$$673 - v$705.length)) >= 0) {var t$1805 = botRightConcat$606;
var t$1804 = v$706;
var t$1791;
var stringLists$682;
var v$1395 = basis$0List$1.map$697(function(x$1649){return SmlPrims.concat(basis$0List$1.rev$682(fold$274(function(v$1651){return v$1651;
},[x$1649,null])));
},v$707);
switch (v$708[0]) { case 1: {stringLists$682 = v$1395;
 break; }case 0: {var v$1398 = v$708[1];
stringLists$682 = (intersperce$120(true,v$1398,v$1395));
 break; }default: {var v$1400 = v$708[1];
stringLists$682 = (intersperce$120(false,v$1400,v$1395));
} };
var stringLists$$683;
var v$1575;
var textwidth$1402 = SmlPrims.chk_ovf_i32(width$$673 - v$705.length);
var fix$1792 = {};
fix$1792.$loop = function(v$1683,v$1684,v$1685,v$1406){lab$loop: while (true) {if (v$1406 == null) {var v$1409 = basis$0List$1.rev$682(v$1684);
if (v$1409 == null) {return basis$0List$1.rev$682(v$1685);
} else {return basis$0List$1.rev$682([v$1409,v$1685]);
};
} else {var v$1413 = v$1406;
var v$1414 = v$1413[0];
var v$1415 = v$1413[1];
if (v$1683 <= 0) {var t$1793 = textwidth$1402;
var t$1794 = null;
var t$1795 = [basis$0List$1.rev$682(v$1684),v$1685];
var t$1796 = [v$1414,v$1415];
var v$1683 = t$1793;
var v$1684 = t$1794;
var v$1685 = t$1795;
var v$1406 = t$1796;
continue lab$loop;
} else {var t$1797 = SmlPrims.chk_ovf_i32(v$1683 - v$1414.length);
var t$1798 = [v$1414,v$1684];
var t$1799 = v$1685;
var t$1800 = v$1415;
var v$1683 = t$1797;
var v$1684 = t$1798;
var v$1685 = t$1799;
var v$1406 = t$1800;
continue lab$loop;
};
};
};
};
var loop$1404 = fix$1792.$loop;
v$1575 = (loop$1404(textwidth$1402,null,null,stringLists$682));
switch (v$705) { case "": {stringLists$$683 = v$1575;
 break; }default: {if (v$1575 == null) {stringLists$$683 = [[v$705,null],null];
} else {var v$700 = v$1575;
var v$701 = v$700[0];
var v$702 = v$700[1];
var t$1803;
var t$1802 = [v$705,v$701];
var t$1801;
var ind$696 = blanks$438(v$705.length);
t$1801 = (basis$0List$1.map$697(function(line$699){return [ind$696,line$699];
},v$702));
t$1803 = [t$1802,t$1801];
stringLists$$683 = t$1803;
};
} };
t$1791 = [1,basis$0List$1.map$697(function(ss$1418){return SmlPrims.concat(ss$1418);
},stringLists$$683)];
return t$1805(t$1804,t$1791);
} else {return [1,["...",null]];
};
 break; }default: {var v$776 = v$649[1];
var v$777 = v$776[4];
var v$778 = v$776[2];
var v$779 = v$776[3];
var v$780 = v$776[0];
var v$781 = v$776[1];
try {var width$$720 = tools$0PrettyPrint$1.raggedRight$64[0]?tools$0PrettyPrint$1.colwidth$65[0]:v$646;
return [1,[SmlPrims.concat(basis$0List$1.rev$682((fold$274(function(v$1424){var v$1425 = v$1424[0];
var v$1426 = v$1424[1];
var v$1427 = v$1426[0];
var v$1428 = v$1426[1];
var n$1429 = v$1425.length;
if (n$1429 <= v$1428) {return [[v$1425,v$1427],SmlPrims.chk_ovf_i32(v$1428 - n$1429)];
} else {throw exn$FlatString$257;
};
},[v$649,[null,width$$720]]))[0])),null]];
} catch(v$1806) {return (function(FlatString$728){var t$1807 = FlatString$728;
if (t$1807[0] == en$FlatString$257) {var startLines$729 = (v$777 == "")?[1,null]:[1,[v$777,null]];
var finishLines$734;
if (v$778 == "") {finishLines$734 = [1,null];
} else {var t$1815;
var t$1814;
var t$1810;
var fix$1808 = {};
fix$1808.$strip$ = function(v$1656){lab$strip$: while (true) {if (v$1656 == null) {return v$1656;
} else {var v$1657 = v$1656;
switch (v$1657[0]) { case 32: {var v$1658 = v$1657[1];
var t$1809 = v$1658;
var v$1656 = t$1809;
continue lab$strip$;
 break; }default: {return v$1656;
} };
};
};
};
var strip$$1655 = fix$1808.$strip$;
var x$1659;
var fix$1811 = {};
fix$1811.$h = function(v$1663,v$1664){lab$h: while (true) {if (v$1663 < 0) {return v$1664;
} else {var t$1812 = SmlPrims.chk_ovf_i32(v$1663 - 1);
var t$1813 = [v$778.charCodeAt(v$1663),v$1664];
var v$1663 = t$1812;
var v$1664 = t$1813;
continue lab$h;
};
};
};
var h$1661 = fix$1811.$h;
x$1659 = (h$1661(SmlPrims.chk_ovf_i32(v$778.length - 1),null));
t$1810 = (SmlPrims.implode(strip$$1655(x$1659)));
t$1814 = [t$1810,null];
t$1815 = t$1814;
finishLines$734 = [1,t$1815];
};
if (((v$777.length <= v$646)?(v$778.length <= v$646):false)?true:tools$0PrettyPrint$1.raggedRight$64[0]) {if (((SmlPrims.chk_ovf_i32(v$646 - v$779)) >= 3)?true:tools$0PrettyPrint$1.raggedRight$64[0]) {var childrenLines$747 = fix$1757.$pileChildren(v$646,v$779,v$781,v$780);
var t$1817;
var t$1816;
var v$754 = get_first_line$453(childrenLines$747);
switch (v$754[0]) { case 1: {t$1816 = startLines$729;
 break; }default: {var v$755 = v$754[1];
var v$756 = v$755[0];
var v$757 = v$755[1];
t$1816 = (smash$549(v$777,v$756,v$757));
} };
t$1817 = [t$1816,finishLines$734];
return [0,t$1817];
} else {return (v$780 == null)?[0,[startLines$729,finishLines$734]]:[0,[startLines$729,[0,[[1,["...",null]],finishLines$734]]]];
};
} else {return [1,["...",null]];
};
} else {throw FlatString$728;
};
})(v$1806);
};
} };
};
fix$1757.$pileChildren = function(v$1680,v$1681,v$1682,v$814){if (v$814 == null) {return [1,null];
} else {var v$818 = v$814;
var v$819 = v$818[1];
if (v$819 == null) {var v$823 = v$818[0];
var m$1333 = fix$1757.$print(SmlPrims.chk_ovf_i32(v$1680 - v$1681),v$823);
switch (m$1333[0]) { case 1: {return [2,[v$1681,m$1333]];
 break; }case 2: {var v$1334 = m$1333[1];
var v$1335 = v$1334[0];
var v$1336 = v$1334[1];
return [2,[SmlPrims.chk_ovf_i32(v$1681 + v$1335),v$1336]];
 break; }default: {return [2,[v$1681,m$1333]];
} };
} else {switch (v$1682[0]) { case 1: {var m$1338;
var t$1790 = pilePages$411;
var t$1789;
var t$1788 = basis$0List$1.map$697;
var t$1787;
var v$1686 = SmlPrims.chk_ovf_i32(v$1680 - v$1681);
t$1787 = (function(v$1687){return fix$1757.$print(v$1686,v$1687);
});
t$1789 = (t$1788(t$1787,v$814));
m$1338 = (t$1790(t$1789));
switch (m$1338[0]) { case 1: {return [2,[v$1681,m$1338]];
 break; }case 2: {var v$1339 = m$1338[1];
var v$1340 = v$1339[0];
var v$1341 = v$1339[1];
return [2,[SmlPrims.chk_ovf_i32(v$1681 + v$1340),v$1341]];
 break; }default: {return [2,[v$1681,m$1338]];
} };
 break; }case 2: {var v$854 = v$1682[1];
var v$855 = v$818[0];
var s$826;
var fix$1780 = {};
fix$1780.$strip$ = function(v$1632){lab$strip$: while (true) {if (v$1632 == null) {return v$1632;
} else {var v$1633 = v$1632;
switch (v$1633[0]) { case 32: {var v$1634 = v$1633[1];
var t$1781 = v$1634;
var v$1632 = t$1781;
continue lab$strip$;
 break; }default: {return v$1632;
} };
};
};
};
var strip$$1631 = fix$1780.$strip$;
var x$1635;
var fix$1782 = {};
fix$1782.$h = function(v$1639,v$1640){lab$h: while (true) {if (v$1639 < 0) {return v$1640;
} else {var t$1783 = SmlPrims.chk_ovf_i32(v$1639 - 1);
var t$1784 = [v$854.charCodeAt(v$1639),v$1640];
var v$1639 = t$1783;
var v$1640 = t$1784;
continue lab$h;
};
};
};
var h$1637 = fix$1782.$h;
x$1635 = (h$1637(SmlPrims.chk_ovf_i32(v$854.length - 1),null));
s$826 = (SmlPrims.implode(strip$$1631(x$1635)));
var firstWidth$827 = tools$0PrettyPrint$1.raggedRight$64[0]?v$1680:(SmlPrims.chk_ovf_i32(v$1680 - v$1681));
var restWidth$832 = tools$0PrettyPrint$1.raggedRight$64[0]?v$1680:(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$1680 - v$1681)) - s$826.length));
if ((restWidth$832 < 3)?(tools$0PrettyPrint$1.raggedRight$64[0]?false:true):false) {var m$1348 = [1,["...",null]];
switch (m$1348[0]) { case 1: {return [2,[v$1681,m$1348]];
 break; }case 2: {var v$1349 = m$1348[1];
var v$1350 = v$1349[0];
var v$1351 = v$1349[1];
return [2,[SmlPrims.chk_ovf_i32(v$1681 + v$1350),v$1351]];
 break; }default: {return [2,[v$1681,m$1348]];
} };
} else {var restPages$841 = basis$0List$1.map$697(function(x$1355){var m$1645 = fix$1757.$print(restWidth$832,x$1355);
switch (m$1645[0]) { case 1: {return [2,[v$1681,m$1645]];
 break; }case 2: {var v$1646 = m$1645[1];
var v$1647 = v$1646[0];
var v$1648 = v$1646[1];
return [2,[SmlPrims.chk_ovf_i32(v$1681 + v$1647),v$1648]];
 break; }default: {return [2,[v$1681,m$1645]];
} };
},v$819);
var restPages$$842 = basis$0List$1.map$697(function(m$1362){var v$1363 = get_first_line$453(m$1362);
switch (v$1363[0]) { case 1: {return [1,null];
 break; }default: {var v$1364 = v$1363[1];
var v$1365 = v$1364[0];
var v$1366 = v$1364[1];
return smash$549(s$826,v$1365,v$1366);
} };
},restPages$841);
var firstWidth$$843 = tools$0PrettyPrint$1.raggedRight$64[0]?firstWidth$827:(SmlPrims.chk_ovf_i32(firstWidth$827 + s$826.length));
var t$1786;
var t$1785;
var m$1370 = fix$1757.$print(firstWidth$$843,v$855);
switch (m$1370[0]) { case 1: {t$1785 = [2,[v$1681,m$1370]];
 break; }case 2: {var v$1371 = m$1370[1];
var v$1372 = v$1371[0];
var v$1373 = v$1371[1];
t$1785 = [2,[SmlPrims.chk_ovf_i32(v$1681 + v$1372),v$1373]];
 break; }default: {t$1785 = [2,[v$1681,m$1370]];
} };
t$1786 = [t$1785,pilePages$411(restPages$$842)];
return [0,t$1786];
};
 break; }default: {var v$885 = v$1682[1];
var myWidth$858 = tools$0PrettyPrint$1.raggedRight$64[0]?v$1680:(SmlPrims.chk_ovf_i32(v$1680 - v$1681));
if ((myWidth$858 < 3)?(tools$0PrettyPrint$1.raggedRight$64[0]?false:true):false) {var m$1378 = [1,["...",null]];
switch (m$1378[0]) { case 1: {return [2,[v$1681,m$1378]];
 break; }case 2: {var v$1379 = m$1378[1];
var v$1380 = v$1379[0];
var v$1381 = v$1379[1];
return [2,[SmlPrims.chk_ovf_i32(v$1681 + v$1380),v$1381]];
 break; }default: {return [2,[v$1681,m$1378]];
} };
} else {var v$872 = basis$0List$1.rev$682(v$814);
if (v$872 == null) {throw [basis$0Initial$1.en$Fail$54,"PrettyPrint: pileChildren"];
} else {var v$876 = v$872;
var v$877 = v$876[0];
var v$878 = v$876[1];
var firstNPages$874 = basis$0List$1.map$697(function(v$1691){return fix$1757.$print(myWidth$858,v$1691);
},basis$0List$1.rev$682(v$878));
var firstNPages$$875 = basis$0List$1.map$697(function(v$1693){return botRightConcat$606(v$885,v$1693);
},firstNPages$874);
var m$1383 = [0,[pilePages$411(firstNPages$$875),fix$1757.$print(myWidth$858,v$877)]];
switch (m$1383[0]) { case 1: {return [2,[v$1681,m$1383]];
 break; }case 2: {var v$1384 = m$1383[1];
var v$1385 = v$1384[0];
var v$1386 = v$1384[1];
return [2,[SmlPrims.chk_ovf_i32(v$1681 + v$1385),v$1386]];
 break; }default: {return [2,[v$1681,m$1383]];
} };
};
};
} };
};
};
};
var print$643 = fix$1757.$print;
var pileChildren$642 = fix$1757.$pileChildren;
var fix$1758 = {};
fix$1758.$interpret = function(v$933,v$934,v$935){lab$interpret: while (true) {switch (v$934[0]) { case 2: {var v$927 = v$934[1];
var v$928 = v$927[0];
var v$929 = v$927[1];
var t$1760 = SmlPrims.chk_ovf_i32(v$933 + v$928);
var t$1761 = v$929;
var t$1762 = v$935;
var v$933 = t$1760;
var v$934 = t$1761;
var v$935 = t$1762;
continue lab$interpret;
 break; }case 1: {var v$925 = v$934[1];
var fix$1759 = {};
fix$1759.$foldr = function(v$1446){if (v$1446 == null) {return v$935;
} else {var v$1447 = v$1446;
var v$1448 = v$1447[0];
var v$1449 = v$1447[1];
var v$1678 = fix$1759.$foldr(v$1449);
return [(blanks$438(v$933)) + v$1448,v$1678];
};
};
var foldr$1445 = fix$1759.$foldr;
return foldr$1445(v$925);
 break; }default: {var v$930 = v$934[1];
var v$931 = v$930[0];
var v$932 = v$930[1];
var t$1763 = v$933;
var t$1764 = v$931;
var t$1765 = fix$1758.$interpret(v$933,v$932,v$935);
var v$933 = t$1763;
var v$934 = t$1764;
var v$935 = t$1765;
continue lab$interpret;
} };
};
};
var interpret$901 = fix$1758.$interpret;
tools$0PrettyPrint$1.flatten$936 = function(v$950){switch (v$950[0]) { case 1: {var v$957 = v$950[1];
return basis$0String$1.concatWith$182("\n",v$957);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"PrettyPrint: flatten"];
} };
};
tools$0PrettyPrint$1.format$937 = function(v$946,v$947){if (v$946 < 3) {throw [basis$0Initial$1.en$Fail$54,"PrettyPrint: format: width too small"];
} else {return [1,interpret$901(0,print$643(v$946,v$947),null)];
};
};
tools$0PrettyPrint$1.outputTree$$966 = function(blanks$969,v$974){var v$1069 = v$974[0];
var v$1070 = v$974[1];
var v$1071 = v$974[2];
var fix$1766 = {};
fix$1766.$output_minipage = function(v$1066,v$1067){lab$output_minipage: while (true) {switch (v$1067[0]) { case 1: {var v$1060 = v$1067[1];
if (v$1060 == null) {return 0;
} else {var fix$1769 = {};
fix$1769.$app = function(v$1459){lab$app: while (true) {if (v$1459 == null) {return 0;
} else {var v$1460 = v$1459;
var v$1461 = v$1460[0];
var v$1462 = v$1460[1];
var fix$1770 = {};
fix$1770.$loop = function(n$1670){lab$loop: while (true) {if (n$1670 >= 64) {var v$1671 = SmlPrims.div_i32(n$1670,64,CompilerInitial.exn$Div$47);
var v$1672 = SmlPrims.mod_i32(n$1670,64,CompilerInitial.exn$Div$47);
v$1069(blanks$969(SmlPrims.chk_ovf_i32(v$1671 * 64)));
var t$1771 = v$1672;
var n$1670 = t$1771;
continue lab$loop;
} else {if (n$1670 >= 32) {v$1069("                                ");
var t$1772 = SmlPrims.chk_ovf_i32(n$1670 - 32);
var n$1670 = t$1772;
continue lab$loop;
} else {if (n$1670 >= 16) {v$1069("                ");
var t$1773 = SmlPrims.chk_ovf_i32(n$1670 - 16);
var n$1670 = t$1773;
continue lab$loop;
} else {if (n$1670 >= 8) {v$1069("        ");
var t$1774 = SmlPrims.chk_ovf_i32(n$1670 - 8);
var n$1670 = t$1774;
continue lab$loop;
} else {if (n$1670 >= 4) {v$1069("    ");
var t$1775 = SmlPrims.chk_ovf_i32(n$1670 - 4);
var n$1670 = t$1775;
continue lab$loop;
} else {if (n$1670 >= 2) {v$1069("  ");
var t$1776 = SmlPrims.chk_ovf_i32(n$1670 - 2);
var n$1670 = t$1776;
continue lab$loop;
} else {if (n$1670 == 1) {return v$1069(" ");
} else {return 0;
};
};
};
};
};
};
};
};
};
var loop$1669 = fix$1770.$loop;
v$1069("\n");
loop$1669(v$1066);
v$1069(v$1461);
var t$1777 = v$1462;
var v$1459 = t$1777;
continue lab$app;
};
};
};
var app$1458 = fix$1769.$app;
return app$1458(v$1060);
};
 break; }case 2: {var v$1056 = v$1067[1];
var v$1057 = v$1056[0];
var v$1058 = v$1056[1];
var t$1767 = SmlPrims.chk_ovf_i32(v$1057 + v$1066);
var t$1768 = v$1058;
var v$1066 = t$1767;
var v$1067 = t$1768;
continue lab$output_minipage;
 break; }default: {var v$1063 = v$1067[1];
var v$1064 = v$1063[0];
var v$1065 = v$1063[1];
fix$1766.$output_minipage(v$1066,v$1064);
var t$1778 = v$1066;
var t$1779 = v$1065;
var v$1066 = t$1778;
var v$1067 = t$1779;
continue lab$output_minipage;
} };
};
};
var output_minipage$1037 = fix$1766.$output_minipage;
var minipage$1068 = print$643(v$1071,v$1070);
return output_minipage$1037(0,minipage$1068);
};
tools$0PrettyPrint$1.outputTree$1072 = function(a$1075){return tools$0PrettyPrint$1.outputTree$$966(function(n$1078){return "b" + (basis$0Int32$1.toString$458(n$1078));
},a$1075);
};
tools$0PrettyPrint$1.printTree$1079 = function(t$1082){var a$1471 = [basis$0TextIO$1.print$164,t$1082,tools$0PrettyPrint$1.colwidth$65[0]];
return tools$0PrettyPrint$1.outputTree$$966(function(n$1472){return "b" + (basis$0Int32$1.toString$458(n$1472));
},a$1471);
};
tools$0PrettyPrint$1.reportStringTree$$1083 = function(width$1086,tree$1089){var v$1094;
if (width$1086 < 3) {throw [basis$0Initial$1.en$Fail$54,"PrettyPrint: format: width too small"];
} else {v$1094 = [1,interpret$901(0,print$643(width$1086,tree$1089),null)];
};
switch (v$1094[0]) { case 1: {var v$1097 = v$1094[1];
var lines$1096 = basis$0List$1.map$697(function(v$1695){return tools$0Report$1.line$60(v$1695);
},v$1097);
return tools$0Report$1.flatten$87(lines$1096);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"PrettyPrint: reportStringTree'"];
} };
};
tools$0PrettyPrint$1.reportStringTree$1098 = function(tree$1101){var v$1484 = [1,interpret$901(0,print$643(75,tree$1101),null)];
switch (v$1484[0]) { case 1: {var v$1489 = v$1484[1];
var lines$1490 = basis$0List$1.map$697(function(v$1696){return tools$0Report$1.line$60(v$1696);
},v$1489);
return tools$0Report$1.flatten$87(lines$1490);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"PrettyPrint: reportStringTree'"];
} };
};
return 0;
})();
