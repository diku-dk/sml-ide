if ((typeof(special_objects$0TyName$1$3)) == "undefined") {special_objects$0TyName$1$3 = {};
};
(function(){special_objects$0TyName$1$3.die$2768 = function(s$2771){return tools$0Crash$1.impossible$59("QuasiSet." + s$2771);
};
special_objects$0TyName$1$3.key$2772 = function(v$4043,v$4044,v$4045,v$4046,v$4047,v$4048){return v$4045[0][1];
};
special_objects$0TyName$1$3.rigid$2776 = function(v$4049,v$4050,v$4051,v$4052,v$4053,v$4054){return v$4051[0][2];
};
special_objects$0TyName$1$3.empty$2784 = null;
special_objects$0TyName$1$3.singleton$2785 = function(d$2788){var nd$2789 = d$2788[2];
return nd$2789[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(nd$2789[0][1],d$2788)]]:[[1,[tools$0IntStringFinMap$1.singleton$118(nd$2789[0][1],d$2788),special_objects$0Name$1.current_matchcount$69(0)]]];
};
special_objects$0TyName$1$3.isEmpty$2794 = function(v$2797){return (v$2797 == null)?true:false;
};
special_objects$0TyName$1$3.imap$2802 = function(v$2805){if (v$2805 == null) {return [1];
} else {var v$2814 = v$2805;
switch (v$2814[0][0]) { case 0: {var v$2816 = v$2814[0][1];
return [0,v$2816];
 break; }default: {var v$2817 = v$2814[0][1];
var v$2818 = v$2817[0];
return [0,v$2818];
} };
};
};
special_objects$0TyName$1$3.imap$$2819 = function(v$2822){if (v$2822 == null) {return tools$0Crash$1.impossible$59("QuasiSet.imap': impossible");
} else {var v$2832 = v$2822;
switch (v$2832[0][0]) { case 0: {return v$2832[0][1];
 break; }default: {return v$2832[0][1][0];
} };
};
};
special_objects$0TyName$1$3.ensure_consistent_imap$2837 = function(imap$2840){var v$2857 = tools$0IntStringFinMap$1.Fold$78(function(v$2865){var v$2874 = v$2865[0];
var v$2875 = v$2874[0];
var v$2876 = v$2874[1];
var v$2877 = v$2865[1];
var v$2878 = v$2877[0];
var v$2879 = v$2877[1];
var t$4079;
if (v$2878) {var v$3788 = v$2876[2][0][1];
t$4079 = ((v$3788[0] == v$2875[0])?(v$3788[1] == v$2875[1]):false);
} else {t$4079 = false;
};
return [t$4079,v$2879?v$2876[2][0][2]:false];
},[true,true],imap$2840);
var v$2858 = v$2857[0];
var v$2859 = v$2857[1];
return [v$2858?imap$2840:(tools$0IntStringFinMap$1.fold$62(function(v$2852){var v$2853 = v$2852[0];
var v$2854 = v$2852[1];
return tools$0IntStringFinMap$1.add$237(v$2853[2][0][1],v$2853,v$2854);
},tools$0IntStringFinMap$1.empty$117(0),imap$2840)),v$2859];
};
special_objects$0TyName$1$3.ensure_consistent$2880 = function(v$2883){if (v$2883 == null) {return v$2883;
} else {var v$2896 = v$2883;
switch (v$2896[0][0]) { case 0: {return v$2883;
 break; }default: {var v$2916 = v$2896[0][1];
var v$2917 = v$2916[0];
var v$2918 = v$2916[1];
if (v$2918 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2913 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$2917);
var v$2914 = v$2913[1];
var v$2915 = v$2913[0];
if (v$2914) {(v$2896[0] = [0,v$2915],0);
return v$2883;
} else {(v$2896[0] = [1,[v$2915,special_objects$0Name$1.current_matchcount$69(0)]],0);
return v$2883;
};
} else {return v$2883;
};
} };
};
};
special_objects$0TyName$1$3.mk_flex$2919 = function(imap$2922){return [[1,[imap$2922,special_objects$0Name$1.current_matchcount$69(0)]]];
};
special_objects$0TyName$1$3.mk_rigid$2923 = function(imap$2926){return [[0,imap$2926]];
};
special_objects$0TyName$1$3.member$2927 = function(v$4055,v$4056,v$4057,v$4058,v$4059,v$4060){return function(m$2933){var v$2938;
if (m$2933 == null) {m$2933;
} else {var v$3856 = m$2933;
switch (v$3856[0][0]) { case 0: {m$2933;
 break; }default: {var v$3857 = v$3856[0][1];
var v$3858 = v$3857[0];
var v$3859 = v$3857[1];
if (v$3859 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3860 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3858);
var v$3861 = v$3860[1];
var v$3862 = v$3860[0];
if (v$3861) {(v$3856[0] = [0,v$3862],0);
m$2933;
} else {(v$3856[0] = [1,[v$3862,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$2933;
};
} else {m$2933;
};
} };
};
if (m$2933 == null) {v$2938 = [1];
} else {var v$3552 = m$2933;
switch (v$3552[0][0]) { case 0: {var v$3553 = v$3552[0][1];
v$2938 = [0,v$3553];
 break; }default: {var v$3554 = v$3552[0][1];
var v$3555 = v$3554[0];
v$2938 = [0,v$3555];
} };
};
switch (v$2938[0]) { case 0: {var v$2945 = v$2938[1];
switch ((tools$0IntStringFinMap$1.lookup$129(v$2945,v$4057[0][1]))[0]) { case 0: {return true;
 break; }default: {return false;
} };
 break; }default: {return false;
} };
};
};
special_objects$0TyName$1$3.insert$2946 = function(d$2949,m$2952){if (m$2952 == null) {m$2952;
} else {var v$3864 = m$2952;
switch (v$3864[0][0]) { case 0: {m$2952;
 break; }default: {var v$3865 = v$3864[0][1];
var v$3866 = v$3865[0];
var v$3867 = v$3865[1];
if (v$3867 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3868 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3866);
var v$3869 = v$3868[1];
var v$3870 = v$3868[0];
if (v$3869) {(v$3864[0] = [0,v$3870],0);
m$2952;
} else {(v$3864[0] = [1,[v$3870,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$2952;
};
} else {m$2952;
};
} };
};
if (m$2952 == null) {var nd$3558 = d$2949[2];
return nd$3558[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(nd$3558[0][1],d$2949)]]:[[1,[tools$0IntStringFinMap$1.singleton$118(nd$3558[0][1],d$2949),special_objects$0Name$1.current_matchcount$69(0)]]];
} else {var v$2961 = m$2952;
switch (v$2961[0][0]) { case 0: {var v$2969 = v$2961[0][1];
var nd$2963 = d$2949[2];
var i$2964 = nd$2963[0][1];
return nd$2963[0][2]?[[0,tools$0IntStringFinMap$1.add$237(i$2964,d$2949,v$2969)]]:[[1,[tools$0IntStringFinMap$1.add$237(i$2964,d$2949,v$2969),special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {var v$2970 = v$2961[0][1];
var v$2971 = v$2970[0];
return [[1,[tools$0IntStringFinMap$1.add$237(d$2949[2][0][1],d$2949,v$2971),special_objects$0Name$1.current_matchcount$69(0)]]];
} };
};
};
special_objects$0TyName$1$3.union$2972 = function(m1$2975,m2$2978){if (m1$2975 == null) {m1$2975;
} else {var v$3872 = m1$2975;
switch (v$3872[0][0]) { case 0: {m1$2975;
 break; }default: {var v$3873 = v$3872[0][1];
var v$3874 = v$3873[0];
var v$3875 = v$3873[1];
if (v$3875 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3876 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3874);
var v$3877 = v$3876[1];
var v$3878 = v$3876[0];
if (v$3877) {(v$3872[0] = [0,v$3878],0);
m1$2975;
} else {(v$3872[0] = [1,[v$3878,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$2975;
};
} else {m1$2975;
};
} };
};
if (m2$2978 == null) {m2$2978;
} else {var v$3880 = m2$2978;
switch (v$3880[0][0]) { case 0: {m2$2978;
 break; }default: {var v$3881 = v$3880[0][1];
var v$3882 = v$3881[0];
var v$3883 = v$3881[1];
if (v$3883 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3884 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3882);
var v$3885 = v$3884[1];
var v$3886 = v$3884[0];
if (v$3885) {(v$3880[0] = [0,v$3886],0);
m2$2978;
} else {(v$3880[0] = [1,[v$3886,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$2978;
};
} else {m2$2978;
};
} };
};
if (m1$2975 == null) {return m2$2978;
} else {if (m2$2978 == null) {return m1$2975;
} else {var v$2997 = m1$2975;
switch (v$2997[0][0]) { case 0: {var v$2999 = m2$2978;
switch (v$2999[0][0]) { case 0: {var v$3001 = v$2997[0][1];
var v$3002 = v$2999[0][1];
return [[0,tools$0IntStringFinMap$1.plus$255(v$3001,v$3002)]];
 break; }default: {var t$4086;
var t$4085;
var t$4084;
var t$4083;
var t$4082 = tools$0IntStringFinMap$1.plus$255;
var t$4081;
if (m1$2975 == null) {t$4081 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3888 = m1$2975;
switch (v$3888[0][0]) { case 0: {t$4081 = v$3888[0][1];
 break; }default: {t$4081 = v$3888[0][1][0];
} };
};
var t$4080;
if (m2$2978 == null) {t$4080 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3889 = m2$2978;
switch (v$3889[0][0]) { case 0: {t$4080 = v$3889[0][1];
 break; }default: {t$4080 = v$3889[0][1][0];
} };
};
t$4083 = (t$4082(t$4081,t$4080));
t$4084 = [t$4083,special_objects$0Name$1.current_matchcount$69(0)];
t$4085 = [1,t$4084];
t$4086 = [t$4085];
return t$4086;
} };
 break; }default: {var t$4093;
var t$4092;
var t$4091;
var t$4090;
var t$4089 = tools$0IntStringFinMap$1.plus$255;
var t$4088;
if (m1$2975 == null) {t$4088 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3891 = m1$2975;
switch (v$3891[0][0]) { case 0: {t$4088 = v$3891[0][1];
 break; }default: {t$4088 = v$3891[0][1][0];
} };
};
var t$4087;
if (m2$2978 == null) {t$4087 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3892 = m2$2978;
switch (v$3892[0][0]) { case 0: {t$4087 = v$3892[0][1];
 break; }default: {t$4087 = v$3892[0][1][0];
} };
};
t$4090 = (t$4089(t$4088,t$4087));
t$4091 = [t$4090,special_objects$0Name$1.current_matchcount$69(0)];
t$4092 = [1,t$4091];
t$4093 = [t$4092];
return t$4093;
} };
};
};
};
special_objects$0TyName$1$3.remove$3006 = function(v$4061,v$4062,v$4063,v$4064,v$4065,v$4066){return function(m$3012){if (m$3012 == null) {m$3012;
} else {var v$3894 = m$3012;
switch (v$3894[0][0]) { case 0: {m$3012;
 break; }default: {var v$3895 = v$3894[0][1];
var v$3896 = v$3895[0];
var v$3897 = v$3895[1];
if (v$3897 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3898 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3896);
var v$3899 = v$3898[1];
var v$3900 = v$3898[0];
if (v$3899) {(v$3894[0] = [0,v$3900],0);
m$3012;
} else {(v$3894[0] = [1,[v$3900,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3012;
};
} else {m$3012;
};
} };
};
if (m$3012 == null) {return m$3012;
} else {var v$3022 = m$3012;
switch (v$3022[0][0]) { case 0: {var v$3035 = v$3022[0][1];
var v$3028 = tools$0IntStringFinMap$1.remove$262(v$4063[0][1],v$3035);
switch (v$3028[0]) { case 0: {var v$3034 = v$3028[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3034))?null:[[0,v$3034]];
 break; }default: {return m$3012;
} };
 break; }default: {var v$3047 = v$3022[0][1];
var v$3048 = v$3047[0];
var v$3040 = tools$0IntStringFinMap$1.remove$262(v$4063[0][1],v$3048);
switch (v$3040[0]) { case 0: {var v$3046 = v$3040[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3046))?null:[[1,[v$3046,special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {return m$3012;
} };
} };
};
};
};
special_objects$0TyName$1$3.mk$3049 = function(v$3062,v$3063){return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3062))?null:(v$3063?[[0,v$3062]]:[[1,[v$3062,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
special_objects$0TyName$1$3.difference$3064 = function(m1$3067,m2$3070){if (m1$3067 == null) {m1$3067;
} else {var v$3902 = m1$3067;
switch (v$3902[0][0]) { case 0: {m1$3067;
 break; }default: {var v$3903 = v$3902[0][1];
var v$3904 = v$3903[0];
var v$3905 = v$3903[1];
if (v$3905 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3906 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3904);
var v$3907 = v$3906[1];
var v$3908 = v$3906[0];
if (v$3907) {(v$3902[0] = [0,v$3908],0);
m1$3067;
} else {(v$3902[0] = [1,[v$3908,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$3067;
};
} else {m1$3067;
};
} };
};
if (m2$3070 == null) {m2$3070;
} else {var v$3910 = m2$3070;
switch (v$3910[0][0]) { case 0: {m2$3070;
 break; }default: {var v$3911 = v$3910[0][1];
var v$3912 = v$3911[0];
var v$3913 = v$3911[1];
if (v$3913 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3914 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3912);
var v$3915 = v$3914[1];
var v$3916 = v$3914[0];
if (v$3915) {(v$3910[0] = [0,v$3916],0);
m2$3070;
} else {(v$3910[0] = [1,[v$3916,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$3070;
};
} else {m2$3070;
};
} };
};
if (m1$3067 == null) {return null;
} else {if (m2$3070 == null) {return m1$3067;
} else {var im1$3082;
if (m1$3067 == null) {im1$3082 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3583 = m1$3067;
switch (v$3583[0][0]) { case 0: {im1$3082 = v$3583[0][1];
 break; }default: {im1$3082 = v$3583[0][1][0];
} };
};
var im2$3083;
if (m2$3070 == null) {im2$3083 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3587 = m2$3070;
switch (v$3587[0][0]) { case 0: {im2$3083 = v$3587[0][1];
 break; }default: {im2$3083 = v$3587[0][1][0];
} };
};
var v$3087 = tools$0IntStringFinMap$1.Fold$78(function(v$3095){var v$3105 = v$3095[0];
var v$3106 = v$3105[0];
var v$3107 = v$3105[1];
var v$3108 = v$3095[1];
var v$3109 = v$3108[0];
var v$3110 = v$3108[1];
switch ((tools$0IntStringFinMap$1.lookup$129(im2$3083,v$3106))[0]) { case 0: {return [v$3109,v$3110];
 break; }default: {return [tools$0IntStringFinMap$1.add$237(v$3106,v$3107,v$3109),v$3110?v$3107[2][0][2]:false];
} };
},[tools$0IntStringFinMap$1.empty$117(0),true],im1$3082);
var v$3088 = v$3087[0];
var v$3089 = v$3087[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3088))?null:(v$3089?[[0,v$3088]]:[[1,[v$3088,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
};
special_objects$0TyName$1$3.intersect$3111 = function(m1$3114,m2$3117){if (m1$3114 == null) {m1$3114;
} else {var v$3918 = m1$3114;
switch (v$3918[0][0]) { case 0: {m1$3114;
 break; }default: {var v$3919 = v$3918[0][1];
var v$3920 = v$3919[0];
var v$3921 = v$3919[1];
if (v$3921 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3922 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3920);
var v$3923 = v$3922[1];
var v$3924 = v$3922[0];
if (v$3923) {(v$3918[0] = [0,v$3924],0);
m1$3114;
} else {(v$3918[0] = [1,[v$3924,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$3114;
};
} else {m1$3114;
};
} };
};
if (m2$3117 == null) {m2$3117;
} else {var v$3926 = m2$3117;
switch (v$3926[0][0]) { case 0: {m2$3117;
 break; }default: {var v$3927 = v$3926[0][1];
var v$3928 = v$3927[0];
var v$3929 = v$3927[1];
if (v$3929 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3930 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3928);
var v$3931 = v$3930[1];
var v$3932 = v$3930[0];
if (v$3931) {(v$3926[0] = [0,v$3932],0);
m2$3117;
} else {(v$3926[0] = [1,[v$3932,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$3117;
};
} else {m2$3117;
};
} };
};
if (m1$3114 == null) {return null;
} else {if (m2$3117 == null) {return null;
} else {var im1$3128;
if (m1$3114 == null) {im1$3128 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3595 = m1$3114;
switch (v$3595[0][0]) { case 0: {im1$3128 = v$3595[0][1];
 break; }default: {im1$3128 = v$3595[0][1][0];
} };
};
var im2$3129;
if (m2$3117 == null) {im2$3129 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3599 = m2$3117;
switch (v$3599[0][0]) { case 0: {im2$3129 = v$3599[0][1];
 break; }default: {im2$3129 = v$3599[0][1][0];
} };
};
var v$3133 = tools$0IntStringFinMap$1.Fold$78(function(v$3141){var v$3151 = v$3141[0];
var v$3152 = v$3151[0];
var v$3153 = v$3151[1];
var v$3154 = v$3141[1];
var v$3155 = v$3154[0];
var v$3156 = v$3154[1];
switch ((tools$0IntStringFinMap$1.lookup$129(im2$3129,v$3152))[0]) { case 0: {return [tools$0IntStringFinMap$1.add$237(v$3152,v$3153,v$3155),v$3156?v$3153[2][0][2]:false];
 break; }default: {return [v$3155,v$3156];
} };
},[tools$0IntStringFinMap$1.empty$117(0),true],im1$3128);
var v$3134 = v$3133[0];
var v$3135 = v$3133[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3134))?null:(v$3135?[[0,v$3134]]:[[1,[v$3134,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
};
special_objects$0TyName$1$3.partition$3157 = function(f$3160,m$3163){if (m$3163 == null) {m$3163;
} else {var v$3934 = m$3163;
switch (v$3934[0][0]) { case 0: {m$3163;
 break; }default: {var v$3935 = v$3934[0][1];
var v$3936 = v$3935[0];
var v$3937 = v$3935[1];
if (v$3937 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3938 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3936);
var v$3939 = v$3938[1];
var v$3940 = v$3938[0];
if (v$3939) {(v$3934[0] = [0,v$3940],0);
m$3163;
} else {(v$3934[0] = [1,[v$3940,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3163;
};
} else {m$3163;
};
} };
};
if (m$3163 == null) {return [null,null];
} else {var im$3169;
if (m$3163 == null) {im$3169 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3607 = m$3163;
switch (v$3607[0][0]) { case 0: {im$3169 = v$3607[0][1];
 break; }default: {im$3169 = v$3607[0][1][0];
} };
};
var v$3175 = tools$0IntStringFinMap$1.Fold$78(function(v$3187){var v$3200 = v$3187[0];
var v$3201 = v$3200[0];
var v$3202 = v$3200[1];
var v$3203 = v$3187[1];
var v$3204 = v$3203[0];
var v$3205 = v$3203[1];
var v$3206 = v$3203[2];
var v$3207 = v$3203[3];
return (f$3160(v$3202))?[tools$0IntStringFinMap$1.add$237(v$3201,v$3202,v$3204),v$3205?v$3202[2][0][2]:false,v$3206,v$3207]:[v$3204,v$3205,tools$0IntStringFinMap$1.add$237(v$3201,v$3202,v$3206),v$3207?v$3202[2][0][2]:false];
},[tools$0IntStringFinMap$1.empty$117(0),true,tools$0IntStringFinMap$1.empty$117(0),true],im$3169);
var v$3176 = v$3175[0];
var v$3177 = v$3175[1];
var v$3178 = v$3175[2];
var v$3179 = v$3175[3];
return [((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3176))?null:(v$3177?[[0,v$3176]]:[[1,[v$3176,special_objects$0Name$1.current_matchcount$69(0)]]]),((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3178))?null:(v$3179?[[0,v$3178]]:[[1,[v$3178,special_objects$0Name$1.current_matchcount$69(0)]]])];
};
};
special_objects$0TyName$1$3.subst$3208 = function(v$3253,v$3254){return function(m$3215){if (m$3215 == null) {m$3215;
} else {var v$3942 = m$3215;
switch (v$3942[0][0]) { case 0: {m$3215;
 break; }default: {var v$3943 = v$3942[0][1];
var v$3944 = v$3943[0];
var v$3945 = v$3943[1];
if (v$3945 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3946 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3944);
var v$3947 = v$3946[1];
var v$3948 = v$3946[0];
if (v$3947) {(v$3942[0] = [0,v$3948],0);
m$3215;
} else {(v$3942[0] = [1,[v$3948,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3215;
};
} else {m$3215;
};
} };
};
if (m$3215 == null) {return null;
} else {var im$3221;
if (m$3215 == null) {im$3221 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3619 = m$3215;
switch (v$3619[0][0]) { case 0: {im$3221 = v$3619[0][1];
 break; }default: {im$3221 = v$3619[0][1][0];
} };
};
var keya$3222 = v$3253[2][0][1];
var v$3226 = tools$0IntStringFinMap$1.Fold$78(function(v$3234){var v$3247 = v$3234[0];
var v$3248 = v$3247[0];
var v$3249 = v$3247[1];
var v$3250 = v$3234[1];
var v$3251 = v$3250[0];
var v$3252 = v$3250[1];
return ((keya$3222[0] == v$3248[0])?(keya$3222[1] == v$3248[1]):false)?[tools$0IntStringFinMap$1.add$237(v$3254[2][0][1],v$3254,v$3251),v$3252?v$3254[2][0][2]:false]:[tools$0IntStringFinMap$1.add$237(v$3248,v$3249,v$3251),v$3252?v$3249[2][0][2]:false];
},[tools$0IntStringFinMap$1.empty$117(0),true],im$3221);
var v$3227 = v$3226[0];
var v$3228 = v$3226[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3227))?null:(v$3228?[[0,v$3227]]:[[1,[v$3227,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
};
special_objects$0TyName$1$3.fold$3255 = function(f$3258,b$3261,m$3264){if (m$3264 == null) {m$3264;
} else {var v$3951 = m$3264;
switch (v$3951[0][0]) { case 0: {m$3264;
 break; }default: {var v$3952 = v$3951[0][1];
var v$3953 = v$3952[0];
var v$3954 = v$3952[1];
if (v$3954 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3955 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3953);
var v$3956 = v$3955[1];
var v$3957 = v$3955[0];
if (v$3956) {(v$3951[0] = [0,v$3957],0);
m$3264;
} else {(v$3951[0] = [1,[v$3957,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3264;
};
} else {m$3264;
};
} };
};
if (m$3264 == null) {return b$3261;
} else {var im$3270;
if (m$3264 == null) {im$3270 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3634 = m$3264;
switch (v$3634[0][0]) { case 0: {im$3270 = v$3634[0][1];
 break; }default: {im$3270 = v$3634[0][1][0];
} };
};
return tools$0IntStringFinMap$1.fold$62(function(v$3274){var v$3275 = v$3274[0];
var v$3276 = v$3274[1];
return (f$3258(v$3275))(v$3276);
},b$3261,im$3270);
};
};
special_objects$0TyName$1$3.map$3277 = function(f$3280,m$3283){if (m$3283 == null) {m$3283;
} else {var v$3959 = m$3283;
switch (v$3959[0][0]) { case 0: {m$3283;
 break; }default: {var v$3960 = v$3959[0][1];
var v$3961 = v$3960[0];
var v$3962 = v$3960[1];
if (v$3962 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3963 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3961);
var v$3964 = v$3963[1];
var v$3965 = v$3963[0];
if (v$3964) {(v$3959[0] = [0,v$3965],0);
m$3283;
} else {(v$3959[0] = [1,[v$3965,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3283;
};
} else {m$3283;
};
} };
};
if (m$3283 == null) {return m$3283;
} else {var im$3289;
if (m$3283 == null) {im$3289 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3638 = m$3283;
switch (v$3638[0][0]) { case 0: {im$3289 = v$3638[0][1];
 break; }default: {im$3289 = v$3638[0][1][0];
} };
};
var v$3293 = tools$0IntStringFinMap$1.fold$62(function(v$3300){var v$3306 = v$3300[0];
var v$3307 = v$3300[1];
var v$3308 = v$3307[0];
var v$3309 = v$3307[1];
var d$$3301 = f$3280(v$3306);
return [tools$0IntStringFinMap$1.add$237(d$$3301[2][0][1],d$$3301,v$3308),v$3309?d$$3301[2][0][2]:false];
},[tools$0IntStringFinMap$1.empty$117(0),true],im$3289);
var v$3294 = v$3293[0];
var v$3295 = v$3293[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3294))?null:(v$3295?[[0,v$3294]]:[[1,[v$3294,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
special_objects$0TyName$1$3.apply$3310 = function(f$3313,m$3316){var b$3647 = 0;
if (m$3316 == null) {m$3316;
} else {var v$3967 = m$3316;
switch (v$3967[0][0]) { case 0: {m$3316;
 break; }default: {var v$3968 = v$3967[0][1];
var v$3969 = v$3968[0];
var v$3970 = v$3968[1];
if (v$3970 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3971 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3969);
var v$3972 = v$3971[1];
var v$3973 = v$3971[0];
if (v$3972) {(v$3967[0] = [0,v$3973],0);
m$3316;
} else {(v$3967[0] = [1,[v$3973,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3316;
};
} else {m$3316;
};
} };
};
if (m$3316 == null) {return b$3647;
} else {var im$3650;
if (m$3316 == null) {im$3650 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3652 = m$3316;
switch (v$3652[0][0]) { case 0: {im$3650 = v$3652[0][1];
 break; }default: {im$3650 = v$3652[0][1][0];
} };
};
return tools$0IntStringFinMap$1.fold$62(function(v$3654){var v$3655 = v$3654[0];
return f$3313(v$3655);
},b$3647,im$3650);
};
};
special_objects$0TyName$1$3.list$3322 = function(v$3325){if (v$3325 == null) {return null;
} else {var t$4095 = tools$0IntStringFinMap$1.range$284;
var t$4094;
if (v$3325 == null) {v$3325;
} else {var v$3977 = v$3325;
switch (v$3977[0][0]) { case 0: {v$3325;
 break; }default: {var v$3978 = v$3977[0][1];
var v$3979 = v$3978[0];
var v$3980 = v$3978[1];
if (v$3980 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3981 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3979);
var v$3982 = v$3981[1];
var v$3983 = v$3981[0];
if (v$3982) {(v$3977[0] = [0,v$3983],0);
v$3325;
} else {(v$3977[0] = [1,[v$3983,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$3325;
};
} else {v$3325;
};
} };
};
if (v$3325 == null) {t$4094 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3658 = v$3325;
switch (v$3658[0][0]) { case 0: {t$4094 = v$3658[0][1];
 break; }default: {t$4094 = v$3658[0][1][0];
} };
};
return t$4095(t$4094);
};
};
special_objects$0TyName$1$3.fromList$3331 = function(v$3334){if (v$3334 == null) {return null;
} else {var v$3343;
var b$3662 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$4096 = {};
fix$4096.$foldl = function(v$3665,v$3666){lab$foldl: while (true) {if (v$3666 == null) {return v$3665;
} else {var v$3667 = v$3666;
var v$3668 = v$3667[0];
var v$3669 = v$3667[1];
var t$4097;
var v$3987 = v$3665[0];
var v$3988 = v$3665[1];
t$4097 = [tools$0IntStringFinMap$1.add$237(v$3668[2][0][1],v$3668,v$3987),v$3988?v$3668[2][0][2]:false];
var t$4098 = t$4097;
var t$4099 = v$3669;
var v$3665 = t$4098;
var v$3666 = t$4099;
continue lab$foldl;
};
};
};
var foldl$3664 = fix$4096.$foldl;
v$3343 = (foldl$3664(b$3662,v$3334));
var v$3344 = v$3343[0];
var v$3345 = v$3343[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3344))?null:(v$3345?[[0,v$3344]]:[[1,[v$3344,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
special_objects$0TyName$1$3.addList$3359 = function(l$3362,m1$3365){var m2$3366 = special_objects$0TyName$1$3.fromList$3331(l$3362);
return special_objects$0TyName$1$3.union$2972(m1$3365,m2$3366);
};
special_objects$0TyName$1$3.size$3367 = function(m$3370){var v$3375;
if (m$3370 == null) {m$3370;
} else {var v$3990 = m$3370;
switch (v$3990[0][0]) { case 0: {m$3370;
 break; }default: {var v$3991 = v$3990[0][1];
var v$3992 = v$3991[0];
var v$3993 = v$3991[1];
if (v$3993 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3994 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$3992);
var v$3995 = v$3994[1];
var v$3996 = v$3994[0];
if (v$3995) {(v$3990[0] = [0,v$3996],0);
m$3370;
} else {(v$3990[0] = [1,[v$3996,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3370;
};
} else {m$3370;
};
} };
};
if (m$3370 == null) {v$3375 = [1];
} else {var v$3676 = m$3370;
switch (v$3676[0][0]) { case 0: {var v$3677 = v$3676[0][1];
v$3375 = [0,v$3677];
 break; }default: {var v$3678 = v$3676[0][1];
var v$3679 = v$3678[0];
v$3375 = [0,v$3679];
} };
};
switch (v$3375[0]) { case 1: {return 0;
 break; }default: {var v$3380 = v$3375[1];
return tools$0IntStringFinMap$1.fold$62(function(v$3378){return SmlPrims.chk_ovf_i32(v$3378[1] + 1);
},0,v$3380);
} };
};
special_objects$0TyName$1$3.eq$3381 = function(s1$3384,s2$3387){var t$4102;
var t$4101;
var v$3701;
if (s1$3384 == null) {s1$3384;
} else {var v$3998 = s1$3384;
switch (v$3998[0][0]) { case 0: {s1$3384;
 break; }default: {var v$3999 = v$3998[0][1];
var v$4000 = v$3999[0];
var v$4001 = v$3999[1];
if (v$4001 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$4002 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$4000);
var v$4003 = v$4002[1];
var v$4004 = v$4002[0];
if (v$4003) {(v$3998[0] = [0,v$4004],0);
s1$3384;
} else {(v$3998[0] = [1,[v$4004,special_objects$0Name$1.current_matchcount$69(0)]],0);
s1$3384;
};
} else {s1$3384;
};
} };
};
if (s1$3384 == null) {v$3701 = [1];
} else {var v$3703 = s1$3384;
switch (v$3703[0][0]) { case 0: {var v$3704 = v$3703[0][1];
v$3701 = [0,v$3704];
 break; }default: {var v$3705 = v$3703[0][1];
var v$3706 = v$3705[0];
v$3701 = [0,v$3706];
} };
};
switch (v$3701[0]) { case 1: {t$4101 = 0;
 break; }default: {var v$3707 = v$3701[1];
t$4101 = (tools$0IntStringFinMap$1.fold$62(function(v$3708){return SmlPrims.chk_ovf_i32(v$3708[1] + 1);
},0,v$3707));
} };
var t$4100;
var v$3710;
if (s2$3387 == null) {s2$3387;
} else {var v$4006 = s2$3387;
switch (v$4006[0][0]) { case 0: {s2$3387;
 break; }default: {var v$4007 = v$4006[0][1];
var v$4008 = v$4007[0];
var v$4009 = v$4007[1];
if (v$4009 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$4010 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$4008);
var v$4011 = v$4010[1];
var v$4012 = v$4010[0];
if (v$4011) {(v$4006[0] = [0,v$4012],0);
s2$3387;
} else {(v$4006[0] = [1,[v$4012,special_objects$0Name$1.current_matchcount$69(0)]],0);
s2$3387;
};
} else {s2$3387;
};
} };
};
if (s2$3387 == null) {v$3710 = [1];
} else {var v$3712 = s2$3387;
switch (v$3712[0][0]) { case 0: {var v$3713 = v$3712[0][1];
v$3710 = [0,v$3713];
 break; }default: {var v$3714 = v$3712[0][1];
var v$3715 = v$3714[0];
v$3710 = [0,v$3715];
} };
};
switch (v$3710[0]) { case 1: {t$4100 = 0;
 break; }default: {var v$3716 = v$3710[1];
t$4100 = (tools$0IntStringFinMap$1.fold$62(function(v$3717){return SmlPrims.chk_ovf_i32(v$3717[1] + 1);
},0,v$3716));
} };
t$4102 = (t$4101 == t$4100);
if (t$4102) {if (s1$3384 == null) {s1$3384;
} else {var v$4014 = s1$3384;
switch (v$4014[0][0]) { case 0: {s1$3384;
 break; }default: {var v$4015 = v$4014[0][1];
var v$4016 = v$4015[0];
var v$4017 = v$4015[1];
if (v$4017 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$4018 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$4016);
var v$4019 = v$4018[1];
var v$4020 = v$4018[0];
if (v$4019) {(v$4014[0] = [0,v$4020],0);
s1$3384;
} else {(v$4014[0] = [1,[v$4020,special_objects$0Name$1.current_matchcount$69(0)]],0);
s1$3384;
};
} else {s1$3384;
};
} };
};
if (s1$3384 == null) {return true;
} else {var im$3734;
if (s1$3384 == null) {im$3734 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3735 = s1$3384;
switch (v$3735[0][0]) { case 0: {im$3734 = v$3735[0][1];
 break; }default: {im$3734 = v$3735[0][1][0];
} };
};
return tools$0IntStringFinMap$1.fold$62(function(v$3737){var v$3738 = v$3737[0];
if (v$3737[1]) {var v$3742;
if (s2$3387 == null) {s2$3387;
} else {var v$4022 = s2$3387;
switch (v$4022[0][0]) { case 0: {s2$3387;
 break; }default: {var v$4023 = v$4022[0][1];
var v$4024 = v$4023[0];
var v$4025 = v$4023[1];
if (v$4025 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$4026 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$4024);
var v$4027 = v$4026[1];
var v$4028 = v$4026[0];
if (v$4027) {(v$4022[0] = [0,v$4028],0);
s2$3387;
} else {(v$4022[0] = [1,[v$4028,special_objects$0Name$1.current_matchcount$69(0)]],0);
s2$3387;
};
} else {s2$3387;
};
} };
};
if (s2$3387 == null) {v$3742 = [1];
} else {var v$3744 = s2$3387;
switch (v$3744[0][0]) { case 0: {var v$3745 = v$3744[0][1];
v$3742 = [0,v$3745];
 break; }default: {var v$3746 = v$3744[0][1];
var v$3747 = v$3746[0];
v$3742 = [0,v$3747];
} };
};
switch (v$3742[0]) { case 0: {var v$3748 = v$3742[1];
switch ((tools$0IntStringFinMap$1.lookup$129(v$3748,v$3738[2][0][1]))[0]) { case 0: {return true;
 break; }default: {return false;
} };
 break; }default: {return false;
} };
} else {return false;
};
},true,im$3734);
};
} else {return false;
};
};
special_objects$0TyName$1$3.layoutSet$3406 = function(v$3425,v$3424,v$3423){return function(pp_elt$3414){return function(m$3417){var t$4103;
var v$3421 = [0,v$3424];
var t$4109;
var t$4108 = basis$0List$1.map$332;
var t$4107 = pp_elt$3414;
var t$4106;
if (m$3417 == null) {t$4106 = null;
} else {var t$4105 = tools$0IntStringFinMap$1.range$284;
var t$4104;
if (m$3417 == null) {m$3417;
} else {var v$4030 = m$3417;
switch (v$4030[0][0]) { case 0: {m$3417;
 break; }default: {var v$4031 = v$4030[0][1];
var v$4032 = v$4031[0];
var v$4033 = v$4031[1];
if (v$4033 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$4034 = special_objects$0TyName$1$3.ensure_consistent_imap$2837(v$4032);
var v$4035 = v$4034[1];
var v$4036 = v$4034[0];
if (v$4035) {(v$4030[0] = [0,v$4036],0);
m$3417;
} else {(v$4030[0] = [1,[v$4036,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3417;
};
} else {m$3417;
};
} };
};
if (m$3417 == null) {t$4104 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3751 = m$3417;
switch (v$3751[0][0]) { case 0: {t$4104 = v$3751[0][1];
 break; }default: {t$4104 = v$3751[0][1][0];
} };
};
t$4106 = (t$4105(t$4104));
};
t$4109 = (t$4108(t$4107,t$4106));
t$4103 = [t$4109,v$3421,v$3425,1,v$3423];
return [0,t$4103];
};
};
};
special_objects$0TyName$1$3.pu_map0$3426 = function(pu_e$3429){var pu_m$3430 = tools$0IntStringFinMap$1.pu$488(pickle$0pickle$1.shareGen$878(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.int$729,pickle$0pickle$1.string$909)),pu_e$3429);
return pickle$0pickle$1.dataGen$1488(["QuasiSet.map0",function(v$3759){switch (v$3759[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$3760){return pickle$0pickle$1.con1$2014(function(v$3761){return [0,v$3761];
},function(v$3762){switch (v$3762[0]) { case 0: {return v$3762[1];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiSet.pu_map0.Rigid");
} };
},pu_m$3430);
},[function(v$3765){return pickle$0pickle$1.con1$2014(function(v$3766){return [1,[v$3766[1],-1]];
},function(v$3767){switch (v$3767[0]) { case 1: {var v$3768 = v$3767[1];
return [v$3768[1],v$3768[0]];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiSet.pu_map0.Flexible");
} };
},pickle$0pickle$1.shareGen$878(pickle$0pickle$1.pairGen0$983(special_objects$0Name$1.pu_matchcount$298,pu_m$3430)));
},null]]]);
};
special_objects$0TyName$1$3.pu$3472 = function(pu_e$3475){var b$3773;
var t$4111 = pickle$0pickle$1.optionGen$2134;
var t$4110;
var pu$3778 = special_objects$0TyName$1$3.pu_map0$3426(pu_e$3475);
t$4110 = (pickle$0pickle$1.ref0EqGen$1163(function(v$3779){return v$3779[0] == v$3779[1];
},pu$3778));
b$3773 = (t$4111(t$4110));
return pickle$0pickle$1.shareGen$878((pickle$0pickle$1.convert0$2299(function(v$4075){switch (v$4075[0]) { case 0: {var v$4076 = v$4075[1];
return v$4076;
 break; }default: {return null;
} };
},function(v$4077){if (v$4077 == null) {return [1];
} else {var v$4078 = v$4077;
return [0,v$4078];
};
}))(b$3773));
};
return 0;
})();
