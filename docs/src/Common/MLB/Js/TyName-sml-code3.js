if ((typeof(special_objects$0TyName$1$3)) == "undefined") {special_objects$0TyName$1$3 = {};
};
(function(){special_objects$0TyName$1$3.die$2710 = function(s$2713){return tools$0Crash$1.impossible$59("QuasiSet." + s$2713);
};
special_objects$0TyName$1$3.key$2714 = function(v$3978,v$3979,v$3980,v$3981,v$3982,v$3983){return v$3980[0][1];
};
special_objects$0TyName$1$3.rigid$2718 = function(v$3984,v$3985,v$3986,v$3987,v$3988,v$3989){return v$3986[0][2];
};
special_objects$0TyName$1$3.empty$2726 = null;
special_objects$0TyName$1$3.singleton$2727 = function(d$2730){var nd$2731 = d$2730[2];
return nd$2731[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(nd$2731[0][1],d$2730)]]:[[1,[tools$0IntStringFinMap$1.singleton$118(nd$2731[0][1],d$2730),special_objects$0Name$1.current_matchcount$69(0)]]];
};
special_objects$0TyName$1$3.isEmpty$2736 = function(v$2739){return (v$2739 == null)?true:false;
};
special_objects$0TyName$1$3.imap$2744 = function(v$2747){if (v$2747 == null) {return [1];
} else {var v$2756 = v$2747;
switch (v$2756[0][0]) { case 0: {var v$2758 = v$2756[0][1];
return [0,v$2758];
 break; }default: {var v$2759 = v$2756[0][1];
var v$2760 = v$2759[0];
return [0,v$2760];
} };
};
};
special_objects$0TyName$1$3.imap$$2761 = function(v$2764){if (v$2764 == null) {return tools$0Crash$1.impossible$59("QuasiSet.imap': impossible");
} else {var v$2774 = v$2764;
switch (v$2774[0][0]) { case 0: {return v$2774[0][1];
 break; }default: {return v$2774[0][1][0];
} };
};
};
special_objects$0TyName$1$3.ensure_consistent_imap$2779 = function(imap$2782){var v$2799 = tools$0IntStringFinMap$1.Fold$78(function(v$2807){var v$2816 = v$2807[0];
var v$2817 = v$2816[0];
var v$2818 = v$2816[1];
var v$2819 = v$2807[1];
var v$2820 = v$2819[0];
var v$2821 = v$2819[1];
var t$4014;
if (v$2820) {var v$3723 = v$2818[2][0][1];
t$4014 = ((v$3723[0] == v$2817[0])?(v$3723[1] == v$2817[1]):false);
} else {t$4014 = false;
};
return [t$4014,v$2821?v$2818[2][0][2]:false];
},[true,true],imap$2782);
var v$2800 = v$2799[0];
var v$2801 = v$2799[1];
return [v$2800?imap$2782:(tools$0IntStringFinMap$1.fold$62(function(v$2794){var v$2795 = v$2794[0];
var v$2796 = v$2794[1];
return tools$0IntStringFinMap$1.add$237(v$2795[2][0][1],v$2795,v$2796);
},tools$0IntStringFinMap$1.empty$117(0),imap$2782)),v$2801];
};
special_objects$0TyName$1$3.ensure_consistent$2822 = function(v$2825){if (v$2825 == null) {return v$2825;
} else {var v$2838 = v$2825;
switch (v$2838[0][0]) { case 0: {return v$2825;
 break; }default: {var v$2858 = v$2838[0][1];
var v$2859 = v$2858[0];
var v$2860 = v$2858[1];
if (v$2860 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2855 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$2859);
var v$2856 = v$2855[1];
var v$2857 = v$2855[0];
if (v$2856) {(v$2838[0] = [0,v$2857],0);
return v$2825;
} else {(v$2838[0] = [1,[v$2857,special_objects$0Name$1.current_matchcount$69(0)]],0);
return v$2825;
};
} else {return v$2825;
};
} };
};
};
special_objects$0TyName$1$3.mk_flex$2861 = function(imap$2864){return [[1,[imap$2864,special_objects$0Name$1.current_matchcount$69(0)]]];
};
special_objects$0TyName$1$3.mk_rigid$2865 = function(imap$2868){return [[0,imap$2868]];
};
special_objects$0TyName$1$3.member$2869 = function(v$3990,v$3991,v$3992,v$3993,v$3994,v$3995){return function(m$2875){var v$2880;
if (m$2875 == null) {m$2875;
} else {var v$3791 = m$2875;
switch (v$3791[0][0]) { case 0: {m$2875;
 break; }default: {var v$3792 = v$3791[0][1];
var v$3793 = v$3792[0];
var v$3794 = v$3792[1];
if (v$3794 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3795 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3793);
var v$3796 = v$3795[1];
var v$3797 = v$3795[0];
if (v$3796) {(v$3791[0] = [0,v$3797],0);
m$2875;
} else {(v$3791[0] = [1,[v$3797,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$2875;
};
} else {m$2875;
};
} };
};
if (m$2875 == null) {v$2880 = [1];
} else {var v$3494 = m$2875;
switch (v$3494[0][0]) { case 0: {var v$3495 = v$3494[0][1];
v$2880 = [0,v$3495];
 break; }default: {var v$3496 = v$3494[0][1];
var v$3497 = v$3496[0];
v$2880 = [0,v$3497];
} };
};
switch (v$2880[0]) { case 0: {var v$2887 = v$2880[1];
switch ((tools$0IntStringFinMap$1.lookup$129(v$2887,v$3992[0][1]))[0]) { case 0: {return true;
 break; }default: {return false;
} };
 break; }default: {return false;
} };
};
};
special_objects$0TyName$1$3.insert$2888 = function(d$2891,m$2894){if (m$2894 == null) {m$2894;
} else {var v$3799 = m$2894;
switch (v$3799[0][0]) { case 0: {m$2894;
 break; }default: {var v$3800 = v$3799[0][1];
var v$3801 = v$3800[0];
var v$3802 = v$3800[1];
if (v$3802 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3803 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3801);
var v$3804 = v$3803[1];
var v$3805 = v$3803[0];
if (v$3804) {(v$3799[0] = [0,v$3805],0);
m$2894;
} else {(v$3799[0] = [1,[v$3805,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$2894;
};
} else {m$2894;
};
} };
};
if (m$2894 == null) {var nd$3500 = d$2891[2];
return nd$3500[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(nd$3500[0][1],d$2891)]]:[[1,[tools$0IntStringFinMap$1.singleton$118(nd$3500[0][1],d$2891),special_objects$0Name$1.current_matchcount$69(0)]]];
} else {var v$2903 = m$2894;
switch (v$2903[0][0]) { case 0: {var v$2911 = v$2903[0][1];
var nd$2905 = d$2891[2];
var i$2906 = nd$2905[0][1];
return nd$2905[0][2]?[[0,tools$0IntStringFinMap$1.add$237(i$2906,d$2891,v$2911)]]:[[1,[tools$0IntStringFinMap$1.add$237(i$2906,d$2891,v$2911),special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {var v$2912 = v$2903[0][1];
var v$2913 = v$2912[0];
return [[1,[tools$0IntStringFinMap$1.add$237(d$2891[2][0][1],d$2891,v$2913),special_objects$0Name$1.current_matchcount$69(0)]]];
} };
};
};
special_objects$0TyName$1$3.union$2914 = function(m1$2917,m2$2920){if (m1$2917 == null) {m1$2917;
} else {var v$3807 = m1$2917;
switch (v$3807[0][0]) { case 0: {m1$2917;
 break; }default: {var v$3808 = v$3807[0][1];
var v$3809 = v$3808[0];
var v$3810 = v$3808[1];
if (v$3810 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3811 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3809);
var v$3812 = v$3811[1];
var v$3813 = v$3811[0];
if (v$3812) {(v$3807[0] = [0,v$3813],0);
m1$2917;
} else {(v$3807[0] = [1,[v$3813,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$2917;
};
} else {m1$2917;
};
} };
};
if (m2$2920 == null) {m2$2920;
} else {var v$3815 = m2$2920;
switch (v$3815[0][0]) { case 0: {m2$2920;
 break; }default: {var v$3816 = v$3815[0][1];
var v$3817 = v$3816[0];
var v$3818 = v$3816[1];
if (v$3818 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3819 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3817);
var v$3820 = v$3819[1];
var v$3821 = v$3819[0];
if (v$3820) {(v$3815[0] = [0,v$3821],0);
m2$2920;
} else {(v$3815[0] = [1,[v$3821,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$2920;
};
} else {m2$2920;
};
} };
};
if (m1$2917 == null) {return m2$2920;
} else {if (m2$2920 == null) {return m1$2917;
} else {var v$2939 = m1$2917;
switch (v$2939[0][0]) { case 0: {var v$2941 = m2$2920;
switch (v$2941[0][0]) { case 0: {var v$2943 = v$2939[0][1];
var v$2944 = v$2941[0][1];
return [[0,tools$0IntStringFinMap$1.plus$255(v$2943,v$2944)]];
 break; }default: {var t$4021;
var t$4020;
var t$4019;
var t$4018;
var t$4017 = tools$0IntStringFinMap$1.plus$255;
var t$4016;
if (m1$2917 == null) {t$4016 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3823 = m1$2917;
switch (v$3823[0][0]) { case 0: {t$4016 = v$3823[0][1];
 break; }default: {t$4016 = v$3823[0][1][0];
} };
};
var t$4015;
if (m2$2920 == null) {t$4015 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3824 = m2$2920;
switch (v$3824[0][0]) { case 0: {t$4015 = v$3824[0][1];
 break; }default: {t$4015 = v$3824[0][1][0];
} };
};
t$4018 = (t$4017(t$4016,t$4015));
t$4019 = [t$4018,special_objects$0Name$1.current_matchcount$69(0)];
t$4020 = [1,t$4019];
t$4021 = [t$4020];
return t$4021;
} };
 break; }default: {var t$4028;
var t$4027;
var t$4026;
var t$4025;
var t$4024 = tools$0IntStringFinMap$1.plus$255;
var t$4023;
if (m1$2917 == null) {t$4023 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3826 = m1$2917;
switch (v$3826[0][0]) { case 0: {t$4023 = v$3826[0][1];
 break; }default: {t$4023 = v$3826[0][1][0];
} };
};
var t$4022;
if (m2$2920 == null) {t$4022 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3827 = m2$2920;
switch (v$3827[0][0]) { case 0: {t$4022 = v$3827[0][1];
 break; }default: {t$4022 = v$3827[0][1][0];
} };
};
t$4025 = (t$4024(t$4023,t$4022));
t$4026 = [t$4025,special_objects$0Name$1.current_matchcount$69(0)];
t$4027 = [1,t$4026];
t$4028 = [t$4027];
return t$4028;
} };
};
};
};
special_objects$0TyName$1$3.remove$2948 = function(v$3996,v$3997,v$3998,v$3999,v$4000,v$4001){return function(m$2954){if (m$2954 == null) {m$2954;
} else {var v$3829 = m$2954;
switch (v$3829[0][0]) { case 0: {m$2954;
 break; }default: {var v$3830 = v$3829[0][1];
var v$3831 = v$3830[0];
var v$3832 = v$3830[1];
if (v$3832 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3833 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3831);
var v$3834 = v$3833[1];
var v$3835 = v$3833[0];
if (v$3834) {(v$3829[0] = [0,v$3835],0);
m$2954;
} else {(v$3829[0] = [1,[v$3835,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$2954;
};
} else {m$2954;
};
} };
};
if (m$2954 == null) {return m$2954;
} else {var v$2964 = m$2954;
switch (v$2964[0][0]) { case 0: {var v$2977 = v$2964[0][1];
var v$2970 = tools$0IntStringFinMap$1.remove$262(v$3998[0][1],v$2977);
switch (v$2970[0]) { case 0: {var v$2976 = v$2970[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$2976))?null:[[0,v$2976]];
 break; }default: {return m$2954;
} };
 break; }default: {var v$2989 = v$2964[0][1];
var v$2990 = v$2989[0];
var v$2982 = tools$0IntStringFinMap$1.remove$262(v$3998[0][1],v$2990);
switch (v$2982[0]) { case 0: {var v$2988 = v$2982[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$2988))?null:[[1,[v$2988,special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {return m$2954;
} };
} };
};
};
};
special_objects$0TyName$1$3.mk$2991 = function(v$3004,v$3005){return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3004))?null:(v$3005?[[0,v$3004]]:[[1,[v$3004,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
special_objects$0TyName$1$3.difference$3006 = function(m1$3009,m2$3012){if (m1$3009 == null) {m1$3009;
} else {var v$3837 = m1$3009;
switch (v$3837[0][0]) { case 0: {m1$3009;
 break; }default: {var v$3838 = v$3837[0][1];
var v$3839 = v$3838[0];
var v$3840 = v$3838[1];
if (v$3840 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3841 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3839);
var v$3842 = v$3841[1];
var v$3843 = v$3841[0];
if (v$3842) {(v$3837[0] = [0,v$3843],0);
m1$3009;
} else {(v$3837[0] = [1,[v$3843,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$3009;
};
} else {m1$3009;
};
} };
};
if (m2$3012 == null) {m2$3012;
} else {var v$3845 = m2$3012;
switch (v$3845[0][0]) { case 0: {m2$3012;
 break; }default: {var v$3846 = v$3845[0][1];
var v$3847 = v$3846[0];
var v$3848 = v$3846[1];
if (v$3848 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3849 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3847);
var v$3850 = v$3849[1];
var v$3851 = v$3849[0];
if (v$3850) {(v$3845[0] = [0,v$3851],0);
m2$3012;
} else {(v$3845[0] = [1,[v$3851,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$3012;
};
} else {m2$3012;
};
} };
};
if (m1$3009 == null) {return null;
} else {if (m2$3012 == null) {return m1$3009;
} else {var im1$3024;
if (m1$3009 == null) {im1$3024 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3525 = m1$3009;
switch (v$3525[0][0]) { case 0: {im1$3024 = v$3525[0][1];
 break; }default: {im1$3024 = v$3525[0][1][0];
} };
};
var im2$3025;
if (m2$3012 == null) {im2$3025 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3529 = m2$3012;
switch (v$3529[0][0]) { case 0: {im2$3025 = v$3529[0][1];
 break; }default: {im2$3025 = v$3529[0][1][0];
} };
};
var v$3029 = tools$0IntStringFinMap$1.Fold$78(function(v$3037){var v$3047 = v$3037[0];
var v$3048 = v$3047[0];
var v$3049 = v$3047[1];
var v$3050 = v$3037[1];
var v$3051 = v$3050[0];
var v$3052 = v$3050[1];
switch ((tools$0IntStringFinMap$1.lookup$129(im2$3025,v$3048))[0]) { case 0: {return [v$3051,v$3052];
 break; }default: {return [tools$0IntStringFinMap$1.add$237(v$3048,v$3049,v$3051),v$3052?v$3049[2][0][2]:false];
} };
},[tools$0IntStringFinMap$1.empty$117(0),true],im1$3024);
var v$3030 = v$3029[0];
var v$3031 = v$3029[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3030))?null:(v$3031?[[0,v$3030]]:[[1,[v$3030,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
};
special_objects$0TyName$1$3.intersect$3053 = function(m1$3056,m2$3059){if (m1$3056 == null) {m1$3056;
} else {var v$3853 = m1$3056;
switch (v$3853[0][0]) { case 0: {m1$3056;
 break; }default: {var v$3854 = v$3853[0][1];
var v$3855 = v$3854[0];
var v$3856 = v$3854[1];
if (v$3856 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3857 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3855);
var v$3858 = v$3857[1];
var v$3859 = v$3857[0];
if (v$3858) {(v$3853[0] = [0,v$3859],0);
m1$3056;
} else {(v$3853[0] = [1,[v$3859,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$3056;
};
} else {m1$3056;
};
} };
};
if (m2$3059 == null) {m2$3059;
} else {var v$3861 = m2$3059;
switch (v$3861[0][0]) { case 0: {m2$3059;
 break; }default: {var v$3862 = v$3861[0][1];
var v$3863 = v$3862[0];
var v$3864 = v$3862[1];
if (v$3864 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3865 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3863);
var v$3866 = v$3865[1];
var v$3867 = v$3865[0];
if (v$3866) {(v$3861[0] = [0,v$3867],0);
m2$3059;
} else {(v$3861[0] = [1,[v$3867,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$3059;
};
} else {m2$3059;
};
} };
};
if (m1$3056 == null) {return null;
} else {if (m2$3059 == null) {return null;
} else {var im1$3070;
if (m1$3056 == null) {im1$3070 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3537 = m1$3056;
switch (v$3537[0][0]) { case 0: {im1$3070 = v$3537[0][1];
 break; }default: {im1$3070 = v$3537[0][1][0];
} };
};
var im2$3071;
if (m2$3059 == null) {im2$3071 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3541 = m2$3059;
switch (v$3541[0][0]) { case 0: {im2$3071 = v$3541[0][1];
 break; }default: {im2$3071 = v$3541[0][1][0];
} };
};
var v$3075 = tools$0IntStringFinMap$1.Fold$78(function(v$3083){var v$3093 = v$3083[0];
var v$3094 = v$3093[0];
var v$3095 = v$3093[1];
var v$3096 = v$3083[1];
var v$3097 = v$3096[0];
var v$3098 = v$3096[1];
switch ((tools$0IntStringFinMap$1.lookup$129(im2$3071,v$3094))[0]) { case 0: {return [tools$0IntStringFinMap$1.add$237(v$3094,v$3095,v$3097),v$3098?v$3095[2][0][2]:false];
 break; }default: {return [v$3097,v$3098];
} };
},[tools$0IntStringFinMap$1.empty$117(0),true],im1$3070);
var v$3076 = v$3075[0];
var v$3077 = v$3075[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3076))?null:(v$3077?[[0,v$3076]]:[[1,[v$3076,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
};
special_objects$0TyName$1$3.partition$3099 = function(f$3102,m$3105){if (m$3105 == null) {m$3105;
} else {var v$3869 = m$3105;
switch (v$3869[0][0]) { case 0: {m$3105;
 break; }default: {var v$3870 = v$3869[0][1];
var v$3871 = v$3870[0];
var v$3872 = v$3870[1];
if (v$3872 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3873 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3871);
var v$3874 = v$3873[1];
var v$3875 = v$3873[0];
if (v$3874) {(v$3869[0] = [0,v$3875],0);
m$3105;
} else {(v$3869[0] = [1,[v$3875,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3105;
};
} else {m$3105;
};
} };
};
if (m$3105 == null) {return [null,null];
} else {var im$3111;
if (m$3105 == null) {im$3111 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3549 = m$3105;
switch (v$3549[0][0]) { case 0: {im$3111 = v$3549[0][1];
 break; }default: {im$3111 = v$3549[0][1][0];
} };
};
var v$3117 = tools$0IntStringFinMap$1.Fold$78(function(v$3129){var v$3142 = v$3129[0];
var v$3143 = v$3142[0];
var v$3144 = v$3142[1];
var v$3145 = v$3129[1];
var v$3146 = v$3145[0];
var v$3147 = v$3145[1];
var v$3148 = v$3145[2];
var v$3149 = v$3145[3];
return (f$3102(v$3144))?[tools$0IntStringFinMap$1.add$237(v$3143,v$3144,v$3146),v$3147?v$3144[2][0][2]:false,v$3148,v$3149]:[v$3146,v$3147,tools$0IntStringFinMap$1.add$237(v$3143,v$3144,v$3148),v$3149?v$3144[2][0][2]:false];
},[tools$0IntStringFinMap$1.empty$117(0),true,tools$0IntStringFinMap$1.empty$117(0),true],im$3111);
var v$3118 = v$3117[0];
var v$3119 = v$3117[1];
var v$3120 = v$3117[2];
var v$3121 = v$3117[3];
return [((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3118))?null:(v$3119?[[0,v$3118]]:[[1,[v$3118,special_objects$0Name$1.current_matchcount$69(0)]]]),((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3120))?null:(v$3121?[[0,v$3120]]:[[1,[v$3120,special_objects$0Name$1.current_matchcount$69(0)]]])];
};
};
special_objects$0TyName$1$3.subst$3150 = function(v$3195,v$3196){return function(m$3157){if (m$3157 == null) {m$3157;
} else {var v$3877 = m$3157;
switch (v$3877[0][0]) { case 0: {m$3157;
 break; }default: {var v$3878 = v$3877[0][1];
var v$3879 = v$3878[0];
var v$3880 = v$3878[1];
if (v$3880 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3881 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3879);
var v$3882 = v$3881[1];
var v$3883 = v$3881[0];
if (v$3882) {(v$3877[0] = [0,v$3883],0);
m$3157;
} else {(v$3877[0] = [1,[v$3883,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3157;
};
} else {m$3157;
};
} };
};
if (m$3157 == null) {return null;
} else {var im$3163;
if (m$3157 == null) {im$3163 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3561 = m$3157;
switch (v$3561[0][0]) { case 0: {im$3163 = v$3561[0][1];
 break; }default: {im$3163 = v$3561[0][1][0];
} };
};
var keya$3164 = v$3195[2][0][1];
var v$3168 = tools$0IntStringFinMap$1.Fold$78(function(v$3176){var v$3189 = v$3176[0];
var v$3190 = v$3189[0];
var v$3191 = v$3189[1];
var v$3192 = v$3176[1];
var v$3193 = v$3192[0];
var v$3194 = v$3192[1];
return ((keya$3164[0] == v$3190[0])?(keya$3164[1] == v$3190[1]):false)?[tools$0IntStringFinMap$1.add$237(v$3196[2][0][1],v$3196,v$3193),v$3194?v$3196[2][0][2]:false]:[tools$0IntStringFinMap$1.add$237(v$3190,v$3191,v$3193),v$3194?v$3191[2][0][2]:false];
},[tools$0IntStringFinMap$1.empty$117(0),true],im$3163);
var v$3169 = v$3168[0];
var v$3170 = v$3168[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3169))?null:(v$3170?[[0,v$3169]]:[[1,[v$3169,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
};
special_objects$0TyName$1$3.fold$3197 = function(f$3200,b$3203,m$3206){if (m$3206 == null) {m$3206;
} else {var v$3886 = m$3206;
switch (v$3886[0][0]) { case 0: {m$3206;
 break; }default: {var v$3887 = v$3886[0][1];
var v$3888 = v$3887[0];
var v$3889 = v$3887[1];
if (v$3889 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3890 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3888);
var v$3891 = v$3890[1];
var v$3892 = v$3890[0];
if (v$3891) {(v$3886[0] = [0,v$3892],0);
m$3206;
} else {(v$3886[0] = [1,[v$3892,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3206;
};
} else {m$3206;
};
} };
};
if (m$3206 == null) {return b$3203;
} else {var im$3212;
if (m$3206 == null) {im$3212 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3576 = m$3206;
switch (v$3576[0][0]) { case 0: {im$3212 = v$3576[0][1];
 break; }default: {im$3212 = v$3576[0][1][0];
} };
};
return tools$0IntStringFinMap$1.fold$62(function(v$3216){var v$3217 = v$3216[0];
var v$3218 = v$3216[1];
return (f$3200(v$3217))(v$3218);
},b$3203,im$3212);
};
};
special_objects$0TyName$1$3.map$3219 = function(f$3222,m$3225){if (m$3225 == null) {m$3225;
} else {var v$3894 = m$3225;
switch (v$3894[0][0]) { case 0: {m$3225;
 break; }default: {var v$3895 = v$3894[0][1];
var v$3896 = v$3895[0];
var v$3897 = v$3895[1];
if (v$3897 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3898 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3896);
var v$3899 = v$3898[1];
var v$3900 = v$3898[0];
if (v$3899) {(v$3894[0] = [0,v$3900],0);
m$3225;
} else {(v$3894[0] = [1,[v$3900,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3225;
};
} else {m$3225;
};
} };
};
if (m$3225 == null) {return m$3225;
} else {var im$3231;
if (m$3225 == null) {im$3231 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3580 = m$3225;
switch (v$3580[0][0]) { case 0: {im$3231 = v$3580[0][1];
 break; }default: {im$3231 = v$3580[0][1][0];
} };
};
var v$3235 = tools$0IntStringFinMap$1.fold$62(function(v$3242){var v$3248 = v$3242[0];
var v$3249 = v$3242[1];
var v$3250 = v$3249[0];
var v$3251 = v$3249[1];
var d$$3243 = f$3222(v$3248);
return [tools$0IntStringFinMap$1.add$237(d$$3243[2][0][1],d$$3243,v$3250),v$3251?d$$3243[2][0][2]:false];
},[tools$0IntStringFinMap$1.empty$117(0),true],im$3231);
var v$3236 = v$3235[0];
var v$3237 = v$3235[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3236))?null:(v$3237?[[0,v$3236]]:[[1,[v$3236,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
special_objects$0TyName$1$3.apply$3252 = function(f$3255,m$3258){var b$3589 = 0;
if (m$3258 == null) {m$3258;
} else {var v$3902 = m$3258;
switch (v$3902[0][0]) { case 0: {m$3258;
 break; }default: {var v$3903 = v$3902[0][1];
var v$3904 = v$3903[0];
var v$3905 = v$3903[1];
if (v$3905 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3906 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3904);
var v$3907 = v$3906[1];
var v$3908 = v$3906[0];
if (v$3907) {(v$3902[0] = [0,v$3908],0);
m$3258;
} else {(v$3902[0] = [1,[v$3908,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3258;
};
} else {m$3258;
};
} };
};
if (m$3258 == null) {return b$3589;
} else {var im$3592;
if (m$3258 == null) {im$3592 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3594 = m$3258;
switch (v$3594[0][0]) { case 0: {im$3592 = v$3594[0][1];
 break; }default: {im$3592 = v$3594[0][1][0];
} };
};
return tools$0IntStringFinMap$1.fold$62(function(v$3596){var v$3597 = v$3596[0];
return f$3255(v$3597);
},b$3589,im$3592);
};
};
special_objects$0TyName$1$3.list$3264 = function(v$3267){if (v$3267 == null) {return null;
} else {var t$4030 = tools$0IntStringFinMap$1.range$284;
var t$4029;
if (v$3267 == null) {v$3267;
} else {var v$3912 = v$3267;
switch (v$3912[0][0]) { case 0: {v$3267;
 break; }default: {var v$3913 = v$3912[0][1];
var v$3914 = v$3913[0];
var v$3915 = v$3913[1];
if (v$3915 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3916 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3914);
var v$3917 = v$3916[1];
var v$3918 = v$3916[0];
if (v$3917) {(v$3912[0] = [0,v$3918],0);
v$3267;
} else {(v$3912[0] = [1,[v$3918,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$3267;
};
} else {v$3267;
};
} };
};
if (v$3267 == null) {t$4029 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3600 = v$3267;
switch (v$3600[0][0]) { case 0: {t$4029 = v$3600[0][1];
 break; }default: {t$4029 = v$3600[0][1][0];
} };
};
return t$4030(t$4029);
};
};
special_objects$0TyName$1$3.fromList$3273 = function(v$3276){if (v$3276 == null) {return null;
} else {var v$3285;
var b$3604 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$4031 = {};
fix$4031.$foldl = function(v$3607,v$3608){lab$foldl: while (true) {if (v$3608 == null) {return v$3607;
} else {var v$3609 = v$3608;
var v$3610 = v$3609[0];
var v$3611 = v$3609[1];
var t$4032;
var v$3922 = v$3607[0];
var v$3923 = v$3607[1];
t$4032 = [tools$0IntStringFinMap$1.add$237(v$3610[2][0][1],v$3610,v$3922),v$3923?v$3610[2][0][2]:false];
var t$4033 = t$4032;
var t$4034 = v$3611;
var v$3607 = t$4033;
var v$3608 = t$4034;
continue lab$foldl;
};
};
};
var foldl$3606 = fix$4031.$foldl;
v$3285 = (foldl$3606(b$3604,v$3276));
var v$3286 = v$3285[0];
var v$3287 = v$3285[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$3286))?null:(v$3287?[[0,v$3286]]:[[1,[v$3286,special_objects$0Name$1.current_matchcount$69(0)]]]);
};
};
special_objects$0TyName$1$3.addList$3301 = function(l$3304,m1$3307){var m2$3308 = special_objects$0TyName$1$3.fromList$3273(l$3304);
return special_objects$0TyName$1$3.union$2914(m1$3307,m2$3308);
};
special_objects$0TyName$1$3.size$3309 = function(m$3312){var v$3317;
if (m$3312 == null) {m$3312;
} else {var v$3925 = m$3312;
switch (v$3925[0][0]) { case 0: {m$3312;
 break; }default: {var v$3926 = v$3925[0][1];
var v$3927 = v$3926[0];
var v$3928 = v$3926[1];
if (v$3928 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3929 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3927);
var v$3930 = v$3929[1];
var v$3931 = v$3929[0];
if (v$3930) {(v$3925[0] = [0,v$3931],0);
m$3312;
} else {(v$3925[0] = [1,[v$3931,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3312;
};
} else {m$3312;
};
} };
};
if (m$3312 == null) {v$3317 = [1];
} else {var v$3618 = m$3312;
switch (v$3618[0][0]) { case 0: {var v$3619 = v$3618[0][1];
v$3317 = [0,v$3619];
 break; }default: {var v$3620 = v$3618[0][1];
var v$3621 = v$3620[0];
v$3317 = [0,v$3621];
} };
};
switch (v$3317[0]) { case 1: {return 0;
 break; }default: {var v$3322 = v$3317[1];
return tools$0IntStringFinMap$1.fold$62(function(v$3320){return SmlPrims.chk_ovf_i32(v$3320[1] + 1);
},0,v$3322);
} };
};
special_objects$0TyName$1$3.eq$3323 = function(s1$3326,s2$3329){var t$4037;
var t$4036;
var v$3643;
if (s1$3326 == null) {s1$3326;
} else {var v$3933 = s1$3326;
switch (v$3933[0][0]) { case 0: {s1$3326;
 break; }default: {var v$3934 = v$3933[0][1];
var v$3935 = v$3934[0];
var v$3936 = v$3934[1];
if (v$3936 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3937 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3935);
var v$3938 = v$3937[1];
var v$3939 = v$3937[0];
if (v$3938) {(v$3933[0] = [0,v$3939],0);
s1$3326;
} else {(v$3933[0] = [1,[v$3939,special_objects$0Name$1.current_matchcount$69(0)]],0);
s1$3326;
};
} else {s1$3326;
};
} };
};
if (s1$3326 == null) {v$3643 = [1];
} else {var v$3645 = s1$3326;
switch (v$3645[0][0]) { case 0: {var v$3646 = v$3645[0][1];
v$3643 = [0,v$3646];
 break; }default: {var v$3647 = v$3645[0][1];
var v$3648 = v$3647[0];
v$3643 = [0,v$3648];
} };
};
switch (v$3643[0]) { case 1: {t$4036 = 0;
 break; }default: {var v$3649 = v$3643[1];
t$4036 = (tools$0IntStringFinMap$1.fold$62(function(v$3650){return SmlPrims.chk_ovf_i32(v$3650[1] + 1);
},0,v$3649));
} };
var t$4035;
var v$3652;
if (s2$3329 == null) {s2$3329;
} else {var v$3941 = s2$3329;
switch (v$3941[0][0]) { case 0: {s2$3329;
 break; }default: {var v$3942 = v$3941[0][1];
var v$3943 = v$3942[0];
var v$3944 = v$3942[1];
if (v$3944 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3945 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3943);
var v$3946 = v$3945[1];
var v$3947 = v$3945[0];
if (v$3946) {(v$3941[0] = [0,v$3947],0);
s2$3329;
} else {(v$3941[0] = [1,[v$3947,special_objects$0Name$1.current_matchcount$69(0)]],0);
s2$3329;
};
} else {s2$3329;
};
} };
};
if (s2$3329 == null) {v$3652 = [1];
} else {var v$3654 = s2$3329;
switch (v$3654[0][0]) { case 0: {var v$3655 = v$3654[0][1];
v$3652 = [0,v$3655];
 break; }default: {var v$3656 = v$3654[0][1];
var v$3657 = v$3656[0];
v$3652 = [0,v$3657];
} };
};
switch (v$3652[0]) { case 1: {t$4035 = 0;
 break; }default: {var v$3658 = v$3652[1];
t$4035 = (tools$0IntStringFinMap$1.fold$62(function(v$3659){return SmlPrims.chk_ovf_i32(v$3659[1] + 1);
},0,v$3658));
} };
t$4037 = (t$4036 == t$4035);
if (t$4037) {if (s1$3326 == null) {s1$3326;
} else {var v$3949 = s1$3326;
switch (v$3949[0][0]) { case 0: {s1$3326;
 break; }default: {var v$3950 = v$3949[0][1];
var v$3951 = v$3950[0];
var v$3952 = v$3950[1];
if (v$3952 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3953 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3951);
var v$3954 = v$3953[1];
var v$3955 = v$3953[0];
if (v$3954) {(v$3949[0] = [0,v$3955],0);
s1$3326;
} else {(v$3949[0] = [1,[v$3955,special_objects$0Name$1.current_matchcount$69(0)]],0);
s1$3326;
};
} else {s1$3326;
};
} };
};
if (s1$3326 == null) {return true;
} else {var im$3676;
if (s1$3326 == null) {im$3676 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3677 = s1$3326;
switch (v$3677[0][0]) { case 0: {im$3676 = v$3677[0][1];
 break; }default: {im$3676 = v$3677[0][1][0];
} };
};
return tools$0IntStringFinMap$1.fold$62(function(v$3679){var v$3680 = v$3679[0];
if (v$3679[1]) {var v$3684;
if (s2$3329 == null) {s2$3329;
} else {var v$3957 = s2$3329;
switch (v$3957[0][0]) { case 0: {s2$3329;
 break; }default: {var v$3958 = v$3957[0][1];
var v$3959 = v$3958[0];
var v$3960 = v$3958[1];
if (v$3960 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3961 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3959);
var v$3962 = v$3961[1];
var v$3963 = v$3961[0];
if (v$3962) {(v$3957[0] = [0,v$3963],0);
s2$3329;
} else {(v$3957[0] = [1,[v$3963,special_objects$0Name$1.current_matchcount$69(0)]],0);
s2$3329;
};
} else {s2$3329;
};
} };
};
if (s2$3329 == null) {v$3684 = [1];
} else {var v$3686 = s2$3329;
switch (v$3686[0][0]) { case 0: {var v$3687 = v$3686[0][1];
v$3684 = [0,v$3687];
 break; }default: {var v$3688 = v$3686[0][1];
var v$3689 = v$3688[0];
v$3684 = [0,v$3689];
} };
};
switch (v$3684[0]) { case 0: {var v$3690 = v$3684[1];
switch ((tools$0IntStringFinMap$1.lookup$129(v$3690,v$3680[2][0][1]))[0]) { case 0: {return true;
 break; }default: {return false;
} };
 break; }default: {return false;
} };
} else {return false;
};
},true,im$3676);
};
} else {return false;
};
};
special_objects$0TyName$1$3.layoutSet$3348 = function(v$3367,v$3366,v$3365){return function(pp_elt$3356){return function(m$3359){var t$4038;
var v$3363 = [0,v$3366];
var t$4044;
var t$4043 = basis$0List$1.map$332;
var t$4042 = pp_elt$3356;
var t$4041;
if (m$3359 == null) {t$4041 = null;
} else {var t$4040 = tools$0IntStringFinMap$1.range$284;
var t$4039;
if (m$3359 == null) {m$3359;
} else {var v$3965 = m$3359;
switch (v$3965[0][0]) { case 0: {m$3359;
 break; }default: {var v$3966 = v$3965[0][1];
var v$3967 = v$3966[0];
var v$3968 = v$3966[1];
if (v$3968 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$3969 = special_objects$0TyName$1$3.ensure_consistent_imap$2779(v$3967);
var v$3970 = v$3969[1];
var v$3971 = v$3969[0];
if (v$3970) {(v$3965[0] = [0,v$3971],0);
m$3359;
} else {(v$3965[0] = [1,[v$3971,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$3359;
};
} else {m$3359;
};
} };
};
if (m$3359 == null) {t$4039 = (tools$0Crash$1.impossible$59("QuasiSet.imap': impossible"));
} else {var v$3693 = m$3359;
switch (v$3693[0][0]) { case 0: {t$4039 = v$3693[0][1];
 break; }default: {t$4039 = v$3693[0][1][0];
} };
};
t$4041 = (t$4040(t$4039));
};
t$4044 = (t$4043(t$4042,t$4041));
t$4038 = [t$4044,v$3363,v$3367,1,v$3365];
return [0,t$4038];
};
};
};
special_objects$0TyName$1$3.pu_map0$3368 = function(pu_e$3371){var pu_m$3372 = tools$0IntStringFinMap$1.pu$488(pickle$0pickle$1.pairGen$1053([pickle$0pickle$1.int$729,pickle$0pickle$1.string$909]),pu_e$3371);
return pickle$0pickle$1.dataGen$1488(["QuasiSet.map0",function(v$3699){switch (v$3699[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$3700){return pickle$0pickle$1.con1$2014(function(v$3701){return [0,v$3701];
},function(v$3702){switch (v$3702[0]) { case 0: {return v$3702[1];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiSet.pu_map0.Rigid");
} };
},pu_m$3372);
},[function(v$3705){return pickle$0pickle$1.con1$2014(function(v$3706){return [1,[v$3706[1],-1]];
},function(v$3707){switch (v$3707[0]) { case 1: {var v$3708 = v$3707[1];
return [v$3708[1],v$3708[0]];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiSet.pu_map0.Flexible");
} };
},pickle$0pickle$1.pairGen$1053([special_objects$0Name$1.pu_matchcount$298,pu_m$3372]));
},null]]]);
};
special_objects$0TyName$1$3.pu$3414 = function(pu_e$3417){var t$4051 = pickle$0pickle$1.convert$2342;
var t$4050 = [function(v$3711){switch (v$3711[0]) { case 0: {var v$3712 = v$3711[1];
return v$3712;
 break; }default: {return null;
} };
},function(v$3713){if (v$3713 == null) {return [1];
} else {var v$3714 = v$3713;
return [0,v$3714];
};
}];
var t$4049;
var t$4048 = pickle$0pickle$1.optionGen$2134;
var t$4047;
var t$4046 = pickle$0pickle$1.ref0Gen$1264;
var t$4045;
var pu_m$4005 = tools$0IntStringFinMap$1.pu$488(pickle$0pickle$1.pairGen$1053([pickle$0pickle$1.int$729,pickle$0pickle$1.string$909]),pu_e$3417);
t$4045 = (pickle$0pickle$1.dataGen$1488(["QuasiSet.map0",function(v$4006){switch (v$4006[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$4007){return pickle$0pickle$1.con1$2014(function(v$4008){return [0,v$4008];
},function(v$4009){switch (v$4009[0]) { case 0: {return v$4009[1];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiSet.pu_map0.Rigid");
} };
},pu_m$4005);
},[function(v$4010){return pickle$0pickle$1.con1$2014(function(v$4011){return [1,[v$4011[1],-1]];
},function(v$4012){switch (v$4012[0]) { case 1: {var v$4013 = v$4012[1];
return [v$4013[1],v$4013[0]];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiSet.pu_map0.Flexible");
} };
},pickle$0pickle$1.pairGen$1053([special_objects$0Name$1.pu_matchcount$298,pu_m$4005]));
},null]]]));
t$4047 = (t$4046(t$4045));
t$4049 = (t$4048(t$4047));
return t$4051(t$4050,t$4049);
};
return 0;
})();
