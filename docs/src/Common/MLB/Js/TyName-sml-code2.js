if ((typeof(special_objects$0TyName$1$2)) == "undefined") {special_objects$0TyName$1$2 = {};
};
(function(){special_objects$0TyName$1$2.die$1244 = function(s$1247){return tools$0Crash$1.impossible$59("QuasiMap2." + s$1247);
};
special_objects$0TyName$1$2.key$1248 = function(v$2618,v$2619,v$2620,v$2621,v$2622,v$2623){return v$2620[0][1];
};
special_objects$0TyName$1$2.rigid$1252 = function(v$2624,v$2625,v$2626,v$2627,v$2628,v$2629){return v$2626[0][2];
};
special_objects$0TyName$1$2.empty$1260 = function(v$2663){return null;
};
special_objects$0TyName$1$2.singleton$1261 = function(v$1272,v$1273){var nd$1266 = v$1272[2];
var k$1267 = nd$1266[0][1];
return nd$1266[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$1267,[v$1272,v$1273])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$1267,[v$1272,v$1273]),special_objects$0Name$1.current_matchcount$69(0)]]];
};
special_objects$0TyName$1$2.isEmpty$1274 = function(v$1277){return (v$1277 == null)?true:false;
};
special_objects$0TyName$1$2.imap$1282 = function(v$1285){if (v$1285 == null) {return [1];
} else {var v$1294 = v$1285;
switch (v$1294[0][0]) { case 0: {var v$1296 = v$1294[0][1];
return [0,v$1296];
 break; }default: {var v$1297 = v$1294[0][1];
var v$1298 = v$1297[0];
return [0,v$1298];
} };
};
};
special_objects$0TyName$1$2.imap$$1299 = function(v$1302){if (v$1302 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible");
} else {var v$1312 = v$1302;
switch (v$1312[0][0]) { case 0: {return v$1312[0][1];
 break; }default: {return v$1312[0][1][0];
} };
};
};
special_objects$0TyName$1$2.ensure_consistent_imap$1317 = function(imap$1320){var v$1340 = tools$0IntStringFinMap$1.Fold$78(function(v$1348){var v$1357 = v$1348[0];
var v$1358 = v$1357[0];
var v$1359 = v$1357[1];
var v$1360 = v$1359[0];
var v$1361 = v$1348[1];
var v$1362 = v$1361[0];
var v$1363 = v$1361[1];
var t$2664;
if (v$1362) {var v$2307 = v$1360[2][0][1];
t$2664 = ((v$2307[0] == v$1358[0])?(v$2307[1] == v$1358[1]):false);
} else {t$2664 = false;
};
return [t$2664,v$1363?v$1360[2][0][2]:false];
},[true,true],imap$1320);
var v$1341 = v$1340[0];
var v$1342 = v$1340[1];
return [v$1341?imap$1320:(tools$0IntStringFinMap$1.fold$62(function(v$1333){var v$1334 = v$1333[0];
var v$1335 = v$1334[0];
var v$1336 = v$1334[1];
var v$1337 = v$1333[1];
return tools$0IntStringFinMap$1.add$237(v$1335[2][0][1],[v$1335,v$1336],v$1337);
},tools$0IntStringFinMap$1.empty$117(0),imap$1320)),v$1342];
};
special_objects$0TyName$1$2.ensure_consistent$1364 = function(v$1367){if (v$1367 == null) {return v$1367;
} else {var v$1380 = v$1367;
switch (v$1380[0][0]) { case 0: {return v$1367;
 break; }default: {var v$1400 = v$1380[0][1];
var v$1401 = v$1400[0];
var v$1402 = v$1400[1];
if (v$1402 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1397 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$1401);
var v$1398 = v$1397[1];
var v$1399 = v$1397[0];
if (v$1398) {(v$1380[0] = [0,v$1399],0);
return v$1367;
} else {(v$1380[0] = [1,[v$1399,special_objects$0Name$1.current_matchcount$69(0)]],0);
return v$1367;
};
} else {return v$1367;
};
} };
};
};
special_objects$0TyName$1$2.mk_flex$1403 = function(imap$1406){return [[1,[imap$1406,special_objects$0Name$1.current_matchcount$69(0)]]];
};
special_objects$0TyName$1$2.mk_rigid$1407 = function(imap$1410){return [[0,imap$1410]];
};
special_objects$0TyName$1$2.lookup$1411 = function(m$1414,d$1417){var v$1422;
if (m$1414 == null) {m$1414;
} else {var v$2386 = m$1414;
switch (v$2386[0][0]) { case 0: {m$1414;
 break; }default: {var v$2387 = v$2386[0][1];
var v$2388 = v$2387[0];
var v$2389 = v$2387[1];
if (v$2389 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2390 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2388);
var v$2391 = v$2390[1];
var v$2392 = v$2390[0];
if (v$2391) {(v$2386[0] = [0,v$2392],0);
m$1414;
} else {(v$2386[0] = [1,[v$2392,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1414;
};
} else {m$1414;
};
} };
};
if (m$1414 == null) {v$1422 = [1];
} else {var v$2083 = m$1414;
switch (v$2083[0][0]) { case 0: {var v$2084 = v$2083[0][1];
v$1422 = [0,v$2084];
 break; }default: {var v$2085 = v$2083[0][1];
var v$2086 = v$2085[0];
v$1422 = [0,v$2086];
} };
};
switch (v$1422[0]) { case 0: {var v$1432 = v$1422[1];
var v$1428 = tools$0IntStringFinMap$1.lookup$129(v$1432,d$1417[2][0][1]);
switch (v$1428[0]) { case 0: {var v$1430 = v$1428[1];
var v$1431 = v$1430[1];
return [0,v$1431];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
special_objects$0TyName$1$2.add$1433 = function(v$1458,v$1459,v$1460){if (v$1460 == null) {v$1460;
} else {var v$2394 = v$1460;
switch (v$2394[0][0]) { case 0: {v$1460;
 break; }default: {var v$2395 = v$2394[0][1];
var v$2396 = v$2395[0];
var v$2397 = v$2395[1];
if (v$2397 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2398 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2396);
var v$2399 = v$2398[1];
var v$2400 = v$2398[0];
if (v$2399) {(v$2394[0] = [0,v$2400],0);
v$1460;
} else {(v$2394[0] = [1,[v$2400,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1460;
};
} else {v$1460;
};
} };
};
if (v$1460 == null) {var nd$2091 = v$1458[2];
var k$2092 = nd$2091[0][1];
return nd$2091[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$2092,[v$1458,v$1459])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$2092,[v$1458,v$1459]),special_objects$0Name$1.current_matchcount$69(0)]]];
} else {var v$1447 = v$1460;
switch (v$1447[0][0]) { case 0: {var v$1455 = v$1447[0][1];
var nd$1449 = v$1458[2];
var i$1450 = nd$1449[0][1];
return nd$1449[0][2]?[[0,tools$0IntStringFinMap$1.add$237(i$1450,[v$1458,v$1459],v$1455)]]:[[1,[tools$0IntStringFinMap$1.add$237(i$1450,[v$1458,v$1459],v$1455),special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {var v$1456 = v$1447[0][1];
var v$1457 = v$1456[0];
return [[1,[tools$0IntStringFinMap$1.add$237(v$1458[2][0][1],[v$1458,v$1459],v$1457),special_objects$0Name$1.current_matchcount$69(0)]]];
} };
};
};
special_objects$0TyName$1$2.plus$1461 = function(v$1495,v$1496){if (v$1495 == null) {v$1495;
} else {var v$2402 = v$1495;
switch (v$2402[0][0]) { case 0: {v$1495;
 break; }default: {var v$2403 = v$2402[0][1];
var v$2404 = v$2403[0];
var v$2405 = v$2403[1];
if (v$2405 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2406 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2404);
var v$2407 = v$2406[1];
var v$2408 = v$2406[0];
if (v$2407) {(v$2402[0] = [0,v$2408],0);
v$1495;
} else {(v$2402[0] = [1,[v$2408,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1495;
};
} else {v$1495;
};
} };
};
if (v$1496 == null) {v$1496;
} else {var v$2410 = v$1496;
switch (v$2410[0][0]) { case 0: {v$1496;
 break; }default: {var v$2411 = v$2410[0][1];
var v$2412 = v$2411[0];
var v$2413 = v$2411[1];
if (v$2413 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2414 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2412);
var v$2415 = v$2414[1];
var v$2416 = v$2414[0];
if (v$2415) {(v$2410[0] = [0,v$2416],0);
v$1496;
} else {(v$2410[0] = [1,[v$2416,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1496;
};
} else {v$1496;
};
} };
};
if (v$1495 == null) {return v$1496;
} else {if (v$1496 == null) {return v$1495;
} else {var v$1486 = v$1495;
switch (v$1486[0][0]) { case 0: {var v$1488 = v$1496;
switch (v$1488[0][0]) { case 0: {var v$1490 = v$1486[0][1];
var v$1491 = v$1488[0][1];
return [[0,tools$0IntStringFinMap$1.plus$255(v$1490,v$1491)]];
 break; }default: {var t$2671;
var t$2670;
var t$2669;
var t$2668;
var t$2667 = tools$0IntStringFinMap$1.plus$255;
var t$2666;
if (v$1495 == null) {t$2666 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2418 = v$1495;
switch (v$2418[0][0]) { case 0: {t$2666 = v$2418[0][1];
 break; }default: {t$2666 = v$2418[0][1][0];
} };
};
var t$2665;
if (v$1496 == null) {t$2665 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2419 = v$1496;
switch (v$2419[0][0]) { case 0: {t$2665 = v$2419[0][1];
 break; }default: {t$2665 = v$2419[0][1][0];
} };
};
t$2668 = (t$2667(t$2666,t$2665));
t$2669 = [t$2668,special_objects$0Name$1.current_matchcount$69(0)];
t$2670 = [1,t$2669];
t$2671 = [t$2670];
return t$2671;
} };
 break; }default: {var t$2678;
var t$2677;
var t$2676;
var t$2675;
var t$2674 = tools$0IntStringFinMap$1.plus$255;
var t$2673;
if (v$1495 == null) {t$2673 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2421 = v$1495;
switch (v$2421[0][0]) { case 0: {t$2673 = v$2421[0][1];
 break; }default: {t$2673 = v$2421[0][1][0];
} };
};
var t$2672;
if (v$1496 == null) {t$2672 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2422 = v$1496;
switch (v$2422[0][0]) { case 0: {t$2672 = v$2422[0][1];
 break; }default: {t$2672 = v$2422[0][1][0];
} };
};
t$2675 = (t$2674(t$2673,t$2672));
t$2676 = [t$2675,special_objects$0Name$1.current_matchcount$69(0)];
t$2677 = [1,t$2676];
t$2678 = [t$2677];
return t$2678;
} };
};
};
};
special_objects$0TyName$1$2.remove$1497 = function(v$1538,v$1539){if (v$1539 == null) {v$1539;
} else {var v$2424 = v$1539;
switch (v$2424[0][0]) { case 0: {v$1539;
 break; }default: {var v$2425 = v$2424[0][1];
var v$2426 = v$2425[0];
var v$2427 = v$2425[1];
if (v$2427 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2428 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2426);
var v$2429 = v$2428[1];
var v$2430 = v$2428[0];
if (v$2429) {(v$2424[0] = [0,v$2430],0);
v$1539;
} else {(v$2424[0] = [1,[v$2430,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1539;
};
} else {v$1539;
};
} };
};
if (v$1539 == null) {return [1];
} else {var v$1511 = v$1539;
switch (v$1511[0][0]) { case 0: {var v$1524 = v$1511[0][1];
var v$1517 = tools$0IntStringFinMap$1.remove$262(v$1538[2][0][1],v$1524);
switch (v$1517[0]) { case 0: {var v$1523 = v$1517[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$1523))?[0,null]:[0,[[0,v$1523]]];
 break; }default: {return [1];
} };
 break; }default: {var v$1536 = v$1511[0][1];
var v$1537 = v$1536[0];
var v$1529 = tools$0IntStringFinMap$1.remove$262(v$1538[2][0][1],v$1537);
switch (v$1529[0]) { case 0: {var v$1535 = v$1529[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$1535))?[0,null]:[0,[[1,[v$1535,special_objects$0Name$1.current_matchcount$69(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
special_objects$0TyName$1$2.dom$1540 = function(v$1543){if (v$1543 == null) {return null;
} else {var t$2683 = basis$0List$1.map$697;
var t$2682 = function(v$1551){return v$1551[0];
};
var t$2681;
var t$2680 = tools$0IntStringFinMap$1.range$284;
var t$2679;
if (v$1543 == null) {v$1543;
} else {var v$2432 = v$1543;
switch (v$2432[0][0]) { case 0: {v$1543;
 break; }default: {var v$2433 = v$2432[0][1];
var v$2434 = v$2433[0];
var v$2435 = v$2433[1];
if (v$2435 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2436 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2434);
var v$2437 = v$2436[1];
var v$2438 = v$2436[0];
if (v$2437) {(v$2432[0] = [0,v$2438],0);
v$1543;
} else {(v$2432[0] = [1,[v$2438,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1543;
};
} else {v$1543;
};
} };
};
if (v$1543 == null) {t$2679 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2115 = v$1543;
switch (v$2115[0][0]) { case 0: {t$2679 = v$2115[0][1];
 break; }default: {t$2679 = v$2115[0][1][0];
} };
};
t$2681 = (t$2680(t$2679));
return t$2683(t$2682,t$2681);
};
};
special_objects$0TyName$1$2.range$1553 = function(v$1556){if (v$1556 == null) {return null;
} else {var t$2688 = basis$0List$1.map$697;
var t$2687 = function(v$1564){return v$1564[1];
};
var t$2686;
var t$2685 = tools$0IntStringFinMap$1.range$284;
var t$2684;
if (v$1556 == null) {v$1556;
} else {var v$2440 = v$1556;
switch (v$2440[0][0]) { case 0: {v$1556;
 break; }default: {var v$2441 = v$2440[0][1];
var v$2442 = v$2441[0];
var v$2443 = v$2441[1];
if (v$2443 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2444 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2442);
var v$2445 = v$2444[1];
var v$2446 = v$2444[0];
if (v$2445) {(v$2440[0] = [0,v$2446],0);
v$1556;
} else {(v$2440[0] = [1,[v$2446,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1556;
};
} else {v$1556;
};
} };
};
if (v$1556 == null) {t$2684 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2119 = v$1556;
switch (v$2119[0][0]) { case 0: {t$2684 = v$2119[0][1];
 break; }default: {t$2684 = v$2119[0][1][0];
} };
};
t$2686 = (t$2685(t$2684));
return t$2688(t$2687,t$2686);
};
};
special_objects$0TyName$1$2.list$1566 = function(v$1569){if (v$1569 == null) {return null;
} else {var t$2690 = tools$0IntStringFinMap$1.range$284;
var t$2689;
if (v$1569 == null) {v$1569;
} else {var v$2448 = v$1569;
switch (v$2448[0][0]) { case 0: {v$1569;
 break; }default: {var v$2449 = v$2448[0][1];
var v$2450 = v$2449[0];
var v$2451 = v$2449[1];
if (v$2451 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2452 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2450);
var v$2453 = v$2452[1];
var v$2454 = v$2452[0];
if (v$2453) {(v$2448[0] = [0,v$2454],0);
v$1569;
} else {(v$2448[0] = [1,[v$2454,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1569;
};
} else {v$1569;
};
} };
};
if (v$1569 == null) {t$2689 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2123 = v$1569;
switch (v$2123[0][0]) { case 0: {t$2689 = v$2123[0][1];
 break; }default: {t$2689 = v$2123[0][1][0];
} };
};
return t$2690(t$2689);
};
};
special_objects$0TyName$1$2.fromList$1575 = function(v$1578){if (v$1578 == null) {return null;
} else {var v$1591;
var b$2127 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$2691 = {};
fix$2691.$foldl = function(v$2130,v$2131){lab$foldl: while (true) {if (v$2131 == null) {return v$2130;
} else {var v$2132 = v$2131;
var v$2133 = v$2132[0];
var v$2134 = v$2132[1];
var t$2692;
var v$2457 = v$2133[0];
var v$2458 = v$2133[1];
var v$2460 = v$2130[0];
var v$2461 = v$2130[1];
t$2692 = [tools$0IntStringFinMap$1.add$237(v$2457[2][0][1],[v$2457,v$2458],v$2460),v$2461?v$2457[2][0][2]:false];
var t$2693 = t$2692;
var t$2694 = v$2134;
var v$2130 = t$2693;
var v$2131 = t$2694;
continue lab$foldl;
};
};
};
var foldl$2129 = fix$2691.$foldl;
v$1591 = (foldl$2129(b$2127,v$1578));
var v$1592 = v$1591[0];
return v$1591[1]?[[0,v$1592]]:[[1,[v$1592,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
special_objects$0TyName$1$2.composemap$1610 = function(f$1613,m$1616){var v$1621;
if (m$1616 == null) {v$1621 = null;
} else {var t$2696 = tools$0IntStringFinMap$1.range$284;
var t$2695;
if (m$1616 == null) {m$1616;
} else {var v$2463 = m$1616;
switch (v$2463[0][0]) { case 0: {m$1616;
 break; }default: {var v$2464 = v$2463[0][1];
var v$2465 = v$2464[0];
var v$2466 = v$2464[1];
if (v$2466 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2467 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2465);
var v$2468 = v$2467[1];
var v$2469 = v$2467[0];
if (v$2468) {(v$2463[0] = [0,v$2469],0);
m$1616;
} else {(v$2463[0] = [1,[v$2469,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1616;
};
} else {m$1616;
};
} };
};
if (m$1616 == null) {t$2695 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2141 = m$1616;
switch (v$2141[0][0]) { case 0: {t$2695 = v$2141[0][1];
 break; }default: {t$2695 = v$2141[0][1][0];
} };
};
v$1621 = (t$2696(t$2695));
};
if (v$1621 == null) {return null;
} else {var v$1629;
var b$2144 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$2697 = {};
fix$2697.$foldl = function(v$2147,v$2148){lab$foldl: while (true) {if (v$2148 == null) {return v$2147;
} else {var v$2149 = v$2148;
var v$2150 = v$2149[0];
var v$2151 = v$2149[1];
var t$2698;
var v$2472 = v$2150[0];
var v$2473 = v$2150[1];
var v$2475 = v$2147[0];
var v$2476 = v$2147[1];
t$2698 = [tools$0IntStringFinMap$1.add$237(v$2472[2][0][1],[v$2472,f$1613(v$2473)],v$2475),v$2476?v$2472[2][0][2]:false];
var t$2699 = t$2698;
var t$2700 = v$2151;
var v$2147 = t$2699;
var v$2148 = t$2700;
continue lab$foldl;
};
};
};
var foldl$2146 = fix$2697.$foldl;
v$1629 = (foldl$2146(b$2144,v$1621));
var v$1630 = v$1629[0];
return v$1629[1]?[[0,v$1630]]:[[1,[v$1630,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
special_objects$0TyName$1$2.ComposeMap$1648 = function(f$1651,m$1654){var v$1659;
if (m$1654 == null) {v$1659 = null;
} else {var t$2702 = tools$0IntStringFinMap$1.range$284;
var t$2701;
if (m$1654 == null) {m$1654;
} else {var v$2478 = m$1654;
switch (v$2478[0][0]) { case 0: {m$1654;
 break; }default: {var v$2479 = v$2478[0][1];
var v$2480 = v$2479[0];
var v$2481 = v$2479[1];
if (v$2481 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2482 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2480);
var v$2483 = v$2482[1];
var v$2484 = v$2482[0];
if (v$2483) {(v$2478[0] = [0,v$2484],0);
m$1654;
} else {(v$2478[0] = [1,[v$2484,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1654;
};
} else {m$1654;
};
} };
};
if (m$1654 == null) {t$2701 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2158 = m$1654;
switch (v$2158[0][0]) { case 0: {t$2701 = v$2158[0][1];
 break; }default: {t$2701 = v$2158[0][1][0];
} };
};
v$1659 = (t$2702(t$2701));
};
if (v$1659 == null) {return null;
} else {var v$1667;
var b$2161 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$2703 = {};
fix$2703.$foldl = function(v$2164,v$2165){lab$foldl: while (true) {if (v$2165 == null) {return v$2164;
} else {var v$2166 = v$2165;
var v$2167 = v$2166[0];
var v$2168 = v$2166[1];
var t$2704;
var v$2487 = v$2167[0];
var v$2488 = v$2167[1];
var v$2490 = v$2164[0];
var v$2491 = v$2164[1];
t$2704 = [tools$0IntStringFinMap$1.add$237(v$2487[2][0][1],[v$2487,f$1651([v$2487,v$2488])],v$2490),v$2491?v$2487[2][0][2]:false];
var t$2705 = t$2704;
var t$2706 = v$2168;
var v$2164 = t$2705;
var v$2165 = t$2706;
continue lab$foldl;
};
};
};
var foldl$2163 = fix$2703.$foldl;
v$1667 = (foldl$2163(b$2161,v$1659));
var v$1668 = v$1667[0];
return v$1667[1]?[[0,v$1668]]:[[1,[v$1668,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
special_objects$0TyName$1$2.fold$1686 = function(f$1689,b$1692,m$1695){var c$2175;
if (m$1695 == null) {c$2175 = null;
} else {var t$2711 = basis$0List$1.map$697;
var t$2710 = function(v$2183){return v$2183[1];
};
var t$2709;
var t$2708 = tools$0IntStringFinMap$1.range$284;
var t$2707;
if (m$1695 == null) {m$1695;
} else {var v$2493 = m$1695;
switch (v$2493[0][0]) { case 0: {m$1695;
 break; }default: {var v$2494 = v$2493[0][1];
var v$2495 = v$2494[0];
var v$2496 = v$2494[1];
if (v$2496 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2497 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2495);
var v$2498 = v$2497[1];
var v$2499 = v$2497[0];
if (v$2498) {(v$2493[0] = [0,v$2499],0);
m$1695;
} else {(v$2493[0] = [1,[v$2499,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1695;
};
} else {m$1695;
};
} };
};
if (m$1695 == null) {t$2707 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2185 = m$1695;
switch (v$2185[0][0]) { case 0: {t$2707 = v$2185[0][1];
 break; }default: {t$2707 = v$2185[0][1][0];
} };
};
t$2709 = (t$2708(t$2707));
c$2175 = (t$2711(t$2710,t$2709));
};
var fix$2712 = {};
fix$2712.$foldl = function(v$2177,v$2178){lab$foldl: while (true) {if (v$2178 == null) {return v$2177;
} else {var v$2179 = v$2178;
var v$2180 = v$2179[0];
var v$2181 = v$2179[1];
var t$2713 = f$1689([v$2180,v$2177]);
var t$2714 = v$2181;
var v$2177 = t$2713;
var v$2178 = t$2714;
continue lab$foldl;
};
};
};
var foldl$2176 = fix$2712.$foldl;
return foldl$2176(b$1692,c$2175);
};
special_objects$0TyName$1$2.Fold$1696 = function(f$1699,b$1702,m$1705){var c$2189;
if (m$1705 == null) {c$2189 = null;
} else {var t$2716 = tools$0IntStringFinMap$1.range$284;
var t$2715;
if (m$1705 == null) {m$1705;
} else {var v$2501 = m$1705;
switch (v$2501[0][0]) { case 0: {m$1705;
 break; }default: {var v$2502 = v$2501[0][1];
var v$2503 = v$2502[0];
var v$2504 = v$2502[1];
if (v$2504 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2505 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2503);
var v$2506 = v$2505[1];
var v$2507 = v$2505[0];
if (v$2506) {(v$2501[0] = [0,v$2507],0);
m$1705;
} else {(v$2501[0] = [1,[v$2507,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1705;
};
} else {m$1705;
};
} };
};
if (m$1705 == null) {t$2715 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2198 = m$1705;
switch (v$2198[0][0]) { case 0: {t$2715 = v$2198[0][1];
 break; }default: {t$2715 = v$2198[0][1][0];
} };
};
c$2189 = (t$2716(t$2715));
};
var fix$2717 = {};
fix$2717.$foldl = function(v$2191,v$2192){lab$foldl: while (true) {if (v$2192 == null) {return v$2191;
} else {var v$2193 = v$2192;
var v$2194 = v$2193[0];
var v$2195 = v$2193[1];
var t$2718 = f$1699([v$2194,v$2191]);
var t$2719 = v$2195;
var v$2191 = t$2718;
var v$2192 = t$2719;
continue lab$foldl;
};
};
};
var foldl$2190 = fix$2717.$foldl;
return foldl$2190(b$1702,c$2189);
};
special_objects$0TyName$1$2.filter$1706 = function(f$1709,m$1712){var l$1713;
if (m$1712 == null) {l$1713 = null;
} else {var t$2721 = tools$0IntStringFinMap$1.range$284;
var t$2720;
if (m$1712 == null) {m$1712;
} else {var v$2509 = m$1712;
switch (v$2509[0][0]) { case 0: {m$1712;
 break; }default: {var v$2510 = v$2509[0][1];
var v$2511 = v$2510[0];
var v$2512 = v$2510[1];
if (v$2512 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2513 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2511);
var v$2514 = v$2513[1];
var v$2515 = v$2513[0];
if (v$2514) {(v$2509[0] = [0,v$2515],0);
m$1712;
} else {(v$2509[0] = [1,[v$2515,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1712;
};
} else {m$1712;
};
} };
};
if (m$1712 == null) {t$2720 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2202 = m$1712;
switch (v$2202[0][0]) { case 0: {t$2720 = v$2202[0][1];
 break; }default: {t$2720 = v$2202[0][1][0];
} };
};
l$1713 = (t$2721(t$2720));
};
var l$$1714 = basis$0List$1.filter$417(f$1709,l$1713);
return special_objects$0TyName$1$2.fromList$1575(l$$1714);
};
special_objects$0TyName$1$2.addList$1715 = function(l$1718,m1$1721){var m2$1722 = special_objects$0TyName$1$2.fromList$1575(l$1718);
return special_objects$0TyName$1$2.plus$1461(m1$1721,m2$1722);
};
special_objects$0TyName$1$2.mergeMap$1723 = function(f$1726,m1$1729,m2$1732){if (m1$1729 == null) {m1$1729;
} else {var v$2517 = m1$1729;
switch (v$2517[0][0]) { case 0: {m1$1729;
 break; }default: {var v$2518 = v$2517[0][1];
var v$2519 = v$2518[0];
var v$2520 = v$2518[1];
if (v$2520 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2521 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2519);
var v$2522 = v$2521[1];
var v$2523 = v$2521[0];
if (v$2522) {(v$2517[0] = [0,v$2523],0);
m1$1729;
} else {(v$2517[0] = [1,[v$2523,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$1729;
};
} else {m1$1729;
};
} };
};
if (m2$1732 == null) {m2$1732;
} else {var v$2525 = m2$1732;
switch (v$2525[0][0]) { case 0: {m2$1732;
 break; }default: {var v$2526 = v$2525[0][1];
var v$2527 = v$2526[0];
var v$2528 = v$2526[1];
if (v$2528 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2529 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2527);
var v$2530 = v$2529[1];
var v$2531 = v$2529[0];
if (v$2530) {(v$2525[0] = [0,v$2531],0);
m2$1732;
} else {(v$2525[0] = [1,[v$2531,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$1732;
};
} else {m2$1732;
};
} };
};
var rhs3$1761 = function(obj$1778){var t$2730;
var t$2729;
var t$2728;
var t$2727;
var t$2726 = tools$0IntStringFinMap$1.mergeMap$374;
var t$2725 = function(v$2533){var v$2534 = v$2533[0];
var v$2535 = v$2534[0];
var v$2536 = v$2534[1];
var v$2537 = v$2533[1];
var v$2538 = v$2537[0];
var v$2539 = v$2537[1];
var t$2724;
var v$2540 = v$2535[2][0][1];
var v$2541 = v$2538[2][0][1];
t$2724 = ((v$2540[0] == v$2541[0])?(v$2540[1] == v$2541[1]):false);
if (t$2724) {return [v$2535,f$1726([v$2536,v$2539])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
};
var t$2723;
if (m1$1729 == null) {t$2723 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2214 = m1$1729;
switch (v$2214[0][0]) { case 0: {t$2723 = v$2214[0][1];
 break; }default: {t$2723 = v$2214[0][1][0];
} };
};
var t$2722;
if (m2$1732 == null) {t$2722 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2218 = m2$1732;
switch (v$2218[0][0]) { case 0: {t$2722 = v$2218[0][1];
 break; }default: {t$2722 = v$2218[0][1][0];
} };
};
t$2727 = (t$2726(t$2725,t$2723,t$2722));
t$2728 = [t$2727,special_objects$0Name$1.current_matchcount$69(0)];
t$2729 = [1,t$2728];
t$2730 = [t$2729];
return t$2730;
};
if (m1$1729 == null) {return m2$1732;
} else {if (m2$1732 == null) {return m1$1729;
} else {var v$1770 = m1$1729;
switch (v$1770[0][0]) { case 0: {var v$1772 = m2$1732;
switch (v$1772[0][0]) { case 0: {var v$1774 = v$1770[0][1];
var v$1775 = v$1772[0][1];
return [[0,tools$0IntStringFinMap$1.mergeMap$374(function(v$2543){var v$2544 = v$2543[0];
var v$2545 = v$2544[0];
var v$2546 = v$2544[1];
var v$2547 = v$2543[1];
var v$2548 = v$2547[0];
var v$2549 = v$2547[1];
var t$2731;
var v$2550 = v$2545[2][0][1];
var v$2551 = v$2548[2][0][1];
t$2731 = ((v$2550[0] == v$2551[0])?(v$2550[1] == v$2551[1]):false);
if (t$2731) {return [v$2545,f$1726([v$2546,v$2549])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
},v$1774,v$1775)]];
 break; }default: {return rhs3$1761(0);
} };
 break; }default: {return rhs3$1761(0);
} };
};
};
};
var fix$2732 = {};
fix$2732.$pp_lookup = function(v$1782,v$1785,v$1788){lab$pp_lookup: while (true) {if (v$1785 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$1807 = v$1785;
var v$1808 = v$1807[0];
var v$1809 = v$1807[1];
var t$2733;
var v$2363 = v$1808[2][0][1];
t$2733 = ((v$1788[0] == v$2363[0])?(v$1788[1] == v$2363[1]):false);
if (t$2733) {return v$1782(v$1808);
} else {var t$2734 = v$1782;
var t$2735 = v$1809;
var t$2736 = v$1788;
var v$1782 = t$2734;
var v$1785 = t$2735;
var v$1788 = t$2736;
continue lab$pp_lookup;
};
};
};
};
special_objects$0TyName$1$2.pp_lookup$1779 = fix$2732.$pp_lookup;
special_objects$0TyName$1$2.en$Restrict$1811 = new String("Restrict");
special_objects$0TyName$1$2.restrict$1812 = function(v$2630,v$2631,v$1825){if (v$1825 == null) {return null;
} else {if (v$2631 == null) {v$2631;
} else {var v$2555 = v$2631;
switch (v$2555[0][0]) { case 0: {v$2631;
 break; }default: {var v$2556 = v$2555[0][1];
var v$2557 = v$2556[0];
var v$2558 = v$2556[1];
if (v$2558 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2559 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2557);
var v$2560 = v$2559[1];
var v$2561 = v$2559[0];
if (v$2560) {(v$2555[0] = [0,v$2561],0);
v$2631;
} else {(v$2555[0] = [1,[v$2561,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$2631;
};
} else {v$2631;
};
} };
};
if (v$2631 == null) {throw [special_objects$0TyName$1$2.en$Restrict$1811,"[empty map]"];
} else {var im$1833;
if (v$2631 == null) {im$1833 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2230 = v$2631;
switch (v$2230[0][0]) { case 0: {im$1833 = v$2230[0][1];
 break; }default: {im$1833 = v$2230[0][1][0];
} };
};
var ns$1834 = basis$0List$1.map$697(function(d$2233){return d$2233[2][0][1];
},v$1825);
var im$$1836;
try {var t$2743 = tools$0IntStringFinMap$1.restrict$391;
var t$2742;
var fix$2738 = {};
fix$2738.$pp_lookup = function(v$2645,v$2646){lab$pp_lookup: while (true) {if (v$2645 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$2647 = v$2645;
var v$2648 = v$2647[0];
var v$2649 = v$2647[1];
var t$2739;
var v$2650 = v$2648[2][0][1];
t$2739 = ((v$2646[0] == v$2650[0])?(v$2646[1] == v$2650[1]):false);
if (t$2739) {return v$2630(v$2648);
} else {var t$2740 = v$2649;
var t$2741 = v$2646;
var v$2645 = t$2740;
var v$2646 = t$2741;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$2644 = fix$2738.$pp_lookup;
t$2742 = (function(v$2651){return pp_lookup$2644(v$1825,v$2651);
});
im$$1836 = (t$2743(t$2742,im$1833,ns$1834));
} catch(v$2737) {im$$1836 = ((function(v$1840){var t$2744 = v$1840;
if (t$2744[0] == tools$0IntStringFinMap$1.en$Restrict$390) {var s$1837 = v$1840[1];
throw [special_objects$0TyName$1$2.en$Restrict$1811,s$1837];
} else {throw v$1840;
};
})(v$2737));
};
return (tools$0IntStringFinMap$1.fold$62(function(v$1845){var v$1850 = v$1845[0];
var v$1851 = v$1850[0];
return v$1845[1]?v$1851[2][0][2]:false;
},true,im$$1836))?[[0,im$$1836]]:[[1,[im$$1836,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
};
special_objects$0TyName$1$2.enrich$1859 = function(f$1862,v$1866){var v$1890 = v$1866[0];
var v$1891 = v$1866[1];
if (v$1890 == null) {v$1890;
} else {var v$2563 = v$1890;
switch (v$2563[0][0]) { case 0: {v$1890;
 break; }default: {var v$2564 = v$2563[0][1];
var v$2565 = v$2564[0];
var v$2566 = v$2564[1];
if (v$2566 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2567 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2565);
var v$2568 = v$2567[1];
var v$2569 = v$2567[0];
if (v$2568) {(v$2563[0] = [0,v$2569],0);
v$1890;
} else {(v$2563[0] = [1,[v$2569,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1890;
};
} else {v$1890;
};
} };
};
if (v$1891 == null) {v$1891;
} else {var v$2571 = v$1891;
switch (v$2571[0][0]) { case 0: {v$1891;
 break; }default: {var v$2572 = v$2571[0][1];
var v$2573 = v$2572[0];
var v$2574 = v$2572[1];
if (v$2574 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2575 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2573);
var v$2576 = v$2575[1];
var v$2577 = v$2575[0];
if (v$2576) {(v$2571[0] = [0,v$2577],0);
v$1891;
} else {(v$2571[0] = [1,[v$2577,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1891;
};
} else {v$1891;
};
} };
};
if (v$1891 == null) {return true;
} else {if (v$1890 == null) {return false;
} else {var im1$1879;
if (v$1890 == null) {im1$1879 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2238 = v$1890;
switch (v$2238[0][0]) { case 0: {im1$1879 = v$2238[0][1];
 break; }default: {im1$1879 = v$2238[0][1][0];
} };
};
var im2$1880;
if (v$1891 == null) {im2$1880 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2242 = v$1891;
switch (v$2242[0][0]) { case 0: {im2$1880 = v$2242[0][1];
 break; }default: {im2$1880 = v$2242[0][1][0];
} };
};
return tools$0IntStringFinMap$1.enrich$414(function(v$2245){var v$2246 = v$2245[0];
var v$2247 = v$2246[1];
var v$2248 = v$2245[1];
var v$2249 = v$2248[1];
return f$1862([v$2247,v$2249]);
},[im1$1879,im2$1880]);
};
};
};
special_objects$0TyName$1$2.layoutMap$1892 = function(v$1926,v$1928,v$1927,v$1925){return function(pp_dom$1901){return function(pp_range$1904){return function(m$1907){var t$2745;
var v$1923 = [0,v$1927];
var t$2752;
var t$2751 = basis$0List$1.map$697;
var t$2750 = function(v$2250){var v$2251 = v$2250[0];
var v$2252 = v$2250[1];
var t$2749;
var v$2253 = [0,v$1926];
t$2749 = [[pp_dom$1901(v$2251),[pp_range$1904(v$2252),null]],v$2253,"",1,""];
return [0,t$2749];
};
var t$2748;
if (m$1907 == null) {t$2748 = null;
} else {var t$2747 = tools$0IntStringFinMap$1.range$284;
var t$2746;
if (m$1907 == null) {m$1907;
} else {var v$2579 = m$1907;
switch (v$2579[0][0]) { case 0: {m$1907;
 break; }default: {var v$2580 = v$2579[0][1];
var v$2581 = v$2580[0];
var v$2582 = v$2580[1];
if (v$2582 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2583 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2581);
var v$2584 = v$2583[1];
var v$2585 = v$2583[0];
if (v$2584) {(v$2579[0] = [0,v$2585],0);
m$1907;
} else {(v$2579[0] = [1,[v$2585,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1907;
};
} else {m$1907;
};
} };
};
if (m$1907 == null) {t$2746 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2256 = m$1907;
switch (v$2256[0][0]) { case 0: {t$2746 = v$2256[0][1];
 break; }default: {t$2746 = v$2256[0][1][0];
} };
};
t$2748 = (t$2747(t$2746));
};
t$2752 = (t$2751(t$2750,t$2748));
t$2745 = [t$2752,v$1923,v$1928,1,v$1925];
return [0,t$2745];
};
};
};
};
special_objects$0TyName$1$2.reportMap$1929 = function(f$1932,m$1935){var t$2759 = tools$0Report$1.flatten$87;
var t$2758;
var t$2757 = basis$0List$1.map$697;
var t$2756 = f$1932;
var t$2755;
if (m$1935 == null) {t$2755 = null;
} else {var t$2754 = tools$0IntStringFinMap$1.range$284;
var t$2753;
if (m$1935 == null) {m$1935;
} else {var v$2587 = m$1935;
switch (v$2587[0][0]) { case 0: {m$1935;
 break; }default: {var v$2588 = v$2587[0][1];
var v$2589 = v$2588[0];
var v$2590 = v$2588[1];
if (v$2590 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$2591 = special_objects$0TyName$1$2.ensure_consistent_imap$1317(v$2589);
var v$2592 = v$2591[1];
var v$2593 = v$2591[0];
if (v$2592) {(v$2587[0] = [0,v$2593],0);
m$1935;
} else {(v$2587[0] = [1,[v$2593,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1935;
};
} else {m$1935;
};
} };
};
if (m$1935 == null) {t$2753 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2260 = m$1935;
switch (v$2260[0][0]) { case 0: {t$2753 = v$2260[0][1];
 break; }default: {t$2753 = v$2260[0][1][0];
} };
};
t$2755 = (t$2754(t$2753));
};
t$2758 = (t$2757(t$2756,t$2755));
return t$2759(t$2758);
};
special_objects$0TyName$1$2.pu_map0$1936 = function(pu_d$1939,pu_a$1942){var pu_m$1951 = pickle$0pickle$1.combHash$2090(function(m$2262){return tools$0IntStringFinMap$1.fold$62(function(v$2263){return SmlPrims.chk_ovf_i32(v$2263[1] + 1);
},0,m$2262);
},tools$0IntStringFinMap$1.pu$488(pickle$0pickle$1.shareGen$878(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.int$729,pickle$0pickle$1.string$909)),pickle$0pickle$1.shareGen$878(pickle$0pickle$1.pairGen0$983(pu_d$1939,pu_a$1942))));
return pickle$0pickle$1.dataGen$1488(["QuasiMap.map0",function(v$2270){switch (v$2270[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$2271){return pickle$0pickle$1.con1$2014(function(v$2272){return [0,v$2272];
},function(v$2273){switch (v$2273[0]) { case 0: {return v$2273[1];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$1951);
},[function(v$2276){return pickle$0pickle$1.con1$2014(function(v$2277){return [1,[v$2277[1],-1]];
},function(v$2278){switch (v$2278[0]) { case 1: {var v$2279 = v$2278[1];
return [v$2279[1],v$2279[0]];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Flexible");
} };
},pickle$0pickle$1.pairGen0$983(special_objects$0Name$1.pu_matchcount$298,pu_m$1951));
},null]]]);
};
special_objects$0TyName$1$2.pu$1993 = function(pu_d$1996,pu_a$1999){var b$2289 = pickle$0pickle$1.optionGen$2134(pickle$0pickle$1.ref0ShGen$1268(special_objects$0TyName$1$2.pu_map0$1936(pu_d$1996,pu_a$1999)));
return pickle$0pickle$1.shareGen$878((pickle$0pickle$1.convert0$2299(function(v$2658){switch (v$2658[0]) { case 0: {var v$2659 = v$2658[1];
return v$2659;
 break; }default: {return null;
} };
},function(v$2660){if (v$2660 == null) {return [1];
} else {var v$2661 = v$2660;
var t$2762;
var t$2761 = tools$0IntStringFinMap$1.isEmpty$128(0);
var t$2760;
if (v$2660 == null) {t$2760 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$2662 = v$2660;
switch (v$2662[0][0]) { case 0: {t$2760 = v$2662[0][1];
 break; }default: {t$2760 = v$2662[0][1][0];
} };
};
t$2762 = (t$2761(t$2760));
if (t$2762) {return tools$0Crash$1.impossible$59("QuasiMap2.pu.hmmm");
} else {return [0,v$2661];
};
};
}))(b$2289));
};
return 0;
})();
