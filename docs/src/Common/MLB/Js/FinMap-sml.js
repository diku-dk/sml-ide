if ((typeof(tools$0FinMap$1)) == "undefined") {tools$0FinMap$1 = {};
};
(function(){tools$0FinMap$1.eq_map$653 = function(v$657,v$658,v$654){var v$655 = v$654[0];
var v$656 = v$654[1];
switch (v$656[0]) { case 0: {var v$659 = v$655[1];
var v$660 = v$656[1];
var t$1016;
var fix$1012 = {};
fix$1012.$eq_list = function(v$699,v$700){lab$eq_list: while (true) {if (v$699 == null) {return (v$700 == null)?true:false;
} else {if (v$700 == null) {return false;
} else {var v$701 = v$699;
var v$702 = v$700;
var t$1013;
var v$933 = v$701[0];
var v$934 = v$702[0];
t$1013 = ((v$657([v$933[0],v$934[0]]))?(v$658([v$933[1],v$934[1]])):false);
if (t$1013) {var t$1014 = v$701[1];
var t$1015 = v$702[1];
var v$699 = t$1014;
var v$700 = t$1015;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$697 = fix$1012.$eq_list;
t$1016 = (eq_list$697(v$659[0],v$660[0]));
return t$1016?(v$659[1] == v$660[1]):false;
 break; }default: {return false;
} };
};
var reftrue$60 = [true];
tools$0FinMap$1.empty$61 = function(v$664){return [0,[null,reftrue$60]];
};
tools$0FinMap$1.singleton$62 = function(v$665,p$65){return [0,[[p$65,null],reftrue$60]];
};
tools$0FinMap$1.isEmpty$66 = function(v$666,v$69){var v$74 = v$69[1];
return (v$74[0] == null)?true:false;
};
tools$0FinMap$1.lookup$76 = function(v$667,v$79,x$82){var v$108 = v$79[1];
var v$109 = v$108[0];
var fix$1017 = {};
fix$1017.$look = function(v$90){lab$look: while (true) {if (v$90 == null) {return [1];
} else {var v$102 = v$90;
var v$103 = v$102[0];
var v$104 = v$103[0];
var v$105 = v$103[1];
var v$106 = v$102[1];
if (v$667([x$82,v$104])) {return [0,v$105];
} else {var t$1018 = v$106;
var v$90 = t$1018;
continue lab$look;
};
};
};
};
var look$87 = fix$1017.$look;
return look$87(v$109);
};
tools$0FinMap$1.add$141 = function(v$669,v$144){return [0,[[[v$144[0],v$144[1]],v$144[2][1][0]],[false]]];
};
tools$0FinMap$1.plus$155 = function(v$670,v$158){var v$163 = v$158[0];
var v$164 = v$163[1];
var v$165 = v$164[0];
var v$166 = v$158[1];
var v$167 = v$166[1];
var v$168 = v$167[0];
return [0,[basis$0List$1.s$n$686(v$168,v$165),[false]]];
};
tools$0FinMap$1.remove$169 = function(v$671,v$172){var v$235 = v$172[0];
var v$236 = v$172[1];
var v$237 = v$236[1];
var v$238 = v$237[0];
var v$239 = v$237[1];
var is_unique$178 = v$239[0];
var fix$1019 = {};
fix$1019.$revappend = function(v$191,v$997){lab$revappend: while (true) {if (v$191 == null) {return v$997;
} else {var v$193 = v$191;
var v$194 = v$193[0];
var v$195 = v$193[1];
var t$1020 = v$195;
var t$1021 = [v$194,v$997];
var v$191 = t$1020;
var v$997 = t$1021;
continue lab$revappend;
};
};
};
var revappend$179 = fix$1019.$revappend;
var fix$1022 = {};
fix$1022.$rmv = function(v$213,v$998,v$999){lab$rmv: while (true) {if (v$213 == null) {return v$998?[0,[0,[basis$0List$1.rev$682(v$999),[false]]]]:[1];
} else {var v$228 = v$213;
var v$229 = v$228[0];
var v$230 = v$229[0];
var v$232 = v$228[1];
if (v$671([v$235,v$230])) {if (is_unique$178) {return [0,[0,[revappend$179(v$999,v$232),reftrue$60]]];
} else {var t$1023 = v$232;
var t$1024 = true;
var t$1025 = v$999;
var v$213 = t$1023;
var v$998 = t$1024;
var v$999 = t$1025;
continue lab$rmv;
};
} else {var t$1026 = v$232;
var t$1027 = v$998;
var t$1028 = [v$229,v$999];
var v$213 = t$1026;
var v$998 = t$1027;
var v$999 = t$1028;
continue lab$rmv;
};
};
};
};
var rmv$197 = fix$1022.$rmv;
return rmv$197(v$238,false,null);
};
tools$0FinMap$1.mergeMap$240 = function(v$672,v$243,v$246,v$249){var v$266 = v$246[1];
var v$267 = v$266[0];
if (v$267 == null) {return v$249;
} else {var v$271 = v$249[1];
var v$272 = v$271[0];
if (v$272 == null) {return v$246;
} else {var v$321 = v$266[1];
var v$322 = v$271[1];
var t$1035;
var t$1034;
var fix$1029 = {};
fix$1029.$foldl = function(v$722,v$723){lab$foldl: while (true) {if (v$723 == null) {return v$722;
} else {var v$724 = v$723;
var v$725 = v$724[0];
var v$726 = v$724[1];
var t$1030;
var v$963 = v$725[0];
var v$964 = v$725[1];
var fix$1031 = {};
fix$1031.$insert = function(v$1000,v$1001,v$968){if (v$968 == null) {return [[v$1000,v$1001],null];
} else {var v$971 = v$968;
var v$972 = v$971[0];
var v$973 = v$972[0];
var v$974 = v$972[1];
var v$975 = v$971[1];
return (v$672([v$973,v$1000]))?[[v$973,v$243([v$974,v$1001])],v$975]:[[v$973,v$974],fix$1031.$insert(v$1000,v$1001,v$975)];
};
};
var insert$966 = fix$1031.$insert;
t$1030 = (insert$966(v$963,v$964,v$722));
var t$1032 = t$1030;
var t$1033 = v$726;
var v$722 = t$1032;
var v$723 = t$1033;
continue lab$foldl;
};
};
};
var foldl$721 = fix$1029.$foldl;
t$1034 = (foldl$721(v$267,v$272));
t$1035 = [t$1034,(v$321[0]?v$322[0]:false)?reftrue$60:[false]];
return [0,t$1035];
};
};
};
var elimDups$380 = function(v$677,v$383){var v$400 = v$383[1];
var v$401 = v$400[0];
var v$402 = v$400[1];
if (v$402[0]) {return v$401;
} else {var v$397;
var duplicates$829 = [false];
var t$1045;
var fix$1036 = {};
fix$1036.$elim = function(v$832,v$1002){lab$elim: while (true) {if (v$832 == null) {return basis$0List$1.rev$682(v$1002);
} else {var v$833 = v$832;
var v$834 = v$833[0];
var v$835 = v$834[0];
var v$836 = v$833[1];
var t$1040;
var fix$1037 = {};
fix$1037.$seen = function(v$1003,v$840){lab$seen: while (true) {if (v$840 == null) {return false;
} else {var v$842 = v$840;
var v$843 = v$842[0];
var v$844 = v$843[0];
var v$845 = v$842[1];
if (v$677([v$1003,v$844])) {return true;
} else {var t$1038 = v$1003;
var t$1039 = v$845;
var v$1003 = t$1038;
var v$840 = t$1039;
continue lab$seen;
};
};
};
};
var seen$838 = fix$1037.$seen;
t$1040 = (seen$838(v$835,v$1002));
if (t$1040) {(duplicates$829[0] = true,0);
var t$1041 = v$836;
var t$1042 = v$1002;
var v$832 = t$1041;
var v$1002 = t$1042;
continue lab$elim;
} else {var t$1043 = v$836;
var t$1044 = [v$834,v$1002];
var v$832 = t$1043;
var v$1002 = t$1044;
continue lab$elim;
};
};
};
};
var elim$830 = fix$1036.$elim;
t$1045 = (elim$830(v$401,null));
v$397 = [t$1045,duplicates$829[0]];
var v$398 = v$397[0];
var v$399 = v$397[1];
(v$402[0] = (v$399?false:true),0);
return v$398;
};
};
tools$0FinMap$1.dom$403 = function(v$678,v$406){var v$420 = v$406[1];
var v$421 = v$420[0];
var v$422 = v$420[1];
var d$411 = basis$0List$1.map$697(function(v$414){return v$414[0];
},v$421);
if (v$422[0]) {return edlib$0EqSet$1.fromList$115(v$678,d$411);
} else {return edlib$0EqSet$1.fromList$115(v$678,d$411);
};
};
tools$0FinMap$1.range$423 = function(v$679,m$426){var elts$$427 = elimDups$380(v$679,m$426);
return basis$0List$1.map$697(function(v$430){return v$430[1];
},elts$$427);
};
tools$0FinMap$1.list$432 = function(v$680,m$435){return elimDups$380(v$680,m$435);
};
tools$0FinMap$1.composemap$436 = function(v$681,f$439,m$442){return [0,[basis$0List$1.map$697(function(v$446){var v$447 = v$446[0];
var v$448 = v$446[1];
return [v$447,f$439(v$448)];
},elimDups$380(v$681,m$442)),reftrue$60]];
};
tools$0FinMap$1.ComposeMap$449 = function(v$682,f$452,m$455){return [0,[basis$0List$1.map$697(function(v$459){var v$460 = v$459[0];
var v$461 = v$459[1];
return [v$460,f$452([v$460,v$461])];
},elimDups$380(v$682,m$455)),reftrue$60]];
};
tools$0FinMap$1.fold$462 = function(v$683,f$465,x$468,m$471){var c$861 = elimDups$380(v$683,m$471);
var fix$1046 = {};
fix$1046.$foldl = function(v$863,v$864){lab$foldl: while (true) {if (v$864 == null) {return v$863;
} else {var v$865 = v$864;
var v$866 = v$865[0];
var v$867 = v$865[1];
var t$1047;
var v$978 = v$866[1];
t$1047 = (f$465([v$978,v$863]));
var t$1048 = t$1047;
var t$1049 = v$867;
var v$863 = t$1048;
var v$864 = t$1049;
continue lab$foldl;
};
};
};
var foldl$862 = fix$1046.$foldl;
return foldl$862(x$468,c$861);
};
tools$0FinMap$1.Fold$481 = function(v$684,f$484,x$487,m$490){var c$872 = elimDups$380(v$684,m$490);
var fix$1050 = {};
fix$1050.$foldl = function(v$874,v$875){lab$foldl: while (true) {if (v$875 == null) {return v$874;
} else {var v$876 = v$875;
var v$877 = v$876[0];
var v$878 = v$876[1];
var t$1051;
var v$982 = v$877[0];
var v$983 = v$877[1];
t$1051 = (f$484([[v$982,v$983],v$874]));
var t$1052 = t$1051;
var t$1053 = v$878;
var v$874 = t$1052;
var v$875 = t$1053;
continue lab$foldl;
};
};
};
var foldl$873 = fix$1050.$foldl;
return foldl$873(x$487,c$872);
};
tools$0FinMap$1.filter$500 = function(v$685,pred$503,m$506){var elts$507 = elimDups$380(v$685,m$506);
return [0,[basis$0List$1.filter$417(pred$503,elts$507),reftrue$60]];
};
tools$0FinMap$1.fromList$532 = function(v$687,l$535){var fix$1054 = {};
fix$1054.$addList = function(v$887,v$889){lab$addList: while (true) {if (v$887 == null) {return v$889;
} else {var v$895 = v$887;
var v$896 = v$895[0];
var v$897 = v$896[0];
var v$898 = v$896[1];
var v$899 = v$895[1];
var t$1055 = v$899;
var t$1056 = [0,[[[v$897,v$898],v$889[1][0]],[false]]];
var v$887 = t$1055;
var v$889 = t$1056;
continue lab$addList;
};
};
};
var addList$886 = fix$1054.$addList;
var v$1011 = [0,[null,reftrue$60]];
return addList$886(l$535,v$1011);
};
tools$0FinMap$1.reportMap$536 = function(v$688,f$539,m$542){return tools$0Report$1.flatten$87(basis$0List$1.map$697(f$539,elimDups$380(v$688,m$542)));
};
tools$0FinMap$1.reportMapSORTED$543 = function(v$689,lt$546,f$549,m$552){return tools$0Report$1.flatten$87(basis$0List$1.map$697(f$549,edlib$0ListSort$1.sort$54(function(v$555){var v$560 = v$555[0];
return function(v$558){var v$559 = v$558[0];
return lt$546([v$560,v$559]);
};
},elimDups$380(v$689,m$552))));
};
tools$0FinMap$1.layoutMap$561 = function(v$690,v$567){var v$594 = v$567[3];
var v$595 = v$567[0];
var v$596 = v$567[2];
var v$597 = v$567[1];
return function(layoutDom$570){return function(layoutRan$573){return function(m$576){var t$1057;
var v$592 = [0,v$596];
t$1057 = [basis$0List$1.map$697(function(v$912){var v$913 = v$912[0];
var v$914 = v$912[1];
var t$1058;
var v$915 = [0,v$595];
t$1058 = [[layoutDom$570(v$913),[layoutRan$573(v$914),null]],v$915,"",0,""];
return [0,t$1058];
},elimDups$380(v$690,m$576)),v$592,v$597,0,v$594];
return [0,t$1057];
};
};
};
};
tools$0FinMap$1.pu$602 = function(v$692,v$606){var v$625 = v$606[0];
var v$626 = v$606[1];
return pickle$0pickle$1.convert$2342([function(v$919){return [0,[v$919[0],v$919[1]]];
},function(x$923){var v$988 = [0,[elimDups$380(v$692,x$923),reftrue$60]];
var v$989 = v$988[1];
return [v$989[0],v$989[1]];
}],pickle$0pickle$1.pairGen$1053([pickle$0pickle$1.listGen$2109(pickle$0pickle$1.pairGen$1053([v$625,v$626])),pickle$0pickle$1.refOneGen$1282(pickle$0pickle$1.bool$732)]));
};
return 0;
})();
