if ((typeof(tools$0Flags$1$4)) == "undefined") {tools$0Flags$1$4 = {};
};
(function(){tools$0Flags$1$4.eq_bal$1640 = function(v$1642,v$1643){switch (v$1642) { case 0: {switch (v$1643) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1643) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1643) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
var fix$2325 = {};
fix$2325.$eq_tree = function(v$1648,v$1649,v$1645){lab$eq_tree: while (true) {var v$1646 = v$1645[0];
var v$1647 = v$1645[1];
if (v$1646 == null) {return (v$1647 == null)?true:false;
} else {if (v$1647 == null) {return false;
} else {var v$1650 = v$1646;
var v$1651 = v$1647;
if (v$1648([v$1650[0],v$1651[0]])) {if (v$1649([v$1650[1],v$1651[1]])) {if (fix$2325.$eq_tree(v$1648,v$1649,[v$1650[2],v$1651[2]])) {var t$2326 = v$1648;
var t$2327 = v$1649;
var t$2328 = [v$1650[3],v$1651[3]];
var v$1648 = t$2326;
var v$1649 = t$2327;
var v$1645 = t$2328;
continue lab$eq_tree;
} else {return false;
};
} else {return false;
};
} else {return false;
};
};
};
};
};
tools$0Flags$1$4.eq_tree$1644 = fix$2325.$eq_tree;
tools$0Flags$1$4.die$371 = function(s$374){return tools$0Crash$1.impossible$59("OrderFinMap." + s$374);
};
tools$0Flags$1$4.s$j$375 = function(v$2312,v$2313){return v$2312 < v$2313;
};
tools$0Flags$1$4.lt$382 = function(v$2314,v$2315){return v$2314 < v$2315;
};
tools$0Flags$1$4.eq$383 = function(v$392,v$393){return ((v$392 < v$393)?true:(v$393 < v$392))?false:true;
};
tools$0Flags$1$4.empty$399 = function(v$2324){return null;
};
tools$0Flags$1$4.singleton$400 = function(v$2316,v$2317){return [v$2316,v$2317,null,null,2];
};
tools$0Flags$1$4.isEmpty$407 = function(v$410){return (v$410 == null)?true:false;
};
tools$0Flags$1$4.lookup$415 = function(t$418,key$421){var fix$2329 = {};
fix$2329.$search = function(v$425){lab$search: while (true) {if (v$425 == null) {return [1];
} else {var v$442 = v$425;
var v$443 = v$442[0];
var v$444 = v$442[1];
var v$445 = v$442[2];
var v$446 = v$442[3];
if (key$421 < v$443) {var t$2330 = v$445;
var v$425 = t$2330;
continue lab$search;
} else {if (v$443 < key$421) {var t$2331 = v$446;
var v$425 = t$2331;
continue lab$search;
} else {return [0,v$444];
};
};
};
};
};
var search$422 = fix$2329.$search;
return search$422(t$418);
};
tools$0Flags$1$4.en$Impossible$447 = new String("Impossible");
tools$0Flags$1$4.impossible$448 = function(s$451){throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMap" + s$451];
};
var en$ALREADYTHERE$452 = new String("ALREADYTHERE");
var exn$ALREADYTHERE$452 = [en$ALREADYTHERE$452];
tools$0Flags$1$4.add$675 = function(v$684,v$685,v$686){try {var fix$2333 = {};
fix$2333.$ins = function(v$1761){if (v$1761 == null) {return [true,[v$684,v$685,null,null,2]];
} else {var v$1762 = v$1761;
var v$1763 = v$1762[0];
var v$1764 = v$1762[1];
var v$1765 = v$1762[2];
var v$1766 = v$1762[3];
var v$1767 = v$1762[4];
if (v$684 < v$1763) {var v$1769 = fix$2333.$ins(v$1765);
var v$1770 = v$1769[0];
var v$1771 = v$1769[1];
switch (v$1767) { case 2: {return v$1770?[true,[v$1763,v$1764,v$1771,v$1766,1]]:[false,[v$1763,v$1764,v$1771,v$1766,2]];
 break; }case 0: {return v$1770?[false,[v$1763,v$1764,v$1771,v$1766,2]]:[false,[v$1763,v$1764,v$1771,v$1766,0]];
 break; }default: {if (v$1770) {var v$1773;
if (v$1771 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLfinmap 1"];
} else {v$1773 = v$1771;
};
var v$1776 = v$1773[0];
var v$1777 = v$1773[1];
var v$1778 = v$1773[2];
var v$1779 = v$1773[3];
var v$1780 = v$1773[4];
var t$2334;
var v$2131 = 1;
switch (v$1780) { case 0: {switch (v$2131) { case 0: {t$2334 = true;
 break; }default: {t$2334 = false;
} };
 break; }case 1: {switch (v$2131) { case 1: {t$2334 = true;
 break; }default: {t$2334 = false;
} };
 break; }case 2: {switch (v$2131) { case 2: {t$2334 = true;
 break; }default: {t$2334 = false;
} };
 break; } };
if (t$2334) {return [false,[v$1776,v$1777,v$1778,[v$1763,v$1764,v$1779,v$1766,2],2]];
} else {var v$1788;
if (v$1779 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLfinmap 2"];
} else {v$1788 = v$1779;
};
var v$1791 = v$1788[0];
var v$1792 = v$1788[1];
var v$1793 = v$1788[2];
var v$1794 = v$1788[3];
var v$1795 = v$1788[4];
var t$2355 = false;
var t$2354;
var t$2353;
var t$2352 = v$1791;
var t$2351 = v$1792;
var t$2350;
var t$2349;
var t$2348 = v$1776;
var t$2347 = v$1777;
var t$2346 = v$1778;
var t$2345 = v$1793;
var t$2344;
var t$2343;
var v$2137 = 0;
switch (v$1795) { case 0: {switch (v$2137) { case 0: {t$2343 = true;
 break; }default: {t$2343 = false;
} };
 break; }case 1: {switch (v$2137) { case 1: {t$2343 = true;
 break; }default: {t$2343 = false;
} };
 break; }case 2: {switch (v$2137) { case 2: {t$2343 = true;
 break; }default: {t$2343 = false;
} };
 break; } };
t$2344 = (t$2343?1:2);
t$2349 = [t$2348,t$2347,t$2346,t$2345,t$2344];
t$2350 = t$2349;
var t$2342;
var t$2341;
var t$2340 = v$1763;
var t$2339 = v$1764;
var t$2338 = v$1794;
var t$2337 = v$1766;
var t$2336;
var t$2335;
var v$2141 = 1;
switch (v$1795) { case 0: {switch (v$2141) { case 0: {t$2335 = true;
 break; }default: {t$2335 = false;
} };
 break; }case 1: {switch (v$2141) { case 1: {t$2335 = true;
 break; }default: {t$2335 = false;
} };
 break; }case 2: {switch (v$2141) { case 2: {t$2335 = true;
 break; }default: {t$2335 = false;
} };
 break; } };
t$2336 = (t$2335?0:2);
t$2341 = [t$2340,t$2339,t$2338,t$2337,t$2336];
t$2342 = t$2341;
t$2353 = [t$2352,t$2351,t$2350,t$2342,2];
t$2354 = t$2353;
return [t$2355,t$2354];
};
} else {return [false,[v$1763,v$1764,v$1771,v$1766,1]];
};
} };
} else {if (v$1763 < v$684) {var v$1811 = fix$2333.$ins(v$1766);
var v$1812 = v$1811[0];
var v$1813 = v$1811[1];
switch (v$1767) { case 2: {return v$1812?[true,[v$1763,v$1764,v$1765,v$1813,0]]:[false,[v$1763,v$1764,v$1765,v$1813,2]];
 break; }case 1: {return v$1812?[false,[v$1763,v$1764,v$1765,v$1813,2]]:[false,[v$1763,v$1764,v$1765,v$1813,1]];
 break; }default: {if (v$1812) {var v$1815;
if (v$1813 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLfinmap 3"];
} else {v$1815 = v$1813;
};
var v$1818 = v$1815[0];
var v$1819 = v$1815[1];
var v$1820 = v$1815[2];
var v$1821 = v$1815[3];
var v$1822 = v$1815[4];
var t$2356;
var v$2151 = 0;
switch (v$1822) { case 0: {switch (v$2151) { case 0: {t$2356 = true;
 break; }default: {t$2356 = false;
} };
 break; }case 1: {switch (v$2151) { case 1: {t$2356 = true;
 break; }default: {t$2356 = false;
} };
 break; }case 2: {switch (v$2151) { case 2: {t$2356 = true;
 break; }default: {t$2356 = false;
} };
 break; } };
if (t$2356) {return [false,[v$1818,v$1819,[v$1763,v$1764,v$1765,v$1820,2],v$1821,2]];
} else {var v$1830;
if (v$1820 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLfinmap 4"];
} else {v$1830 = v$1820;
};
var v$1833 = v$1830[0];
var v$1834 = v$1830[1];
var v$1835 = v$1830[2];
var v$1836 = v$1830[3];
var v$1837 = v$1830[4];
var t$2377 = false;
var t$2376;
var t$2375;
var t$2374 = v$1833;
var t$2373 = v$1834;
var t$2372;
var t$2371;
var t$2370 = v$1763;
var t$2369 = v$1764;
var t$2368 = v$1765;
var t$2367 = v$1835;
var t$2366;
var t$2365;
var v$2157 = 0;
switch (v$1837) { case 0: {switch (v$2157) { case 0: {t$2365 = true;
 break; }default: {t$2365 = false;
} };
 break; }case 1: {switch (v$2157) { case 1: {t$2365 = true;
 break; }default: {t$2365 = false;
} };
 break; }case 2: {switch (v$2157) { case 2: {t$2365 = true;
 break; }default: {t$2365 = false;
} };
 break; } };
t$2366 = (t$2365?1:2);
t$2371 = [t$2370,t$2369,t$2368,t$2367,t$2366];
t$2372 = t$2371;
var t$2364;
var t$2363;
var t$2362 = v$1818;
var t$2361 = v$1819;
var t$2360 = v$1836;
var t$2359 = v$1821;
var t$2358;
var t$2357;
var v$2161 = 1;
switch (v$1837) { case 0: {switch (v$2161) { case 0: {t$2357 = true;
 break; }default: {t$2357 = false;
} };
 break; }case 1: {switch (v$2161) { case 1: {t$2357 = true;
 break; }default: {t$2357 = false;
} };
 break; }case 2: {switch (v$2161) { case 2: {t$2357 = true;
 break; }default: {t$2357 = false;
} };
 break; } };
t$2358 = (t$2357?0:2);
t$2363 = [t$2362,t$2361,t$2360,t$2359,t$2358];
t$2364 = t$2363;
t$2375 = [t$2374,t$2373,t$2372,t$2364,2];
t$2376 = t$2375;
return [t$2377,t$2376];
};
} else {return [false,[v$1763,v$1764,v$1765,v$1813,0]];
};
} };
} else {throw exn$ALREADYTHERE$452;
};
};
};
};
var ins$1760 = fix$2333.$ins;
return (ins$1760(v$686))[1];
} catch(v$2332) {return (function(ALREADYTHERE$683){var t$2378 = ALREADYTHERE$683;
if (t$2378[0] == en$ALREADYTHERE$452) {var fix$2379 = {};
fix$2379.$repl = function(v$1876){if (v$1876 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLupdate.repl"];
} else {var v$1879 = v$1876;
var v$1880 = v$1879[0];
var v$1881 = v$1879[1];
var v$1882 = v$1879[2];
var v$1883 = v$1879[3];
var v$1884 = v$1879[4];
return (v$684 < v$1880)?[v$1880,v$1881,fix$2379.$repl(v$1882),v$1883,v$1884]:((v$1880 < v$684)?[v$1880,v$1881,v$1882,fix$2379.$repl(v$1883),v$1884]:[v$1880,v$685,v$1882,v$1883,v$1884]);
};
};
var repl$1875 = fix$2379.$repl;
return repl$1875(v$686);
} else {throw ALREADYTHERE$683;
};
})(v$2332);
};
};
var fix$2380 = {};
fix$2380.$plus = function(v$705,v$706){lab$plus: while (true) {if (v$706 == null) {return v$705;
} else {var v$700 = v$706;
var v$701 = v$700[0];
var v$702 = v$700[1];
var v$703 = v$700[2];
var v$704 = v$700[3];
var t$2381 = fix$2380.$plus(tools$0Flags$1$4.add$675(v$701,v$702,v$705),v$703);
var t$2382 = v$704;
var v$705 = t$2381;
var v$706 = t$2382;
continue lab$plus;
};
};
};
tools$0Flags$1$4.plus$687 = fix$2380.$plus;
var en$NOTFOUND$707 = new String("NOTFOUND");
var exn$NOTFOUND$707 = [en$NOTFOUND$707];
var delete$708 = function(v$993,v$994){var balance1$713 = function(v$716){if (v$716 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMap(balance1 on an empty map)"];
} else {var v$786 = v$716;
var v$787 = v$786[0];
var v$788 = v$786[1];
var v$789 = v$786[2];
var v$790 = v$786[3];
switch (v$786[4]) { case 1: {return [[v$787,v$788,v$789,v$790,2],true];
 break; }case 2: {return [[v$787,v$788,v$789,v$790,0],false];
 break; }default: {var v$773;
if (v$790 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLfinmap 5"];
} else {v$773 = v$790;
};
var v$774 = v$773[0];
var v$775 = v$773[1];
var v$776 = v$773[2];
var v$777 = v$773[3];
switch (v$773[4]) { case 1: {var v$760;
if (v$776 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLfinmap 6"];
} else {v$760 = v$776;
};
var v$761 = v$760[0];
var v$762 = v$760[1];
var v$763 = v$760[2];
var v$764 = v$760[3];
var v$765 = v$760[4];
var t$2402;
var t$2401;
var t$2400 = v$761;
var t$2399 = v$762;
var t$2398;
var t$2397;
var t$2396 = v$787;
var t$2395 = v$788;
var t$2394 = v$789;
var t$2393 = v$763;
var t$2392;
var t$2391;
var v$2179 = 0;
switch (v$765) { case 0: {switch (v$2179) { case 0: {t$2391 = true;
 break; }default: {t$2391 = false;
} };
 break; }case 1: {switch (v$2179) { case 1: {t$2391 = true;
 break; }default: {t$2391 = false;
} };
 break; }case 2: {switch (v$2179) { case 2: {t$2391 = true;
 break; }default: {t$2391 = false;
} };
 break; } };
t$2392 = (t$2391?1:2);
t$2397 = [t$2396,t$2395,t$2394,t$2393,t$2392];
t$2398 = t$2397;
var t$2390;
var t$2389;
var t$2388 = v$774;
var t$2387 = v$775;
var t$2386 = v$764;
var t$2385 = v$777;
var t$2384;
var t$2383;
var v$2181 = 1;
switch (v$765) { case 0: {switch (v$2181) { case 0: {t$2383 = true;
 break; }default: {t$2383 = false;
} };
 break; }case 1: {switch (v$2181) { case 1: {t$2383 = true;
 break; }default: {t$2383 = false;
} };
 break; }case 2: {switch (v$2181) { case 2: {t$2383 = true;
 break; }default: {t$2383 = false;
} };
 break; } };
t$2384 = (t$2383?0:2);
t$2389 = [t$2388,t$2387,t$2386,t$2385,t$2384];
t$2390 = t$2389;
t$2401 = [t$2400,t$2399,t$2398,t$2390,2];
t$2402 = t$2401;
return [t$2402,true];
 break; }case 2: {return [[v$774,v$775,[v$787,v$788,v$789,v$776,0],v$777,1],false];
 break; }default: {return [[v$774,v$775,[v$787,v$788,v$789,v$776,2],v$777,2],true];
} };
} };
};
};
var balance2$792 = function(v$795){if (v$795 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMap(balance2 on an empty map)"];
} else {var v$865 = v$795;
var v$866 = v$865[0];
var v$867 = v$865[1];
var v$868 = v$865[2];
var v$869 = v$865[3];
switch (v$865[4]) { case 0: {return [[v$866,v$867,v$868,v$869,2],true];
 break; }case 2: {return [[v$866,v$867,v$868,v$869,1],false];
 break; }default: {var v$852;
if (v$868 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLfinmap 7"];
} else {v$852 = v$868;
};
var v$853 = v$852[0];
var v$854 = v$852[1];
var v$855 = v$852[2];
var v$856 = v$852[3];
switch (v$852[4]) { case 0: {var v$839;
if (v$856 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapAVLfinmap 8"];
} else {v$839 = v$856;
};
var v$840 = v$839[0];
var v$841 = v$839[1];
var v$842 = v$839[2];
var v$843 = v$839[3];
var v$844 = v$839[4];
var t$2422;
var t$2421;
var t$2420 = v$840;
var t$2419 = v$841;
var t$2418;
var t$2417;
var t$2416 = v$853;
var t$2415 = v$854;
var t$2414 = v$855;
var t$2413 = v$842;
var t$2412;
var t$2411;
var v$2191 = 0;
switch (v$844) { case 0: {switch (v$2191) { case 0: {t$2411 = true;
 break; }default: {t$2411 = false;
} };
 break; }case 1: {switch (v$2191) { case 1: {t$2411 = true;
 break; }default: {t$2411 = false;
} };
 break; }case 2: {switch (v$2191) { case 2: {t$2411 = true;
 break; }default: {t$2411 = false;
} };
 break; } };
t$2412 = (t$2411?1:2);
t$2417 = [t$2416,t$2415,t$2414,t$2413,t$2412];
t$2418 = t$2417;
var t$2410;
var t$2409;
var t$2408 = v$866;
var t$2407 = v$867;
var t$2406 = v$843;
var t$2405 = v$869;
var t$2404;
var t$2403;
var v$2189 = 1;
switch (v$844) { case 0: {switch (v$2189) { case 0: {t$2403 = true;
 break; }default: {t$2403 = false;
} };
 break; }case 1: {switch (v$2189) { case 1: {t$2403 = true;
 break; }default: {t$2403 = false;
} };
 break; }case 2: {switch (v$2189) { case 2: {t$2403 = true;
 break; }default: {t$2403 = false;
} };
 break; } };
t$2404 = (t$2403?0:2);
t$2409 = [t$2408,t$2407,t$2406,t$2405,t$2404];
t$2410 = t$2409;
t$2421 = [t$2420,t$2419,t$2418,t$2410,2];
t$2422 = t$2421;
return [t$2422,true];
 break; }case 2: {return [[v$853,v$854,v$855,[v$866,v$867,v$856,v$869,1],0],false];
 break; }default: {return [[v$853,v$854,v$855,[v$866,v$867,v$856,v$869,2],2],true];
} };
} };
};
};
var fix$2423 = {};
fix$2423.$remove_rightmost = function(v$874){if (v$874 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMap(remove_rightmost on empty map)"];
} else {var v$890 = v$874;
var v$891 = v$890[3];
if (v$891 == null) {return [v$890[2],v$890[0],v$890[1],true];
} else {var v$916 = v$890[0];
var v$917 = v$890[1];
var v$918 = v$890[2];
var v$919 = v$890[4];
var v$911 = fix$2423.$remove_rightmost(v$891);
var v$912 = v$911[0];
var v$913 = v$911[1];
var v$914 = v$911[2];
if (v$911[3]) {var v$908 = balance2$792([v$916,v$917,v$918,v$912,v$919]);
return [v$908[0],v$913,v$914,v$908[1]];
} else {return [[v$916,v$917,v$918,v$912,v$919],v$913,v$914,false];
};
};
};
};
var remove_rightmost$871 = fix$2423.$remove_rightmost;
var fix$2424 = {};
fix$2424.$del = function(v$923){if (v$923 == null) {throw exn$NOTFOUND$707;
} else {var v$983 = v$923;
var v$984 = v$983[0];
var v$985 = v$983[1];
var v$986 = v$983[2];
var v$987 = v$983[3];
var v$988 = v$983[4];
if (v$993 < v$984) {var v$944 = fix$2424.$del(v$986);
var v$945 = v$944[0];
if (v$944[1]) {return balance1$713([v$984,v$985,v$945,v$987,v$988]);
} else {return [[v$984,v$985,v$945,v$987,v$988],false];
};
} else {if (v$984 < v$993) {var v$958 = fix$2424.$del(v$987);
var v$959 = v$958[0];
if (v$958[1]) {return balance2$792([v$984,v$985,v$986,v$959,v$988]);
} else {return [[v$984,v$985,v$986,v$959,v$988],false];
};
} else {if (v$987 == null) {return [v$986,true];
} else {if (v$986 == null) {return [v$987,true];
} else {var v$978 = remove_rightmost$871(v$986);
var v$979 = v$978[0];
var v$980 = v$978[1];
var v$981 = v$978[2];
if (v$978[3]) {return balance1$713([v$980,v$981,v$979,v$987,v$988]);
} else {return [[v$980,v$981,v$979,v$987,v$988],false];
};
};
};
};
};
};
};
var del$920 = fix$2424.$del;
return (del$920(v$994))[0];
};
tools$0Flags$1$4.remove$995 = function(v$1003,v$1004){try {return [0,delete$708(v$1003,v$1004)];
} catch(v$2425) {return (function(NOTFOUND$1002){var t$2426 = NOTFOUND$1002;
if (t$2426[0] == en$NOTFOUND$707) {return [1];
} else {throw NOTFOUND$1002;
};
})(v$2425);
};
};
tools$0Flags$1$4.delete$1005 = function(v$1013,v$1014){try {return delete$708(v$1013,v$1014);
} catch(v$2427) {return (function(NOTFOUND$1012){var t$2428 = NOTFOUND$1012;
if (t$2428[0] == en$NOTFOUND$707) {return v$1014;
} else {throw NOTFOUND$1012;
};
})(v$2427);
};
};
tools$0Flags$1$4.dom$1015 = function(m$1018){var fix$2429 = {};
fix$2429.$dom$ = function(v$1022,v$1025){lab$dom$: while (true) {if (v$1022 == null) {return v$1025;
} else {var v$1037 = v$1022;
var v$1038 = v$1037[0];
var v$1039 = v$1037[2];
var v$1040 = v$1037[3];
var t$2430 = v$1039;
var t$2431 = [v$1038,fix$2429.$dom$(v$1040,v$1025)];
var v$1022 = t$2430;
var v$1025 = t$2431;
continue lab$dom$;
};
};
};
var dom$$1019 = fix$2429.$dom$;
return dom$$1019(m$1018,null);
};
tools$0Flags$1$4.range$1042 = function(m$1045){var fix$2432 = {};
fix$2432.$ran = function(v$1049,v$1052){lab$ran: while (true) {if (v$1049 == null) {return v$1052;
} else {var v$1064 = v$1049;
var v$1065 = v$1064[1];
var v$1066 = v$1064[2];
var v$1067 = v$1064[3];
var t$2433 = v$1066;
var t$2434 = [v$1065,fix$2432.$ran(v$1067,v$1052)];
var v$1049 = t$2433;
var v$1052 = t$2434;
continue lab$ran;
};
};
};
var ran$1046 = fix$2432.$ran;
return ran$1046(m$1045,null);
};
tools$0Flags$1$4.list$1069 = function(m$1072){var fix$2435 = {};
fix$2435.$li = function(v$1076,v$1079){lab$li: while (true) {if (v$1076 == null) {return v$1079;
} else {var v$1092 = v$1076;
var v$1093 = v$1092[0];
var v$1094 = v$1092[1];
var v$1095 = v$1092[2];
var v$1096 = v$1092[3];
var t$2436 = v$1095;
var t$2437 = [[v$1093,v$1094],fix$2435.$li(v$1096,v$1079)];
var v$1076 = t$2436;
var v$1079 = t$2437;
continue lab$li;
};
};
};
var li$1073 = fix$2435.$li;
return li$1073(m$1072,null);
};
var fix$2438 = {};
fix$2438.$composemap = function(f$1101,t$1104){if (t$1104 == null) {return null;
} else {var v$1115 = t$1104;
var v$1116 = v$1115[0];
var v$1117 = v$1115[1];
var v$1118 = v$1115[2];
var v$1119 = v$1115[3];
var v$1120 = v$1115[4];
var l$$1114 = fix$2438.$composemap(f$1101,v$1118);
return [v$1116,f$1101(v$1117),l$$1114,fix$2438.$composemap(f$1101,v$1119),v$1120];
};
};
tools$0Flags$1$4.composemap$1098 = fix$2438.$composemap;
var fix$2439 = {};
fix$2439.$ComposeMap = function(f$1124,t$1127){if (t$1127 == null) {return null;
} else {var v$1138 = t$1127;
var v$1139 = v$1138[0];
var v$1140 = v$1138[1];
var v$1141 = v$1138[2];
var v$1142 = v$1138[3];
var v$1143 = v$1138[4];
var l$$1137 = fix$2439.$ComposeMap(f$1124,v$1141);
return [v$1139,f$1124([v$1139,v$1140]),l$$1137,fix$2439.$ComposeMap(f$1124,v$1142),v$1143];
};
};
tools$0Flags$1$4.ComposeMap$1121 = fix$2439.$ComposeMap;
tools$0Flags$1$4.fold$1144 = function(f$1147,e$1150,t$1153){var fix$2440 = {};
fix$2440.$fold$ = function(v$1157,v$1160){lab$fold$: while (true) {if (v$1157 == null) {return v$1160;
} else {var v$1172 = v$1157;
var v$1173 = v$1172[1];
var v$1174 = v$1172[2];
var v$1175 = v$1172[3];
var t$2441 = v$1175;
var t$2442 = f$1147([v$1173,fix$2440.$fold$(v$1174,v$1160)]);
var v$1157 = t$2441;
var v$1160 = t$2442;
continue lab$fold$;
};
};
};
var fold$$1154 = fix$2440.$fold$;
return fold$$1154(t$1153,e$1150);
};
tools$0Flags$1$4.Fold$1177 = function(f$1180,e$1183,t$1186){var fix$2443 = {};
fix$2443.$fold$ = function(v$1190,v$1193){lab$fold$: while (true) {if (v$1190 == null) {return v$1193;
} else {var v$1206 = v$1190;
var v$1207 = v$1206[0];
var v$1208 = v$1206[1];
var v$1209 = v$1206[2];
var v$1210 = v$1206[3];
var t$2444 = v$1210;
var t$2445 = f$1180([[v$1207,v$1208],fix$2443.$fold$(v$1209,v$1193)]);
var v$1190 = t$2444;
var v$1193 = t$2445;
continue lab$fold$;
};
};
};
var fold$$1187 = fix$2443.$fold$;
return fold$$1187(t$1186,e$1183);
};
tools$0Flags$1$4.filter$1212 = function(f$1215,t$1218){var fix$2446 = {};
fix$2446.$fold$ = function(v$1943,v$1944){lab$fold$: while (true) {if (v$1943 == null) {return v$1944;
} else {var v$1947 = v$1943;
var v$1948 = v$1947[0];
var v$1949 = v$1947[1];
var v$1950 = v$1947[2];
var v$1951 = v$1947[3];
var t$2448 = v$1951;
var t$2447;
var v$2303 = fix$2446.$fold$(v$1950,v$1944);
t$2447 = ((f$1215([v$1948,v$1949]))?(tools$0Flags$1$4.add$675(v$1948,v$1949,v$2303)):v$2303);
var t$2449 = t$2448;
var t$2450 = t$2447;
var v$1943 = t$2449;
var v$1944 = t$2450;
continue lab$fold$;
};
};
};
var fold$$1942 = fix$2446.$fold$;
return fold$$1942(t$1218,tools$0Flags$1$4.empty$399(0));
};
var fix$2451 = {};
fix$2451.$addList = function(v$1235,v$1238){lab$addList: while (true) {if (v$1235 == null) {return v$1238;
} else {var v$1250 = v$1235;
var v$1251 = v$1250[0];
var v$1252 = v$1251[0];
var v$1253 = v$1251[1];
var v$1254 = v$1250[1];
var t$2452 = v$1254;
var t$2453 = tools$0Flags$1$4.add$675(v$1252,v$1253,v$1238);
var v$1235 = t$2452;
var v$1238 = t$2453;
continue lab$addList;
};
};
};
tools$0Flags$1$4.addList$1232 = fix$2451.$addList;
tools$0Flags$1$4.fromList$1256 = function(l$1259){return tools$0Flags$1$4.addList$1232(l$1259,tools$0Flags$1$4.empty$399(0));
};
tools$0Flags$1$4.fromSortedList$1260 = function(l$1263){var fix$2454 = {};
fix$2454.$build = function(v$1292,v$2318){switch (v$1292) { case 0: {return [v$2318,null];
 break; }default: {var n$$1294 = SmlPrims.div_i32(v$1292,2,CompilerInitial.exn$Div$47);
var v$1325 = fix$2454.$build(n$$1294,v$2318);
var v$1326 = v$1325[0];
var v$1327 = v$1325[1];
var v$1308;
if (v$1326 == null) {throw [tools$0Flags$1$4.en$Impossible$447,"OrderFinMapbuild"];
} else {var v$1320 = v$1326;
var v$1321 = v$1320[0];
v$1308 = [v$1321[0],v$1321[1],v$1320[1]];
};
var v$1309 = v$1308[0];
var v$1310 = v$1308[1];
var v$1311 = v$1308[2];
var v$1305 = fix$2454.$build(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$1292 - n$$1294)) - 1),v$1311);
return [v$1305[0],[v$1309,v$1310,v$1327,v$1305[1]]];
} };
};
var build$1281 = fix$2454.$build;
var fix$2455 = {};
fix$2455.$mk_avl = function(v$1343){if (v$1343 == null) {return [null,0];
} else {var v$1372 = v$1343;
var v$1373 = v$1372[0];
var v$1374 = v$1372[1];
var v$1375 = v$1372[2];
var v$1376 = v$1372[3];
var v$1369 = fix$2455.$mk_avl(v$1375);
var v$1370 = v$1369[0];
var v$1371 = v$1369[1];
var v$1366 = fix$2455.$mk_avl(v$1376);
var v$1367 = v$1366[0];
var v$1368 = v$1366[1];
return [[v$1373,v$1374,v$1370,v$1367,(v$1371 == v$1368)?2:((v$1371 > v$1368)?1:0)],SmlPrims.chk_ovf_i32(1 + ((v$1371 > v$1368)?v$1371:v$1368))];
};
};
var mk_avl$1340 = fix$2455.$mk_avl;
var t$2464;
var t$2463 = mk_avl$1340;
var t$2462;
var t$2461;
var t$2460 = build$1281;
var t$2459;
var fix$2456 = {};
fix$2456.$acc = function(v$1960,v$1961){lab$acc: while (true) {if (v$1960 == null) {return v$1961;
} else {var v$1962 = v$1960;
var v$1963 = v$1962[1];
var t$2457 = v$1963;
var t$2458 = SmlPrims.chk_ovf_i32(v$1961 + 1);
var v$1960 = t$2457;
var v$1961 = t$2458;
continue lab$acc;
};
};
};
var acc$1959 = fix$2456.$acc;
t$2459 = (acc$1959(l$1263,0));
t$2461 = (t$2460(t$2459,l$1263));
t$2462 = t$2461[1];
t$2464 = (t$2463(t$2462));
return t$2464[0];
};
tools$0Flags$1$4.mergeMap$1385 = function(f$1388,t1$1391,t2$1394){var fix$2465 = {};
fix$2465.$merge = function(v$1415,v$2319){if (v$1415 == null) {return v$2319;
} else {if (v$2319 == null) {return v$1415;
} else {var v$1426 = v$1415;
var v$1427 = v$1426[0];
var v$1428 = v$1427[0];
var v$1429 = v$1427[1];
var v$1430 = v$1426[1];
var v$1431 = v$2319;
var v$1432 = v$1431[0];
var v$1433 = v$1432[0];
var v$1434 = v$1432[1];
var v$1435 = v$1431[1];
return (v$1428 < v$1433)?[[v$1428,v$1429],fix$2465.$merge(v$1430,v$2319)]:((v$1433 < v$1428)?[[v$1433,v$1434],fix$2465.$merge(v$1415,v$1435)]:[[v$1428,f$1388([v$1429,v$1434])],fix$2465.$merge(v$1430,v$1435)]);
};
};
};
var merge$1395 = fix$2465.$merge;
var t$2476 = tools$0Flags$1$4.fromSortedList$1260;
var t$2475;
var t$2474 = merge$1395;
var t$2473;
var fix$2470 = {};
fix$2470.$li = function(v$1968,v$1969){lab$li: while (true) {if (v$1968 == null) {return v$1969;
} else {var v$1972 = v$1968;
var v$1973 = v$1972[0];
var v$1974 = v$1972[1];
var v$1975 = v$1972[2];
var v$1976 = v$1972[3];
var t$2471 = v$1975;
var t$2472 = [[v$1973,v$1974],fix$2470.$li(v$1976,v$1969)];
var v$1968 = t$2471;
var v$1969 = t$2472;
continue lab$li;
};
};
};
var li$1967 = fix$2470.$li;
t$2473 = (li$1967(t1$1391,null));
var t$2469;
var fix$2466 = {};
fix$2466.$li = function(v$1980,v$1981){lab$li: while (true) {if (v$1980 == null) {return v$1981;
} else {var v$1984 = v$1980;
var v$1985 = v$1984[0];
var v$1986 = v$1984[1];
var v$1987 = v$1984[2];
var v$1988 = v$1984[3];
var t$2467 = v$1987;
var t$2468 = [[v$1985,v$1986],fix$2466.$li(v$1988,v$1981)];
var v$1980 = t$2467;
var v$1981 = t$2468;
continue lab$li;
};
};
};
var li$1979 = fix$2466.$li;
t$2469 = (li$1979(t2$1394,null));
t$2475 = (t$2474(t$2473,t$2469));
return t$2476(t$2475);
};
var fix$2477 = {};
fix$2477.$oneForWhich = function(f$1439,t$1442){lab$oneForWhich: while (true) {if (t$1442 == null) {return [1];
} else {var v$1462 = t$1442;
var v$1463 = v$1462[0];
var v$1464 = v$1462[1];
var v$1465 = v$1462[2];
var v$1466 = v$1462[3];
if (f$1439([v$1463,v$1464])) {return [0,[v$1463,v$1464]];
} else {var v$1459 = fix$2477.$oneForWhich(f$1439,v$1465);
switch (v$1459[0]) { case 0: {var v$1461 = v$1459[1];
return [0,v$1461];
 break; }default: {var t$2478 = f$1439;
var t$2479 = v$1466;
var f$1439 = t$2478;
var t$1442 = t$2479;
continue lab$oneForWhich;
} };
};
};
};
};
tools$0Flags$1$4.oneForWhich$1436 = fix$2477.$oneForWhich;
tools$0Flags$1$4.en$Restrict$1467 = new String("Restrict");
tools$0Flags$1$4.restrict$1468 = function(v$1487,v$1488,v$1489){var fix$2480 = {};
fix$2480.$foldl = function(v$1994,v$1995){lab$foldl: while (true) {if (v$1995 == null) {return v$1994;
} else {var v$1996 = v$1995;
var v$1997 = v$1996[0];
var v$1998 = v$1996[1];
var t$2484;
var v$2268;
var fix$2481 = {};
fix$2481.$search = function(v$2270){lab$search: while (true) {if (v$2270 == null) {return [1];
} else {var v$2271 = v$2270;
var v$2272 = v$2271[0];
var v$2273 = v$2271[1];
var v$2274 = v$2271[2];
var v$2275 = v$2271[3];
if (v$1997 < v$2272) {var t$2482 = v$2274;
var v$2270 = t$2482;
continue lab$search;
} else {if (v$2272 < v$1997) {var t$2483 = v$2275;
var v$2270 = t$2483;
continue lab$search;
} else {return [0,v$2273];
};
};
};
};
};
var search$2269 = fix$2481.$search;
v$2268 = (search$2269(v$1488));
switch (v$2268[0]) { case 0: {var v$2276 = v$2268[1];
t$2484 = (tools$0Flags$1$4.add$675(v$1997,v$2276,v$1994));
 break; }default: {throw [tools$0Flags$1$4.en$Restrict$1467,v$1487(v$1997)];
} };
var t$2485 = t$2484;
var t$2486 = v$1998;
var v$1994 = t$2485;
var v$1995 = t$2486;
continue lab$foldl;
};
};
};
var foldl$1993 = fix$2480.$foldl;
return foldl$1993(tools$0Flags$1$4.empty$399(0),v$1489);
};
tools$0Flags$1$4.enrich$1490 = function(en$1493,v$1497){var v$1518 = v$1497[0];
var v$1519 = v$1497[1];
var fix$2487 = {};
fix$2487.$fold$ = function(v$2014,v$2015){lab$fold$: while (true) {if (v$2014 == null) {return v$2015;
} else {var v$2018 = v$2014;
var v$2019 = v$2018[0];
var v$2020 = v$2018[1];
var v$2021 = v$2018[2];
var v$2022 = v$2018[3];
var t$2492 = v$2022;
var t$2491;
if (fix$2487.$fold$(v$2021,v$2015)) {var v$2281;
var fix$2488 = {};
fix$2488.$search = function(v$2283){lab$search: while (true) {if (v$2283 == null) {return [1];
} else {var v$2284 = v$2283;
var v$2285 = v$2284[0];
var v$2286 = v$2284[1];
var v$2287 = v$2284[2];
var v$2288 = v$2284[3];
if (v$2019 < v$2285) {var t$2489 = v$2287;
var v$2283 = t$2489;
continue lab$search;
} else {if (v$2285 < v$2019) {var t$2490 = v$2288;
var v$2283 = t$2490;
continue lab$search;
} else {return [0,v$2286];
};
};
};
};
};
var search$2282 = fix$2488.$search;
v$2281 = (search$2282(v$1518));
switch (v$2281[0]) { case 0: {var v$2289 = v$2281[1];
t$2491 = (en$1493([v$2289,v$2020]));
 break; }default: {t$2491 = false;
} };
} else {t$2491 = false;
};
var t$2493 = t$2492;
var t$2494 = t$2491;
var v$2014 = t$2493;
var v$2015 = t$2494;
continue lab$fold$;
};
};
};
var fold$$2013 = fix$2487.$fold$;
return fold$$2013(v$1519,true);
};
tools$0Flags$1$4.layoutMap$1520 = function(v$1553,v$1555,v$1554,v$1552){return function(layoutDom$1529){return function(layoutRan$1532){return function(m$1535){var t$2502;
var t$2501;
var t$2500 = basis$0List$1.map$697;
var t$2499 = function(v$1539){var v$1545 = v$1539[0];
var v$1546 = v$1539[1];
return [0,[[layoutDom$1529(v$1545),[layoutRan$1532(v$1546),null]],[0,v$1553],"",3,""]];
};
var t$2498;
var fix$2495 = {};
fix$2495.$li = function(v$2037,v$2038){lab$li: while (true) {if (v$2037 == null) {return v$2038;
} else {var v$2041 = v$2037;
var v$2042 = v$2041[0];
var v$2043 = v$2041[1];
var v$2044 = v$2041[2];
var v$2045 = v$2041[3];
var t$2496 = v$2044;
var t$2497 = [[v$2042,v$2043],fix$2495.$li(v$2045,v$2038)];
var v$2037 = t$2496;
var v$2038 = t$2497;
continue lab$li;
};
};
};
var li$2036 = fix$2495.$li;
t$2498 = (li$2036(m$1535,null));
t$2501 = (t$2500(t$2499,t$2498));
t$2502 = [t$2501,[0,v$1554],v$1555,3,v$1552];
return [0,t$2502];
};
};
};
};
tools$0Flags$1$4.reportMap$1556 = function(f$1559,t$1562){var t$2510 = tools$0Report$1.flatten$87;
var t$2509;
var t$2508 = basis$0List$1.map$697;
var t$2507 = f$1559;
var t$2506;
var fix$2503 = {};
fix$2503.$li = function(v$2049,v$2050){lab$li: while (true) {if (v$2049 == null) {return v$2050;
} else {var v$2053 = v$2049;
var v$2054 = v$2053[0];
var v$2055 = v$2053[1];
var v$2056 = v$2053[2];
var v$2057 = v$2053[3];
var t$2504 = v$2056;
var t$2505 = [[v$2054,v$2055],fix$2503.$li(v$2057,v$2050)];
var v$2049 = t$2504;
var v$2050 = t$2505;
continue lab$li;
};
};
};
var li$2048 = fix$2503.$li;
t$2506 = (li$2048(t$1562,null));
t$2509 = (t$2508(t$2507,t$2506));
return t$2510(t$2509);
};
tools$0Flags$1$4.reportMapSORTED$1563 = function(f$2059,t$2060){var t$2518 = tools$0Report$1.flatten$87;
var t$2517;
var t$2516 = basis$0List$1.map$697;
var t$2515 = f$2059;
var t$2514;
var fix$2511 = {};
fix$2511.$li = function(v$2063,v$2064){lab$li: while (true) {if (v$2063 == null) {return v$2064;
} else {var v$2067 = v$2063;
var v$2068 = v$2067[0];
var v$2069 = v$2067[1];
var v$2070 = v$2067[2];
var v$2071 = v$2067[3];
var t$2512 = v$2070;
var t$2513 = [[v$2068,v$2069],fix$2511.$li(v$2071,v$2064)];
var v$2063 = t$2512;
var v$2064 = t$2513;
continue lab$li;
};
};
};
var li$2062 = fix$2511.$li;
t$2514 = (li$2062(t$2060,null));
t$2517 = (t$2516(t$2515,t$2514));
return t$2518(t$2517);
};
tools$0Flags$1$4.pu_bal$1564 = pickle$0pickle$1.enumGen$2158(function(v$2073){var v$2074 = v$2073[0];
var v$2075 = v$2073[1];
switch (v$2074) { case 0: {switch (v$2075) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$2075) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$2075) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderFinMap.bal",[1,[2,[0,null]]]]);
tools$0Flags$1$4.pu$1565 = function(pu_dom$1568,pu_r$1571){var fun_E$1580;
var v$2322 = null;
fun_E$1580 = (function(v$2323){return pickle$0pickle$1.con0$1988(v$2322,v$2323);
});
return pickle$0pickle$1.dataGen$1488(["OrderFinMap.map",function(v$2089){return (v$2089 == null)?0:1;
},[fun_E$1580,[function(pu$2090){return pickle$0pickle$1.con1$2014(function(v$2091){var v$2092 = v$2091[0];
return [v$2092[0],v$2092[1],v$2092[2],v$2092[3],v$2091[1]];
},function(v$2093){if (v$2093 == null) {return tools$0Crash$1.impossible$59("OrderFinMap.pu.fun_N");
} else {var v$2094 = v$2093;
return [[v$2094[0],v$2094[1],v$2094[2],v$2094[3]],v$2094[4]];
};
},pickle$0pickle$1.pairGen0$983((pickle$0pickle$1.convert0$2299(function(v$2102){var v$2103 = v$2102[0];
var v$2104 = v$2103[0];
var v$2105 = v$2103[1];
var v$2106 = v$2102[1];
return [v$2104,v$2105,v$2106[0],v$2106[1]];
},function(v$2107){return [[v$2107[0],v$2107[1]],[v$2107[2],v$2107[3]]];
}))(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.pairGen0$983(pu_dom$1568,pu_r$1571),pickle$0pickle$1.pairGen0$983(pu$2090,pu$2090))),tools$0Flags$1$4.pu_bal$1564));
},null]]]);
};
return 0;
})();
