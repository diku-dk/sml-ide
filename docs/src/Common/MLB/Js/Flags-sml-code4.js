if ((typeof(tools$0Flags$1$4)) == "undefined") {tools$0Flags$1$4 = {};
};
(function(){tools$0Flags$1$4.eq_bal$1637 = function(v$1639,v$1640){switch (v$1639) { case 0: {switch (v$1640) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1640) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1640) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
var fix$2296 = {};
fix$2296.$eq_tree = function(v$1645,v$1646,v$1642){lab$eq_tree: while (true) {var v$1643 = v$1642[0];
var v$1644 = v$1642[1];
if (v$1643 == null) {return (v$1644 == null)?true:false;
} else {if (v$1644 == null) {return false;
} else {var v$1647 = v$1643;
var v$1648 = v$1644;
if (v$1645([v$1647[0],v$1648[0]])) {if (v$1646([v$1647[1],v$1648[1]])) {if (fix$2296.$eq_tree(v$1645,v$1646,[v$1647[2],v$1648[2]])) {var t$2297 = v$1645;
var t$2298 = v$1646;
var t$2299 = [v$1647[3],v$1648[3]];
var v$1645 = t$2297;
var v$1646 = t$2298;
var v$1642 = t$2299;
continue lab$eq_tree;
} else {return false;
};
} else {return false;
};
} else {return false;
};
};
};
};
};
tools$0Flags$1$4.eq_tree$1641 = fix$2296.$eq_tree;
tools$0Flags$1$4.die$368 = function(s$371){return tools$0Crash$1.impossible$59("OrderFinMap." + s$371);
};
tools$0Flags$1$4.s$j$372 = function(v$2283,v$2284){return v$2283 < v$2284;
};
tools$0Flags$1$4.lt$379 = function(v$2285,v$2286){return v$2285 < v$2286;
};
tools$0Flags$1$4.eq$380 = function(v$389,v$390){return ((v$389 < v$390)?true:(v$390 < v$389))?false:true;
};
tools$0Flags$1$4.empty$396 = function(v$2295){return null;
};
tools$0Flags$1$4.singleton$397 = function(v$2287,v$2288){return [v$2287,v$2288,null,null,2];
};
tools$0Flags$1$4.isEmpty$404 = function(v$407){return (v$407 == null)?true:false;
};
tools$0Flags$1$4.lookup$412 = function(t$415,key$418){var fix$2300 = {};
fix$2300.$search = function(v$422){lab$search: while (true) {if (v$422 == null) {return [1];
} else {var v$439 = v$422;
var v$440 = v$439[0];
var v$441 = v$439[1];
var v$442 = v$439[2];
var v$443 = v$439[3];
if (key$418 < v$440) {var t$2301 = v$442;
var v$422 = t$2301;
continue lab$search;
} else {if (v$440 < key$418) {var t$2302 = v$443;
var v$422 = t$2302;
continue lab$search;
} else {return [0,v$441];
};
};
};
};
};
var search$419 = fix$2300.$search;
return search$419(t$415);
};
tools$0Flags$1$4.en$Impossible$444 = new String("Impossible");
tools$0Flags$1$4.impossible$445 = function(s$448){throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMap" + s$448];
};
var en$ALREADYTHERE$449 = new String("ALREADYTHERE");
var exn$ALREADYTHERE$449 = [en$ALREADYTHERE$449];
tools$0Flags$1$4.add$672 = function(v$681,v$682,v$683){try {var fix$2304 = {};
fix$2304.$ins = function(v$1758){if (v$1758 == null) {return [true,[v$681,v$682,null,null,2]];
} else {var v$1759 = v$1758;
var v$1760 = v$1759[0];
var v$1761 = v$1759[1];
var v$1762 = v$1759[2];
var v$1763 = v$1759[3];
var v$1764 = v$1759[4];
if (v$681 < v$1760) {var v$1766 = fix$2304.$ins(v$1762);
var v$1767 = v$1766[0];
var v$1768 = v$1766[1];
switch (v$1764) { case 2: {return v$1767?[true,[v$1760,v$1761,v$1768,v$1763,1]]:[false,[v$1760,v$1761,v$1768,v$1763,2]];
 break; }case 0: {return v$1767?[false,[v$1760,v$1761,v$1768,v$1763,2]]:[false,[v$1760,v$1761,v$1768,v$1763,0]];
 break; }default: {if (v$1767) {var v$1770;
if (v$1768 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLfinmap 1"];
} else {v$1770 = v$1768;
};
var v$1773 = v$1770[0];
var v$1774 = v$1770[1];
var v$1775 = v$1770[2];
var v$1776 = v$1770[3];
var v$1777 = v$1770[4];
var t$2305;
var v$2106 = 1;
switch (v$1777) { case 0: {switch (v$2106) { case 0: {t$2305 = true;
 break; }default: {t$2305 = false;
} };
 break; }case 1: {switch (v$2106) { case 1: {t$2305 = true;
 break; }default: {t$2305 = false;
} };
 break; }case 2: {switch (v$2106) { case 2: {t$2305 = true;
 break; }default: {t$2305 = false;
} };
 break; } };
if (t$2305) {return [false,[v$1773,v$1774,v$1775,[v$1760,v$1761,v$1776,v$1763,2],2]];
} else {var v$1785;
if (v$1776 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLfinmap 2"];
} else {v$1785 = v$1776;
};
var v$1788 = v$1785[0];
var v$1789 = v$1785[1];
var v$1790 = v$1785[2];
var v$1791 = v$1785[3];
var v$1792 = v$1785[4];
var t$2326 = false;
var t$2325;
var t$2324;
var t$2323 = v$1788;
var t$2322 = v$1789;
var t$2321;
var t$2320;
var t$2319 = v$1773;
var t$2318 = v$1774;
var t$2317 = v$1775;
var t$2316 = v$1790;
var t$2315;
var t$2314;
var v$2112 = 0;
switch (v$1792) { case 0: {switch (v$2112) { case 0: {t$2314 = true;
 break; }default: {t$2314 = false;
} };
 break; }case 1: {switch (v$2112) { case 1: {t$2314 = true;
 break; }default: {t$2314 = false;
} };
 break; }case 2: {switch (v$2112) { case 2: {t$2314 = true;
 break; }default: {t$2314 = false;
} };
 break; } };
t$2315 = (t$2314?1:2);
t$2320 = [t$2319,t$2318,t$2317,t$2316,t$2315];
t$2321 = t$2320;
var t$2313;
var t$2312;
var t$2311 = v$1760;
var t$2310 = v$1761;
var t$2309 = v$1791;
var t$2308 = v$1763;
var t$2307;
var t$2306;
var v$2116 = 1;
switch (v$1792) { case 0: {switch (v$2116) { case 0: {t$2306 = true;
 break; }default: {t$2306 = false;
} };
 break; }case 1: {switch (v$2116) { case 1: {t$2306 = true;
 break; }default: {t$2306 = false;
} };
 break; }case 2: {switch (v$2116) { case 2: {t$2306 = true;
 break; }default: {t$2306 = false;
} };
 break; } };
t$2307 = (t$2306?0:2);
t$2312 = [t$2311,t$2310,t$2309,t$2308,t$2307];
t$2313 = t$2312;
t$2324 = [t$2323,t$2322,t$2321,t$2313,2];
t$2325 = t$2324;
return [t$2326,t$2325];
};
} else {return [false,[v$1760,v$1761,v$1768,v$1763,1]];
};
} };
} else {if (v$1760 < v$681) {var v$1808 = fix$2304.$ins(v$1763);
var v$1809 = v$1808[0];
var v$1810 = v$1808[1];
switch (v$1764) { case 2: {return v$1809?[true,[v$1760,v$1761,v$1762,v$1810,0]]:[false,[v$1760,v$1761,v$1762,v$1810,2]];
 break; }case 1: {return v$1809?[false,[v$1760,v$1761,v$1762,v$1810,2]]:[false,[v$1760,v$1761,v$1762,v$1810,1]];
 break; }default: {if (v$1809) {var v$1812;
if (v$1810 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLfinmap 3"];
} else {v$1812 = v$1810;
};
var v$1815 = v$1812[0];
var v$1816 = v$1812[1];
var v$1817 = v$1812[2];
var v$1818 = v$1812[3];
var v$1819 = v$1812[4];
var t$2327;
var v$2126 = 0;
switch (v$1819) { case 0: {switch (v$2126) { case 0: {t$2327 = true;
 break; }default: {t$2327 = false;
} };
 break; }case 1: {switch (v$2126) { case 1: {t$2327 = true;
 break; }default: {t$2327 = false;
} };
 break; }case 2: {switch (v$2126) { case 2: {t$2327 = true;
 break; }default: {t$2327 = false;
} };
 break; } };
if (t$2327) {return [false,[v$1815,v$1816,[v$1760,v$1761,v$1762,v$1817,2],v$1818,2]];
} else {var v$1827;
if (v$1817 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLfinmap 4"];
} else {v$1827 = v$1817;
};
var v$1830 = v$1827[0];
var v$1831 = v$1827[1];
var v$1832 = v$1827[2];
var v$1833 = v$1827[3];
var v$1834 = v$1827[4];
var t$2348 = false;
var t$2347;
var t$2346;
var t$2345 = v$1830;
var t$2344 = v$1831;
var t$2343;
var t$2342;
var t$2341 = v$1760;
var t$2340 = v$1761;
var t$2339 = v$1762;
var t$2338 = v$1832;
var t$2337;
var t$2336;
var v$2132 = 0;
switch (v$1834) { case 0: {switch (v$2132) { case 0: {t$2336 = true;
 break; }default: {t$2336 = false;
} };
 break; }case 1: {switch (v$2132) { case 1: {t$2336 = true;
 break; }default: {t$2336 = false;
} };
 break; }case 2: {switch (v$2132) { case 2: {t$2336 = true;
 break; }default: {t$2336 = false;
} };
 break; } };
t$2337 = (t$2336?1:2);
t$2342 = [t$2341,t$2340,t$2339,t$2338,t$2337];
t$2343 = t$2342;
var t$2335;
var t$2334;
var t$2333 = v$1815;
var t$2332 = v$1816;
var t$2331 = v$1833;
var t$2330 = v$1818;
var t$2329;
var t$2328;
var v$2136 = 1;
switch (v$1834) { case 0: {switch (v$2136) { case 0: {t$2328 = true;
 break; }default: {t$2328 = false;
} };
 break; }case 1: {switch (v$2136) { case 1: {t$2328 = true;
 break; }default: {t$2328 = false;
} };
 break; }case 2: {switch (v$2136) { case 2: {t$2328 = true;
 break; }default: {t$2328 = false;
} };
 break; } };
t$2329 = (t$2328?0:2);
t$2334 = [t$2333,t$2332,t$2331,t$2330,t$2329];
t$2335 = t$2334;
t$2346 = [t$2345,t$2344,t$2343,t$2335,2];
t$2347 = t$2346;
return [t$2348,t$2347];
};
} else {return [false,[v$1760,v$1761,v$1762,v$1810,0]];
};
} };
} else {throw exn$ALREADYTHERE$449;
};
};
};
};
var ins$1757 = fix$2304.$ins;
return (ins$1757(v$683))[1];
} catch(v$2303) {return (function(ALREADYTHERE$680){var t$2349 = ALREADYTHERE$680;
if (t$2349[0] == en$ALREADYTHERE$449) {var fix$2350 = {};
fix$2350.$repl = function(v$1873){if (v$1873 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLupdate.repl"];
} else {var v$1876 = v$1873;
var v$1877 = v$1876[0];
var v$1878 = v$1876[1];
var v$1879 = v$1876[2];
var v$1880 = v$1876[3];
var v$1881 = v$1876[4];
return (v$681 < v$1877)?[v$1877,v$1878,fix$2350.$repl(v$1879),v$1880,v$1881]:((v$1877 < v$681)?[v$1877,v$1878,v$1879,fix$2350.$repl(v$1880),v$1881]:[v$1877,v$682,v$1879,v$1880,v$1881]);
};
};
var repl$1872 = fix$2350.$repl;
return repl$1872(v$683);
} else {throw ALREADYTHERE$680;
};
})(v$2303);
};
};
var fix$2351 = {};
fix$2351.$plus = function(v$702,v$703){lab$plus: while (true) {if (v$703 == null) {return v$702;
} else {var v$697 = v$703;
var v$698 = v$697[0];
var v$699 = v$697[1];
var v$700 = v$697[2];
var v$701 = v$697[3];
var t$2352 = fix$2351.$plus(tools$0Flags$1$4.add$672(v$698,v$699,v$702),v$700);
var t$2353 = v$701;
var v$702 = t$2352;
var v$703 = t$2353;
continue lab$plus;
};
};
};
tools$0Flags$1$4.plus$684 = fix$2351.$plus;
var en$NOTFOUND$704 = new String("NOTFOUND");
var exn$NOTFOUND$704 = [en$NOTFOUND$704];
var delete$705 = function(v$990,v$991){var balance1$710 = function(v$713){if (v$713 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMap(balance1 on an empty map)"];
} else {var v$783 = v$713;
var v$784 = v$783[0];
var v$785 = v$783[1];
var v$786 = v$783[2];
var v$787 = v$783[3];
switch (v$783[4]) { case 1: {return [[v$784,v$785,v$786,v$787,2],true];
 break; }case 2: {return [[v$784,v$785,v$786,v$787,0],false];
 break; }default: {var v$770;
if (v$787 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLfinmap 5"];
} else {v$770 = v$787;
};
var v$771 = v$770[0];
var v$772 = v$770[1];
var v$773 = v$770[2];
var v$774 = v$770[3];
switch (v$770[4]) { case 1: {var v$757;
if (v$773 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLfinmap 6"];
} else {v$757 = v$773;
};
var v$758 = v$757[0];
var v$759 = v$757[1];
var v$760 = v$757[2];
var v$761 = v$757[3];
var v$762 = v$757[4];
var t$2373;
var t$2372;
var t$2371 = v$758;
var t$2370 = v$759;
var t$2369;
var t$2368;
var t$2367 = v$784;
var t$2366 = v$785;
var t$2365 = v$786;
var t$2364 = v$760;
var t$2363;
var t$2362;
var v$2154 = 0;
switch (v$762) { case 0: {switch (v$2154) { case 0: {t$2362 = true;
 break; }default: {t$2362 = false;
} };
 break; }case 1: {switch (v$2154) { case 1: {t$2362 = true;
 break; }default: {t$2362 = false;
} };
 break; }case 2: {switch (v$2154) { case 2: {t$2362 = true;
 break; }default: {t$2362 = false;
} };
 break; } };
t$2363 = (t$2362?1:2);
t$2368 = [t$2367,t$2366,t$2365,t$2364,t$2363];
t$2369 = t$2368;
var t$2361;
var t$2360;
var t$2359 = v$771;
var t$2358 = v$772;
var t$2357 = v$761;
var t$2356 = v$774;
var t$2355;
var t$2354;
var v$2156 = 1;
switch (v$762) { case 0: {switch (v$2156) { case 0: {t$2354 = true;
 break; }default: {t$2354 = false;
} };
 break; }case 1: {switch (v$2156) { case 1: {t$2354 = true;
 break; }default: {t$2354 = false;
} };
 break; }case 2: {switch (v$2156) { case 2: {t$2354 = true;
 break; }default: {t$2354 = false;
} };
 break; } };
t$2355 = (t$2354?0:2);
t$2360 = [t$2359,t$2358,t$2357,t$2356,t$2355];
t$2361 = t$2360;
t$2372 = [t$2371,t$2370,t$2369,t$2361,2];
t$2373 = t$2372;
return [t$2373,true];
 break; }case 2: {return [[v$771,v$772,[v$784,v$785,v$786,v$773,0],v$774,1],false];
 break; }default: {return [[v$771,v$772,[v$784,v$785,v$786,v$773,2],v$774,2],true];
} };
} };
};
};
var balance2$789 = function(v$792){if (v$792 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMap(balance2 on an empty map)"];
} else {var v$862 = v$792;
var v$863 = v$862[0];
var v$864 = v$862[1];
var v$865 = v$862[2];
var v$866 = v$862[3];
switch (v$862[4]) { case 0: {return [[v$863,v$864,v$865,v$866,2],true];
 break; }case 2: {return [[v$863,v$864,v$865,v$866,1],false];
 break; }default: {var v$849;
if (v$865 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLfinmap 7"];
} else {v$849 = v$865;
};
var v$850 = v$849[0];
var v$851 = v$849[1];
var v$852 = v$849[2];
var v$853 = v$849[3];
switch (v$849[4]) { case 0: {var v$836;
if (v$853 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapAVLfinmap 8"];
} else {v$836 = v$853;
};
var v$837 = v$836[0];
var v$838 = v$836[1];
var v$839 = v$836[2];
var v$840 = v$836[3];
var v$841 = v$836[4];
var t$2393;
var t$2392;
var t$2391 = v$837;
var t$2390 = v$838;
var t$2389;
var t$2388;
var t$2387 = v$850;
var t$2386 = v$851;
var t$2385 = v$852;
var t$2384 = v$839;
var t$2383;
var t$2382;
var v$2166 = 0;
switch (v$841) { case 0: {switch (v$2166) { case 0: {t$2382 = true;
 break; }default: {t$2382 = false;
} };
 break; }case 1: {switch (v$2166) { case 1: {t$2382 = true;
 break; }default: {t$2382 = false;
} };
 break; }case 2: {switch (v$2166) { case 2: {t$2382 = true;
 break; }default: {t$2382 = false;
} };
 break; } };
t$2383 = (t$2382?1:2);
t$2388 = [t$2387,t$2386,t$2385,t$2384,t$2383];
t$2389 = t$2388;
var t$2381;
var t$2380;
var t$2379 = v$863;
var t$2378 = v$864;
var t$2377 = v$840;
var t$2376 = v$866;
var t$2375;
var t$2374;
var v$2164 = 1;
switch (v$841) { case 0: {switch (v$2164) { case 0: {t$2374 = true;
 break; }default: {t$2374 = false;
} };
 break; }case 1: {switch (v$2164) { case 1: {t$2374 = true;
 break; }default: {t$2374 = false;
} };
 break; }case 2: {switch (v$2164) { case 2: {t$2374 = true;
 break; }default: {t$2374 = false;
} };
 break; } };
t$2375 = (t$2374?0:2);
t$2380 = [t$2379,t$2378,t$2377,t$2376,t$2375];
t$2381 = t$2380;
t$2392 = [t$2391,t$2390,t$2389,t$2381,2];
t$2393 = t$2392;
return [t$2393,true];
 break; }case 2: {return [[v$850,v$851,v$852,[v$863,v$864,v$853,v$866,1],0],false];
 break; }default: {return [[v$850,v$851,v$852,[v$863,v$864,v$853,v$866,2],2],true];
} };
} };
};
};
var fix$2394 = {};
fix$2394.$remove_rightmost = function(v$871){if (v$871 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMap(remove_rightmost on empty map)"];
} else {var v$887 = v$871;
var v$888 = v$887[3];
if (v$888 == null) {return [v$887[2],v$887[0],v$887[1],true];
} else {var v$913 = v$887[0];
var v$914 = v$887[1];
var v$915 = v$887[2];
var v$916 = v$887[4];
var v$908 = fix$2394.$remove_rightmost(v$888);
var v$909 = v$908[0];
var v$910 = v$908[1];
var v$911 = v$908[2];
if (v$908[3]) {var v$905 = balance2$789([v$913,v$914,v$915,v$909,v$916]);
return [v$905[0],v$910,v$911,v$905[1]];
} else {return [[v$913,v$914,v$915,v$909,v$916],v$910,v$911,false];
};
};
};
};
var remove_rightmost$868 = fix$2394.$remove_rightmost;
var fix$2395 = {};
fix$2395.$del = function(v$920){if (v$920 == null) {throw exn$NOTFOUND$704;
} else {var v$980 = v$920;
var v$981 = v$980[0];
var v$982 = v$980[1];
var v$983 = v$980[2];
var v$984 = v$980[3];
var v$985 = v$980[4];
if (v$990 < v$981) {var v$941 = fix$2395.$del(v$983);
var v$942 = v$941[0];
if (v$941[1]) {return balance1$710([v$981,v$982,v$942,v$984,v$985]);
} else {return [[v$981,v$982,v$942,v$984,v$985],false];
};
} else {if (v$981 < v$990) {var v$955 = fix$2395.$del(v$984);
var v$956 = v$955[0];
if (v$955[1]) {return balance2$789([v$981,v$982,v$983,v$956,v$985]);
} else {return [[v$981,v$982,v$983,v$956,v$985],false];
};
} else {if (v$984 == null) {return [v$983,true];
} else {if (v$983 == null) {return [v$984,true];
} else {var v$975 = remove_rightmost$868(v$983);
var v$976 = v$975[0];
var v$977 = v$975[1];
var v$978 = v$975[2];
if (v$975[3]) {return balance1$710([v$977,v$978,v$976,v$984,v$985]);
} else {return [[v$977,v$978,v$976,v$984,v$985],false];
};
};
};
};
};
};
};
var del$917 = fix$2395.$del;
return (del$917(v$991))[0];
};
tools$0Flags$1$4.remove$992 = function(v$1000,v$1001){try {return [0,delete$705(v$1000,v$1001)];
} catch(v$2396) {return (function(NOTFOUND$999){var t$2397 = NOTFOUND$999;
if (t$2397[0] == en$NOTFOUND$704) {return [1];
} else {throw NOTFOUND$999;
};
})(v$2396);
};
};
tools$0Flags$1$4.delete$1002 = function(v$1010,v$1011){try {return delete$705(v$1010,v$1011);
} catch(v$2398) {return (function(NOTFOUND$1009){var t$2399 = NOTFOUND$1009;
if (t$2399[0] == en$NOTFOUND$704) {return v$1011;
} else {throw NOTFOUND$1009;
};
})(v$2398);
};
};
tools$0Flags$1$4.dom$1012 = function(m$1015){var fix$2400 = {};
fix$2400.$dom$ = function(v$1019,v$1022){lab$dom$: while (true) {if (v$1019 == null) {return v$1022;
} else {var v$1034 = v$1019;
var v$1035 = v$1034[0];
var v$1036 = v$1034[2];
var v$1037 = v$1034[3];
var t$2401 = v$1036;
var t$2402 = [v$1035,fix$2400.$dom$(v$1037,v$1022)];
var v$1019 = t$2401;
var v$1022 = t$2402;
continue lab$dom$;
};
};
};
var dom$$1016 = fix$2400.$dom$;
return dom$$1016(m$1015,null);
};
tools$0Flags$1$4.range$1039 = function(m$1042){var fix$2403 = {};
fix$2403.$ran = function(v$1046,v$1049){lab$ran: while (true) {if (v$1046 == null) {return v$1049;
} else {var v$1061 = v$1046;
var v$1062 = v$1061[1];
var v$1063 = v$1061[2];
var v$1064 = v$1061[3];
var t$2404 = v$1063;
var t$2405 = [v$1062,fix$2403.$ran(v$1064,v$1049)];
var v$1046 = t$2404;
var v$1049 = t$2405;
continue lab$ran;
};
};
};
var ran$1043 = fix$2403.$ran;
return ran$1043(m$1042,null);
};
tools$0Flags$1$4.list$1066 = function(m$1069){var fix$2406 = {};
fix$2406.$li = function(v$1073,v$1076){lab$li: while (true) {if (v$1073 == null) {return v$1076;
} else {var v$1089 = v$1073;
var v$1090 = v$1089[0];
var v$1091 = v$1089[1];
var v$1092 = v$1089[2];
var v$1093 = v$1089[3];
var t$2407 = v$1092;
var t$2408 = [[v$1090,v$1091],fix$2406.$li(v$1093,v$1076)];
var v$1073 = t$2407;
var v$1076 = t$2408;
continue lab$li;
};
};
};
var li$1070 = fix$2406.$li;
return li$1070(m$1069,null);
};
var fix$2409 = {};
fix$2409.$composemap = function(f$1098,t$1101){if (t$1101 == null) {return null;
} else {var v$1112 = t$1101;
var v$1113 = v$1112[0];
var v$1114 = v$1112[1];
var v$1115 = v$1112[2];
var v$1116 = v$1112[3];
var v$1117 = v$1112[4];
var l$$1111 = fix$2409.$composemap(f$1098,v$1115);
return [v$1113,f$1098(v$1114),l$$1111,fix$2409.$composemap(f$1098,v$1116),v$1117];
};
};
tools$0Flags$1$4.composemap$1095 = fix$2409.$composemap;
var fix$2410 = {};
fix$2410.$ComposeMap = function(f$1121,t$1124){if (t$1124 == null) {return null;
} else {var v$1135 = t$1124;
var v$1136 = v$1135[0];
var v$1137 = v$1135[1];
var v$1138 = v$1135[2];
var v$1139 = v$1135[3];
var v$1140 = v$1135[4];
var l$$1134 = fix$2410.$ComposeMap(f$1121,v$1138);
return [v$1136,f$1121([v$1136,v$1137]),l$$1134,fix$2410.$ComposeMap(f$1121,v$1139),v$1140];
};
};
tools$0Flags$1$4.ComposeMap$1118 = fix$2410.$ComposeMap;
tools$0Flags$1$4.fold$1141 = function(f$1144,e$1147,t$1150){var fix$2411 = {};
fix$2411.$fold$ = function(v$1154,v$1157){lab$fold$: while (true) {if (v$1154 == null) {return v$1157;
} else {var v$1169 = v$1154;
var v$1170 = v$1169[1];
var v$1171 = v$1169[2];
var v$1172 = v$1169[3];
var t$2412 = v$1172;
var t$2413 = f$1144([v$1170,fix$2411.$fold$(v$1171,v$1157)]);
var v$1154 = t$2412;
var v$1157 = t$2413;
continue lab$fold$;
};
};
};
var fold$$1151 = fix$2411.$fold$;
return fold$$1151(t$1150,e$1147);
};
tools$0Flags$1$4.Fold$1174 = function(f$1177,e$1180,t$1183){var fix$2414 = {};
fix$2414.$fold$ = function(v$1187,v$1190){lab$fold$: while (true) {if (v$1187 == null) {return v$1190;
} else {var v$1203 = v$1187;
var v$1204 = v$1203[0];
var v$1205 = v$1203[1];
var v$1206 = v$1203[2];
var v$1207 = v$1203[3];
var t$2415 = v$1207;
var t$2416 = f$1177([[v$1204,v$1205],fix$2414.$fold$(v$1206,v$1190)]);
var v$1187 = t$2415;
var v$1190 = t$2416;
continue lab$fold$;
};
};
};
var fold$$1184 = fix$2414.$fold$;
return fold$$1184(t$1183,e$1180);
};
tools$0Flags$1$4.filter$1209 = function(f$1212,t$1215){var fix$2417 = {};
fix$2417.$fold$ = function(v$1940,v$1941){lab$fold$: while (true) {if (v$1940 == null) {return v$1941;
} else {var v$1944 = v$1940;
var v$1945 = v$1944[0];
var v$1946 = v$1944[1];
var v$1947 = v$1944[2];
var v$1948 = v$1944[3];
var t$2419 = v$1948;
var t$2418;
var v$2274 = fix$2417.$fold$(v$1947,v$1941);
t$2418 = ((f$1212([v$1945,v$1946]))?(tools$0Flags$1$4.add$672(v$1945,v$1946,v$2274)):v$2274);
var t$2420 = t$2419;
var t$2421 = t$2418;
var v$1940 = t$2420;
var v$1941 = t$2421;
continue lab$fold$;
};
};
};
var fold$$1939 = fix$2417.$fold$;
return fold$$1939(t$1215,tools$0Flags$1$4.empty$396(0));
};
var fix$2422 = {};
fix$2422.$addList = function(v$1232,v$1235){lab$addList: while (true) {if (v$1232 == null) {return v$1235;
} else {var v$1247 = v$1232;
var v$1248 = v$1247[0];
var v$1249 = v$1248[0];
var v$1250 = v$1248[1];
var v$1251 = v$1247[1];
var t$2423 = v$1251;
var t$2424 = tools$0Flags$1$4.add$672(v$1249,v$1250,v$1235);
var v$1232 = t$2423;
var v$1235 = t$2424;
continue lab$addList;
};
};
};
tools$0Flags$1$4.addList$1229 = fix$2422.$addList;
tools$0Flags$1$4.fromList$1253 = function(l$1256){return tools$0Flags$1$4.addList$1229(l$1256,tools$0Flags$1$4.empty$396(0));
};
tools$0Flags$1$4.fromSortedList$1257 = function(l$1260){var fix$2425 = {};
fix$2425.$build = function(v$1289,v$2289){switch (v$1289) { case 0: {return [v$2289,null];
 break; }default: {var n$$1291 = SmlPrims.div_i32(v$1289,2,CompilerInitial.exn$Div$47);
var v$1322 = fix$2425.$build(n$$1291,v$2289);
var v$1323 = v$1322[0];
var v$1324 = v$1322[1];
var v$1305;
if (v$1323 == null) {throw [tools$0Flags$1$4.en$Impossible$444,"OrderFinMapbuild"];
} else {var v$1317 = v$1323;
var v$1318 = v$1317[0];
v$1305 = [v$1318[0],v$1318[1],v$1317[1]];
};
var v$1306 = v$1305[0];
var v$1307 = v$1305[1];
var v$1308 = v$1305[2];
var v$1302 = fix$2425.$build(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$1289 - n$$1291)) - 1),v$1308);
return [v$1302[0],[v$1306,v$1307,v$1324,v$1302[1]]];
} };
};
var build$1278 = fix$2425.$build;
var fix$2426 = {};
fix$2426.$mk_avl = function(v$1340){if (v$1340 == null) {return [null,0];
} else {var v$1369 = v$1340;
var v$1370 = v$1369[0];
var v$1371 = v$1369[1];
var v$1372 = v$1369[2];
var v$1373 = v$1369[3];
var v$1366 = fix$2426.$mk_avl(v$1372);
var v$1367 = v$1366[0];
var v$1368 = v$1366[1];
var v$1363 = fix$2426.$mk_avl(v$1373);
var v$1364 = v$1363[0];
var v$1365 = v$1363[1];
return [[v$1370,v$1371,v$1367,v$1364,(v$1368 == v$1365)?2:((v$1368 > v$1365)?1:0)],SmlPrims.chk_ovf_i32(1 + ((v$1368 > v$1365)?v$1368:v$1365))];
};
};
var mk_avl$1337 = fix$2426.$mk_avl;
var t$2435;
var t$2434 = mk_avl$1337;
var t$2433;
var t$2432;
var t$2431 = build$1278;
var t$2430;
var fix$2427 = {};
fix$2427.$acc = function(v$1957,v$1958){lab$acc: while (true) {if (v$1957 == null) {return v$1958;
} else {var v$1959 = v$1957;
var v$1960 = v$1959[1];
var t$2428 = v$1960;
var t$2429 = SmlPrims.chk_ovf_i32(v$1958 + 1);
var v$1957 = t$2428;
var v$1958 = t$2429;
continue lab$acc;
};
};
};
var acc$1956 = fix$2427.$acc;
t$2430 = (acc$1956(l$1260,0));
t$2432 = (t$2431(t$2430,l$1260));
t$2433 = t$2432[1];
t$2435 = (t$2434(t$2433));
return t$2435[0];
};
tools$0Flags$1$4.mergeMap$1382 = function(f$1385,t1$1388,t2$1391){var fix$2436 = {};
fix$2436.$merge = function(v$1412,v$2290){if (v$1412 == null) {return v$2290;
} else {if (v$2290 == null) {return v$1412;
} else {var v$1423 = v$1412;
var v$1424 = v$1423[0];
var v$1425 = v$1424[0];
var v$1426 = v$1424[1];
var v$1427 = v$1423[1];
var v$1428 = v$2290;
var v$1429 = v$1428[0];
var v$1430 = v$1429[0];
var v$1431 = v$1429[1];
var v$1432 = v$1428[1];
return (v$1425 < v$1430)?[[v$1425,v$1426],fix$2436.$merge(v$1427,v$2290)]:((v$1430 < v$1425)?[[v$1430,v$1431],fix$2436.$merge(v$1412,v$1432)]:[[v$1425,f$1385([v$1426,v$1431])],fix$2436.$merge(v$1427,v$1432)]);
};
};
};
var merge$1392 = fix$2436.$merge;
var t$2447 = tools$0Flags$1$4.fromSortedList$1257;
var t$2446;
var t$2445 = merge$1392;
var t$2444;
var fix$2441 = {};
fix$2441.$li = function(v$1965,v$1966){lab$li: while (true) {if (v$1965 == null) {return v$1966;
} else {var v$1969 = v$1965;
var v$1970 = v$1969[0];
var v$1971 = v$1969[1];
var v$1972 = v$1969[2];
var v$1973 = v$1969[3];
var t$2442 = v$1972;
var t$2443 = [[v$1970,v$1971],fix$2441.$li(v$1973,v$1966)];
var v$1965 = t$2442;
var v$1966 = t$2443;
continue lab$li;
};
};
};
var li$1964 = fix$2441.$li;
t$2444 = (li$1964(t1$1388,null));
var t$2440;
var fix$2437 = {};
fix$2437.$li = function(v$1977,v$1978){lab$li: while (true) {if (v$1977 == null) {return v$1978;
} else {var v$1981 = v$1977;
var v$1982 = v$1981[0];
var v$1983 = v$1981[1];
var v$1984 = v$1981[2];
var v$1985 = v$1981[3];
var t$2438 = v$1984;
var t$2439 = [[v$1982,v$1983],fix$2437.$li(v$1985,v$1978)];
var v$1977 = t$2438;
var v$1978 = t$2439;
continue lab$li;
};
};
};
var li$1976 = fix$2437.$li;
t$2440 = (li$1976(t2$1391,null));
t$2446 = (t$2445(t$2444,t$2440));
return t$2447(t$2446);
};
var fix$2448 = {};
fix$2448.$oneForWhich = function(f$1436,t$1439){lab$oneForWhich: while (true) {if (t$1439 == null) {return [1];
} else {var v$1459 = t$1439;
var v$1460 = v$1459[0];
var v$1461 = v$1459[1];
var v$1462 = v$1459[2];
var v$1463 = v$1459[3];
if (f$1436([v$1460,v$1461])) {return [0,[v$1460,v$1461]];
} else {var v$1456 = fix$2448.$oneForWhich(f$1436,v$1462);
switch (v$1456[0]) { case 0: {var v$1458 = v$1456[1];
return [0,v$1458];
 break; }default: {var t$2449 = f$1436;
var t$2450 = v$1463;
var f$1436 = t$2449;
var t$1439 = t$2450;
continue lab$oneForWhich;
} };
};
};
};
};
tools$0Flags$1$4.oneForWhich$1433 = fix$2448.$oneForWhich;
tools$0Flags$1$4.en$Restrict$1464 = new String("Restrict");
tools$0Flags$1$4.restrict$1465 = function(v$1484,v$1485,v$1486){var fix$2451 = {};
fix$2451.$foldl = function(v$1991,v$1992){lab$foldl: while (true) {if (v$1992 == null) {return v$1991;
} else {var v$1993 = v$1992;
var v$1994 = v$1993[0];
var v$1995 = v$1993[1];
var t$2455;
var v$2239;
var fix$2452 = {};
fix$2452.$search = function(v$2241){lab$search: while (true) {if (v$2241 == null) {return [1];
} else {var v$2242 = v$2241;
var v$2243 = v$2242[0];
var v$2244 = v$2242[1];
var v$2245 = v$2242[2];
var v$2246 = v$2242[3];
if (v$1994 < v$2243) {var t$2453 = v$2245;
var v$2241 = t$2453;
continue lab$search;
} else {if (v$2243 < v$1994) {var t$2454 = v$2246;
var v$2241 = t$2454;
continue lab$search;
} else {return [0,v$2244];
};
};
};
};
};
var search$2240 = fix$2452.$search;
v$2239 = (search$2240(v$1485));
switch (v$2239[0]) { case 0: {var v$2247 = v$2239[1];
t$2455 = (tools$0Flags$1$4.add$672(v$1994,v$2247,v$1991));
 break; }default: {throw [tools$0Flags$1$4.en$Restrict$1464,v$1484(v$1994)];
} };
var t$2456 = t$2455;
var t$2457 = v$1995;
var v$1991 = t$2456;
var v$1992 = t$2457;
continue lab$foldl;
};
};
};
var foldl$1990 = fix$2451.$foldl;
return foldl$1990(tools$0Flags$1$4.empty$396(0),v$1486);
};
tools$0Flags$1$4.enrich$1487 = function(en$1490,v$1494){var v$1515 = v$1494[0];
var v$1516 = v$1494[1];
var fix$2458 = {};
fix$2458.$fold$ = function(v$2011,v$2012){lab$fold$: while (true) {if (v$2011 == null) {return v$2012;
} else {var v$2015 = v$2011;
var v$2016 = v$2015[0];
var v$2017 = v$2015[1];
var v$2018 = v$2015[2];
var v$2019 = v$2015[3];
var t$2463 = v$2019;
var t$2462;
if (fix$2458.$fold$(v$2018,v$2012)) {var v$2252;
var fix$2459 = {};
fix$2459.$search = function(v$2254){lab$search: while (true) {if (v$2254 == null) {return [1];
} else {var v$2255 = v$2254;
var v$2256 = v$2255[0];
var v$2257 = v$2255[1];
var v$2258 = v$2255[2];
var v$2259 = v$2255[3];
if (v$2016 < v$2256) {var t$2460 = v$2258;
var v$2254 = t$2460;
continue lab$search;
} else {if (v$2256 < v$2016) {var t$2461 = v$2259;
var v$2254 = t$2461;
continue lab$search;
} else {return [0,v$2257];
};
};
};
};
};
var search$2253 = fix$2459.$search;
v$2252 = (search$2253(v$1515));
switch (v$2252[0]) { case 0: {var v$2260 = v$2252[1];
t$2462 = (en$1490([v$2260,v$2017]));
 break; }default: {t$2462 = false;
} };
} else {t$2462 = false;
};
var t$2464 = t$2463;
var t$2465 = t$2462;
var v$2011 = t$2464;
var v$2012 = t$2465;
continue lab$fold$;
};
};
};
var fold$$2010 = fix$2458.$fold$;
return fold$$2010(v$1516,true);
};
tools$0Flags$1$4.layoutMap$1517 = function(v$1550,v$1552,v$1551,v$1549){return function(layoutDom$1526){return function(layoutRan$1529){return function(m$1532){var t$2473;
var t$2472;
var t$2471 = basis$0List$1.map$697;
var t$2470 = function(v$1536){var v$1542 = v$1536[0];
var v$1543 = v$1536[1];
return [0,[[layoutDom$1526(v$1542),[layoutRan$1529(v$1543),null]],[0,v$1550],"",3,""]];
};
var t$2469;
var fix$2466 = {};
fix$2466.$li = function(v$2034,v$2035){lab$li: while (true) {if (v$2034 == null) {return v$2035;
} else {var v$2038 = v$2034;
var v$2039 = v$2038[0];
var v$2040 = v$2038[1];
var v$2041 = v$2038[2];
var v$2042 = v$2038[3];
var t$2467 = v$2041;
var t$2468 = [[v$2039,v$2040],fix$2466.$li(v$2042,v$2035)];
var v$2034 = t$2467;
var v$2035 = t$2468;
continue lab$li;
};
};
};
var li$2033 = fix$2466.$li;
t$2469 = (li$2033(m$1532,null));
t$2472 = (t$2471(t$2470,t$2469));
t$2473 = [t$2472,[0,v$1551],v$1552,3,v$1549];
return [0,t$2473];
};
};
};
};
tools$0Flags$1$4.reportMap$1553 = function(f$1556,t$1559){var t$2481 = tools$0Report$1.flatten$87;
var t$2480;
var t$2479 = basis$0List$1.map$697;
var t$2478 = f$1556;
var t$2477;
var fix$2474 = {};
fix$2474.$li = function(v$2046,v$2047){lab$li: while (true) {if (v$2046 == null) {return v$2047;
} else {var v$2050 = v$2046;
var v$2051 = v$2050[0];
var v$2052 = v$2050[1];
var v$2053 = v$2050[2];
var v$2054 = v$2050[3];
var t$2475 = v$2053;
var t$2476 = [[v$2051,v$2052],fix$2474.$li(v$2054,v$2047)];
var v$2046 = t$2475;
var v$2047 = t$2476;
continue lab$li;
};
};
};
var li$2045 = fix$2474.$li;
t$2477 = (li$2045(t$1559,null));
t$2480 = (t$2479(t$2478,t$2477));
return t$2481(t$2480);
};
tools$0Flags$1$4.reportMapSORTED$1560 = function(f$2056,t$2057){var t$2489 = tools$0Report$1.flatten$87;
var t$2488;
var t$2487 = basis$0List$1.map$697;
var t$2486 = f$2056;
var t$2485;
var fix$2482 = {};
fix$2482.$li = function(v$2060,v$2061){lab$li: while (true) {if (v$2060 == null) {return v$2061;
} else {var v$2064 = v$2060;
var v$2065 = v$2064[0];
var v$2066 = v$2064[1];
var v$2067 = v$2064[2];
var v$2068 = v$2064[3];
var t$2483 = v$2067;
var t$2484 = [[v$2065,v$2066],fix$2482.$li(v$2068,v$2061)];
var v$2060 = t$2483;
var v$2061 = t$2484;
continue lab$li;
};
};
};
var li$2059 = fix$2482.$li;
t$2485 = (li$2059(t$2057,null));
t$2488 = (t$2487(t$2486,t$2485));
return t$2489(t$2488);
};
tools$0Flags$1$4.pu_bal$1561 = pickle$0pickle$1.enumGen$2158(function(v$2070){var v$2071 = v$2070[0];
var v$2072 = v$2070[1];
switch (v$2071) { case 0: {switch (v$2072) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$2072) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$2072) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderFinMap.bal",[1,[2,[0,null]]]]);
tools$0Flags$1$4.pu$1562 = function(pu_dom$1565,pu_r$1568){var fun_E$1577;
var v$2293 = null;
fun_E$1577 = (function(v$2294){return pickle$0pickle$1.con0$1988(v$2293,v$2294);
});
return pickle$0pickle$1.dataGen$1488(["OrderFinMap.map",function(v$2075){return (v$2075 == null)?0:1;
},[fun_E$1577,[function(pu$2076){return pickle$0pickle$1.con1$2014(function(v$2077){var v$2078 = v$2077[0];
return [v$2078[0],v$2078[1],v$2078[2],v$2078[3],v$2077[1]];
},function(v$2079){if (v$2079 == null) {return tools$0Crash$1.impossible$59("OrderFinMap.pu.fun_N");
} else {var v$2080 = v$2079;
return [[v$2080[0],v$2080[1],v$2080[2],v$2080[3]],v$2080[4]];
};
},pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.tup4Gen0$2377(pu_dom$1565,pu_r$1568,pu$2076,pu$2076),tools$0Flags$1$4.pu_bal$1561));
},null]]]);
};
return 0;
})();
