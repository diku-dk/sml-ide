if ((typeof(basics$0ElabTopdec$1$3)) == "undefined") {basics$0ElabTopdec$1$3 = {};
};
(function(){basics$0ElabTopdec$1$3.eq_bal$2064 = function(v$2066,v$2067){switch (v$2066) { case 0: {switch (v$2067) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$2067) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$2067) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
basics$0ElabTopdec$1$3.s$j$1172 = function(v$1177,v$1178){return basics$0ElabTopdec$1$2.lt$1133(v$1177,v$1178);
};
basics$0ElabTopdec$1$3.s$kk$1179 = function(v$1188,v$1189){return ((basics$0ElabTopdec$1$2.lt$1133(v$1188,v$1189))?true:(basics$0ElabTopdec$1$2.lt$1133(v$1189,v$1188)))?false:true;
};
basics$0ElabTopdec$1$3.en$Impossible$1190 = new String("Impossible");
basics$0ElabTopdec$1$3.impossible$1191 = function(s$1194){var s$1195 = "Impossible.OrderSet." + s$1194;
basis$0General$1.print$163(s$1195);
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,s$1195];
};
basics$0ElabTopdec$1$3.empty$1203 = null;
basics$0ElabTopdec$1$3.singleton$1204 = function(i$1207){return [i$1207,null,null,2];
};
var fix$2412 = {};
fix$2412.$size = function(v$1211){if (v$1211 == null) {return 0;
} else {var v$1218 = v$1211;
var v$1219 = v$1218[1];
var v$1220 = v$1218[2];
return SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(1 + (fix$2412.$size(v$1219)))) + (fix$2412.$size(v$1220)));
};
};
basics$0ElabTopdec$1$3.size$1208 = fix$2412.$size;
basics$0ElabTopdec$1$3.isEmpty$1221 = function(v$1224){return (v$1224 == null)?true:false;
};
basics$0ElabTopdec$1$3.member$1229 = function(i$1232,s$1235){var fix$2413 = {};
fix$2413.$search = function(v$1239){lab$search: while (true) {if (v$1239 == null) {return false;
} else {var v$1255 = v$1239;
var v$1256 = v$1255[0];
var v$1257 = v$1255[1];
var v$1258 = v$1255[2];
if (((basics$0ElabTopdec$1$2.lt$1133(i$1232,v$1256))?true:(basics$0ElabTopdec$1$2.lt$1133(v$1256,i$1232)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$2.lt$1133(i$1232,v$1256)) {var t$2414 = v$1257;
var v$1239 = t$2414;
continue lab$search;
} else {var t$2415 = v$1258;
var v$1239 = t$2415;
continue lab$search;
};
};
};
};
};
var search$1236 = fix$2413.$search;
return search$1236(s$1235);
};
basics$0ElabTopdec$1$3.eq$1259 = function(s1$1262,s2$1265){if ((basics$0ElabTopdec$1$3.size$1208(s1$1262)) == (basics$0ElabTopdec$1$3.size$1208(s2$1265))) {var fix$2416 = {};
fix$2416.$eq$ = function(v$1273){lab$eq$: while (true) {if (v$1273 == null) {return true;
} else {var v$1289 = v$1273;
var v$1290 = v$1289[0];
var v$1291 = v$1289[1];
var v$1292 = v$1289[2];
var t$2420;
var fix$2417 = {};
fix$2417.$search = function(v$2337){lab$search: while (true) {if (v$2337 == null) {return false;
} else {var v$2338 = v$2337;
var v$2339 = v$2338[0];
var v$2340 = v$2338[1];
var v$2341 = v$2338[2];
if (((basics$0ElabTopdec$1$2.lt$1133(v$1290,v$2339))?true:(basics$0ElabTopdec$1$2.lt$1133(v$2339,v$1290)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$2.lt$1133(v$1290,v$2339)) {var t$2418 = v$2340;
var v$2337 = t$2418;
continue lab$search;
} else {var t$2419 = v$2341;
var v$2337 = t$2419;
continue lab$search;
};
};
};
};
};
var search$2336 = fix$2417.$search;
t$2420 = (search$2336(s2$1265));
if (t$2420) {if (fix$2416.$eq$(v$1291)) {var t$2421 = v$1292;
var v$1273 = t$2421;
continue lab$eq$;
} else {return false;
};
} else {return false;
};
};
};
};
var eq$$1270 = fix$2416.$eq$;
return eq$$1270(s1$1262);
} else {return false;
};
};
basics$0ElabTopdec$1$3.en$ALREADYTHERE$1293 = new String("ALREADYTHERE");
basics$0ElabTopdec$1$3.exn$ALREADYTHERE$1293 = [basics$0ElabTopdec$1$3.en$ALREADYTHERE$1293];
basics$0ElabTopdec$1$3.insert$1294 = function(k0$1297,t$1300){var fix$2422 = {};
fix$2422.$ins = function(v$1304){if (v$1304 == null) {return [true,[k0$1297,null,null,2]];
} else {var v$1457 = v$1304;
var v$1458 = v$1457[0];
var v$1459 = v$1457[1];
var v$1460 = v$1457[2];
var v$1461 = v$1457[3];
if (((basics$0ElabTopdec$1$2.lt$1133(k0$1297,v$1458))?true:(basics$0ElabTopdec$1$2.lt$1133(v$1458,k0$1297)))?false:true) {throw basics$0ElabTopdec$1$3.exn$ALREADYTHERE$1293;
} else {if (basics$0ElabTopdec$1$2.lt$1133(k0$1297,v$1458)) {var v$1386 = fix$2422.$ins(v$1459);
var v$1387 = v$1386[0];
var v$1388 = v$1386[1];
switch (v$1461) { case 2: {return v$1387?[true,[v$1458,v$1388,v$1460,1]]:[false,[v$1458,v$1388,v$1460,2]];
 break; }case 0: {return v$1387?[false,[v$1458,v$1388,v$1460,2]]:[false,[v$1458,v$1388,v$1460,0]];
 break; }default: {if (v$1387) {var v$1374;
if (v$1388 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree01!");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.empty tree01!"];
} else {v$1374 = v$1388;
};
var v$1375 = v$1374[0];
var v$1376 = v$1374[1];
var v$1377 = v$1374[2];
var v$1378 = v$1374[3];
var t$2425;
var v$2271 = 1;
switch (v$1378) { case 0: {switch (v$2271) { case 0: {t$2425 = true;
 break; }default: {t$2425 = false;
} };
 break; }case 1: {switch (v$2271) { case 1: {t$2425 = true;
 break; }default: {t$2425 = false;
} };
 break; }case 2: {switch (v$2271) { case 2: {t$2425 = true;
 break; }default: {t$2425 = false;
} };
 break; } };
if (t$2425) {return [false,[v$1375,v$1376,[v$1458,v$1377,v$1460,2],2]];
} else {var v$1362;
if (v$1377 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree02!");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.empty tree02!"];
} else {v$1362 = v$1377;
};
var v$1363 = v$1362[0];
var v$1364 = v$1362[1];
var v$1365 = v$1362[2];
var v$1366 = v$1362[3];
var t$2443 = false;
var t$2442;
var t$2441;
var t$2440 = v$1363;
var t$2439;
var t$2438;
var t$2437 = v$1375;
var t$2436 = v$1376;
var t$2435 = v$1364;
var t$2434;
var t$2433;
var v$2275 = 0;
switch (v$1366) { case 0: {switch (v$2275) { case 0: {t$2433 = true;
 break; }default: {t$2433 = false;
} };
 break; }case 1: {switch (v$2275) { case 1: {t$2433 = true;
 break; }default: {t$2433 = false;
} };
 break; }case 2: {switch (v$2275) { case 2: {t$2433 = true;
 break; }default: {t$2433 = false;
} };
 break; } };
t$2434 = (t$2433?1:2);
t$2438 = [t$2437,t$2436,t$2435,t$2434];
t$2439 = t$2438;
var t$2432;
var t$2431;
var t$2430 = v$1458;
var t$2429 = v$1365;
var t$2428 = v$1460;
var t$2427;
var t$2426;
var v$2277 = 1;
switch (v$1366) { case 0: {switch (v$2277) { case 0: {t$2426 = true;
 break; }default: {t$2426 = false;
} };
 break; }case 1: {switch (v$2277) { case 1: {t$2426 = true;
 break; }default: {t$2426 = false;
} };
 break; }case 2: {switch (v$2277) { case 2: {t$2426 = true;
 break; }default: {t$2426 = false;
} };
 break; } };
t$2427 = (t$2426?0:2);
t$2431 = [t$2430,t$2429,t$2428,t$2427];
t$2432 = t$2431;
t$2441 = [t$2440,t$2439,t$2432,2];
t$2442 = t$2441;
return [t$2443,t$2442];
};
} else {return [false,[v$1458,v$1388,v$1460,1]];
};
} };
} else {var v$1454 = fix$2422.$ins(v$1460);
var v$1455 = v$1454[0];
var v$1456 = v$1454[1];
switch (v$1461) { case 2: {return v$1455?[true,[v$1458,v$1459,v$1456,0]]:[false,[v$1458,v$1459,v$1456,2]];
 break; }case 1: {return v$1455?[false,[v$1458,v$1459,v$1456,2]]:[false,[v$1458,v$1459,v$1456,1]];
 break; }default: {if (v$1455) {var v$1442;
if (v$1456 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree03!");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.empty tree03!"];
} else {v$1442 = v$1456;
};
var v$1443 = v$1442[0];
var v$1444 = v$1442[1];
var v$1445 = v$1442[2];
var v$1446 = v$1442[3];
var t$2444;
var v$2283 = 0;
switch (v$1446) { case 0: {switch (v$2283) { case 0: {t$2444 = true;
 break; }default: {t$2444 = false;
} };
 break; }case 1: {switch (v$2283) { case 1: {t$2444 = true;
 break; }default: {t$2444 = false;
} };
 break; }case 2: {switch (v$2283) { case 2: {t$2444 = true;
 break; }default: {t$2444 = false;
} };
 break; } };
if (t$2444) {return [false,[v$1443,[v$1458,v$1459,v$1444,2],v$1445,2]];
} else {var v$1430;
if (v$1444 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree04!");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.empty tree04!"];
} else {v$1430 = v$1444;
};
var v$1431 = v$1430[0];
var v$1432 = v$1430[1];
var v$1433 = v$1430[2];
var v$1434 = v$1430[3];
var t$2462 = false;
var t$2461;
var t$2460;
var t$2459 = v$1431;
var t$2458;
var t$2457;
var t$2456 = v$1458;
var t$2455 = v$1459;
var t$2454 = v$1432;
var t$2453;
var t$2452;
var v$2287 = 0;
switch (v$1434) { case 0: {switch (v$2287) { case 0: {t$2452 = true;
 break; }default: {t$2452 = false;
} };
 break; }case 1: {switch (v$2287) { case 1: {t$2452 = true;
 break; }default: {t$2452 = false;
} };
 break; }case 2: {switch (v$2287) { case 2: {t$2452 = true;
 break; }default: {t$2452 = false;
} };
 break; } };
t$2453 = (t$2452?1:2);
t$2457 = [t$2456,t$2455,t$2454,t$2453];
t$2458 = t$2457;
var t$2451;
var t$2450;
var t$2449 = v$1443;
var t$2448 = v$1433;
var t$2447 = v$1445;
var t$2446;
var t$2445;
var v$2289 = 1;
switch (v$1434) { case 0: {switch (v$2289) { case 0: {t$2445 = true;
 break; }default: {t$2445 = false;
} };
 break; }case 1: {switch (v$2289) { case 1: {t$2445 = true;
 break; }default: {t$2445 = false;
} };
 break; }case 2: {switch (v$2289) { case 2: {t$2445 = true;
 break; }default: {t$2445 = false;
} };
 break; } };
t$2446 = (t$2445?0:2);
t$2450 = [t$2449,t$2448,t$2447,t$2446];
t$2451 = t$2450;
t$2460 = [t$2459,t$2458,t$2451,2];
t$2461 = t$2460;
return [t$2462,t$2461];
};
} else {return [false,[v$1458,v$1459,v$1456,0]];
};
} };
};
};
};
};
var ins$1301 = fix$2422.$ins;
try {return (ins$1301(t$1300))[1];
} catch(v$2423) {return (function(ALREADYTHERE$1468){var t$2424 = ALREADYTHERE$1468;
if (t$2424[0] == basics$0ElabTopdec$1$3.en$ALREADYTHERE$1293) {return t$1300;
} else {throw ALREADYTHERE$1468;
};
})(v$2423);
};
};
basics$0ElabTopdec$1$3.list$1469 = function(s$1472){var fix$2463 = {};
fix$2463.$f = function(v$1476,v$1479){lab$f: while (true) {if (v$1476 == null) {return v$1479;
} else {var v$1491 = v$1476;
var v$1492 = v$1491[0];
var v$1493 = v$1491[1];
var v$1494 = v$1491[2];
var t$2464 = v$1493;
var t$2465 = [v$1492,fix$2463.$f(v$1494,v$1479)];
var v$1476 = t$2464;
var v$1479 = t$2465;
continue lab$f;
};
};
};
var f$1473 = fix$2463.$f;
return f$1473(s$1472,null);
};
var fix$2466 = {};
fix$2466.$fromList = function(l$1499){if (l$1499 == null) {return basics$0ElabTopdec$1$3.empty$1203;
} else {var v$1506 = l$1499;
var v$1507 = v$1506[0];
var v$1508 = v$1506[1];
return basics$0ElabTopdec$1$3.insert$1294(v$1507,fix$2466.$fromList(v$1508));
};
};
basics$0ElabTopdec$1$3.fromList$1496 = fix$2466.$fromList;
var fix$2467 = {};
fix$2467.$union = function(s1$1512,s2$1515){lab$union: while (true) {if (s2$1515 == null) {return s1$1512;
} else {var v$1523 = s2$1515;
var v$1524 = v$1523[0];
var v$1525 = v$1523[1];
var v$1526 = v$1523[2];
var t$2468 = fix$2467.$union(basics$0ElabTopdec$1$3.insert$1294(v$1524,s1$1512),v$1525);
var t$2469 = v$1526;
var s1$1512 = t$2468;
var s2$1515 = t$2469;
continue lab$union;
};
};
};
basics$0ElabTopdec$1$3.union$1509 = fix$2467.$union;
var fix$2470 = {};
fix$2470.$addList = function(v$1530,v$1533){lab$addList: while (true) {if (v$1530 == null) {return v$1533;
} else {var v$1544 = v$1530;
var v$1545 = v$1544[0];
var v$1546 = v$1544[1];
var t$2471 = v$1546;
var t$2472 = basics$0ElabTopdec$1$3.insert$1294(v$1545,v$1533);
var v$1530 = t$2471;
var v$1533 = t$2472;
continue lab$addList;
};
};
};
basics$0ElabTopdec$1$3.addList$1527 = fix$2470.$addList;
basics$0ElabTopdec$1$3.en$NOTFOUND$1548 = new String("NOTFOUND");
basics$0ElabTopdec$1$3.exn$NOTFOUND$1548 = [basics$0ElabTopdec$1$3.en$NOTFOUND$1548];
basics$0ElabTopdec$1$3.remove$1549 = function(k0$1552,t$1555){var balance1$1556 = function(v$1559){if (v$1559 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance1 on an empty tree)");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.(balance1 on an empty tree)"];
} else {var v$1624 = v$1559;
var v$1625 = v$1624[0];
var v$1626 = v$1624[1];
var v$1627 = v$1624[2];
switch (v$1624[3]) { case 1: {return [[v$1625,v$1626,v$1627,2],true];
 break; }case 2: {return [[v$1625,v$1626,v$1627,0],false];
 break; }default: {var v$1612;
if (v$1627 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree11!");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.empty tree11!"];
} else {v$1612 = v$1627;
};
var v$1613 = v$1612[0];
var v$1614 = v$1612[1];
var v$1615 = v$1612[2];
switch (v$1612[3]) { case 1: {var v$1600;
if (v$1614 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree12!");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.empty tree12!"];
} else {v$1600 = v$1614;
};
var v$1601 = v$1600[0];
var v$1602 = v$1600[1];
var v$1603 = v$1600[2];
var v$1604 = v$1600[3];
var t$2489;
var t$2488;
var t$2487 = v$1601;
var t$2486;
var t$2485;
var t$2484 = v$1625;
var t$2483 = v$1626;
var t$2482 = v$1602;
var t$2481;
var t$2480;
var v$2301 = 0;
switch (v$1604) { case 0: {switch (v$2301) { case 0: {t$2480 = true;
 break; }default: {t$2480 = false;
} };
 break; }case 1: {switch (v$2301) { case 1: {t$2480 = true;
 break; }default: {t$2480 = false;
} };
 break; }case 2: {switch (v$2301) { case 2: {t$2480 = true;
 break; }default: {t$2480 = false;
} };
 break; } };
t$2481 = (t$2480?1:2);
t$2485 = [t$2484,t$2483,t$2482,t$2481];
t$2486 = t$2485;
var t$2479;
var t$2478;
var t$2477 = v$1613;
var t$2476 = v$1603;
var t$2475 = v$1615;
var t$2474;
var t$2473;
var v$2303 = 1;
switch (v$1604) { case 0: {switch (v$2303) { case 0: {t$2473 = true;
 break; }default: {t$2473 = false;
} };
 break; }case 1: {switch (v$2303) { case 1: {t$2473 = true;
 break; }default: {t$2473 = false;
} };
 break; }case 2: {switch (v$2303) { case 2: {t$2473 = true;
 break; }default: {t$2473 = false;
} };
 break; } };
t$2474 = (t$2473?0:2);
t$2478 = [t$2477,t$2476,t$2475,t$2474];
t$2479 = t$2478;
t$2488 = [t$2487,t$2486,t$2479,2];
t$2489 = t$2488;
return [t$2489,true];
 break; }case 2: {return [[v$1613,[v$1625,v$1626,v$1614,0],v$1615,1],false];
 break; }default: {return [[v$1613,[v$1625,v$1626,v$1614,2],v$1615,2],true];
} };
} };
};
};
var balance2$1629 = function(v$1632){if (v$1632 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance2 on an empty tree)");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.(balance2 on an empty tree)"];
} else {var v$1697 = v$1632;
var v$1698 = v$1697[0];
var v$1699 = v$1697[1];
var v$1700 = v$1697[2];
switch (v$1697[3]) { case 0: {return [[v$1698,v$1699,v$1700,2],true];
 break; }case 2: {return [[v$1698,v$1699,v$1700,1],false];
 break; }default: {var v$1685;
if (v$1699 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree21!");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.empty tree21!"];
} else {v$1685 = v$1699;
};
var v$1686 = v$1685[0];
var v$1687 = v$1685[1];
var v$1688 = v$1685[2];
switch (v$1685[3]) { case 0: {var v$1673;
if (v$1688 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree22!");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.empty tree22!"];
} else {v$1673 = v$1688;
};
var v$1674 = v$1673[0];
var v$1675 = v$1673[1];
var v$1676 = v$1673[2];
var v$1677 = v$1673[3];
var t$2506;
var t$2505;
var t$2504 = v$1674;
var t$2503;
var t$2502;
var t$2501 = v$1686;
var t$2500 = v$1687;
var t$2499 = v$1675;
var t$2498;
var t$2497;
var v$2313 = 0;
switch (v$1677) { case 0: {switch (v$2313) { case 0: {t$2497 = true;
 break; }default: {t$2497 = false;
} };
 break; }case 1: {switch (v$2313) { case 1: {t$2497 = true;
 break; }default: {t$2497 = false;
} };
 break; }case 2: {switch (v$2313) { case 2: {t$2497 = true;
 break; }default: {t$2497 = false;
} };
 break; } };
t$2498 = (t$2497?1:2);
t$2502 = [t$2501,t$2500,t$2499,t$2498];
t$2503 = t$2502;
var t$2496;
var t$2495;
var t$2494 = v$1698;
var t$2493 = v$1676;
var t$2492 = v$1700;
var t$2491;
var t$2490;
var v$2311 = 1;
switch (v$1677) { case 0: {switch (v$2311) { case 0: {t$2490 = true;
 break; }default: {t$2490 = false;
} };
 break; }case 1: {switch (v$2311) { case 1: {t$2490 = true;
 break; }default: {t$2490 = false;
} };
 break; }case 2: {switch (v$2311) { case 2: {t$2490 = true;
 break; }default: {t$2490 = false;
} };
 break; } };
t$2491 = (t$2490?0:2);
t$2495 = [t$2494,t$2493,t$2492,t$2491];
t$2496 = t$2495;
t$2505 = [t$2504,t$2503,t$2496,2];
t$2506 = t$2505;
return [t$2506,true];
 break; }case 2: {return [[v$1686,v$1687,[v$1698,v$1688,v$1700,1],0],false];
 break; }default: {return [[v$1686,v$1687,[v$1698,v$1688,v$1700,2],2],true];
} };
} };
};
};
var fix$2507 = {};
fix$2507.$remove_rightmost = function(v$1705){if (v$1705 == null) {basis$0General$1.print$163("Impossible.OrderSet.(remove_rightmost on empty tree)");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.(remove_rightmost on empty tree)"];
} else {var v$1719 = v$1705;
var v$1720 = v$1719[2];
if (v$1720 == null) {return [v$1719[1],v$1719[0],true];
} else {var v$1742 = v$1719[0];
var v$1743 = v$1719[1];
var v$1744 = v$1719[3];
var v$1738 = fix$2507.$remove_rightmost(v$1720);
var v$1739 = v$1738[0];
var v$1740 = v$1738[1];
if (v$1738[2]) {var v$1735 = balance2$1629([v$1742,v$1743,v$1739,v$1744]);
return [v$1735[0],v$1740,v$1735[1]];
} else {return [[v$1742,v$1743,v$1739,v$1744],v$1740,false];
};
};
};
};
var remove_rightmost$1702 = fix$2507.$remove_rightmost;
var fix$2508 = {};
fix$2508.$del = function(v$1748){if (v$1748 == null) {throw basics$0ElabTopdec$1$3.exn$NOTFOUND$1548;
} else {var v$1805 = v$1748;
var v$1806 = v$1805[0];
var v$1807 = v$1805[1];
var v$1808 = v$1805[2];
var v$1809 = v$1805[3];
if (basics$0ElabTopdec$1$2.lt$1133(k0$1552,v$1806)) {var v$1768 = fix$2508.$del(v$1807);
var v$1769 = v$1768[0];
if (v$1768[1]) {return balance1$1556([v$1806,v$1769,v$1808,v$1809]);
} else {return [[v$1806,v$1769,v$1808,v$1809],false];
};
} else {if (basics$0ElabTopdec$1$2.lt$1133(v$1806,k0$1552)) {var v$1782 = fix$2508.$del(v$1808);
var v$1783 = v$1782[0];
if (v$1782[1]) {return balance2$1629([v$1806,v$1807,v$1783,v$1809]);
} else {return [[v$1806,v$1807,v$1783,v$1809],false];
};
} else {if (v$1808 == null) {return [v$1807,true];
} else {if (v$1807 == null) {return [v$1808,true];
} else {var v$1801 = remove_rightmost$1702(v$1807);
var v$1802 = v$1801[0];
var v$1803 = v$1801[1];
if (v$1801[2]) {return balance1$1556([v$1803,v$1802,v$1808,v$1809]);
} else {return [[v$1803,v$1802,v$1808,v$1809],false];
};
};
};
};
};
};
};
var del$1745 = fix$2508.$del;
try {return (del$1745(t$1555))[0];
} catch(v$2509) {return (function(NOTFOUND$1816){var t$2510 = NOTFOUND$1816;
if (t$2510[0] == basics$0ElabTopdec$1$3.en$NOTFOUND$1548) {return t$1555;
} else {throw NOTFOUND$1816;
};
})(v$2509);
};
};
var fix$2511 = {};
fix$2511.$difference = function(s1$1820,s2$1823){lab$difference: while (true) {if (s1$1820 == null) {return null;
} else {if (s2$1823 == null) {return s1$1820;
} else {var v$1835 = s2$1823;
var v$1836 = v$1835[0];
var v$1837 = v$1835[1];
var v$1838 = v$1835[2];
var t$2512 = fix$2511.$difference(basics$0ElabTopdec$1$3.remove$1549(v$1836,s1$1820),v$1837);
var t$2513 = v$1838;
var s1$1820 = t$2512;
var s2$1823 = t$2513;
continue lab$difference;
};
};
};
};
basics$0ElabTopdec$1$3.difference$1817 = fix$2511.$difference;
basics$0ElabTopdec$1$3.intersect$1839 = function(s1$1842,s2$1845){var fix$2514 = {};
fix$2514.$inters = function(v$1849,v$1852){lab$inters: while (true) {if (v$1849 == null) {return v$1852;
} else {var v$1868 = v$1849;
var v$1869 = v$1868[0];
var v$1870 = v$1868[1];
var v$1871 = v$1868[2];
var t$2523 = v$1870;
var t$2522;
var t$2521 = fix$2514.$inters;
var t$2520 = v$1871;
var t$2519;
var t$2518;
var fix$2515 = {};
fix$2515.$search = function(v$2375){lab$search: while (true) {if (v$2375 == null) {return false;
} else {var v$2376 = v$2375;
var v$2377 = v$2376[0];
var v$2378 = v$2376[1];
var v$2379 = v$2376[2];
if (((basics$0ElabTopdec$1$2.lt$1133(v$1869,v$2377))?true:(basics$0ElabTopdec$1$2.lt$1133(v$2377,v$1869)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$2.lt$1133(v$1869,v$2377)) {var t$2516 = v$2378;
var v$2375 = t$2516;
continue lab$search;
} else {var t$2517 = v$2379;
var v$2375 = t$2517;
continue lab$search;
};
};
};
};
};
var search$2374 = fix$2515.$search;
t$2518 = (search$2374(s2$1845));
t$2519 = (t$2518?(basics$0ElabTopdec$1$3.insert$1294(v$1869,v$1852)):v$1852);
t$2522 = (t$2521(t$2520,t$2519));
var t$2524 = t$2523;
var t$2525 = t$2522;
var v$1849 = t$2524;
var v$1852 = t$2525;
continue lab$inters;
};
};
};
var inters$1846 = fix$2514.$inters;
return inters$1846(s1$1842,basics$0ElabTopdec$1$3.empty$1203);
};
basics$0ElabTopdec$1$3.partition$1873 = function(f$1876,s$1879){var fix$2526 = {};
fix$2526.$g = function(v$1883,v$1886){lab$g: while (true) {if (v$1883 == null) {return v$1886;
} else {var v$1904 = v$1883;
var v$1905 = v$1904[0];
var v$1906 = v$1904[1];
var v$1907 = v$1904[2];
var v$1909 = v$1886[0];
var v$1910 = v$1886[1];
var b$1899 = (f$1876(v$1905))?[basics$0ElabTopdec$1$3.insert$1294(v$1905,v$1909),v$1910]:[v$1909,basics$0ElabTopdec$1$3.insert$1294(v$1905,v$1910)];
var t$2527 = v$1907;
var t$2528 = fix$2526.$g(v$1906,b$1899);
var v$1883 = t$2527;
var v$1886 = t$2528;
continue lab$g;
};
};
};
var g$1880 = fix$2526.$g;
return g$1880(s$1879,[basics$0ElabTopdec$1$3.empty$1203,basics$0ElabTopdec$1$3.empty$1203]);
};
basics$0ElabTopdec$1$3.fold$1911 = function(f$1914,e$1917,t$1920){var fix$2529 = {};
fix$2529.$fold$ = function(v$1924,v$1927){lab$fold$: while (true) {if (v$1924 == null) {return v$1927;
} else {var v$1939 = v$1924;
var v$1940 = v$1939[0];
var v$1941 = v$1939[1];
var v$1942 = v$1939[2];
var t$2530 = v$1942;
var t$2531 = (f$1914(v$1940))(fix$2529.$fold$(v$1941,v$1927));
var v$1924 = t$2530;
var v$1927 = t$2531;
continue lab$fold$;
};
};
};
var fold$$1921 = fix$2529.$fold$;
return fold$$1921(t$1920,e$1917);
};
basics$0ElabTopdec$1$3.listmap$1944 = function(v$2408,v$2409){return basis$0List$1.map$697(v$2408,v$2409);
};
basics$0ElabTopdec$1$3.map$1945 = function(f$1948,t$1951){var t$2539 = basics$0ElabTopdec$1$3.fromList$1496;
var t$2538;
var t$2537 = basis$0List$1.map$697;
var t$2536 = f$1948;
var t$2535;
var fix$2532 = {};
fix$2532.$f = function(v$2211,v$2212){lab$f: while (true) {if (v$2211 == null) {return v$2212;
} else {var v$2215 = v$2211;
var v$2216 = v$2215[0];
var v$2217 = v$2215[1];
var v$2218 = v$2215[2];
var t$2533 = v$2217;
var t$2534 = [v$2216,fix$2532.$f(v$2218,v$2212)];
var v$2211 = t$2533;
var v$2212 = t$2534;
continue lab$f;
};
};
};
var f$2210 = fix$2532.$f;
t$2535 = (f$2210(t$1951,null));
t$2538 = (t$2537(t$2536,t$2535));
return t$2539(t$2538);
};
basics$0ElabTopdec$1$3.subst$1952 = function(v$1964,v$1965){return function(s$1959){var t$2543;
var fix$2540 = {};
fix$2540.$search = function(v$2383){lab$search: while (true) {if (v$2383 == null) {return false;
} else {var v$2384 = v$2383;
var v$2385 = v$2384[0];
var v$2386 = v$2384[1];
var v$2387 = v$2384[2];
if (((basics$0ElabTopdec$1$2.lt$1133(v$1965,v$2385))?true:(basics$0ElabTopdec$1$2.lt$1133(v$2385,v$1965)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$2.lt$1133(v$1965,v$2385)) {var t$2541 = v$2386;
var v$2383 = t$2541;
continue lab$search;
} else {var t$2542 = v$2387;
var v$2383 = t$2542;
continue lab$search;
};
};
};
};
};
var search$2382 = fix$2540.$search;
t$2543 = (search$2382(s$1959));
if (t$2543) {return basics$0ElabTopdec$1$3.insert$1294(v$1964,basics$0ElabTopdec$1$3.remove$1549(v$1965,s$1959));
} else {return s$1959;
};
};
};
basics$0ElabTopdec$1$3.apply$1966 = function(f$1969,s$1972){var fix$2544 = {};
fix$2544.$appl = function(v$1976){lab$appl: while (true) {if (v$1976 == null) {return 0;
} else {var v$1988 = v$1976;
var v$1989 = v$1988[0];
var v$1990 = v$1988[1];
var v$1991 = v$1988[2];
fix$2544.$appl(v$1990);
f$1969(v$1989);
var t$2545 = v$1991;
var v$1976 = t$2545;
continue lab$appl;
};
};
};
var appl$1973 = fix$2544.$appl;
return appl$1973(s$1972);
};
basics$0ElabTopdec$1$3.layoutSet$1992 = function(v$2011,v$2010,v$2009){return function(layoutItem$2000){return function(s$2003){var t$2546;
var v$2007 = [0,v$2010];
var t$2553;
var t$2552 = basis$0List$1.map$697;
var t$2551 = layoutItem$2000;
var t$2550;
var fix$2547 = {};
fix$2547.$f = function(v$2222,v$2223){lab$f: while (true) {if (v$2222 == null) {return v$2223;
} else {var v$2226 = v$2222;
var v$2227 = v$2226[0];
var v$2228 = v$2226[1];
var v$2229 = v$2226[2];
var t$2548 = v$2228;
var t$2549 = [v$2227,fix$2547.$f(v$2229,v$2223)];
var v$2222 = t$2548;
var v$2223 = t$2549;
continue lab$f;
};
};
};
var f$2221 = fix$2547.$f;
t$2550 = (f$2221(s$2003,null));
t$2553 = (t$2552(t$2551,t$2550));
t$2546 = [t$2553,v$2007,v$2011,3,v$2009];
return [0,t$2546];
};
};
};
basics$0ElabTopdec$1$3.pu_bal$2012 = pickle$0pickle$1.enumGen$2158(function(v$2231){var v$2232 = v$2231[0];
var v$2233 = v$2231[1];
switch (v$2232) { case 0: {switch (v$2233) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$2233) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$2233) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderSet.bal",[1,[2,[0,null]]]]);
basics$0ElabTopdec$1$3.pu$2013 = function(pu_elt$2016){var funE$2025;
var v$2410 = null;
funE$2025 = (function(v$2411){return pickle$0pickle$1.con0$1988(v$2410,v$2411);
});
return pickle$0pickle$1.dataGen$1488(["OrderSet.Set",function(v$2237){return (v$2237 == null)?0:1;
},[funE$2025,[function(pu$2238){return pickle$0pickle$1.con1$2014(function(v$2239){return v$2239;
},function(v$2240){if (v$2240 == null) {basis$0General$1.print$163("Impossible.OrderSet.pu.N");
throw [basics$0ElabTopdec$1$3.en$Impossible$1190,"Impossible.OrderSet.pu.N"];
} else {return v$2240;
};
},pickle$0pickle$1.tup4Gen0$2377(pu_elt$2016,pu$2238,pu$2238,basics$0ElabTopdec$1$3.pu_bal$2012));
},null]]]);
};
return 0;
})();
