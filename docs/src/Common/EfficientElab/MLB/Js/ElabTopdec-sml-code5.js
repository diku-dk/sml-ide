if ((typeof(basics$0ElabTopdec$1$5)) == "undefined") {basics$0ElabTopdec$1$5 = {};
};
(function(){basics$0ElabTopdec$1$5.eq_bal$3485 = function(v$3487,v$3488){switch (v$3487) { case 0: {switch (v$3488) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$3488) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$3488) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
basics$0ElabTopdec$1$5.s$j$2593 = function(v$2598,v$2599){return basics$0ElabTopdec$1$4.lt$2554(v$2598,v$2599);
};
basics$0ElabTopdec$1$5.s$kk$2600 = function(v$2609,v$2610){return ((basics$0ElabTopdec$1$4.lt$2554(v$2609,v$2610))?true:(basics$0ElabTopdec$1$4.lt$2554(v$2610,v$2609)))?false:true;
};
basics$0ElabTopdec$1$5.en$Impossible$2611 = new String("Impossible");
basics$0ElabTopdec$1$5.impossible$2612 = function(s$2615){var s$2616 = "Impossible.OrderSet." + s$2615;
basis$0General$1.print$163(s$2616);
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,s$2616];
};
basics$0ElabTopdec$1$5.empty$2624 = null;
basics$0ElabTopdec$1$5.singleton$2625 = function(i$2628){return [i$2628,null,null,2];
};
var fix$3833 = {};
fix$3833.$size = function(v$2632){if (v$2632 == null) {return 0;
} else {var v$2639 = v$2632;
var v$2640 = v$2639[1];
var v$2641 = v$2639[2];
return SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(1 + (fix$3833.$size(v$2640)))) + (fix$3833.$size(v$2641)));
};
};
basics$0ElabTopdec$1$5.size$2629 = fix$3833.$size;
basics$0ElabTopdec$1$5.isEmpty$2642 = function(v$2645){return (v$2645 == null)?true:false;
};
basics$0ElabTopdec$1$5.member$2650 = function(i$2653,s$2656){var fix$3834 = {};
fix$3834.$search = function(v$2660){lab$search: while (true) {if (v$2660 == null) {return false;
} else {var v$2676 = v$2660;
var v$2677 = v$2676[0];
var v$2678 = v$2676[1];
var v$2679 = v$2676[2];
if (((basics$0ElabTopdec$1$4.lt$2554(i$2653,v$2677))?true:(basics$0ElabTopdec$1$4.lt$2554(v$2677,i$2653)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$4.lt$2554(i$2653,v$2677)) {var t$3835 = v$2678;
var v$2660 = t$3835;
continue lab$search;
} else {var t$3836 = v$2679;
var v$2660 = t$3836;
continue lab$search;
};
};
};
};
};
var search$2657 = fix$3834.$search;
return search$2657(s$2656);
};
basics$0ElabTopdec$1$5.eq$2680 = function(s1$2683,s2$2686){if ((basics$0ElabTopdec$1$5.size$2629(s1$2683)) == (basics$0ElabTopdec$1$5.size$2629(s2$2686))) {var fix$3837 = {};
fix$3837.$eq$ = function(v$2694){lab$eq$: while (true) {if (v$2694 == null) {return true;
} else {var v$2710 = v$2694;
var v$2711 = v$2710[0];
var v$2712 = v$2710[1];
var v$2713 = v$2710[2];
var t$3841;
var fix$3838 = {};
fix$3838.$search = function(v$3758){lab$search: while (true) {if (v$3758 == null) {return false;
} else {var v$3759 = v$3758;
var v$3760 = v$3759[0];
var v$3761 = v$3759[1];
var v$3762 = v$3759[2];
if (((basics$0ElabTopdec$1$4.lt$2554(v$2711,v$3760))?true:(basics$0ElabTopdec$1$4.lt$2554(v$3760,v$2711)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$4.lt$2554(v$2711,v$3760)) {var t$3839 = v$3761;
var v$3758 = t$3839;
continue lab$search;
} else {var t$3840 = v$3762;
var v$3758 = t$3840;
continue lab$search;
};
};
};
};
};
var search$3757 = fix$3838.$search;
t$3841 = (search$3757(s2$2686));
if (t$3841) {if (fix$3837.$eq$(v$2712)) {var t$3842 = v$2713;
var v$2694 = t$3842;
continue lab$eq$;
} else {return false;
};
} else {return false;
};
};
};
};
var eq$$2691 = fix$3837.$eq$;
return eq$$2691(s1$2683);
} else {return false;
};
};
basics$0ElabTopdec$1$5.en$ALREADYTHERE$2714 = new String("ALREADYTHERE");
basics$0ElabTopdec$1$5.exn$ALREADYTHERE$2714 = [basics$0ElabTopdec$1$5.en$ALREADYTHERE$2714];
basics$0ElabTopdec$1$5.insert$2715 = function(k0$2718,t$2721){var fix$3843 = {};
fix$3843.$ins = function(v$2725){if (v$2725 == null) {return [true,[k0$2718,null,null,2]];
} else {var v$2878 = v$2725;
var v$2879 = v$2878[0];
var v$2880 = v$2878[1];
var v$2881 = v$2878[2];
var v$2882 = v$2878[3];
if (((basics$0ElabTopdec$1$4.lt$2554(k0$2718,v$2879))?true:(basics$0ElabTopdec$1$4.lt$2554(v$2879,k0$2718)))?false:true) {throw basics$0ElabTopdec$1$5.exn$ALREADYTHERE$2714;
} else {if (basics$0ElabTopdec$1$4.lt$2554(k0$2718,v$2879)) {var v$2807 = fix$3843.$ins(v$2880);
var v$2808 = v$2807[0];
var v$2809 = v$2807[1];
switch (v$2882) { case 2: {return v$2808?[true,[v$2879,v$2809,v$2881,1]]:[false,[v$2879,v$2809,v$2881,2]];
 break; }case 0: {return v$2808?[false,[v$2879,v$2809,v$2881,2]]:[false,[v$2879,v$2809,v$2881,0]];
 break; }default: {if (v$2808) {var v$2795;
if (v$2809 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree01!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.empty tree01!"];
} else {v$2795 = v$2809;
};
var v$2796 = v$2795[0];
var v$2797 = v$2795[1];
var v$2798 = v$2795[2];
var v$2799 = v$2795[3];
var t$3846;
var v$3692 = 1;
switch (v$2799) { case 0: {switch (v$3692) { case 0: {t$3846 = true;
 break; }default: {t$3846 = false;
} };
 break; }case 1: {switch (v$3692) { case 1: {t$3846 = true;
 break; }default: {t$3846 = false;
} };
 break; }case 2: {switch (v$3692) { case 2: {t$3846 = true;
 break; }default: {t$3846 = false;
} };
 break; } };
if (t$3846) {return [false,[v$2796,v$2797,[v$2879,v$2798,v$2881,2],2]];
} else {var v$2783;
if (v$2798 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree02!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.empty tree02!"];
} else {v$2783 = v$2798;
};
var v$2784 = v$2783[0];
var v$2785 = v$2783[1];
var v$2786 = v$2783[2];
var v$2787 = v$2783[3];
var t$3864 = false;
var t$3863;
var t$3862;
var t$3861 = v$2784;
var t$3860;
var t$3859;
var t$3858 = v$2796;
var t$3857 = v$2797;
var t$3856 = v$2785;
var t$3855;
var t$3854;
var v$3696 = 0;
switch (v$2787) { case 0: {switch (v$3696) { case 0: {t$3854 = true;
 break; }default: {t$3854 = false;
} };
 break; }case 1: {switch (v$3696) { case 1: {t$3854 = true;
 break; }default: {t$3854 = false;
} };
 break; }case 2: {switch (v$3696) { case 2: {t$3854 = true;
 break; }default: {t$3854 = false;
} };
 break; } };
t$3855 = (t$3854?1:2);
t$3859 = [t$3858,t$3857,t$3856,t$3855];
t$3860 = t$3859;
var t$3853;
var t$3852;
var t$3851 = v$2879;
var t$3850 = v$2786;
var t$3849 = v$2881;
var t$3848;
var t$3847;
var v$3698 = 1;
switch (v$2787) { case 0: {switch (v$3698) { case 0: {t$3847 = true;
 break; }default: {t$3847 = false;
} };
 break; }case 1: {switch (v$3698) { case 1: {t$3847 = true;
 break; }default: {t$3847 = false;
} };
 break; }case 2: {switch (v$3698) { case 2: {t$3847 = true;
 break; }default: {t$3847 = false;
} };
 break; } };
t$3848 = (t$3847?0:2);
t$3852 = [t$3851,t$3850,t$3849,t$3848];
t$3853 = t$3852;
t$3862 = [t$3861,t$3860,t$3853,2];
t$3863 = t$3862;
return [t$3864,t$3863];
};
} else {return [false,[v$2879,v$2809,v$2881,1]];
};
} };
} else {var v$2875 = fix$3843.$ins(v$2881);
var v$2876 = v$2875[0];
var v$2877 = v$2875[1];
switch (v$2882) { case 2: {return v$2876?[true,[v$2879,v$2880,v$2877,0]]:[false,[v$2879,v$2880,v$2877,2]];
 break; }case 1: {return v$2876?[false,[v$2879,v$2880,v$2877,2]]:[false,[v$2879,v$2880,v$2877,1]];
 break; }default: {if (v$2876) {var v$2863;
if (v$2877 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree03!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.empty tree03!"];
} else {v$2863 = v$2877;
};
var v$2864 = v$2863[0];
var v$2865 = v$2863[1];
var v$2866 = v$2863[2];
var v$2867 = v$2863[3];
var t$3865;
var v$3704 = 0;
switch (v$2867) { case 0: {switch (v$3704) { case 0: {t$3865 = true;
 break; }default: {t$3865 = false;
} };
 break; }case 1: {switch (v$3704) { case 1: {t$3865 = true;
 break; }default: {t$3865 = false;
} };
 break; }case 2: {switch (v$3704) { case 2: {t$3865 = true;
 break; }default: {t$3865 = false;
} };
 break; } };
if (t$3865) {return [false,[v$2864,[v$2879,v$2880,v$2865,2],v$2866,2]];
} else {var v$2851;
if (v$2865 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree04!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.empty tree04!"];
} else {v$2851 = v$2865;
};
var v$2852 = v$2851[0];
var v$2853 = v$2851[1];
var v$2854 = v$2851[2];
var v$2855 = v$2851[3];
var t$3883 = false;
var t$3882;
var t$3881;
var t$3880 = v$2852;
var t$3879;
var t$3878;
var t$3877 = v$2879;
var t$3876 = v$2880;
var t$3875 = v$2853;
var t$3874;
var t$3873;
var v$3708 = 0;
switch (v$2855) { case 0: {switch (v$3708) { case 0: {t$3873 = true;
 break; }default: {t$3873 = false;
} };
 break; }case 1: {switch (v$3708) { case 1: {t$3873 = true;
 break; }default: {t$3873 = false;
} };
 break; }case 2: {switch (v$3708) { case 2: {t$3873 = true;
 break; }default: {t$3873 = false;
} };
 break; } };
t$3874 = (t$3873?1:2);
t$3878 = [t$3877,t$3876,t$3875,t$3874];
t$3879 = t$3878;
var t$3872;
var t$3871;
var t$3870 = v$2864;
var t$3869 = v$2854;
var t$3868 = v$2866;
var t$3867;
var t$3866;
var v$3710 = 1;
switch (v$2855) { case 0: {switch (v$3710) { case 0: {t$3866 = true;
 break; }default: {t$3866 = false;
} };
 break; }case 1: {switch (v$3710) { case 1: {t$3866 = true;
 break; }default: {t$3866 = false;
} };
 break; }case 2: {switch (v$3710) { case 2: {t$3866 = true;
 break; }default: {t$3866 = false;
} };
 break; } };
t$3867 = (t$3866?0:2);
t$3871 = [t$3870,t$3869,t$3868,t$3867];
t$3872 = t$3871;
t$3881 = [t$3880,t$3879,t$3872,2];
t$3882 = t$3881;
return [t$3883,t$3882];
};
} else {return [false,[v$2879,v$2880,v$2877,0]];
};
} };
};
};
};
};
var ins$2722 = fix$3843.$ins;
try {return (ins$2722(t$2721))[1];
} catch(v$3844) {return (function(ALREADYTHERE$2889){var t$3845 = ALREADYTHERE$2889;
if (t$3845[0] == basics$0ElabTopdec$1$5.en$ALREADYTHERE$2714) {return t$2721;
} else {throw ALREADYTHERE$2889;
};
})(v$3844);
};
};
basics$0ElabTopdec$1$5.list$2890 = function(s$2893){var fix$3884 = {};
fix$3884.$f = function(v$2897,v$2900){lab$f: while (true) {if (v$2897 == null) {return v$2900;
} else {var v$2912 = v$2897;
var v$2913 = v$2912[0];
var v$2914 = v$2912[1];
var v$2915 = v$2912[2];
var t$3885 = v$2914;
var t$3886 = [v$2913,fix$3884.$f(v$2915,v$2900)];
var v$2897 = t$3885;
var v$2900 = t$3886;
continue lab$f;
};
};
};
var f$2894 = fix$3884.$f;
return f$2894(s$2893,null);
};
var fix$3887 = {};
fix$3887.$fromList = function(l$2920){if (l$2920 == null) {return basics$0ElabTopdec$1$5.empty$2624;
} else {var v$2927 = l$2920;
var v$2928 = v$2927[0];
var v$2929 = v$2927[1];
return basics$0ElabTopdec$1$5.insert$2715(v$2928,fix$3887.$fromList(v$2929));
};
};
basics$0ElabTopdec$1$5.fromList$2917 = fix$3887.$fromList;
var fix$3888 = {};
fix$3888.$union = function(s1$2933,s2$2936){lab$union: while (true) {if (s2$2936 == null) {return s1$2933;
} else {var v$2944 = s2$2936;
var v$2945 = v$2944[0];
var v$2946 = v$2944[1];
var v$2947 = v$2944[2];
var t$3889 = fix$3888.$union(basics$0ElabTopdec$1$5.insert$2715(v$2945,s1$2933),v$2946);
var t$3890 = v$2947;
var s1$2933 = t$3889;
var s2$2936 = t$3890;
continue lab$union;
};
};
};
basics$0ElabTopdec$1$5.union$2930 = fix$3888.$union;
var fix$3891 = {};
fix$3891.$addList = function(v$2951,v$2954){lab$addList: while (true) {if (v$2951 == null) {return v$2954;
} else {var v$2965 = v$2951;
var v$2966 = v$2965[0];
var v$2967 = v$2965[1];
var t$3892 = v$2967;
var t$3893 = basics$0ElabTopdec$1$5.insert$2715(v$2966,v$2954);
var v$2951 = t$3892;
var v$2954 = t$3893;
continue lab$addList;
};
};
};
basics$0ElabTopdec$1$5.addList$2948 = fix$3891.$addList;
basics$0ElabTopdec$1$5.en$NOTFOUND$2969 = new String("NOTFOUND");
basics$0ElabTopdec$1$5.exn$NOTFOUND$2969 = [basics$0ElabTopdec$1$5.en$NOTFOUND$2969];
basics$0ElabTopdec$1$5.remove$2970 = function(k0$2973,t$2976){var balance1$2977 = function(v$2980){if (v$2980 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance1 on an empty tree)");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.(balance1 on an empty tree)"];
} else {var v$3045 = v$2980;
var v$3046 = v$3045[0];
var v$3047 = v$3045[1];
var v$3048 = v$3045[2];
switch (v$3045[3]) { case 1: {return [[v$3046,v$3047,v$3048,2],true];
 break; }case 2: {return [[v$3046,v$3047,v$3048,0],false];
 break; }default: {var v$3033;
if (v$3048 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree11!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.empty tree11!"];
} else {v$3033 = v$3048;
};
var v$3034 = v$3033[0];
var v$3035 = v$3033[1];
var v$3036 = v$3033[2];
switch (v$3033[3]) { case 1: {var v$3021;
if (v$3035 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree12!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.empty tree12!"];
} else {v$3021 = v$3035;
};
var v$3022 = v$3021[0];
var v$3023 = v$3021[1];
var v$3024 = v$3021[2];
var v$3025 = v$3021[3];
var t$3910;
var t$3909;
var t$3908 = v$3022;
var t$3907;
var t$3906;
var t$3905 = v$3046;
var t$3904 = v$3047;
var t$3903 = v$3023;
var t$3902;
var t$3901;
var v$3722 = 0;
switch (v$3025) { case 0: {switch (v$3722) { case 0: {t$3901 = true;
 break; }default: {t$3901 = false;
} };
 break; }case 1: {switch (v$3722) { case 1: {t$3901 = true;
 break; }default: {t$3901 = false;
} };
 break; }case 2: {switch (v$3722) { case 2: {t$3901 = true;
 break; }default: {t$3901 = false;
} };
 break; } };
t$3902 = (t$3901?1:2);
t$3906 = [t$3905,t$3904,t$3903,t$3902];
t$3907 = t$3906;
var t$3900;
var t$3899;
var t$3898 = v$3034;
var t$3897 = v$3024;
var t$3896 = v$3036;
var t$3895;
var t$3894;
var v$3724 = 1;
switch (v$3025) { case 0: {switch (v$3724) { case 0: {t$3894 = true;
 break; }default: {t$3894 = false;
} };
 break; }case 1: {switch (v$3724) { case 1: {t$3894 = true;
 break; }default: {t$3894 = false;
} };
 break; }case 2: {switch (v$3724) { case 2: {t$3894 = true;
 break; }default: {t$3894 = false;
} };
 break; } };
t$3895 = (t$3894?0:2);
t$3899 = [t$3898,t$3897,t$3896,t$3895];
t$3900 = t$3899;
t$3909 = [t$3908,t$3907,t$3900,2];
t$3910 = t$3909;
return [t$3910,true];
 break; }case 2: {return [[v$3034,[v$3046,v$3047,v$3035,0],v$3036,1],false];
 break; }default: {return [[v$3034,[v$3046,v$3047,v$3035,2],v$3036,2],true];
} };
} };
};
};
var balance2$3050 = function(v$3053){if (v$3053 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance2 on an empty tree)");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.(balance2 on an empty tree)"];
} else {var v$3118 = v$3053;
var v$3119 = v$3118[0];
var v$3120 = v$3118[1];
var v$3121 = v$3118[2];
switch (v$3118[3]) { case 0: {return [[v$3119,v$3120,v$3121,2],true];
 break; }case 2: {return [[v$3119,v$3120,v$3121,1],false];
 break; }default: {var v$3106;
if (v$3120 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree21!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.empty tree21!"];
} else {v$3106 = v$3120;
};
var v$3107 = v$3106[0];
var v$3108 = v$3106[1];
var v$3109 = v$3106[2];
switch (v$3106[3]) { case 0: {var v$3094;
if (v$3109 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree22!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.empty tree22!"];
} else {v$3094 = v$3109;
};
var v$3095 = v$3094[0];
var v$3096 = v$3094[1];
var v$3097 = v$3094[2];
var v$3098 = v$3094[3];
var t$3927;
var t$3926;
var t$3925 = v$3095;
var t$3924;
var t$3923;
var t$3922 = v$3107;
var t$3921 = v$3108;
var t$3920 = v$3096;
var t$3919;
var t$3918;
var v$3734 = 0;
switch (v$3098) { case 0: {switch (v$3734) { case 0: {t$3918 = true;
 break; }default: {t$3918 = false;
} };
 break; }case 1: {switch (v$3734) { case 1: {t$3918 = true;
 break; }default: {t$3918 = false;
} };
 break; }case 2: {switch (v$3734) { case 2: {t$3918 = true;
 break; }default: {t$3918 = false;
} };
 break; } };
t$3919 = (t$3918?1:2);
t$3923 = [t$3922,t$3921,t$3920,t$3919];
t$3924 = t$3923;
var t$3917;
var t$3916;
var t$3915 = v$3119;
var t$3914 = v$3097;
var t$3913 = v$3121;
var t$3912;
var t$3911;
var v$3732 = 1;
switch (v$3098) { case 0: {switch (v$3732) { case 0: {t$3911 = true;
 break; }default: {t$3911 = false;
} };
 break; }case 1: {switch (v$3732) { case 1: {t$3911 = true;
 break; }default: {t$3911 = false;
} };
 break; }case 2: {switch (v$3732) { case 2: {t$3911 = true;
 break; }default: {t$3911 = false;
} };
 break; } };
t$3912 = (t$3911?0:2);
t$3916 = [t$3915,t$3914,t$3913,t$3912];
t$3917 = t$3916;
t$3926 = [t$3925,t$3924,t$3917,2];
t$3927 = t$3926;
return [t$3927,true];
 break; }case 2: {return [[v$3107,v$3108,[v$3119,v$3109,v$3121,1],0],false];
 break; }default: {return [[v$3107,v$3108,[v$3119,v$3109,v$3121,2],2],true];
} };
} };
};
};
var fix$3928 = {};
fix$3928.$remove_rightmost = function(v$3126){if (v$3126 == null) {basis$0General$1.print$163("Impossible.OrderSet.(remove_rightmost on empty tree)");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.(remove_rightmost on empty tree)"];
} else {var v$3140 = v$3126;
var v$3141 = v$3140[2];
if (v$3141 == null) {return [v$3140[1],v$3140[0],true];
} else {var v$3163 = v$3140[0];
var v$3164 = v$3140[1];
var v$3165 = v$3140[3];
var v$3159 = fix$3928.$remove_rightmost(v$3141);
var v$3160 = v$3159[0];
var v$3161 = v$3159[1];
if (v$3159[2]) {var v$3156 = balance2$3050([v$3163,v$3164,v$3160,v$3165]);
return [v$3156[0],v$3161,v$3156[1]];
} else {return [[v$3163,v$3164,v$3160,v$3165],v$3161,false];
};
};
};
};
var remove_rightmost$3123 = fix$3928.$remove_rightmost;
var fix$3929 = {};
fix$3929.$del = function(v$3169){if (v$3169 == null) {throw basics$0ElabTopdec$1$5.exn$NOTFOUND$2969;
} else {var v$3226 = v$3169;
var v$3227 = v$3226[0];
var v$3228 = v$3226[1];
var v$3229 = v$3226[2];
var v$3230 = v$3226[3];
if (basics$0ElabTopdec$1$4.lt$2554(k0$2973,v$3227)) {var v$3189 = fix$3929.$del(v$3228);
var v$3190 = v$3189[0];
if (v$3189[1]) {return balance1$2977([v$3227,v$3190,v$3229,v$3230]);
} else {return [[v$3227,v$3190,v$3229,v$3230],false];
};
} else {if (basics$0ElabTopdec$1$4.lt$2554(v$3227,k0$2973)) {var v$3203 = fix$3929.$del(v$3229);
var v$3204 = v$3203[0];
if (v$3203[1]) {return balance2$3050([v$3227,v$3228,v$3204,v$3230]);
} else {return [[v$3227,v$3228,v$3204,v$3230],false];
};
} else {if (v$3229 == null) {return [v$3228,true];
} else {if (v$3228 == null) {return [v$3229,true];
} else {var v$3222 = remove_rightmost$3123(v$3228);
var v$3223 = v$3222[0];
var v$3224 = v$3222[1];
if (v$3222[2]) {return balance1$2977([v$3224,v$3223,v$3229,v$3230]);
} else {return [[v$3224,v$3223,v$3229,v$3230],false];
};
};
};
};
};
};
};
var del$3166 = fix$3929.$del;
try {return (del$3166(t$2976))[0];
} catch(v$3930) {return (function(NOTFOUND$3237){var t$3931 = NOTFOUND$3237;
if (t$3931[0] == basics$0ElabTopdec$1$5.en$NOTFOUND$2969) {return t$2976;
} else {throw NOTFOUND$3237;
};
})(v$3930);
};
};
var fix$3932 = {};
fix$3932.$difference = function(s1$3241,s2$3244){lab$difference: while (true) {if (s1$3241 == null) {return null;
} else {if (s2$3244 == null) {return s1$3241;
} else {var v$3256 = s2$3244;
var v$3257 = v$3256[0];
var v$3258 = v$3256[1];
var v$3259 = v$3256[2];
var t$3933 = fix$3932.$difference(basics$0ElabTopdec$1$5.remove$2970(v$3257,s1$3241),v$3258);
var t$3934 = v$3259;
var s1$3241 = t$3933;
var s2$3244 = t$3934;
continue lab$difference;
};
};
};
};
basics$0ElabTopdec$1$5.difference$3238 = fix$3932.$difference;
basics$0ElabTopdec$1$5.intersect$3260 = function(s1$3263,s2$3266){var fix$3935 = {};
fix$3935.$inters = function(v$3270,v$3273){lab$inters: while (true) {if (v$3270 == null) {return v$3273;
} else {var v$3289 = v$3270;
var v$3290 = v$3289[0];
var v$3291 = v$3289[1];
var v$3292 = v$3289[2];
var t$3944 = v$3291;
var t$3943;
var t$3942 = fix$3935.$inters;
var t$3941 = v$3292;
var t$3940;
var t$3939;
var fix$3936 = {};
fix$3936.$search = function(v$3796){lab$search: while (true) {if (v$3796 == null) {return false;
} else {var v$3797 = v$3796;
var v$3798 = v$3797[0];
var v$3799 = v$3797[1];
var v$3800 = v$3797[2];
if (((basics$0ElabTopdec$1$4.lt$2554(v$3290,v$3798))?true:(basics$0ElabTopdec$1$4.lt$2554(v$3798,v$3290)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$4.lt$2554(v$3290,v$3798)) {var t$3937 = v$3799;
var v$3796 = t$3937;
continue lab$search;
} else {var t$3938 = v$3800;
var v$3796 = t$3938;
continue lab$search;
};
};
};
};
};
var search$3795 = fix$3936.$search;
t$3939 = (search$3795(s2$3266));
t$3940 = (t$3939?(basics$0ElabTopdec$1$5.insert$2715(v$3290,v$3273)):v$3273);
t$3943 = (t$3942(t$3941,t$3940));
var t$3945 = t$3944;
var t$3946 = t$3943;
var v$3270 = t$3945;
var v$3273 = t$3946;
continue lab$inters;
};
};
};
var inters$3267 = fix$3935.$inters;
return inters$3267(s1$3263,basics$0ElabTopdec$1$5.empty$2624);
};
basics$0ElabTopdec$1$5.partition$3294 = function(f$3297,s$3300){var fix$3947 = {};
fix$3947.$g = function(v$3304,v$3307){lab$g: while (true) {if (v$3304 == null) {return v$3307;
} else {var v$3325 = v$3304;
var v$3326 = v$3325[0];
var v$3327 = v$3325[1];
var v$3328 = v$3325[2];
var v$3330 = v$3307[0];
var v$3331 = v$3307[1];
var b$3320 = (f$3297(v$3326))?[basics$0ElabTopdec$1$5.insert$2715(v$3326,v$3330),v$3331]:[v$3330,basics$0ElabTopdec$1$5.insert$2715(v$3326,v$3331)];
var t$3948 = v$3328;
var t$3949 = fix$3947.$g(v$3327,b$3320);
var v$3304 = t$3948;
var v$3307 = t$3949;
continue lab$g;
};
};
};
var g$3301 = fix$3947.$g;
return g$3301(s$3300,[basics$0ElabTopdec$1$5.empty$2624,basics$0ElabTopdec$1$5.empty$2624]);
};
basics$0ElabTopdec$1$5.fold$3332 = function(f$3335,e$3338,t$3341){var fix$3950 = {};
fix$3950.$fold$ = function(v$3345,v$3348){lab$fold$: while (true) {if (v$3345 == null) {return v$3348;
} else {var v$3360 = v$3345;
var v$3361 = v$3360[0];
var v$3362 = v$3360[1];
var v$3363 = v$3360[2];
var t$3951 = v$3363;
var t$3952 = (f$3335(v$3361))(fix$3950.$fold$(v$3362,v$3348));
var v$3345 = t$3951;
var v$3348 = t$3952;
continue lab$fold$;
};
};
};
var fold$$3342 = fix$3950.$fold$;
return fold$$3342(t$3341,e$3338);
};
basics$0ElabTopdec$1$5.listmap$3365 = function(v$3829,v$3830){return basis$0List$1.map$697(v$3829,v$3830);
};
basics$0ElabTopdec$1$5.map$3366 = function(f$3369,t$3372){var t$3960 = basics$0ElabTopdec$1$5.fromList$2917;
var t$3959;
var t$3958 = basis$0List$1.map$697;
var t$3957 = f$3369;
var t$3956;
var fix$3953 = {};
fix$3953.$f = function(v$3632,v$3633){lab$f: while (true) {if (v$3632 == null) {return v$3633;
} else {var v$3636 = v$3632;
var v$3637 = v$3636[0];
var v$3638 = v$3636[1];
var v$3639 = v$3636[2];
var t$3954 = v$3638;
var t$3955 = [v$3637,fix$3953.$f(v$3639,v$3633)];
var v$3632 = t$3954;
var v$3633 = t$3955;
continue lab$f;
};
};
};
var f$3631 = fix$3953.$f;
t$3956 = (f$3631(t$3372,null));
t$3959 = (t$3958(t$3957,t$3956));
return t$3960(t$3959);
};
basics$0ElabTopdec$1$5.subst$3373 = function(v$3385,v$3386){return function(s$3380){var t$3964;
var fix$3961 = {};
fix$3961.$search = function(v$3804){lab$search: while (true) {if (v$3804 == null) {return false;
} else {var v$3805 = v$3804;
var v$3806 = v$3805[0];
var v$3807 = v$3805[1];
var v$3808 = v$3805[2];
if (((basics$0ElabTopdec$1$4.lt$2554(v$3386,v$3806))?true:(basics$0ElabTopdec$1$4.lt$2554(v$3806,v$3386)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$4.lt$2554(v$3386,v$3806)) {var t$3962 = v$3807;
var v$3804 = t$3962;
continue lab$search;
} else {var t$3963 = v$3808;
var v$3804 = t$3963;
continue lab$search;
};
};
};
};
};
var search$3803 = fix$3961.$search;
t$3964 = (search$3803(s$3380));
if (t$3964) {return basics$0ElabTopdec$1$5.insert$2715(v$3385,basics$0ElabTopdec$1$5.remove$2970(v$3386,s$3380));
} else {return s$3380;
};
};
};
basics$0ElabTopdec$1$5.apply$3387 = function(f$3390,s$3393){var fix$3965 = {};
fix$3965.$appl = function(v$3397){lab$appl: while (true) {if (v$3397 == null) {return 0;
} else {var v$3409 = v$3397;
var v$3410 = v$3409[0];
var v$3411 = v$3409[1];
var v$3412 = v$3409[2];
fix$3965.$appl(v$3411);
f$3390(v$3410);
var t$3966 = v$3412;
var v$3397 = t$3966;
continue lab$appl;
};
};
};
var appl$3394 = fix$3965.$appl;
return appl$3394(s$3393);
};
basics$0ElabTopdec$1$5.layoutSet$3413 = function(v$3432,v$3431,v$3430){return function(layoutItem$3421){return function(s$3424){var t$3967;
var v$3428 = [0,v$3431];
var t$3974;
var t$3973 = basis$0List$1.map$697;
var t$3972 = layoutItem$3421;
var t$3971;
var fix$3968 = {};
fix$3968.$f = function(v$3643,v$3644){lab$f: while (true) {if (v$3643 == null) {return v$3644;
} else {var v$3647 = v$3643;
var v$3648 = v$3647[0];
var v$3649 = v$3647[1];
var v$3650 = v$3647[2];
var t$3969 = v$3649;
var t$3970 = [v$3648,fix$3968.$f(v$3650,v$3644)];
var v$3643 = t$3969;
var v$3644 = t$3970;
continue lab$f;
};
};
};
var f$3642 = fix$3968.$f;
t$3971 = (f$3642(s$3424,null));
t$3974 = (t$3973(t$3972,t$3971));
t$3967 = [t$3974,v$3428,v$3432,3,v$3430];
return [0,t$3967];
};
};
};
basics$0ElabTopdec$1$5.pu_bal$3433 = pickle$0pickle$1.enumGen$2158(function(v$3652){var v$3653 = v$3652[0];
var v$3654 = v$3652[1];
switch (v$3653) { case 0: {switch (v$3654) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$3654) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$3654) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderSet.bal",[1,[2,[0,null]]]]);
basics$0ElabTopdec$1$5.pu$3434 = function(pu_elt$3437){var funE$3446;
var v$3831 = null;
funE$3446 = (function(v$3832){return pickle$0pickle$1.con0$1988(v$3831,v$3832);
});
return pickle$0pickle$1.dataGen$1488(["OrderSet.Set",function(v$3658){return (v$3658 == null)?0:1;
},[funE$3446,[function(pu$3659){return pickle$0pickle$1.con1$2014(function(v$3660){return v$3660;
},function(v$3661){if (v$3661 == null) {basis$0General$1.print$163("Impossible.OrderSet.pu.N");
throw [basics$0ElabTopdec$1$5.en$Impossible$2611,"Impossible.OrderSet.pu.N"];
} else {return v$3661;
};
},pickle$0pickle$1.tup4Gen0$2377(pu_elt$3437,pu$3659,pu$3659,basics$0ElabTopdec$1$5.pu_bal$3433));
},null]]]);
};
return 0;
})();
