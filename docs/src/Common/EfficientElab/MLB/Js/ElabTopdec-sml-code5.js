if ((typeof(basics$0ElabTopdec$1$5)) == "undefined") {basics$0ElabTopdec$1$5 = {};
};
(function(){basics$0ElabTopdec$1$5.eq_bal$3511 = function(v$3513,v$3514){switch (v$3513) { case 0: {switch (v$3514) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$3514) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$3514) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
basics$0ElabTopdec$1$5.s$j$2619 = function(v$2624,v$2625){return basics$0ElabTopdec$1$4.lt$2580(v$2624,v$2625);
};
basics$0ElabTopdec$1$5.s$kk$2626 = function(v$2635,v$2636){return ((basics$0ElabTopdec$1$4.lt$2580(v$2635,v$2636))?true:(basics$0ElabTopdec$1$4.lt$2580(v$2636,v$2635)))?false:true;
};
basics$0ElabTopdec$1$5.en$Impossible$2637 = new String("Impossible");
basics$0ElabTopdec$1$5.impossible$2638 = function(s$2641){var s$2642 = "Impossible.OrderSet." + s$2641;
basis$0General$1.print$163(s$2642);
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,s$2642];
};
basics$0ElabTopdec$1$5.empty$2650 = null;
basics$0ElabTopdec$1$5.singleton$2651 = function(i$2654){return [i$2654,null,null,2];
};
var fix$3885 = {};
fix$3885.$size = function(v$2658){if (v$2658 == null) {return 0;
} else {var v$2665 = v$2658;
var v$2666 = v$2665[1];
var v$2667 = v$2665[2];
return SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(1 + (fix$3885.$size(v$2666)))) + (fix$3885.$size(v$2667)));
};
};
basics$0ElabTopdec$1$5.size$2655 = fix$3885.$size;
basics$0ElabTopdec$1$5.isEmpty$2668 = function(v$2671){return (v$2671 == null)?true:false;
};
basics$0ElabTopdec$1$5.member$2676 = function(i$2679,s$2682){var fix$3886 = {};
fix$3886.$search = function(v$2686){lab$search: while (true) {if (v$2686 == null) {return false;
} else {var v$2702 = v$2686;
var v$2703 = v$2702[0];
var v$2704 = v$2702[1];
var v$2705 = v$2702[2];
if (((basics$0ElabTopdec$1$4.lt$2580(i$2679,v$2703))?true:(basics$0ElabTopdec$1$4.lt$2580(v$2703,i$2679)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$4.lt$2580(i$2679,v$2703)) {var t$3887 = v$2704;
var v$2686 = t$3887;
continue lab$search;
} else {var t$3888 = v$2705;
var v$2686 = t$3888;
continue lab$search;
};
};
};
};
};
var search$2683 = fix$3886.$search;
return search$2683(s$2682);
};
basics$0ElabTopdec$1$5.eq$2706 = function(s1$2709,s2$2712){if ((basics$0ElabTopdec$1$5.size$2655(s1$2709)) == (basics$0ElabTopdec$1$5.size$2655(s2$2712))) {var fix$3889 = {};
fix$3889.$eq$ = function(v$2720){lab$eq$: while (true) {if (v$2720 == null) {return true;
} else {var v$2736 = v$2720;
var v$2737 = v$2736[0];
var v$2738 = v$2736[1];
var v$2739 = v$2736[2];
var t$3893;
var fix$3890 = {};
fix$3890.$search = function(v$3810){lab$search: while (true) {if (v$3810 == null) {return false;
} else {var v$3811 = v$3810;
var v$3812 = v$3811[0];
var v$3813 = v$3811[1];
var v$3814 = v$3811[2];
if (((basics$0ElabTopdec$1$4.lt$2580(v$2737,v$3812))?true:(basics$0ElabTopdec$1$4.lt$2580(v$3812,v$2737)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$4.lt$2580(v$2737,v$3812)) {var t$3891 = v$3813;
var v$3810 = t$3891;
continue lab$search;
} else {var t$3892 = v$3814;
var v$3810 = t$3892;
continue lab$search;
};
};
};
};
};
var search$3809 = fix$3890.$search;
t$3893 = (search$3809(s2$2712));
if (t$3893) {if (fix$3889.$eq$(v$2738)) {var t$3894 = v$2739;
var v$2720 = t$3894;
continue lab$eq$;
} else {return false;
};
} else {return false;
};
};
};
};
var eq$$2717 = fix$3889.$eq$;
return eq$$2717(s1$2709);
} else {return false;
};
};
basics$0ElabTopdec$1$5.en$ALREADYTHERE$2740 = new String("ALREADYTHERE");
basics$0ElabTopdec$1$5.exn$ALREADYTHERE$2740 = [basics$0ElabTopdec$1$5.en$ALREADYTHERE$2740];
basics$0ElabTopdec$1$5.insert$2741 = function(k0$2744,t$2747){var fix$3895 = {};
fix$3895.$ins = function(v$2751){if (v$2751 == null) {return [true,[k0$2744,null,null,2]];
} else {var v$2904 = v$2751;
var v$2905 = v$2904[0];
var v$2906 = v$2904[1];
var v$2907 = v$2904[2];
var v$2908 = v$2904[3];
if (((basics$0ElabTopdec$1$4.lt$2580(k0$2744,v$2905))?true:(basics$0ElabTopdec$1$4.lt$2580(v$2905,k0$2744)))?false:true) {throw basics$0ElabTopdec$1$5.exn$ALREADYTHERE$2740;
} else {if (basics$0ElabTopdec$1$4.lt$2580(k0$2744,v$2905)) {var v$2833 = fix$3895.$ins(v$2906);
var v$2834 = v$2833[0];
var v$2835 = v$2833[1];
switch (v$2908) { case 2: {return v$2834?[true,[v$2905,v$2835,v$2907,1]]:[false,[v$2905,v$2835,v$2907,2]];
 break; }case 0: {return v$2834?[false,[v$2905,v$2835,v$2907,2]]:[false,[v$2905,v$2835,v$2907,0]];
 break; }default: {if (v$2834) {var v$2821;
if (v$2835 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree01!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.empty tree01!"];
} else {v$2821 = v$2835;
};
var v$2822 = v$2821[0];
var v$2823 = v$2821[1];
var v$2824 = v$2821[2];
var v$2825 = v$2821[3];
var t$3898;
var v$3740 = 1;
switch (v$2825) { case 0: {switch (v$3740) { case 0: {t$3898 = true;
 break; }default: {t$3898 = false;
} };
 break; }case 1: {switch (v$3740) { case 1: {t$3898 = true;
 break; }default: {t$3898 = false;
} };
 break; }case 2: {switch (v$3740) { case 2: {t$3898 = true;
 break; }default: {t$3898 = false;
} };
 break; } };
if (t$3898) {return [false,[v$2822,v$2823,[v$2905,v$2824,v$2907,2],2]];
} else {var v$2809;
if (v$2824 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree02!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.empty tree02!"];
} else {v$2809 = v$2824;
};
var v$2810 = v$2809[0];
var v$2811 = v$2809[1];
var v$2812 = v$2809[2];
var v$2813 = v$2809[3];
var t$3916 = false;
var t$3915;
var t$3914;
var t$3913 = v$2810;
var t$3912;
var t$3911;
var t$3910 = v$2822;
var t$3909 = v$2823;
var t$3908 = v$2811;
var t$3907;
var t$3906;
var v$3744 = 0;
switch (v$2813) { case 0: {switch (v$3744) { case 0: {t$3906 = true;
 break; }default: {t$3906 = false;
} };
 break; }case 1: {switch (v$3744) { case 1: {t$3906 = true;
 break; }default: {t$3906 = false;
} };
 break; }case 2: {switch (v$3744) { case 2: {t$3906 = true;
 break; }default: {t$3906 = false;
} };
 break; } };
t$3907 = (t$3906?1:2);
t$3911 = [t$3910,t$3909,t$3908,t$3907];
t$3912 = t$3911;
var t$3905;
var t$3904;
var t$3903 = v$2905;
var t$3902 = v$2812;
var t$3901 = v$2907;
var t$3900;
var t$3899;
var v$3746 = 1;
switch (v$2813) { case 0: {switch (v$3746) { case 0: {t$3899 = true;
 break; }default: {t$3899 = false;
} };
 break; }case 1: {switch (v$3746) { case 1: {t$3899 = true;
 break; }default: {t$3899 = false;
} };
 break; }case 2: {switch (v$3746) { case 2: {t$3899 = true;
 break; }default: {t$3899 = false;
} };
 break; } };
t$3900 = (t$3899?0:2);
t$3904 = [t$3903,t$3902,t$3901,t$3900];
t$3905 = t$3904;
t$3914 = [t$3913,t$3912,t$3905,2];
t$3915 = t$3914;
return [t$3916,t$3915];
};
} else {return [false,[v$2905,v$2835,v$2907,1]];
};
} };
} else {var v$2901 = fix$3895.$ins(v$2907);
var v$2902 = v$2901[0];
var v$2903 = v$2901[1];
switch (v$2908) { case 2: {return v$2902?[true,[v$2905,v$2906,v$2903,0]]:[false,[v$2905,v$2906,v$2903,2]];
 break; }case 1: {return v$2902?[false,[v$2905,v$2906,v$2903,2]]:[false,[v$2905,v$2906,v$2903,1]];
 break; }default: {if (v$2902) {var v$2889;
if (v$2903 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree03!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.empty tree03!"];
} else {v$2889 = v$2903;
};
var v$2890 = v$2889[0];
var v$2891 = v$2889[1];
var v$2892 = v$2889[2];
var v$2893 = v$2889[3];
var t$3917;
var v$3752 = 0;
switch (v$2893) { case 0: {switch (v$3752) { case 0: {t$3917 = true;
 break; }default: {t$3917 = false;
} };
 break; }case 1: {switch (v$3752) { case 1: {t$3917 = true;
 break; }default: {t$3917 = false;
} };
 break; }case 2: {switch (v$3752) { case 2: {t$3917 = true;
 break; }default: {t$3917 = false;
} };
 break; } };
if (t$3917) {return [false,[v$2890,[v$2905,v$2906,v$2891,2],v$2892,2]];
} else {var v$2877;
if (v$2891 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree04!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.empty tree04!"];
} else {v$2877 = v$2891;
};
var v$2878 = v$2877[0];
var v$2879 = v$2877[1];
var v$2880 = v$2877[2];
var v$2881 = v$2877[3];
var t$3935 = false;
var t$3934;
var t$3933;
var t$3932 = v$2878;
var t$3931;
var t$3930;
var t$3929 = v$2905;
var t$3928 = v$2906;
var t$3927 = v$2879;
var t$3926;
var t$3925;
var v$3756 = 0;
switch (v$2881) { case 0: {switch (v$3756) { case 0: {t$3925 = true;
 break; }default: {t$3925 = false;
} };
 break; }case 1: {switch (v$3756) { case 1: {t$3925 = true;
 break; }default: {t$3925 = false;
} };
 break; }case 2: {switch (v$3756) { case 2: {t$3925 = true;
 break; }default: {t$3925 = false;
} };
 break; } };
t$3926 = (t$3925?1:2);
t$3930 = [t$3929,t$3928,t$3927,t$3926];
t$3931 = t$3930;
var t$3924;
var t$3923;
var t$3922 = v$2890;
var t$3921 = v$2880;
var t$3920 = v$2892;
var t$3919;
var t$3918;
var v$3758 = 1;
switch (v$2881) { case 0: {switch (v$3758) { case 0: {t$3918 = true;
 break; }default: {t$3918 = false;
} };
 break; }case 1: {switch (v$3758) { case 1: {t$3918 = true;
 break; }default: {t$3918 = false;
} };
 break; }case 2: {switch (v$3758) { case 2: {t$3918 = true;
 break; }default: {t$3918 = false;
} };
 break; } };
t$3919 = (t$3918?0:2);
t$3923 = [t$3922,t$3921,t$3920,t$3919];
t$3924 = t$3923;
t$3933 = [t$3932,t$3931,t$3924,2];
t$3934 = t$3933;
return [t$3935,t$3934];
};
} else {return [false,[v$2905,v$2906,v$2903,0]];
};
} };
};
};
};
};
var ins$2748 = fix$3895.$ins;
try {return (ins$2748(t$2747))[1];
} catch(v$3896) {return (function(ALREADYTHERE$2915){var t$3897 = ALREADYTHERE$2915;
if (t$3897[0] == basics$0ElabTopdec$1$5.en$ALREADYTHERE$2740) {return t$2747;
} else {throw ALREADYTHERE$2915;
};
})(v$3896);
};
};
basics$0ElabTopdec$1$5.list$2916 = function(s$2919){var fix$3936 = {};
fix$3936.$f = function(v$2923,v$2926){lab$f: while (true) {if (v$2923 == null) {return v$2926;
} else {var v$2938 = v$2923;
var v$2939 = v$2938[0];
var v$2940 = v$2938[1];
var v$2941 = v$2938[2];
var t$3937 = v$2940;
var t$3938 = [v$2939,fix$3936.$f(v$2941,v$2926)];
var v$2923 = t$3937;
var v$2926 = t$3938;
continue lab$f;
};
};
};
var f$2920 = fix$3936.$f;
return f$2920(s$2919,null);
};
var fix$3939 = {};
fix$3939.$fromList = function(l$2946){if (l$2946 == null) {return basics$0ElabTopdec$1$5.empty$2650;
} else {var v$2953 = l$2946;
var v$2954 = v$2953[0];
var v$2955 = v$2953[1];
return basics$0ElabTopdec$1$5.insert$2741(v$2954,fix$3939.$fromList(v$2955));
};
};
basics$0ElabTopdec$1$5.fromList$2943 = fix$3939.$fromList;
var fix$3940 = {};
fix$3940.$union = function(s1$2959,s2$2962){lab$union: while (true) {if (s2$2962 == null) {return s1$2959;
} else {var v$2970 = s2$2962;
var v$2971 = v$2970[0];
var v$2972 = v$2970[1];
var v$2973 = v$2970[2];
var t$3941 = fix$3940.$union(basics$0ElabTopdec$1$5.insert$2741(v$2971,s1$2959),v$2972);
var t$3942 = v$2973;
var s1$2959 = t$3941;
var s2$2962 = t$3942;
continue lab$union;
};
};
};
basics$0ElabTopdec$1$5.union$2956 = fix$3940.$union;
var fix$3943 = {};
fix$3943.$addList = function(v$2977,v$2980){lab$addList: while (true) {if (v$2977 == null) {return v$2980;
} else {var v$2991 = v$2977;
var v$2992 = v$2991[0];
var v$2993 = v$2991[1];
var t$3944 = v$2993;
var t$3945 = basics$0ElabTopdec$1$5.insert$2741(v$2992,v$2980);
var v$2977 = t$3944;
var v$2980 = t$3945;
continue lab$addList;
};
};
};
basics$0ElabTopdec$1$5.addList$2974 = fix$3943.$addList;
basics$0ElabTopdec$1$5.en$NOTFOUND$2995 = new String("NOTFOUND");
basics$0ElabTopdec$1$5.exn$NOTFOUND$2995 = [basics$0ElabTopdec$1$5.en$NOTFOUND$2995];
basics$0ElabTopdec$1$5.remove$2996 = function(k0$2999,t$3002){var balance1$3003 = function(v$3006){if (v$3006 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance1 on an empty tree)");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.(balance1 on an empty tree)"];
} else {var v$3071 = v$3006;
var v$3072 = v$3071[0];
var v$3073 = v$3071[1];
var v$3074 = v$3071[2];
switch (v$3071[3]) { case 1: {return [[v$3072,v$3073,v$3074,2],true];
 break; }case 2: {return [[v$3072,v$3073,v$3074,0],false];
 break; }default: {var v$3059;
if (v$3074 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree11!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.empty tree11!"];
} else {v$3059 = v$3074;
};
var v$3060 = v$3059[0];
var v$3061 = v$3059[1];
var v$3062 = v$3059[2];
switch (v$3059[3]) { case 1: {var v$3047;
if (v$3061 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree12!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.empty tree12!"];
} else {v$3047 = v$3061;
};
var v$3048 = v$3047[0];
var v$3049 = v$3047[1];
var v$3050 = v$3047[2];
var v$3051 = v$3047[3];
var t$3962;
var t$3961;
var t$3960 = v$3048;
var t$3959;
var t$3958;
var t$3957 = v$3072;
var t$3956 = v$3073;
var t$3955 = v$3049;
var t$3954;
var t$3953;
var v$3770 = 0;
switch (v$3051) { case 0: {switch (v$3770) { case 0: {t$3953 = true;
 break; }default: {t$3953 = false;
} };
 break; }case 1: {switch (v$3770) { case 1: {t$3953 = true;
 break; }default: {t$3953 = false;
} };
 break; }case 2: {switch (v$3770) { case 2: {t$3953 = true;
 break; }default: {t$3953 = false;
} };
 break; } };
t$3954 = (t$3953?1:2);
t$3958 = [t$3957,t$3956,t$3955,t$3954];
t$3959 = t$3958;
var t$3952;
var t$3951;
var t$3950 = v$3060;
var t$3949 = v$3050;
var t$3948 = v$3062;
var t$3947;
var t$3946;
var v$3772 = 1;
switch (v$3051) { case 0: {switch (v$3772) { case 0: {t$3946 = true;
 break; }default: {t$3946 = false;
} };
 break; }case 1: {switch (v$3772) { case 1: {t$3946 = true;
 break; }default: {t$3946 = false;
} };
 break; }case 2: {switch (v$3772) { case 2: {t$3946 = true;
 break; }default: {t$3946 = false;
} };
 break; } };
t$3947 = (t$3946?0:2);
t$3951 = [t$3950,t$3949,t$3948,t$3947];
t$3952 = t$3951;
t$3961 = [t$3960,t$3959,t$3952,2];
t$3962 = t$3961;
return [t$3962,true];
 break; }case 2: {return [[v$3060,[v$3072,v$3073,v$3061,0],v$3062,1],false];
 break; }default: {return [[v$3060,[v$3072,v$3073,v$3061,2],v$3062,2],true];
} };
} };
};
};
var balance2$3076 = function(v$3079){if (v$3079 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance2 on an empty tree)");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.(balance2 on an empty tree)"];
} else {var v$3144 = v$3079;
var v$3145 = v$3144[0];
var v$3146 = v$3144[1];
var v$3147 = v$3144[2];
switch (v$3144[3]) { case 0: {return [[v$3145,v$3146,v$3147,2],true];
 break; }case 2: {return [[v$3145,v$3146,v$3147,1],false];
 break; }default: {var v$3132;
if (v$3146 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree21!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.empty tree21!"];
} else {v$3132 = v$3146;
};
var v$3133 = v$3132[0];
var v$3134 = v$3132[1];
var v$3135 = v$3132[2];
switch (v$3132[3]) { case 0: {var v$3120;
if (v$3135 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree22!");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.empty tree22!"];
} else {v$3120 = v$3135;
};
var v$3121 = v$3120[0];
var v$3122 = v$3120[1];
var v$3123 = v$3120[2];
var v$3124 = v$3120[3];
var t$3979;
var t$3978;
var t$3977 = v$3121;
var t$3976;
var t$3975;
var t$3974 = v$3133;
var t$3973 = v$3134;
var t$3972 = v$3122;
var t$3971;
var t$3970;
var v$3782 = 0;
switch (v$3124) { case 0: {switch (v$3782) { case 0: {t$3970 = true;
 break; }default: {t$3970 = false;
} };
 break; }case 1: {switch (v$3782) { case 1: {t$3970 = true;
 break; }default: {t$3970 = false;
} };
 break; }case 2: {switch (v$3782) { case 2: {t$3970 = true;
 break; }default: {t$3970 = false;
} };
 break; } };
t$3971 = (t$3970?1:2);
t$3975 = [t$3974,t$3973,t$3972,t$3971];
t$3976 = t$3975;
var t$3969;
var t$3968;
var t$3967 = v$3145;
var t$3966 = v$3123;
var t$3965 = v$3147;
var t$3964;
var t$3963;
var v$3780 = 1;
switch (v$3124) { case 0: {switch (v$3780) { case 0: {t$3963 = true;
 break; }default: {t$3963 = false;
} };
 break; }case 1: {switch (v$3780) { case 1: {t$3963 = true;
 break; }default: {t$3963 = false;
} };
 break; }case 2: {switch (v$3780) { case 2: {t$3963 = true;
 break; }default: {t$3963 = false;
} };
 break; } };
t$3964 = (t$3963?0:2);
t$3968 = [t$3967,t$3966,t$3965,t$3964];
t$3969 = t$3968;
t$3978 = [t$3977,t$3976,t$3969,2];
t$3979 = t$3978;
return [t$3979,true];
 break; }case 2: {return [[v$3133,v$3134,[v$3145,v$3135,v$3147,1],0],false];
 break; }default: {return [[v$3133,v$3134,[v$3145,v$3135,v$3147,2],2],true];
} };
} };
};
};
var fix$3980 = {};
fix$3980.$remove_rightmost = function(v$3152){if (v$3152 == null) {basis$0General$1.print$163("Impossible.OrderSet.(remove_rightmost on empty tree)");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.(remove_rightmost on empty tree)"];
} else {var v$3166 = v$3152;
var v$3167 = v$3166[2];
if (v$3167 == null) {return [v$3166[1],v$3166[0],true];
} else {var v$3189 = v$3166[0];
var v$3190 = v$3166[1];
var v$3191 = v$3166[3];
var v$3185 = fix$3980.$remove_rightmost(v$3167);
var v$3186 = v$3185[0];
var v$3187 = v$3185[1];
if (v$3185[2]) {var v$3182 = balance2$3076([v$3189,v$3190,v$3186,v$3191]);
return [v$3182[0],v$3187,v$3182[1]];
} else {return [[v$3189,v$3190,v$3186,v$3191],v$3187,false];
};
};
};
};
var remove_rightmost$3149 = fix$3980.$remove_rightmost;
var fix$3981 = {};
fix$3981.$del = function(v$3195){if (v$3195 == null) {throw basics$0ElabTopdec$1$5.exn$NOTFOUND$2995;
} else {var v$3252 = v$3195;
var v$3253 = v$3252[0];
var v$3254 = v$3252[1];
var v$3255 = v$3252[2];
var v$3256 = v$3252[3];
if (basics$0ElabTopdec$1$4.lt$2580(k0$2999,v$3253)) {var v$3215 = fix$3981.$del(v$3254);
var v$3216 = v$3215[0];
if (v$3215[1]) {return balance1$3003([v$3253,v$3216,v$3255,v$3256]);
} else {return [[v$3253,v$3216,v$3255,v$3256],false];
};
} else {if (basics$0ElabTopdec$1$4.lt$2580(v$3253,k0$2999)) {var v$3229 = fix$3981.$del(v$3255);
var v$3230 = v$3229[0];
if (v$3229[1]) {return balance2$3076([v$3253,v$3254,v$3230,v$3256]);
} else {return [[v$3253,v$3254,v$3230,v$3256],false];
};
} else {if (v$3255 == null) {return [v$3254,true];
} else {if (v$3254 == null) {return [v$3255,true];
} else {var v$3248 = remove_rightmost$3149(v$3254);
var v$3249 = v$3248[0];
var v$3250 = v$3248[1];
if (v$3248[2]) {return balance1$3003([v$3250,v$3249,v$3255,v$3256]);
} else {return [[v$3250,v$3249,v$3255,v$3256],false];
};
};
};
};
};
};
};
var del$3192 = fix$3981.$del;
try {return (del$3192(t$3002))[0];
} catch(v$3982) {return (function(NOTFOUND$3263){var t$3983 = NOTFOUND$3263;
if (t$3983[0] == basics$0ElabTopdec$1$5.en$NOTFOUND$2995) {return t$3002;
} else {throw NOTFOUND$3263;
};
})(v$3982);
};
};
var fix$3984 = {};
fix$3984.$difference = function(s1$3267,s2$3270){lab$difference: while (true) {if (s1$3267 == null) {return null;
} else {if (s2$3270 == null) {return s1$3267;
} else {var v$3282 = s2$3270;
var v$3283 = v$3282[0];
var v$3284 = v$3282[1];
var v$3285 = v$3282[2];
var t$3985 = fix$3984.$difference(basics$0ElabTopdec$1$5.remove$2996(v$3283,s1$3267),v$3284);
var t$3986 = v$3285;
var s1$3267 = t$3985;
var s2$3270 = t$3986;
continue lab$difference;
};
};
};
};
basics$0ElabTopdec$1$5.difference$3264 = fix$3984.$difference;
basics$0ElabTopdec$1$5.intersect$3286 = function(s1$3289,s2$3292){var fix$3987 = {};
fix$3987.$inters = function(v$3296,v$3299){lab$inters: while (true) {if (v$3296 == null) {return v$3299;
} else {var v$3315 = v$3296;
var v$3316 = v$3315[0];
var v$3317 = v$3315[1];
var v$3318 = v$3315[2];
var t$3996 = v$3317;
var t$3995;
var t$3994 = fix$3987.$inters;
var t$3993 = v$3318;
var t$3992;
var t$3991;
var fix$3988 = {};
fix$3988.$search = function(v$3848){lab$search: while (true) {if (v$3848 == null) {return false;
} else {var v$3849 = v$3848;
var v$3850 = v$3849[0];
var v$3851 = v$3849[1];
var v$3852 = v$3849[2];
if (((basics$0ElabTopdec$1$4.lt$2580(v$3316,v$3850))?true:(basics$0ElabTopdec$1$4.lt$2580(v$3850,v$3316)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$4.lt$2580(v$3316,v$3850)) {var t$3989 = v$3851;
var v$3848 = t$3989;
continue lab$search;
} else {var t$3990 = v$3852;
var v$3848 = t$3990;
continue lab$search;
};
};
};
};
};
var search$3847 = fix$3988.$search;
t$3991 = (search$3847(s2$3292));
t$3992 = (t$3991?(basics$0ElabTopdec$1$5.insert$2741(v$3316,v$3299)):v$3299);
t$3995 = (t$3994(t$3993,t$3992));
var t$3997 = t$3996;
var t$3998 = t$3995;
var v$3296 = t$3997;
var v$3299 = t$3998;
continue lab$inters;
};
};
};
var inters$3293 = fix$3987.$inters;
return inters$3293(s1$3289,basics$0ElabTopdec$1$5.empty$2650);
};
basics$0ElabTopdec$1$5.partition$3320 = function(f$3323,s$3326){var fix$3999 = {};
fix$3999.$g = function(v$3330,v$3333){lab$g: while (true) {if (v$3330 == null) {return v$3333;
} else {var v$3351 = v$3330;
var v$3352 = v$3351[0];
var v$3353 = v$3351[1];
var v$3354 = v$3351[2];
var v$3356 = v$3333[0];
var v$3357 = v$3333[1];
var b$3346 = (f$3323(v$3352))?[basics$0ElabTopdec$1$5.insert$2741(v$3352,v$3356),v$3357]:[v$3356,basics$0ElabTopdec$1$5.insert$2741(v$3352,v$3357)];
var t$4000 = v$3354;
var t$4001 = fix$3999.$g(v$3353,b$3346);
var v$3330 = t$4000;
var v$3333 = t$4001;
continue lab$g;
};
};
};
var g$3327 = fix$3999.$g;
return g$3327(s$3326,[basics$0ElabTopdec$1$5.empty$2650,basics$0ElabTopdec$1$5.empty$2650]);
};
basics$0ElabTopdec$1$5.fold$3358 = function(f$3361,e$3364,t$3367){var fix$4002 = {};
fix$4002.$fold$ = function(v$3371,v$3374){lab$fold$: while (true) {if (v$3371 == null) {return v$3374;
} else {var v$3386 = v$3371;
var v$3387 = v$3386[0];
var v$3388 = v$3386[1];
var v$3389 = v$3386[2];
var t$4003 = v$3389;
var t$4004 = (f$3361(v$3387))(fix$4002.$fold$(v$3388,v$3374));
var v$3371 = t$4003;
var v$3374 = t$4004;
continue lab$fold$;
};
};
};
var fold$$3368 = fix$4002.$fold$;
return fold$$3368(t$3367,e$3364);
};
basics$0ElabTopdec$1$5.listmap$3391 = function(v$3881,v$3882){return basis$0List$1.map$697(v$3881,v$3882);
};
basics$0ElabTopdec$1$5.map$3392 = function(f$3395,t$3398){var t$4012 = basics$0ElabTopdec$1$5.fromList$2943;
var t$4011;
var t$4010 = basis$0List$1.map$697;
var t$4009 = f$3395;
var t$4008;
var fix$4005 = {};
fix$4005.$f = function(v$3658,v$3659){lab$f: while (true) {if (v$3658 == null) {return v$3659;
} else {var v$3662 = v$3658;
var v$3663 = v$3662[0];
var v$3664 = v$3662[1];
var v$3665 = v$3662[2];
var t$4006 = v$3664;
var t$4007 = [v$3663,fix$4005.$f(v$3665,v$3659)];
var v$3658 = t$4006;
var v$3659 = t$4007;
continue lab$f;
};
};
};
var f$3657 = fix$4005.$f;
t$4008 = (f$3657(t$3398,null));
t$4011 = (t$4010(t$4009,t$4008));
return t$4012(t$4011);
};
basics$0ElabTopdec$1$5.subst$3399 = function(v$3411,v$3412){return function(s$3406){var t$4016;
var fix$4013 = {};
fix$4013.$search = function(v$3856){lab$search: while (true) {if (v$3856 == null) {return false;
} else {var v$3857 = v$3856;
var v$3858 = v$3857[0];
var v$3859 = v$3857[1];
var v$3860 = v$3857[2];
if (((basics$0ElabTopdec$1$4.lt$2580(v$3412,v$3858))?true:(basics$0ElabTopdec$1$4.lt$2580(v$3858,v$3412)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$4.lt$2580(v$3412,v$3858)) {var t$4014 = v$3859;
var v$3856 = t$4014;
continue lab$search;
} else {var t$4015 = v$3860;
var v$3856 = t$4015;
continue lab$search;
};
};
};
};
};
var search$3855 = fix$4013.$search;
t$4016 = (search$3855(s$3406));
if (t$4016) {return basics$0ElabTopdec$1$5.insert$2741(v$3411,basics$0ElabTopdec$1$5.remove$2996(v$3412,s$3406));
} else {return s$3406;
};
};
};
basics$0ElabTopdec$1$5.apply$3413 = function(f$3416,s$3419){var fix$4017 = {};
fix$4017.$appl = function(v$3423){lab$appl: while (true) {if (v$3423 == null) {return 0;
} else {var v$3435 = v$3423;
var v$3436 = v$3435[0];
var v$3437 = v$3435[1];
var v$3438 = v$3435[2];
fix$4017.$appl(v$3437);
f$3416(v$3436);
var t$4018 = v$3438;
var v$3423 = t$4018;
continue lab$appl;
};
};
};
var appl$3420 = fix$4017.$appl;
return appl$3420(s$3419);
};
basics$0ElabTopdec$1$5.layoutSet$3439 = function(v$3458,v$3457,v$3456){return function(layoutItem$3447){return function(s$3450){var t$4019;
var v$3454 = [0,v$3457];
var t$4026;
var t$4025 = basis$0List$1.map$697;
var t$4024 = layoutItem$3447;
var t$4023;
var fix$4020 = {};
fix$4020.$f = function(v$3669,v$3670){lab$f: while (true) {if (v$3669 == null) {return v$3670;
} else {var v$3673 = v$3669;
var v$3674 = v$3673[0];
var v$3675 = v$3673[1];
var v$3676 = v$3673[2];
var t$4021 = v$3675;
var t$4022 = [v$3674,fix$4020.$f(v$3676,v$3670)];
var v$3669 = t$4021;
var v$3670 = t$4022;
continue lab$f;
};
};
};
var f$3668 = fix$4020.$f;
t$4023 = (f$3668(s$3450,null));
t$4026 = (t$4025(t$4024,t$4023));
t$4019 = [t$4026,v$3454,v$3458,3,v$3456];
return [0,t$4019];
};
};
};
basics$0ElabTopdec$1$5.pu_bal$3459 = pickle$0pickle$1.enumGen$2158(function(v$3678){var v$3679 = v$3678[0];
var v$3680 = v$3678[1];
switch (v$3679) { case 0: {switch (v$3680) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$3680) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$3680) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderSet.bal",[1,[2,[0,null]]]]);
basics$0ElabTopdec$1$5.pu$3460 = function(pu_elt$3463){var funE$3472;
var v$3883 = null;
funE$3472 = (function(v$3884){return pickle$0pickle$1.con0$1988(v$3883,v$3884);
});
return pickle$0pickle$1.dataGen$1488(["OrderSet.Set",function(v$3695){return (v$3695 == null)?0:1;
},[funE$3472,[function(pu$3696){return pickle$0pickle$1.con1$2014(function(v$3697){return v$3697;
},function(v$3698){if (v$3698 == null) {basis$0General$1.print$163("Impossible.OrderSet.pu.N");
throw [basics$0ElabTopdec$1$5.en$Impossible$2637,"Impossible.OrderSet.pu.N"];
} else {return v$3698;
};
},(pickle$0pickle$1.convert0$2299(function(v$3707){var v$3708 = v$3707[0];
var v$3709 = v$3708[0];
var v$3710 = v$3708[1];
var v$3711 = v$3707[1];
return [v$3709,v$3710,v$3711[0],v$3711[1]];
},function(v$3712){return [[v$3712[0],v$3712[1]],[v$3712[2],v$3712[3]]];
}))(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.pairGen0$983(pu_elt$3463,pu$3696),pickle$0pickle$1.pairGen0$983(pu$3696,basics$0ElabTopdec$1$5.pu_bal$3459))));
},null]]]);
};
return 0;
})();
