if ((typeof(basics$0ElabTopdec$1$7)) == "undefined") {basics$0ElabTopdec$1$7 = {};
};
(function(){basics$0ElabTopdec$1$7.eq_bal$4958 = function(v$4960,v$4961){switch (v$4960) { case 0: {switch (v$4961) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4961) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4961) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
basics$0ElabTopdec$1$7.s$j$4066 = function(v$4071,v$4072){return basics$0ElabTopdec$1$6.lt$4027(v$4071,v$4072);
};
basics$0ElabTopdec$1$7.s$kk$4073 = function(v$4082,v$4083){return ((basics$0ElabTopdec$1$6.lt$4027(v$4082,v$4083))?true:(basics$0ElabTopdec$1$6.lt$4027(v$4083,v$4082)))?false:true;
};
basics$0ElabTopdec$1$7.en$Impossible$4084 = new String("Impossible");
basics$0ElabTopdec$1$7.impossible$4085 = function(s$4088){var s$4089 = "Impossible.OrderSet." + s$4088;
basis$0General$1.print$163(s$4089);
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,s$4089];
};
basics$0ElabTopdec$1$7.empty$4097 = null;
basics$0ElabTopdec$1$7.singleton$4098 = function(i$4101){return [i$4101,null,null,2];
};
var fix$5332 = {};
fix$5332.$size = function(v$4105){if (v$4105 == null) {return 0;
} else {var v$4112 = v$4105;
var v$4113 = v$4112[1];
var v$4114 = v$4112[2];
return SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(1 + (fix$5332.$size(v$4113)))) + (fix$5332.$size(v$4114)));
};
};
basics$0ElabTopdec$1$7.size$4102 = fix$5332.$size;
basics$0ElabTopdec$1$7.isEmpty$4115 = function(v$4118){return (v$4118 == null)?true:false;
};
basics$0ElabTopdec$1$7.member$4123 = function(i$4126,s$4129){var fix$5333 = {};
fix$5333.$search = function(v$4133){lab$search: while (true) {if (v$4133 == null) {return false;
} else {var v$4149 = v$4133;
var v$4150 = v$4149[0];
var v$4151 = v$4149[1];
var v$4152 = v$4149[2];
if (((basics$0ElabTopdec$1$6.lt$4027(i$4126,v$4150))?true:(basics$0ElabTopdec$1$6.lt$4027(v$4150,i$4126)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$6.lt$4027(i$4126,v$4150)) {var t$5334 = v$4151;
var v$4133 = t$5334;
continue lab$search;
} else {var t$5335 = v$4152;
var v$4133 = t$5335;
continue lab$search;
};
};
};
};
};
var search$4130 = fix$5333.$search;
return search$4130(s$4129);
};
basics$0ElabTopdec$1$7.eq$4153 = function(s1$4156,s2$4159){if ((basics$0ElabTopdec$1$7.size$4102(s1$4156)) == (basics$0ElabTopdec$1$7.size$4102(s2$4159))) {var fix$5336 = {};
fix$5336.$eq$ = function(v$4167){lab$eq$: while (true) {if (v$4167 == null) {return true;
} else {var v$4183 = v$4167;
var v$4184 = v$4183[0];
var v$4185 = v$4183[1];
var v$4186 = v$4183[2];
var t$5340;
var fix$5337 = {};
fix$5337.$search = function(v$5257){lab$search: while (true) {if (v$5257 == null) {return false;
} else {var v$5258 = v$5257;
var v$5259 = v$5258[0];
var v$5260 = v$5258[1];
var v$5261 = v$5258[2];
if (((basics$0ElabTopdec$1$6.lt$4027(v$4184,v$5259))?true:(basics$0ElabTopdec$1$6.lt$4027(v$5259,v$4184)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$6.lt$4027(v$4184,v$5259)) {var t$5338 = v$5260;
var v$5257 = t$5338;
continue lab$search;
} else {var t$5339 = v$5261;
var v$5257 = t$5339;
continue lab$search;
};
};
};
};
};
var search$5256 = fix$5337.$search;
t$5340 = (search$5256(s2$4159));
if (t$5340) {if (fix$5336.$eq$(v$4185)) {var t$5341 = v$4186;
var v$4167 = t$5341;
continue lab$eq$;
} else {return false;
};
} else {return false;
};
};
};
};
var eq$$4164 = fix$5336.$eq$;
return eq$$4164(s1$4156);
} else {return false;
};
};
basics$0ElabTopdec$1$7.en$ALREADYTHERE$4187 = new String("ALREADYTHERE");
basics$0ElabTopdec$1$7.exn$ALREADYTHERE$4187 = [basics$0ElabTopdec$1$7.en$ALREADYTHERE$4187];
basics$0ElabTopdec$1$7.insert$4188 = function(k0$4191,t$4194){var fix$5342 = {};
fix$5342.$ins = function(v$4198){if (v$4198 == null) {return [true,[k0$4191,null,null,2]];
} else {var v$4351 = v$4198;
var v$4352 = v$4351[0];
var v$4353 = v$4351[1];
var v$4354 = v$4351[2];
var v$4355 = v$4351[3];
if (((basics$0ElabTopdec$1$6.lt$4027(k0$4191,v$4352))?true:(basics$0ElabTopdec$1$6.lt$4027(v$4352,k0$4191)))?false:true) {throw basics$0ElabTopdec$1$7.exn$ALREADYTHERE$4187;
} else {if (basics$0ElabTopdec$1$6.lt$4027(k0$4191,v$4352)) {var v$4280 = fix$5342.$ins(v$4353);
var v$4281 = v$4280[0];
var v$4282 = v$4280[1];
switch (v$4355) { case 2: {return v$4281?[true,[v$4352,v$4282,v$4354,1]]:[false,[v$4352,v$4282,v$4354,2]];
 break; }case 0: {return v$4281?[false,[v$4352,v$4282,v$4354,2]]:[false,[v$4352,v$4282,v$4354,0]];
 break; }default: {if (v$4281) {var v$4268;
if (v$4282 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree01!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.empty tree01!"];
} else {v$4268 = v$4282;
};
var v$4269 = v$4268[0];
var v$4270 = v$4268[1];
var v$4271 = v$4268[2];
var v$4272 = v$4268[3];
var t$5345;
var v$5187 = 1;
switch (v$4272) { case 0: {switch (v$5187) { case 0: {t$5345 = true;
 break; }default: {t$5345 = false;
} };
 break; }case 1: {switch (v$5187) { case 1: {t$5345 = true;
 break; }default: {t$5345 = false;
} };
 break; }case 2: {switch (v$5187) { case 2: {t$5345 = true;
 break; }default: {t$5345 = false;
} };
 break; } };
if (t$5345) {return [false,[v$4269,v$4270,[v$4352,v$4271,v$4354,2],2]];
} else {var v$4256;
if (v$4271 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree02!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.empty tree02!"];
} else {v$4256 = v$4271;
};
var v$4257 = v$4256[0];
var v$4258 = v$4256[1];
var v$4259 = v$4256[2];
var v$4260 = v$4256[3];
var t$5363 = false;
var t$5362;
var t$5361;
var t$5360 = v$4257;
var t$5359;
var t$5358;
var t$5357 = v$4269;
var t$5356 = v$4270;
var t$5355 = v$4258;
var t$5354;
var t$5353;
var v$5191 = 0;
switch (v$4260) { case 0: {switch (v$5191) { case 0: {t$5353 = true;
 break; }default: {t$5353 = false;
} };
 break; }case 1: {switch (v$5191) { case 1: {t$5353 = true;
 break; }default: {t$5353 = false;
} };
 break; }case 2: {switch (v$5191) { case 2: {t$5353 = true;
 break; }default: {t$5353 = false;
} };
 break; } };
t$5354 = (t$5353?1:2);
t$5358 = [t$5357,t$5356,t$5355,t$5354];
t$5359 = t$5358;
var t$5352;
var t$5351;
var t$5350 = v$4352;
var t$5349 = v$4259;
var t$5348 = v$4354;
var t$5347;
var t$5346;
var v$5193 = 1;
switch (v$4260) { case 0: {switch (v$5193) { case 0: {t$5346 = true;
 break; }default: {t$5346 = false;
} };
 break; }case 1: {switch (v$5193) { case 1: {t$5346 = true;
 break; }default: {t$5346 = false;
} };
 break; }case 2: {switch (v$5193) { case 2: {t$5346 = true;
 break; }default: {t$5346 = false;
} };
 break; } };
t$5347 = (t$5346?0:2);
t$5351 = [t$5350,t$5349,t$5348,t$5347];
t$5352 = t$5351;
t$5361 = [t$5360,t$5359,t$5352,2];
t$5362 = t$5361;
return [t$5363,t$5362];
};
} else {return [false,[v$4352,v$4282,v$4354,1]];
};
} };
} else {var v$4348 = fix$5342.$ins(v$4354);
var v$4349 = v$4348[0];
var v$4350 = v$4348[1];
switch (v$4355) { case 2: {return v$4349?[true,[v$4352,v$4353,v$4350,0]]:[false,[v$4352,v$4353,v$4350,2]];
 break; }case 1: {return v$4349?[false,[v$4352,v$4353,v$4350,2]]:[false,[v$4352,v$4353,v$4350,1]];
 break; }default: {if (v$4349) {var v$4336;
if (v$4350 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree03!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.empty tree03!"];
} else {v$4336 = v$4350;
};
var v$4337 = v$4336[0];
var v$4338 = v$4336[1];
var v$4339 = v$4336[2];
var v$4340 = v$4336[3];
var t$5364;
var v$5199 = 0;
switch (v$4340) { case 0: {switch (v$5199) { case 0: {t$5364 = true;
 break; }default: {t$5364 = false;
} };
 break; }case 1: {switch (v$5199) { case 1: {t$5364 = true;
 break; }default: {t$5364 = false;
} };
 break; }case 2: {switch (v$5199) { case 2: {t$5364 = true;
 break; }default: {t$5364 = false;
} };
 break; } };
if (t$5364) {return [false,[v$4337,[v$4352,v$4353,v$4338,2],v$4339,2]];
} else {var v$4324;
if (v$4338 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree04!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.empty tree04!"];
} else {v$4324 = v$4338;
};
var v$4325 = v$4324[0];
var v$4326 = v$4324[1];
var v$4327 = v$4324[2];
var v$4328 = v$4324[3];
var t$5382 = false;
var t$5381;
var t$5380;
var t$5379 = v$4325;
var t$5378;
var t$5377;
var t$5376 = v$4352;
var t$5375 = v$4353;
var t$5374 = v$4326;
var t$5373;
var t$5372;
var v$5203 = 0;
switch (v$4328) { case 0: {switch (v$5203) { case 0: {t$5372 = true;
 break; }default: {t$5372 = false;
} };
 break; }case 1: {switch (v$5203) { case 1: {t$5372 = true;
 break; }default: {t$5372 = false;
} };
 break; }case 2: {switch (v$5203) { case 2: {t$5372 = true;
 break; }default: {t$5372 = false;
} };
 break; } };
t$5373 = (t$5372?1:2);
t$5377 = [t$5376,t$5375,t$5374,t$5373];
t$5378 = t$5377;
var t$5371;
var t$5370;
var t$5369 = v$4337;
var t$5368 = v$4327;
var t$5367 = v$4339;
var t$5366;
var t$5365;
var v$5205 = 1;
switch (v$4328) { case 0: {switch (v$5205) { case 0: {t$5365 = true;
 break; }default: {t$5365 = false;
} };
 break; }case 1: {switch (v$5205) { case 1: {t$5365 = true;
 break; }default: {t$5365 = false;
} };
 break; }case 2: {switch (v$5205) { case 2: {t$5365 = true;
 break; }default: {t$5365 = false;
} };
 break; } };
t$5366 = (t$5365?0:2);
t$5370 = [t$5369,t$5368,t$5367,t$5366];
t$5371 = t$5370;
t$5380 = [t$5379,t$5378,t$5371,2];
t$5381 = t$5380;
return [t$5382,t$5381];
};
} else {return [false,[v$4352,v$4353,v$4350,0]];
};
} };
};
};
};
};
var ins$4195 = fix$5342.$ins;
try {return (ins$4195(t$4194))[1];
} catch(v$5343) {return (function(ALREADYTHERE$4362){var t$5344 = ALREADYTHERE$4362;
if (t$5344[0] == basics$0ElabTopdec$1$7.en$ALREADYTHERE$4187) {return t$4194;
} else {throw ALREADYTHERE$4362;
};
})(v$5343);
};
};
basics$0ElabTopdec$1$7.list$4363 = function(s$4366){var fix$5383 = {};
fix$5383.$f = function(v$4370,v$4373){lab$f: while (true) {if (v$4370 == null) {return v$4373;
} else {var v$4385 = v$4370;
var v$4386 = v$4385[0];
var v$4387 = v$4385[1];
var v$4388 = v$4385[2];
var t$5384 = v$4387;
var t$5385 = [v$4386,fix$5383.$f(v$4388,v$4373)];
var v$4370 = t$5384;
var v$4373 = t$5385;
continue lab$f;
};
};
};
var f$4367 = fix$5383.$f;
return f$4367(s$4366,null);
};
var fix$5386 = {};
fix$5386.$fromList = function(l$4393){if (l$4393 == null) {return basics$0ElabTopdec$1$7.empty$4097;
} else {var v$4400 = l$4393;
var v$4401 = v$4400[0];
var v$4402 = v$4400[1];
return basics$0ElabTopdec$1$7.insert$4188(v$4401,fix$5386.$fromList(v$4402));
};
};
basics$0ElabTopdec$1$7.fromList$4390 = fix$5386.$fromList;
var fix$5387 = {};
fix$5387.$union = function(s1$4406,s2$4409){lab$union: while (true) {if (s2$4409 == null) {return s1$4406;
} else {var v$4417 = s2$4409;
var v$4418 = v$4417[0];
var v$4419 = v$4417[1];
var v$4420 = v$4417[2];
var t$5388 = fix$5387.$union(basics$0ElabTopdec$1$7.insert$4188(v$4418,s1$4406),v$4419);
var t$5389 = v$4420;
var s1$4406 = t$5388;
var s2$4409 = t$5389;
continue lab$union;
};
};
};
basics$0ElabTopdec$1$7.union$4403 = fix$5387.$union;
var fix$5390 = {};
fix$5390.$addList = function(v$4424,v$4427){lab$addList: while (true) {if (v$4424 == null) {return v$4427;
} else {var v$4438 = v$4424;
var v$4439 = v$4438[0];
var v$4440 = v$4438[1];
var t$5391 = v$4440;
var t$5392 = basics$0ElabTopdec$1$7.insert$4188(v$4439,v$4427);
var v$4424 = t$5391;
var v$4427 = t$5392;
continue lab$addList;
};
};
};
basics$0ElabTopdec$1$7.addList$4421 = fix$5390.$addList;
basics$0ElabTopdec$1$7.en$NOTFOUND$4442 = new String("NOTFOUND");
basics$0ElabTopdec$1$7.exn$NOTFOUND$4442 = [basics$0ElabTopdec$1$7.en$NOTFOUND$4442];
basics$0ElabTopdec$1$7.remove$4443 = function(k0$4446,t$4449){var balance1$4450 = function(v$4453){if (v$4453 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance1 on an empty tree)");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.(balance1 on an empty tree)"];
} else {var v$4518 = v$4453;
var v$4519 = v$4518[0];
var v$4520 = v$4518[1];
var v$4521 = v$4518[2];
switch (v$4518[3]) { case 1: {return [[v$4519,v$4520,v$4521,2],true];
 break; }case 2: {return [[v$4519,v$4520,v$4521,0],false];
 break; }default: {var v$4506;
if (v$4521 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree11!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.empty tree11!"];
} else {v$4506 = v$4521;
};
var v$4507 = v$4506[0];
var v$4508 = v$4506[1];
var v$4509 = v$4506[2];
switch (v$4506[3]) { case 1: {var v$4494;
if (v$4508 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree12!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.empty tree12!"];
} else {v$4494 = v$4508;
};
var v$4495 = v$4494[0];
var v$4496 = v$4494[1];
var v$4497 = v$4494[2];
var v$4498 = v$4494[3];
var t$5409;
var t$5408;
var t$5407 = v$4495;
var t$5406;
var t$5405;
var t$5404 = v$4519;
var t$5403 = v$4520;
var t$5402 = v$4496;
var t$5401;
var t$5400;
var v$5217 = 0;
switch (v$4498) { case 0: {switch (v$5217) { case 0: {t$5400 = true;
 break; }default: {t$5400 = false;
} };
 break; }case 1: {switch (v$5217) { case 1: {t$5400 = true;
 break; }default: {t$5400 = false;
} };
 break; }case 2: {switch (v$5217) { case 2: {t$5400 = true;
 break; }default: {t$5400 = false;
} };
 break; } };
t$5401 = (t$5400?1:2);
t$5405 = [t$5404,t$5403,t$5402,t$5401];
t$5406 = t$5405;
var t$5399;
var t$5398;
var t$5397 = v$4507;
var t$5396 = v$4497;
var t$5395 = v$4509;
var t$5394;
var t$5393;
var v$5219 = 1;
switch (v$4498) { case 0: {switch (v$5219) { case 0: {t$5393 = true;
 break; }default: {t$5393 = false;
} };
 break; }case 1: {switch (v$5219) { case 1: {t$5393 = true;
 break; }default: {t$5393 = false;
} };
 break; }case 2: {switch (v$5219) { case 2: {t$5393 = true;
 break; }default: {t$5393 = false;
} };
 break; } };
t$5394 = (t$5393?0:2);
t$5398 = [t$5397,t$5396,t$5395,t$5394];
t$5399 = t$5398;
t$5408 = [t$5407,t$5406,t$5399,2];
t$5409 = t$5408;
return [t$5409,true];
 break; }case 2: {return [[v$4507,[v$4519,v$4520,v$4508,0],v$4509,1],false];
 break; }default: {return [[v$4507,[v$4519,v$4520,v$4508,2],v$4509,2],true];
} };
} };
};
};
var balance2$4523 = function(v$4526){if (v$4526 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance2 on an empty tree)");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.(balance2 on an empty tree)"];
} else {var v$4591 = v$4526;
var v$4592 = v$4591[0];
var v$4593 = v$4591[1];
var v$4594 = v$4591[2];
switch (v$4591[3]) { case 0: {return [[v$4592,v$4593,v$4594,2],true];
 break; }case 2: {return [[v$4592,v$4593,v$4594,1],false];
 break; }default: {var v$4579;
if (v$4593 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree21!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.empty tree21!"];
} else {v$4579 = v$4593;
};
var v$4580 = v$4579[0];
var v$4581 = v$4579[1];
var v$4582 = v$4579[2];
switch (v$4579[3]) { case 0: {var v$4567;
if (v$4582 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree22!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.empty tree22!"];
} else {v$4567 = v$4582;
};
var v$4568 = v$4567[0];
var v$4569 = v$4567[1];
var v$4570 = v$4567[2];
var v$4571 = v$4567[3];
var t$5426;
var t$5425;
var t$5424 = v$4568;
var t$5423;
var t$5422;
var t$5421 = v$4580;
var t$5420 = v$4581;
var t$5419 = v$4569;
var t$5418;
var t$5417;
var v$5229 = 0;
switch (v$4571) { case 0: {switch (v$5229) { case 0: {t$5417 = true;
 break; }default: {t$5417 = false;
} };
 break; }case 1: {switch (v$5229) { case 1: {t$5417 = true;
 break; }default: {t$5417 = false;
} };
 break; }case 2: {switch (v$5229) { case 2: {t$5417 = true;
 break; }default: {t$5417 = false;
} };
 break; } };
t$5418 = (t$5417?1:2);
t$5422 = [t$5421,t$5420,t$5419,t$5418];
t$5423 = t$5422;
var t$5416;
var t$5415;
var t$5414 = v$4592;
var t$5413 = v$4570;
var t$5412 = v$4594;
var t$5411;
var t$5410;
var v$5227 = 1;
switch (v$4571) { case 0: {switch (v$5227) { case 0: {t$5410 = true;
 break; }default: {t$5410 = false;
} };
 break; }case 1: {switch (v$5227) { case 1: {t$5410 = true;
 break; }default: {t$5410 = false;
} };
 break; }case 2: {switch (v$5227) { case 2: {t$5410 = true;
 break; }default: {t$5410 = false;
} };
 break; } };
t$5411 = (t$5410?0:2);
t$5415 = [t$5414,t$5413,t$5412,t$5411];
t$5416 = t$5415;
t$5425 = [t$5424,t$5423,t$5416,2];
t$5426 = t$5425;
return [t$5426,true];
 break; }case 2: {return [[v$4580,v$4581,[v$4592,v$4582,v$4594,1],0],false];
 break; }default: {return [[v$4580,v$4581,[v$4592,v$4582,v$4594,2],2],true];
} };
} };
};
};
var fix$5427 = {};
fix$5427.$remove_rightmost = function(v$4599){if (v$4599 == null) {basis$0General$1.print$163("Impossible.OrderSet.(remove_rightmost on empty tree)");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.(remove_rightmost on empty tree)"];
} else {var v$4613 = v$4599;
var v$4614 = v$4613[2];
if (v$4614 == null) {return [v$4613[1],v$4613[0],true];
} else {var v$4636 = v$4613[0];
var v$4637 = v$4613[1];
var v$4638 = v$4613[3];
var v$4632 = fix$5427.$remove_rightmost(v$4614);
var v$4633 = v$4632[0];
var v$4634 = v$4632[1];
if (v$4632[2]) {var v$4629 = balance2$4523([v$4636,v$4637,v$4633,v$4638]);
return [v$4629[0],v$4634,v$4629[1]];
} else {return [[v$4636,v$4637,v$4633,v$4638],v$4634,false];
};
};
};
};
var remove_rightmost$4596 = fix$5427.$remove_rightmost;
var fix$5428 = {};
fix$5428.$del = function(v$4642){if (v$4642 == null) {throw basics$0ElabTopdec$1$7.exn$NOTFOUND$4442;
} else {var v$4699 = v$4642;
var v$4700 = v$4699[0];
var v$4701 = v$4699[1];
var v$4702 = v$4699[2];
var v$4703 = v$4699[3];
if (basics$0ElabTopdec$1$6.lt$4027(k0$4446,v$4700)) {var v$4662 = fix$5428.$del(v$4701);
var v$4663 = v$4662[0];
if (v$4662[1]) {return balance1$4450([v$4700,v$4663,v$4702,v$4703]);
} else {return [[v$4700,v$4663,v$4702,v$4703],false];
};
} else {if (basics$0ElabTopdec$1$6.lt$4027(v$4700,k0$4446)) {var v$4676 = fix$5428.$del(v$4702);
var v$4677 = v$4676[0];
if (v$4676[1]) {return balance2$4523([v$4700,v$4701,v$4677,v$4703]);
} else {return [[v$4700,v$4701,v$4677,v$4703],false];
};
} else {if (v$4702 == null) {return [v$4701,true];
} else {if (v$4701 == null) {return [v$4702,true];
} else {var v$4695 = remove_rightmost$4596(v$4701);
var v$4696 = v$4695[0];
var v$4697 = v$4695[1];
if (v$4695[2]) {return balance1$4450([v$4697,v$4696,v$4702,v$4703]);
} else {return [[v$4697,v$4696,v$4702,v$4703],false];
};
};
};
};
};
};
};
var del$4639 = fix$5428.$del;
try {return (del$4639(t$4449))[0];
} catch(v$5429) {return (function(NOTFOUND$4710){var t$5430 = NOTFOUND$4710;
if (t$5430[0] == basics$0ElabTopdec$1$7.en$NOTFOUND$4442) {return t$4449;
} else {throw NOTFOUND$4710;
};
})(v$5429);
};
};
var fix$5431 = {};
fix$5431.$difference = function(s1$4714,s2$4717){lab$difference: while (true) {if (s1$4714 == null) {return null;
} else {if (s2$4717 == null) {return s1$4714;
} else {var v$4729 = s2$4717;
var v$4730 = v$4729[0];
var v$4731 = v$4729[1];
var v$4732 = v$4729[2];
var t$5432 = fix$5431.$difference(basics$0ElabTopdec$1$7.remove$4443(v$4730,s1$4714),v$4731);
var t$5433 = v$4732;
var s1$4714 = t$5432;
var s2$4717 = t$5433;
continue lab$difference;
};
};
};
};
basics$0ElabTopdec$1$7.difference$4711 = fix$5431.$difference;
basics$0ElabTopdec$1$7.intersect$4733 = function(s1$4736,s2$4739){var fix$5434 = {};
fix$5434.$inters = function(v$4743,v$4746){lab$inters: while (true) {if (v$4743 == null) {return v$4746;
} else {var v$4762 = v$4743;
var v$4763 = v$4762[0];
var v$4764 = v$4762[1];
var v$4765 = v$4762[2];
var t$5443 = v$4764;
var t$5442;
var t$5441 = fix$5434.$inters;
var t$5440 = v$4765;
var t$5439;
var t$5438;
var fix$5435 = {};
fix$5435.$search = function(v$5295){lab$search: while (true) {if (v$5295 == null) {return false;
} else {var v$5296 = v$5295;
var v$5297 = v$5296[0];
var v$5298 = v$5296[1];
var v$5299 = v$5296[2];
if (((basics$0ElabTopdec$1$6.lt$4027(v$4763,v$5297))?true:(basics$0ElabTopdec$1$6.lt$4027(v$5297,v$4763)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$6.lt$4027(v$4763,v$5297)) {var t$5436 = v$5298;
var v$5295 = t$5436;
continue lab$search;
} else {var t$5437 = v$5299;
var v$5295 = t$5437;
continue lab$search;
};
};
};
};
};
var search$5294 = fix$5435.$search;
t$5438 = (search$5294(s2$4739));
t$5439 = (t$5438?(basics$0ElabTopdec$1$7.insert$4188(v$4763,v$4746)):v$4746);
t$5442 = (t$5441(t$5440,t$5439));
var t$5444 = t$5443;
var t$5445 = t$5442;
var v$4743 = t$5444;
var v$4746 = t$5445;
continue lab$inters;
};
};
};
var inters$4740 = fix$5434.$inters;
return inters$4740(s1$4736,basics$0ElabTopdec$1$7.empty$4097);
};
basics$0ElabTopdec$1$7.partition$4767 = function(f$4770,s$4773){var fix$5446 = {};
fix$5446.$g = function(v$4777,v$4780){lab$g: while (true) {if (v$4777 == null) {return v$4780;
} else {var v$4798 = v$4777;
var v$4799 = v$4798[0];
var v$4800 = v$4798[1];
var v$4801 = v$4798[2];
var v$4803 = v$4780[0];
var v$4804 = v$4780[1];
var b$4793 = (f$4770(v$4799))?[basics$0ElabTopdec$1$7.insert$4188(v$4799,v$4803),v$4804]:[v$4803,basics$0ElabTopdec$1$7.insert$4188(v$4799,v$4804)];
var t$5447 = v$4801;
var t$5448 = fix$5446.$g(v$4800,b$4793);
var v$4777 = t$5447;
var v$4780 = t$5448;
continue lab$g;
};
};
};
var g$4774 = fix$5446.$g;
return g$4774(s$4773,[basics$0ElabTopdec$1$7.empty$4097,basics$0ElabTopdec$1$7.empty$4097]);
};
basics$0ElabTopdec$1$7.fold$4805 = function(f$4808,e$4811,t$4814){var fix$5449 = {};
fix$5449.$fold$ = function(v$4818,v$4821){lab$fold$: while (true) {if (v$4818 == null) {return v$4821;
} else {var v$4833 = v$4818;
var v$4834 = v$4833[0];
var v$4835 = v$4833[1];
var v$4836 = v$4833[2];
var t$5450 = v$4836;
var t$5451 = (f$4808(v$4834))(fix$5449.$fold$(v$4835,v$4821));
var v$4818 = t$5450;
var v$4821 = t$5451;
continue lab$fold$;
};
};
};
var fold$$4815 = fix$5449.$fold$;
return fold$$4815(t$4814,e$4811);
};
basics$0ElabTopdec$1$7.listmap$4838 = function(v$5328,v$5329){return basis$0List$1.map$697(v$5328,v$5329);
};
basics$0ElabTopdec$1$7.map$4839 = function(f$4842,t$4845){var t$5459 = basics$0ElabTopdec$1$7.fromList$4390;
var t$5458;
var t$5457 = basis$0List$1.map$697;
var t$5456 = f$4842;
var t$5455;
var fix$5452 = {};
fix$5452.$f = function(v$5105,v$5106){lab$f: while (true) {if (v$5105 == null) {return v$5106;
} else {var v$5109 = v$5105;
var v$5110 = v$5109[0];
var v$5111 = v$5109[1];
var v$5112 = v$5109[2];
var t$5453 = v$5111;
var t$5454 = [v$5110,fix$5452.$f(v$5112,v$5106)];
var v$5105 = t$5453;
var v$5106 = t$5454;
continue lab$f;
};
};
};
var f$5104 = fix$5452.$f;
t$5455 = (f$5104(t$4845,null));
t$5458 = (t$5457(t$5456,t$5455));
return t$5459(t$5458);
};
basics$0ElabTopdec$1$7.subst$4846 = function(v$4858,v$4859){return function(s$4853){var t$5463;
var fix$5460 = {};
fix$5460.$search = function(v$5303){lab$search: while (true) {if (v$5303 == null) {return false;
} else {var v$5304 = v$5303;
var v$5305 = v$5304[0];
var v$5306 = v$5304[1];
var v$5307 = v$5304[2];
if (((basics$0ElabTopdec$1$6.lt$4027(v$4859,v$5305))?true:(basics$0ElabTopdec$1$6.lt$4027(v$5305,v$4859)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$6.lt$4027(v$4859,v$5305)) {var t$5461 = v$5306;
var v$5303 = t$5461;
continue lab$search;
} else {var t$5462 = v$5307;
var v$5303 = t$5462;
continue lab$search;
};
};
};
};
};
var search$5302 = fix$5460.$search;
t$5463 = (search$5302(s$4853));
if (t$5463) {return basics$0ElabTopdec$1$7.insert$4188(v$4858,basics$0ElabTopdec$1$7.remove$4443(v$4859,s$4853));
} else {return s$4853;
};
};
};
basics$0ElabTopdec$1$7.apply$4860 = function(f$4863,s$4866){var fix$5464 = {};
fix$5464.$appl = function(v$4870){lab$appl: while (true) {if (v$4870 == null) {return 0;
} else {var v$4882 = v$4870;
var v$4883 = v$4882[0];
var v$4884 = v$4882[1];
var v$4885 = v$4882[2];
fix$5464.$appl(v$4884);
f$4863(v$4883);
var t$5465 = v$4885;
var v$4870 = t$5465;
continue lab$appl;
};
};
};
var appl$4867 = fix$5464.$appl;
return appl$4867(s$4866);
};
basics$0ElabTopdec$1$7.layoutSet$4886 = function(v$4905,v$4904,v$4903){return function(layoutItem$4894){return function(s$4897){var t$5466;
var v$4901 = [0,v$4904];
var t$5473;
var t$5472 = basis$0List$1.map$697;
var t$5471 = layoutItem$4894;
var t$5470;
var fix$5467 = {};
fix$5467.$f = function(v$5116,v$5117){lab$f: while (true) {if (v$5116 == null) {return v$5117;
} else {var v$5120 = v$5116;
var v$5121 = v$5120[0];
var v$5122 = v$5120[1];
var v$5123 = v$5120[2];
var t$5468 = v$5122;
var t$5469 = [v$5121,fix$5467.$f(v$5123,v$5117)];
var v$5116 = t$5468;
var v$5117 = t$5469;
continue lab$f;
};
};
};
var f$5115 = fix$5467.$f;
t$5470 = (f$5115(s$4897,null));
t$5473 = (t$5472(t$5471,t$5470));
t$5466 = [t$5473,v$4901,v$4905,3,v$4903];
return [0,t$5466];
};
};
};
basics$0ElabTopdec$1$7.pu_bal$4906 = pickle$0pickle$1.enumGen$2158(function(v$5125){var v$5126 = v$5125[0];
var v$5127 = v$5125[1];
switch (v$5126) { case 0: {switch (v$5127) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$5127) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$5127) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderSet.bal",[1,[2,[0,null]]]]);
basics$0ElabTopdec$1$7.pu$4907 = function(pu_elt$4910){var funE$4919;
var v$5330 = null;
funE$4919 = (function(v$5331){return pickle$0pickle$1.con0$1988(v$5330,v$5331);
});
return pickle$0pickle$1.dataGen$1488(["OrderSet.Set",function(v$5142){return (v$5142 == null)?0:1;
},[funE$4919,[function(pu$5143){return pickle$0pickle$1.con1$2014(function(v$5144){return v$5144;
},function(v$5145){if (v$5145 == null) {basis$0General$1.print$163("Impossible.OrderSet.pu.N");
throw [basics$0ElabTopdec$1$7.en$Impossible$4084,"Impossible.OrderSet.pu.N"];
} else {return v$5145;
};
},(pickle$0pickle$1.convert0$2299(function(v$5154){var v$5155 = v$5154[0];
var v$5156 = v$5155[0];
var v$5157 = v$5155[1];
var v$5158 = v$5154[1];
return [v$5156,v$5157,v$5158[0],v$5158[1]];
},function(v$5159){return [[v$5159[0],v$5159[1]],[v$5159[2],v$5159[3]]];
}))(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.pairGen0$983(pu_elt$4910,pu$5143),pickle$0pickle$1.pairGen0$983(pu$5143,basics$0ElabTopdec$1$7.pu_bal$4906))));
},null]]]);
};
return 0;
})();
