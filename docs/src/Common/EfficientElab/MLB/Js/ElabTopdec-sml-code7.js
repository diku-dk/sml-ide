if ((typeof(basics$0ElabTopdec$1$7)) == "undefined") {basics$0ElabTopdec$1$7 = {};
};
(function(){basics$0ElabTopdec$1$7.eq_bal$4906 = function(v$4908,v$4909){switch (v$4908) { case 0: {switch (v$4909) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4909) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4909) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
basics$0ElabTopdec$1$7.s$j$4014 = function(v$4019,v$4020){return basics$0ElabTopdec$1$6.lt$3975(v$4019,v$4020);
};
basics$0ElabTopdec$1$7.s$kk$4021 = function(v$4030,v$4031){return ((basics$0ElabTopdec$1$6.lt$3975(v$4030,v$4031))?true:(basics$0ElabTopdec$1$6.lt$3975(v$4031,v$4030)))?false:true;
};
basics$0ElabTopdec$1$7.en$Impossible$4032 = new String("Impossible");
basics$0ElabTopdec$1$7.impossible$4033 = function(s$4036){var s$4037 = "Impossible.OrderSet." + s$4036;
basis$0General$1.print$163(s$4037);
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,s$4037];
};
basics$0ElabTopdec$1$7.empty$4045 = null;
basics$0ElabTopdec$1$7.singleton$4046 = function(i$4049){return [i$4049,null,null,2];
};
var fix$5254 = {};
fix$5254.$size = function(v$4053){if (v$4053 == null) {return 0;
} else {var v$4060 = v$4053;
var v$4061 = v$4060[1];
var v$4062 = v$4060[2];
return SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(1 + (fix$5254.$size(v$4061)))) + (fix$5254.$size(v$4062)));
};
};
basics$0ElabTopdec$1$7.size$4050 = fix$5254.$size;
basics$0ElabTopdec$1$7.isEmpty$4063 = function(v$4066){return (v$4066 == null)?true:false;
};
basics$0ElabTopdec$1$7.member$4071 = function(i$4074,s$4077){var fix$5255 = {};
fix$5255.$search = function(v$4081){lab$search: while (true) {if (v$4081 == null) {return false;
} else {var v$4097 = v$4081;
var v$4098 = v$4097[0];
var v$4099 = v$4097[1];
var v$4100 = v$4097[2];
if (((basics$0ElabTopdec$1$6.lt$3975(i$4074,v$4098))?true:(basics$0ElabTopdec$1$6.lt$3975(v$4098,i$4074)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$6.lt$3975(i$4074,v$4098)) {var t$5256 = v$4099;
var v$4081 = t$5256;
continue lab$search;
} else {var t$5257 = v$4100;
var v$4081 = t$5257;
continue lab$search;
};
};
};
};
};
var search$4078 = fix$5255.$search;
return search$4078(s$4077);
};
basics$0ElabTopdec$1$7.eq$4101 = function(s1$4104,s2$4107){if ((basics$0ElabTopdec$1$7.size$4050(s1$4104)) == (basics$0ElabTopdec$1$7.size$4050(s2$4107))) {var fix$5258 = {};
fix$5258.$eq$ = function(v$4115){lab$eq$: while (true) {if (v$4115 == null) {return true;
} else {var v$4131 = v$4115;
var v$4132 = v$4131[0];
var v$4133 = v$4131[1];
var v$4134 = v$4131[2];
var t$5262;
var fix$5259 = {};
fix$5259.$search = function(v$5179){lab$search: while (true) {if (v$5179 == null) {return false;
} else {var v$5180 = v$5179;
var v$5181 = v$5180[0];
var v$5182 = v$5180[1];
var v$5183 = v$5180[2];
if (((basics$0ElabTopdec$1$6.lt$3975(v$4132,v$5181))?true:(basics$0ElabTopdec$1$6.lt$3975(v$5181,v$4132)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$6.lt$3975(v$4132,v$5181)) {var t$5260 = v$5182;
var v$5179 = t$5260;
continue lab$search;
} else {var t$5261 = v$5183;
var v$5179 = t$5261;
continue lab$search;
};
};
};
};
};
var search$5178 = fix$5259.$search;
t$5262 = (search$5178(s2$4107));
if (t$5262) {if (fix$5258.$eq$(v$4133)) {var t$5263 = v$4134;
var v$4115 = t$5263;
continue lab$eq$;
} else {return false;
};
} else {return false;
};
};
};
};
var eq$$4112 = fix$5258.$eq$;
return eq$$4112(s1$4104);
} else {return false;
};
};
basics$0ElabTopdec$1$7.en$ALREADYTHERE$4135 = new String("ALREADYTHERE");
basics$0ElabTopdec$1$7.exn$ALREADYTHERE$4135 = [basics$0ElabTopdec$1$7.en$ALREADYTHERE$4135];
basics$0ElabTopdec$1$7.insert$4136 = function(k0$4139,t$4142){var fix$5264 = {};
fix$5264.$ins = function(v$4146){if (v$4146 == null) {return [true,[k0$4139,null,null,2]];
} else {var v$4299 = v$4146;
var v$4300 = v$4299[0];
var v$4301 = v$4299[1];
var v$4302 = v$4299[2];
var v$4303 = v$4299[3];
if (((basics$0ElabTopdec$1$6.lt$3975(k0$4139,v$4300))?true:(basics$0ElabTopdec$1$6.lt$3975(v$4300,k0$4139)))?false:true) {throw basics$0ElabTopdec$1$7.exn$ALREADYTHERE$4135;
} else {if (basics$0ElabTopdec$1$6.lt$3975(k0$4139,v$4300)) {var v$4228 = fix$5264.$ins(v$4301);
var v$4229 = v$4228[0];
var v$4230 = v$4228[1];
switch (v$4303) { case 2: {return v$4229?[true,[v$4300,v$4230,v$4302,1]]:[false,[v$4300,v$4230,v$4302,2]];
 break; }case 0: {return v$4229?[false,[v$4300,v$4230,v$4302,2]]:[false,[v$4300,v$4230,v$4302,0]];
 break; }default: {if (v$4229) {var v$4216;
if (v$4230 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree01!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.empty tree01!"];
} else {v$4216 = v$4230;
};
var v$4217 = v$4216[0];
var v$4218 = v$4216[1];
var v$4219 = v$4216[2];
var v$4220 = v$4216[3];
var t$5267;
var v$5113 = 1;
switch (v$4220) { case 0: {switch (v$5113) { case 0: {t$5267 = true;
 break; }default: {t$5267 = false;
} };
 break; }case 1: {switch (v$5113) { case 1: {t$5267 = true;
 break; }default: {t$5267 = false;
} };
 break; }case 2: {switch (v$5113) { case 2: {t$5267 = true;
 break; }default: {t$5267 = false;
} };
 break; } };
if (t$5267) {return [false,[v$4217,v$4218,[v$4300,v$4219,v$4302,2],2]];
} else {var v$4204;
if (v$4219 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree02!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.empty tree02!"];
} else {v$4204 = v$4219;
};
var v$4205 = v$4204[0];
var v$4206 = v$4204[1];
var v$4207 = v$4204[2];
var v$4208 = v$4204[3];
var t$5285 = false;
var t$5284;
var t$5283;
var t$5282 = v$4205;
var t$5281;
var t$5280;
var t$5279 = v$4217;
var t$5278 = v$4218;
var t$5277 = v$4206;
var t$5276;
var t$5275;
var v$5117 = 0;
switch (v$4208) { case 0: {switch (v$5117) { case 0: {t$5275 = true;
 break; }default: {t$5275 = false;
} };
 break; }case 1: {switch (v$5117) { case 1: {t$5275 = true;
 break; }default: {t$5275 = false;
} };
 break; }case 2: {switch (v$5117) { case 2: {t$5275 = true;
 break; }default: {t$5275 = false;
} };
 break; } };
t$5276 = (t$5275?1:2);
t$5280 = [t$5279,t$5278,t$5277,t$5276];
t$5281 = t$5280;
var t$5274;
var t$5273;
var t$5272 = v$4300;
var t$5271 = v$4207;
var t$5270 = v$4302;
var t$5269;
var t$5268;
var v$5119 = 1;
switch (v$4208) { case 0: {switch (v$5119) { case 0: {t$5268 = true;
 break; }default: {t$5268 = false;
} };
 break; }case 1: {switch (v$5119) { case 1: {t$5268 = true;
 break; }default: {t$5268 = false;
} };
 break; }case 2: {switch (v$5119) { case 2: {t$5268 = true;
 break; }default: {t$5268 = false;
} };
 break; } };
t$5269 = (t$5268?0:2);
t$5273 = [t$5272,t$5271,t$5270,t$5269];
t$5274 = t$5273;
t$5283 = [t$5282,t$5281,t$5274,2];
t$5284 = t$5283;
return [t$5285,t$5284];
};
} else {return [false,[v$4300,v$4230,v$4302,1]];
};
} };
} else {var v$4296 = fix$5264.$ins(v$4302);
var v$4297 = v$4296[0];
var v$4298 = v$4296[1];
switch (v$4303) { case 2: {return v$4297?[true,[v$4300,v$4301,v$4298,0]]:[false,[v$4300,v$4301,v$4298,2]];
 break; }case 1: {return v$4297?[false,[v$4300,v$4301,v$4298,2]]:[false,[v$4300,v$4301,v$4298,1]];
 break; }default: {if (v$4297) {var v$4284;
if (v$4298 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree03!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.empty tree03!"];
} else {v$4284 = v$4298;
};
var v$4285 = v$4284[0];
var v$4286 = v$4284[1];
var v$4287 = v$4284[2];
var v$4288 = v$4284[3];
var t$5286;
var v$5125 = 0;
switch (v$4288) { case 0: {switch (v$5125) { case 0: {t$5286 = true;
 break; }default: {t$5286 = false;
} };
 break; }case 1: {switch (v$5125) { case 1: {t$5286 = true;
 break; }default: {t$5286 = false;
} };
 break; }case 2: {switch (v$5125) { case 2: {t$5286 = true;
 break; }default: {t$5286 = false;
} };
 break; } };
if (t$5286) {return [false,[v$4285,[v$4300,v$4301,v$4286,2],v$4287,2]];
} else {var v$4272;
if (v$4286 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree04!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.empty tree04!"];
} else {v$4272 = v$4286;
};
var v$4273 = v$4272[0];
var v$4274 = v$4272[1];
var v$4275 = v$4272[2];
var v$4276 = v$4272[3];
var t$5304 = false;
var t$5303;
var t$5302;
var t$5301 = v$4273;
var t$5300;
var t$5299;
var t$5298 = v$4300;
var t$5297 = v$4301;
var t$5296 = v$4274;
var t$5295;
var t$5294;
var v$5129 = 0;
switch (v$4276) { case 0: {switch (v$5129) { case 0: {t$5294 = true;
 break; }default: {t$5294 = false;
} };
 break; }case 1: {switch (v$5129) { case 1: {t$5294 = true;
 break; }default: {t$5294 = false;
} };
 break; }case 2: {switch (v$5129) { case 2: {t$5294 = true;
 break; }default: {t$5294 = false;
} };
 break; } };
t$5295 = (t$5294?1:2);
t$5299 = [t$5298,t$5297,t$5296,t$5295];
t$5300 = t$5299;
var t$5293;
var t$5292;
var t$5291 = v$4285;
var t$5290 = v$4275;
var t$5289 = v$4287;
var t$5288;
var t$5287;
var v$5131 = 1;
switch (v$4276) { case 0: {switch (v$5131) { case 0: {t$5287 = true;
 break; }default: {t$5287 = false;
} };
 break; }case 1: {switch (v$5131) { case 1: {t$5287 = true;
 break; }default: {t$5287 = false;
} };
 break; }case 2: {switch (v$5131) { case 2: {t$5287 = true;
 break; }default: {t$5287 = false;
} };
 break; } };
t$5288 = (t$5287?0:2);
t$5292 = [t$5291,t$5290,t$5289,t$5288];
t$5293 = t$5292;
t$5302 = [t$5301,t$5300,t$5293,2];
t$5303 = t$5302;
return [t$5304,t$5303];
};
} else {return [false,[v$4300,v$4301,v$4298,0]];
};
} };
};
};
};
};
var ins$4143 = fix$5264.$ins;
try {return (ins$4143(t$4142))[1];
} catch(v$5265) {return (function(ALREADYTHERE$4310){var t$5266 = ALREADYTHERE$4310;
if (t$5266[0] == basics$0ElabTopdec$1$7.en$ALREADYTHERE$4135) {return t$4142;
} else {throw ALREADYTHERE$4310;
};
})(v$5265);
};
};
basics$0ElabTopdec$1$7.list$4311 = function(s$4314){var fix$5305 = {};
fix$5305.$f = function(v$4318,v$4321){lab$f: while (true) {if (v$4318 == null) {return v$4321;
} else {var v$4333 = v$4318;
var v$4334 = v$4333[0];
var v$4335 = v$4333[1];
var v$4336 = v$4333[2];
var t$5306 = v$4335;
var t$5307 = [v$4334,fix$5305.$f(v$4336,v$4321)];
var v$4318 = t$5306;
var v$4321 = t$5307;
continue lab$f;
};
};
};
var f$4315 = fix$5305.$f;
return f$4315(s$4314,null);
};
var fix$5308 = {};
fix$5308.$fromList = function(l$4341){if (l$4341 == null) {return basics$0ElabTopdec$1$7.empty$4045;
} else {var v$4348 = l$4341;
var v$4349 = v$4348[0];
var v$4350 = v$4348[1];
return basics$0ElabTopdec$1$7.insert$4136(v$4349,fix$5308.$fromList(v$4350));
};
};
basics$0ElabTopdec$1$7.fromList$4338 = fix$5308.$fromList;
var fix$5309 = {};
fix$5309.$union = function(s1$4354,s2$4357){lab$union: while (true) {if (s2$4357 == null) {return s1$4354;
} else {var v$4365 = s2$4357;
var v$4366 = v$4365[0];
var v$4367 = v$4365[1];
var v$4368 = v$4365[2];
var t$5310 = fix$5309.$union(basics$0ElabTopdec$1$7.insert$4136(v$4366,s1$4354),v$4367);
var t$5311 = v$4368;
var s1$4354 = t$5310;
var s2$4357 = t$5311;
continue lab$union;
};
};
};
basics$0ElabTopdec$1$7.union$4351 = fix$5309.$union;
var fix$5312 = {};
fix$5312.$addList = function(v$4372,v$4375){lab$addList: while (true) {if (v$4372 == null) {return v$4375;
} else {var v$4386 = v$4372;
var v$4387 = v$4386[0];
var v$4388 = v$4386[1];
var t$5313 = v$4388;
var t$5314 = basics$0ElabTopdec$1$7.insert$4136(v$4387,v$4375);
var v$4372 = t$5313;
var v$4375 = t$5314;
continue lab$addList;
};
};
};
basics$0ElabTopdec$1$7.addList$4369 = fix$5312.$addList;
basics$0ElabTopdec$1$7.en$NOTFOUND$4390 = new String("NOTFOUND");
basics$0ElabTopdec$1$7.exn$NOTFOUND$4390 = [basics$0ElabTopdec$1$7.en$NOTFOUND$4390];
basics$0ElabTopdec$1$7.remove$4391 = function(k0$4394,t$4397){var balance1$4398 = function(v$4401){if (v$4401 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance1 on an empty tree)");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.(balance1 on an empty tree)"];
} else {var v$4466 = v$4401;
var v$4467 = v$4466[0];
var v$4468 = v$4466[1];
var v$4469 = v$4466[2];
switch (v$4466[3]) { case 1: {return [[v$4467,v$4468,v$4469,2],true];
 break; }case 2: {return [[v$4467,v$4468,v$4469,0],false];
 break; }default: {var v$4454;
if (v$4469 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree11!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.empty tree11!"];
} else {v$4454 = v$4469;
};
var v$4455 = v$4454[0];
var v$4456 = v$4454[1];
var v$4457 = v$4454[2];
switch (v$4454[3]) { case 1: {var v$4442;
if (v$4456 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree12!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.empty tree12!"];
} else {v$4442 = v$4456;
};
var v$4443 = v$4442[0];
var v$4444 = v$4442[1];
var v$4445 = v$4442[2];
var v$4446 = v$4442[3];
var t$5331;
var t$5330;
var t$5329 = v$4443;
var t$5328;
var t$5327;
var t$5326 = v$4467;
var t$5325 = v$4468;
var t$5324 = v$4444;
var t$5323;
var t$5322;
var v$5143 = 0;
switch (v$4446) { case 0: {switch (v$5143) { case 0: {t$5322 = true;
 break; }default: {t$5322 = false;
} };
 break; }case 1: {switch (v$5143) { case 1: {t$5322 = true;
 break; }default: {t$5322 = false;
} };
 break; }case 2: {switch (v$5143) { case 2: {t$5322 = true;
 break; }default: {t$5322 = false;
} };
 break; } };
t$5323 = (t$5322?1:2);
t$5327 = [t$5326,t$5325,t$5324,t$5323];
t$5328 = t$5327;
var t$5321;
var t$5320;
var t$5319 = v$4455;
var t$5318 = v$4445;
var t$5317 = v$4457;
var t$5316;
var t$5315;
var v$5145 = 1;
switch (v$4446) { case 0: {switch (v$5145) { case 0: {t$5315 = true;
 break; }default: {t$5315 = false;
} };
 break; }case 1: {switch (v$5145) { case 1: {t$5315 = true;
 break; }default: {t$5315 = false;
} };
 break; }case 2: {switch (v$5145) { case 2: {t$5315 = true;
 break; }default: {t$5315 = false;
} };
 break; } };
t$5316 = (t$5315?0:2);
t$5320 = [t$5319,t$5318,t$5317,t$5316];
t$5321 = t$5320;
t$5330 = [t$5329,t$5328,t$5321,2];
t$5331 = t$5330;
return [t$5331,true];
 break; }case 2: {return [[v$4455,[v$4467,v$4468,v$4456,0],v$4457,1],false];
 break; }default: {return [[v$4455,[v$4467,v$4468,v$4456,2],v$4457,2],true];
} };
} };
};
};
var balance2$4471 = function(v$4474){if (v$4474 == null) {basis$0General$1.print$163("Impossible.OrderSet.(balance2 on an empty tree)");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.(balance2 on an empty tree)"];
} else {var v$4539 = v$4474;
var v$4540 = v$4539[0];
var v$4541 = v$4539[1];
var v$4542 = v$4539[2];
switch (v$4539[3]) { case 0: {return [[v$4540,v$4541,v$4542,2],true];
 break; }case 2: {return [[v$4540,v$4541,v$4542,1],false];
 break; }default: {var v$4527;
if (v$4541 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree21!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.empty tree21!"];
} else {v$4527 = v$4541;
};
var v$4528 = v$4527[0];
var v$4529 = v$4527[1];
var v$4530 = v$4527[2];
switch (v$4527[3]) { case 0: {var v$4515;
if (v$4530 == null) {basis$0General$1.print$163("Impossible.OrderSet.empty tree22!");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.empty tree22!"];
} else {v$4515 = v$4530;
};
var v$4516 = v$4515[0];
var v$4517 = v$4515[1];
var v$4518 = v$4515[2];
var v$4519 = v$4515[3];
var t$5348;
var t$5347;
var t$5346 = v$4516;
var t$5345;
var t$5344;
var t$5343 = v$4528;
var t$5342 = v$4529;
var t$5341 = v$4517;
var t$5340;
var t$5339;
var v$5155 = 0;
switch (v$4519) { case 0: {switch (v$5155) { case 0: {t$5339 = true;
 break; }default: {t$5339 = false;
} };
 break; }case 1: {switch (v$5155) { case 1: {t$5339 = true;
 break; }default: {t$5339 = false;
} };
 break; }case 2: {switch (v$5155) { case 2: {t$5339 = true;
 break; }default: {t$5339 = false;
} };
 break; } };
t$5340 = (t$5339?1:2);
t$5344 = [t$5343,t$5342,t$5341,t$5340];
t$5345 = t$5344;
var t$5338;
var t$5337;
var t$5336 = v$4540;
var t$5335 = v$4518;
var t$5334 = v$4542;
var t$5333;
var t$5332;
var v$5153 = 1;
switch (v$4519) { case 0: {switch (v$5153) { case 0: {t$5332 = true;
 break; }default: {t$5332 = false;
} };
 break; }case 1: {switch (v$5153) { case 1: {t$5332 = true;
 break; }default: {t$5332 = false;
} };
 break; }case 2: {switch (v$5153) { case 2: {t$5332 = true;
 break; }default: {t$5332 = false;
} };
 break; } };
t$5333 = (t$5332?0:2);
t$5337 = [t$5336,t$5335,t$5334,t$5333];
t$5338 = t$5337;
t$5347 = [t$5346,t$5345,t$5338,2];
t$5348 = t$5347;
return [t$5348,true];
 break; }case 2: {return [[v$4528,v$4529,[v$4540,v$4530,v$4542,1],0],false];
 break; }default: {return [[v$4528,v$4529,[v$4540,v$4530,v$4542,2],2],true];
} };
} };
};
};
var fix$5349 = {};
fix$5349.$remove_rightmost = function(v$4547){if (v$4547 == null) {basis$0General$1.print$163("Impossible.OrderSet.(remove_rightmost on empty tree)");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.(remove_rightmost on empty tree)"];
} else {var v$4561 = v$4547;
var v$4562 = v$4561[2];
if (v$4562 == null) {return [v$4561[1],v$4561[0],true];
} else {var v$4584 = v$4561[0];
var v$4585 = v$4561[1];
var v$4586 = v$4561[3];
var v$4580 = fix$5349.$remove_rightmost(v$4562);
var v$4581 = v$4580[0];
var v$4582 = v$4580[1];
if (v$4580[2]) {var v$4577 = balance2$4471([v$4584,v$4585,v$4581,v$4586]);
return [v$4577[0],v$4582,v$4577[1]];
} else {return [[v$4584,v$4585,v$4581,v$4586],v$4582,false];
};
};
};
};
var remove_rightmost$4544 = fix$5349.$remove_rightmost;
var fix$5350 = {};
fix$5350.$del = function(v$4590){if (v$4590 == null) {throw basics$0ElabTopdec$1$7.exn$NOTFOUND$4390;
} else {var v$4647 = v$4590;
var v$4648 = v$4647[0];
var v$4649 = v$4647[1];
var v$4650 = v$4647[2];
var v$4651 = v$4647[3];
if (basics$0ElabTopdec$1$6.lt$3975(k0$4394,v$4648)) {var v$4610 = fix$5350.$del(v$4649);
var v$4611 = v$4610[0];
if (v$4610[1]) {return balance1$4398([v$4648,v$4611,v$4650,v$4651]);
} else {return [[v$4648,v$4611,v$4650,v$4651],false];
};
} else {if (basics$0ElabTopdec$1$6.lt$3975(v$4648,k0$4394)) {var v$4624 = fix$5350.$del(v$4650);
var v$4625 = v$4624[0];
if (v$4624[1]) {return balance2$4471([v$4648,v$4649,v$4625,v$4651]);
} else {return [[v$4648,v$4649,v$4625,v$4651],false];
};
} else {if (v$4650 == null) {return [v$4649,true];
} else {if (v$4649 == null) {return [v$4650,true];
} else {var v$4643 = remove_rightmost$4544(v$4649);
var v$4644 = v$4643[0];
var v$4645 = v$4643[1];
if (v$4643[2]) {return balance1$4398([v$4645,v$4644,v$4650,v$4651]);
} else {return [[v$4645,v$4644,v$4650,v$4651],false];
};
};
};
};
};
};
};
var del$4587 = fix$5350.$del;
try {return (del$4587(t$4397))[0];
} catch(v$5351) {return (function(NOTFOUND$4658){var t$5352 = NOTFOUND$4658;
if (t$5352[0] == basics$0ElabTopdec$1$7.en$NOTFOUND$4390) {return t$4397;
} else {throw NOTFOUND$4658;
};
})(v$5351);
};
};
var fix$5353 = {};
fix$5353.$difference = function(s1$4662,s2$4665){lab$difference: while (true) {if (s1$4662 == null) {return null;
} else {if (s2$4665 == null) {return s1$4662;
} else {var v$4677 = s2$4665;
var v$4678 = v$4677[0];
var v$4679 = v$4677[1];
var v$4680 = v$4677[2];
var t$5354 = fix$5353.$difference(basics$0ElabTopdec$1$7.remove$4391(v$4678,s1$4662),v$4679);
var t$5355 = v$4680;
var s1$4662 = t$5354;
var s2$4665 = t$5355;
continue lab$difference;
};
};
};
};
basics$0ElabTopdec$1$7.difference$4659 = fix$5353.$difference;
basics$0ElabTopdec$1$7.intersect$4681 = function(s1$4684,s2$4687){var fix$5356 = {};
fix$5356.$inters = function(v$4691,v$4694){lab$inters: while (true) {if (v$4691 == null) {return v$4694;
} else {var v$4710 = v$4691;
var v$4711 = v$4710[0];
var v$4712 = v$4710[1];
var v$4713 = v$4710[2];
var t$5365 = v$4712;
var t$5364;
var t$5363 = fix$5356.$inters;
var t$5362 = v$4713;
var t$5361;
var t$5360;
var fix$5357 = {};
fix$5357.$search = function(v$5217){lab$search: while (true) {if (v$5217 == null) {return false;
} else {var v$5218 = v$5217;
var v$5219 = v$5218[0];
var v$5220 = v$5218[1];
var v$5221 = v$5218[2];
if (((basics$0ElabTopdec$1$6.lt$3975(v$4711,v$5219))?true:(basics$0ElabTopdec$1$6.lt$3975(v$5219,v$4711)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$6.lt$3975(v$4711,v$5219)) {var t$5358 = v$5220;
var v$5217 = t$5358;
continue lab$search;
} else {var t$5359 = v$5221;
var v$5217 = t$5359;
continue lab$search;
};
};
};
};
};
var search$5216 = fix$5357.$search;
t$5360 = (search$5216(s2$4687));
t$5361 = (t$5360?(basics$0ElabTopdec$1$7.insert$4136(v$4711,v$4694)):v$4694);
t$5364 = (t$5363(t$5362,t$5361));
var t$5366 = t$5365;
var t$5367 = t$5364;
var v$4691 = t$5366;
var v$4694 = t$5367;
continue lab$inters;
};
};
};
var inters$4688 = fix$5356.$inters;
return inters$4688(s1$4684,basics$0ElabTopdec$1$7.empty$4045);
};
basics$0ElabTopdec$1$7.partition$4715 = function(f$4718,s$4721){var fix$5368 = {};
fix$5368.$g = function(v$4725,v$4728){lab$g: while (true) {if (v$4725 == null) {return v$4728;
} else {var v$4746 = v$4725;
var v$4747 = v$4746[0];
var v$4748 = v$4746[1];
var v$4749 = v$4746[2];
var v$4751 = v$4728[0];
var v$4752 = v$4728[1];
var b$4741 = (f$4718(v$4747))?[basics$0ElabTopdec$1$7.insert$4136(v$4747,v$4751),v$4752]:[v$4751,basics$0ElabTopdec$1$7.insert$4136(v$4747,v$4752)];
var t$5369 = v$4749;
var t$5370 = fix$5368.$g(v$4748,b$4741);
var v$4725 = t$5369;
var v$4728 = t$5370;
continue lab$g;
};
};
};
var g$4722 = fix$5368.$g;
return g$4722(s$4721,[basics$0ElabTopdec$1$7.empty$4045,basics$0ElabTopdec$1$7.empty$4045]);
};
basics$0ElabTopdec$1$7.fold$4753 = function(f$4756,e$4759,t$4762){var fix$5371 = {};
fix$5371.$fold$ = function(v$4766,v$4769){lab$fold$: while (true) {if (v$4766 == null) {return v$4769;
} else {var v$4781 = v$4766;
var v$4782 = v$4781[0];
var v$4783 = v$4781[1];
var v$4784 = v$4781[2];
var t$5372 = v$4784;
var t$5373 = (f$4756(v$4782))(fix$5371.$fold$(v$4783,v$4769));
var v$4766 = t$5372;
var v$4769 = t$5373;
continue lab$fold$;
};
};
};
var fold$$4763 = fix$5371.$fold$;
return fold$$4763(t$4762,e$4759);
};
basics$0ElabTopdec$1$7.listmap$4786 = function(v$5250,v$5251){return basis$0List$1.map$697(v$5250,v$5251);
};
basics$0ElabTopdec$1$7.map$4787 = function(f$4790,t$4793){var t$5381 = basics$0ElabTopdec$1$7.fromList$4338;
var t$5380;
var t$5379 = basis$0List$1.map$697;
var t$5378 = f$4790;
var t$5377;
var fix$5374 = {};
fix$5374.$f = function(v$5053,v$5054){lab$f: while (true) {if (v$5053 == null) {return v$5054;
} else {var v$5057 = v$5053;
var v$5058 = v$5057[0];
var v$5059 = v$5057[1];
var v$5060 = v$5057[2];
var t$5375 = v$5059;
var t$5376 = [v$5058,fix$5374.$f(v$5060,v$5054)];
var v$5053 = t$5375;
var v$5054 = t$5376;
continue lab$f;
};
};
};
var f$5052 = fix$5374.$f;
t$5377 = (f$5052(t$4793,null));
t$5380 = (t$5379(t$5378,t$5377));
return t$5381(t$5380);
};
basics$0ElabTopdec$1$7.subst$4794 = function(v$4806,v$4807){return function(s$4801){var t$5385;
var fix$5382 = {};
fix$5382.$search = function(v$5225){lab$search: while (true) {if (v$5225 == null) {return false;
} else {var v$5226 = v$5225;
var v$5227 = v$5226[0];
var v$5228 = v$5226[1];
var v$5229 = v$5226[2];
if (((basics$0ElabTopdec$1$6.lt$3975(v$4807,v$5227))?true:(basics$0ElabTopdec$1$6.lt$3975(v$5227,v$4807)))?false:true) {return true;
} else {if (basics$0ElabTopdec$1$6.lt$3975(v$4807,v$5227)) {var t$5383 = v$5228;
var v$5225 = t$5383;
continue lab$search;
} else {var t$5384 = v$5229;
var v$5225 = t$5384;
continue lab$search;
};
};
};
};
};
var search$5224 = fix$5382.$search;
t$5385 = (search$5224(s$4801));
if (t$5385) {return basics$0ElabTopdec$1$7.insert$4136(v$4806,basics$0ElabTopdec$1$7.remove$4391(v$4807,s$4801));
} else {return s$4801;
};
};
};
basics$0ElabTopdec$1$7.apply$4808 = function(f$4811,s$4814){var fix$5386 = {};
fix$5386.$appl = function(v$4818){lab$appl: while (true) {if (v$4818 == null) {return 0;
} else {var v$4830 = v$4818;
var v$4831 = v$4830[0];
var v$4832 = v$4830[1];
var v$4833 = v$4830[2];
fix$5386.$appl(v$4832);
f$4811(v$4831);
var t$5387 = v$4833;
var v$4818 = t$5387;
continue lab$appl;
};
};
};
var appl$4815 = fix$5386.$appl;
return appl$4815(s$4814);
};
basics$0ElabTopdec$1$7.layoutSet$4834 = function(v$4853,v$4852,v$4851){return function(layoutItem$4842){return function(s$4845){var t$5388;
var v$4849 = [0,v$4852];
var t$5395;
var t$5394 = basis$0List$1.map$697;
var t$5393 = layoutItem$4842;
var t$5392;
var fix$5389 = {};
fix$5389.$f = function(v$5064,v$5065){lab$f: while (true) {if (v$5064 == null) {return v$5065;
} else {var v$5068 = v$5064;
var v$5069 = v$5068[0];
var v$5070 = v$5068[1];
var v$5071 = v$5068[2];
var t$5390 = v$5070;
var t$5391 = [v$5069,fix$5389.$f(v$5071,v$5065)];
var v$5064 = t$5390;
var v$5065 = t$5391;
continue lab$f;
};
};
};
var f$5063 = fix$5389.$f;
t$5392 = (f$5063(s$4845,null));
t$5395 = (t$5394(t$5393,t$5392));
t$5388 = [t$5395,v$4849,v$4853,3,v$4851];
return [0,t$5388];
};
};
};
basics$0ElabTopdec$1$7.pu_bal$4854 = pickle$0pickle$1.enumGen$2158(function(v$5073){var v$5074 = v$5073[0];
var v$5075 = v$5073[1];
switch (v$5074) { case 0: {switch (v$5075) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$5075) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$5075) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderSet.bal",[1,[2,[0,null]]]]);
basics$0ElabTopdec$1$7.pu$4855 = function(pu_elt$4858){var funE$4867;
var v$5252 = null;
funE$4867 = (function(v$5253){return pickle$0pickle$1.con0$1988(v$5252,v$5253);
});
return pickle$0pickle$1.dataGen$1488(["OrderSet.Set",function(v$5079){return (v$5079 == null)?0:1;
},[funE$4867,[function(pu$5080){return pickle$0pickle$1.con1$2014(function(v$5081){return v$5081;
},function(v$5082){if (v$5082 == null) {basis$0General$1.print$163("Impossible.OrderSet.pu.N");
throw [basics$0ElabTopdec$1$7.en$Impossible$4032,"Impossible.OrderSet.pu.N"];
} else {return v$5082;
};
},pickle$0pickle$1.tup4Gen0$2377(pu_elt$4858,pu$5080,pu$5080,basics$0ElabTopdec$1$7.pu_bal$4854));
},null]]]);
};
return 0;
})();
