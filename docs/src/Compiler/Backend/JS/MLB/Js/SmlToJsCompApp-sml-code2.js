if ((typeof(smltojs0$0SmlToJsCompApp$1$2)) == "undefined") {smltojs0$0SmlToJsCompApp$1$2 = {};
};
(function(){smltojs0$0SmlToJsCompApp$1$2.scrollDown$928 = function(e$931){return (function(t){t.scrollTop = t.scrollHeight;})(e$931);
};
smltojs0$0SmlToJsCompApp$1$2.userAgent$935 = function(v$937){return (function(){return navigator.userAgent;})();
};
smltojs0$0SmlToJsCompApp$1$2.agent$940 = basis$0String$1.translate$217(function(x$2954){return basis$0Char$1.toString$277(((65 <= x$2954)?(x$2954 <= 90):false)?(SmlPrims.chk_ovf_i32(x$2954 + 32)):x$2954);
},(function(){return navigator.userAgent;})());
smltojs0$0SmlToJsCompApp$1$2.touchDevices$941 = ["ipod",["ipad",["iphone",["series60",["symbian",["android",["windows ce",["blackberry",null]]]]]]]];
smltojs0$0SmlToJsCompApp$1$2.touchScreen$942 = function(a$945){var fix$10189 = {};
fix$10189.$exists = function(v$2964){lab$exists: while (true) {if (v$2964 == null) {return false;
} else {var v$2965 = v$2964;
var v$2966 = v$2965[0];
var v$2967 = v$2965[1];
if (basis$0String$1.isSubstring$268(v$2966,a$945)) {return true;
} else {var t$10190 = v$2967;
var v$2964 = t$10190;
continue lab$exists;
};
};
};
};
var exists$2963 = fix$10189.$exists;
return exists$2963(smltojs0$0SmlToJsCompApp$1$2.touchDevices$941);
};
smltojs0$0SmlToJsCompApp$1$2.serverGet$953 = function(file$956){var file$957;
var t$10194 = file$956 + "?_=";
var t$10193;
var t$10192 = basis$0Real$1.toString$153;
var t$10191;
var v$2971 = SmlPrims.getrealtime();
t$10191 = ((v$2971[0] - (-2147483648)) + (v$2971[1] / 1000000.0));
t$10193 = (t$10192(t$10191));
file$957 = (t$10194 + t$10193);
var r$958 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$958,"GET",file$957,false);
js$0Js$1.send$654(r$958,[1]);
var v$965 = (function(r){return SmlPrims.option(r.responseText);})(r$958);
switch (v$965[0]) { case 0: {return v$965[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$957];
} };
};
smltojs0$0SmlToJsCompApp$1$2.outarea$973;
var attrs$2979 = [["readonly","readonly"],null];
var newelem$2980 = document.createElement("textarea");
var fix$10195 = {};
fix$10195.$app = function(v$2982){lab$app: while (true) {if (v$2982 == null) {return 0;
} else {var v$2983 = v$2982;
var v$2984 = v$2983[0];
var v$2985 = v$2983[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2980,v$2984[0],v$2984[1]);
var t$10196 = v$2985;
var v$2982 = t$10196;
continue lab$app;
};
};
};
var app$2981 = fix$10195.$app;
app$2981(attrs$2979);
smltojs0$0SmlToJsCompApp$1$2.outarea$973 = newelem$2980;
smltojs0$0SmlToJsCompApp$1$2.outareaDiv$974;
var attrs$2987 = [["class","textareacontainer"],null];
var newelem$2989 = document.createElement("div");
var fix$10197 = {};
fix$10197.$app = function(v$2991){lab$app: while (true) {if (v$2991 == null) {return 0;
} else {var v$2992 = v$2991;
var v$2993 = v$2992[0];
var v$2994 = v$2992[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2989,v$2993[0],v$2993[1]);
var t$10198 = v$2994;
var v$2991 = t$10198;
continue lab$app;
};
};
};
var app$2990 = fix$10197.$app;
app$2990(attrs$2987);
(function(e,a){return e.appendChild(a);})(newelem$2989,smltojs0$0SmlToJsCompApp$1$2.outarea$973);
smltojs0$0SmlToJsCompApp$1$2.outareaDiv$974 = newelem$2989;
smltojs0$0SmlToJsCompApp$1$2.logarea$975;
var attrs$2996 = [["readonly","readonly"],null];
var newelem$2997 = document.createElement("textarea");
var fix$10199 = {};
fix$10199.$app = function(v$2999){lab$app: while (true) {if (v$2999 == null) {return 0;
} else {var v$3000 = v$2999;
var v$3001 = v$3000[0];
var v$3002 = v$3000[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2997,v$3001[0],v$3001[1]);
var t$10200 = v$3002;
var v$2999 = t$10200;
continue lab$app;
};
};
};
var app$2998 = fix$10199.$app;
app$2998(attrs$2996);
smltojs0$0SmlToJsCompApp$1$2.logarea$975 = newelem$2997;
smltojs0$0SmlToJsCompApp$1$2.logareaDiv$976;
var attrs$3004 = [["class","textareacontainer"],null];
var newelem$3006 = document.createElement("div");
var fix$10201 = {};
fix$10201.$app = function(v$3008){lab$app: while (true) {if (v$3008 == null) {return 0;
} else {var v$3009 = v$3008;
var v$3010 = v$3009[0];
var v$3011 = v$3009[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3006,v$3010[0],v$3010[1]);
var t$10202 = v$3011;
var v$3008 = t$10202;
continue lab$app;
};
};
};
var app$3007 = fix$10201.$app;
app$3007(attrs$3004);
(function(e,a){return e.appendChild(a);})(newelem$3006,smltojs0$0SmlToJsCompApp$1$2.logarea$975);
smltojs0$0SmlToJsCompApp$1$2.logareaDiv$976 = newelem$3006;
smltojs0$0SmlToJsCompApp$1$2.clearoutbutton$977;
var attrs$3013 = [["type","button"],[["value","Clear Output"],null]];
var newelem$3014 = document.createElement("input");
var fix$10203 = {};
fix$10203.$app = function(v$3016){lab$app: while (true) {if (v$3016 == null) {return 0;
} else {var v$3017 = v$3016;
var v$3018 = v$3017[0];
var v$3019 = v$3017[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3014,v$3018[0],v$3018[1]);
var t$10204 = v$3019;
var v$3016 = t$10204;
continue lab$app;
};
};
};
var app$3015 = fix$10203.$app;
app$3015(attrs$3013);
smltojs0$0SmlToJsCompApp$1$2.clearoutbutton$977 = newelem$3014;
smltojs0$0SmlToJsCompApp$1$2.nodropboxPng$978 = "nodropbox.png";
smltojs0$0SmlToJsCompApp$1$2.dropboxPng$979 = "dropbox.png";
smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980;
var attrs$3021 = [["class","notify_area"],null];
var elem$3022 = document.createTextNode("welcome!");
var newelem$3023 = document.createElement("div");
var fix$10205 = {};
fix$10205.$app = function(v$3025){lab$app: while (true) {if (v$3025 == null) {return 0;
} else {var v$3026 = v$3025;
var v$3027 = v$3026[0];
var v$3028 = v$3026[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3023,v$3027[0],v$3027[1]);
var t$10206 = v$3028;
var v$3025 = t$10206;
continue lab$app;
};
};
};
var app$3024 = fix$10205.$app;
app$3024(attrs$3021);
(function(e,a){return e.appendChild(a);})(newelem$3023,elem$3022);
smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980 = newelem$3023;
smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981;
var attrs$3031 = [["src","nodropbox.png"],[["class","dropbox_area"],null]];
var newelem$3032 = document.createElement("img");
var fix$10207 = {};
fix$10207.$app = function(v$3034){lab$app: while (true) {if (v$3034 == null) {return 0;
} else {var v$3035 = v$3034;
var v$3036 = v$3035[0];
var v$3037 = v$3035[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3032,v$3036[0],v$3036[1]);
var t$10208 = v$3037;
var v$3034 = t$10208;
continue lab$app;
};
};
};
var app$3033 = fix$10207.$app;
app$3033(attrs$3031);
smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981 = newelem$3032;
smltojs0$0SmlToJsCompApp$1$2.setNoDropboxPng$982 = function(v$984){return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981,"src","nodropbox.png");
};
smltojs0$0SmlToJsCompApp$1$2.setDropboxPng$985 = function(v$987){return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981,"src","dropbox.png");
};
var notifyTimeout$988 = [[1]];
var notify0$1026 = function(color$1029,e$1032,s$1035){var v$1046 = notifyTimeout$988[0];
switch (v$1046[0]) { case 0: {(function(id){return clearTimeout(id);})(v$1046[1]);
 break; }default: {0;
} };
(function(e,s){e.innerHTML = s;})(e$1032,s$1035);
(function(e,a,b){return e.setAttribute(a,b);})(e$1032,"style",((("opacity:" + (basis$0Real$1.toString$153(1.0))) + "; background-color:") + color$1029) + ";");
var t$10222 = notifyTimeout$988;
var t$10221;
var t$10220;
var t$10219 = 3000;
var t$10218;
var fix$10209 = {};
fix$10209.$fadeNotification = function(opacity$10003,v$10004){lab$fadeNotification: while (true) {if (opacity$10003 < 0.0) {(function(e,a,b){return e.setAttribute(a,b);})(e$1032,"style","opacity:0.0;");
return (notifyTimeout$988[0] = [1],0);
} else {(function(e,a,b){return e.setAttribute(a,b);})(e$1032,"style",((("opacity:" + (basis$0Real$1.toString$153(opacity$10003))) + "; background-color:") + color$1029) + ";");
var t$10217 = notifyTimeout$988;
var t$10216;
var t$10215;
var t$10214 = 50;
var t$10210;
var v$10047 = opacity$10003 - 0.02;
t$10210 = ((function(env$10213){return function(v$10048){var v$10211 = env$10213[0];
var v$10212 = env$10213[1];
return v$10212(v$10211,v$10048);
};
})([v$10047,fix$10209.$fadeNotification]));
t$10215 = ((function(i,f){return setTimeout(f,i);})(t$10214,t$10210));
t$10216 = [0,t$10215];
return (t$10217[0] = t$10216,0);
};
};
};
var fadeNotification$10002 = fix$10209.$fadeNotification;
t$10218 = (function(v$10050){return fadeNotification$10002(0.98,v$10050);
});
t$10220 = ((function(i,f){return setTimeout(f,i);})(t$10219,t$10218));
t$10221 = [0,t$10220];
return (t$10222[0] = t$10221,0);
};
smltojs0$0SmlToJsCompApp$1$2.notify_err$1049 = function(v$10053){return notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,v$10053);
};
smltojs0$0SmlToJsCompApp$1$2.notify_errE$1050 = function(v$10055){return function(v$10056){return notify0$1026("#dd8888",v$10055,v$10056);
};
};
smltojs0$0SmlToJsCompApp$1$2.notify_warn$1051 = function(v$10059){return notify0$1026("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,v$10059);
};
smltojs0$0SmlToJsCompApp$1$2.notify$1052 = function(v$10062){return notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,v$10062);
};
smltojs0$0SmlToJsCompApp$1$2.outRef$1053 = [function(v$1055){throw [basis$0Initial$1.en$Fail$54,"outRef not initialized"];
}];
smltojs0$0SmlToJsCompApp$1$2.out$1056 = function(s$1059){return smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0](s$1059);
};
var fix$10223 = {};
fix$10223.$whileSome = function(f$1063,g$1066){lab$whileSome: while (true) {var v$1071 = f$1063(0);
switch (v$1071[0]) { case 0: {var v$1075 = v$1071[1];
g$1066(v$1075);
var t$10224 = f$1063;
var t$10225 = g$1066;
var f$1063 = t$10224;
var g$1066 = t$10225;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.whileSome$1060 = fix$10223.$whileSome;
smltojs0$0SmlToJsCompApp$1$2.clearoutarea$1076 = function(v$1078){var fix$10226 = {};
fix$10226.$whileSome = function(g$6341){lab$whileSome: while (true) {var v$6342 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
switch (v$6342[0]) { case 0: {var v$6343 = v$6342[1];
g$6341(v$6343);
var t$10227 = g$6341;
var g$6341 = t$10227;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$6340 = fix$10226.$whileSome;
return whileSome$6340(function(e$1083){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,e$1083);
});
};
smltojs0$0SmlToJsCompApp$1$2.outfun$1084 = function(s$1087){(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,document.createTextNode(s$1087));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
};
smltojs0$0SmlToJsCompApp$1$2.clearlogarea$1090 = function(v$1092){var fix$10228 = {};
fix$10228.$whileSome = function(g$6348){lab$whileSome: while (true) {var v$6349 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
switch (v$6349[0]) { case 0: {var v$6350 = v$6349[1];
g$6348(v$6350);
var t$10229 = g$6348;
var g$6348 = t$10229;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$6347 = fix$10228.$whileSome;
return whileSome$6347(function(e$1097){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,e$1097);
});
};
smltojs0$0SmlToJsCompApp$1$2.log0$1098 = function(s$1101){var s$1102;
var t$10235;
var t$10234;
var t$10233;
var t$10232 = basis$0Date$1.fmt$816;
var t$10231 = "%H:%M:%S";
var t$10230;
var v$10018 = SmlPrims.getrealtime();
t$10230 = (basis$0Date$1.fromTimeLocal$512(v$10018[0],v$10018[1]));
t$10233 = (t$10232(t$10231,t$10230));
t$10234 = (t$10233 + ": ");
t$10235 = (t$10234 + s$1101);
s$1102 = (t$10235 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$1102));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
smltojs0$0SmlToJsCompApp$1$2.log$1105 = function(s$1108){notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$1108);
var s$3120;
var t$10241;
var t$10240;
var t$10239;
var t$10238 = basis$0Date$1.fmt$816;
var t$10237 = "%H:%M:%S";
var t$10236;
var v$10019 = SmlPrims.getrealtime();
t$10236 = (basis$0Date$1.fromTimeLocal$512(v$10019[0],v$10019[1]));
t$10239 = (t$10238(t$10237,t$10236));
t$10240 = (t$10239 + ": ");
t$10241 = (t$10240 + s$1108);
s$3120 = (t$10241 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3120));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
smltojs0$0SmlToJsCompApp$1$2.logerr$1111 = function(s$1114){notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$1114);
var s$3129;
var t$10247;
var t$10246;
var t$10245;
var t$10244 = basis$0Date$1.fmt$816;
var t$10243 = "%H:%M:%S";
var t$10242;
var v$10020 = SmlPrims.getrealtime();
t$10242 = (basis$0Date$1.fromTimeLocal$512(v$10020[0],v$10020[1]));
t$10245 = (t$10244(t$10243,t$10242));
t$10246 = (t$10245 + ": ");
t$10247 = (t$10246 + s$1114);
s$3129 = (t$10247 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3129));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
smltojs0$0SmlToJsCompApp$1$2.logwarn$1117 = function(s$1120){notify0$1026("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$1120);
var s$3138;
var t$10253;
var t$10252;
var t$10251;
var t$10250 = basis$0Date$1.fmt$816;
var t$10249 = "%H:%M:%S";
var t$10248;
var v$10021 = SmlPrims.getrealtime();
t$10248 = (basis$0Date$1.fromTimeLocal$512(v$10021[0],v$10021[1]));
t$10251 = (t$10250(t$10249,t$10248));
t$10252 = (t$10251 + ": ");
t$10253 = (t$10252 + s$1120);
s$3138 = (t$10253 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3138));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
smltojs0$0SmlToJsCompApp$1$2.topelem$1123 = (function(d){return d.documentElement;})(js$0Js$1.document$88);
smltojs0$0SmlToJsCompApp$1$2.appendStyleLink$1124 = function(path$1127){var v$1132 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1132[0]) { case 0: {var t$10257 = v$1132[1];
var t$10254;
var attrs$3151 = [["rel","stylesheet"],[["href",path$1127],null]];
var newelem$3152 = document.createElement("link");
var fix$10255 = {};
fix$10255.$app = function(v$3154){lab$app: while (true) {if (v$3154 == null) {return 0;
} else {var v$3155 = v$3154;
var v$3156 = v$3155[0];
var v$3157 = v$3155[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3152,v$3156[0],v$3156[1]);
var t$10256 = v$3157;
var v$3154 = t$10256;
continue lab$app;
};
};
};
var app$3153 = fix$10255.$app;
app$3153(attrs$3151);
t$10254 = newelem$3152;
return (function(e,a){return e.appendChild(a);})(t$10257,t$10254);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.appendIconLink$1135 = function(path$1138){var v$1143 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1143[0]) { case 0: {var t$10261 = v$1143[1];
var t$10258;
var attrs$3162 = [["rel","shortcut icon"],[["type","image/x-icon"],[["href",path$1138],null]]];
var newelem$3163 = document.createElement("link");
var fix$10259 = {};
fix$10259.$app = function(v$3165){lab$app: while (true) {if (v$3165 == null) {return 0;
} else {var v$3166 = v$3165;
var v$3167 = v$3166[0];
var v$3168 = v$3166[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3163,v$3167[0],v$3167[1]);
var t$10260 = v$3168;
var v$3165 = t$10260;
continue lab$app;
};
};
};
var app$3164 = fix$10259.$app;
app$3164(attrs$3162);
t$10258 = newelem$3163;
return (function(e,a){return e.appendChild(a);})(t$10261,t$10258);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.appendScript$1146 = function(path$1149){var v$1154 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1154[0]) { case 0: {var t$10265 = v$1154[1];
var t$10262;
var attrs$3173 = [["type","text/javascript"],[["src",path$1149],null]];
var newelem$3174 = document.createElement("script");
var fix$10263 = {};
fix$10263.$app = function(v$3176){lab$app: while (true) {if (v$3176 == null) {return 0;
} else {var v$3177 = v$3176;
var v$3178 = v$3177[0];
var v$3179 = v$3177[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3174,v$3178[0],v$3178[1]);
var t$10264 = v$3179;
var v$3176 = t$10264;
continue lab$app;
};
};
};
var app$3175 = fix$10263.$app;
app$3175(attrs$3173);
t$10262 = newelem$3174;
return (function(e,a){return e.appendChild(a);})(t$10265,t$10262);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.cleanupBody$1157 = function(v$1159){var v$1164 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1164[0]) { case 0: {var v$1180 = v$1164[1];
var v$1170 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1180);
switch (v$1170[0]) { case 0: {var v$1179 = v$1170[1];
var v$1176 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1179);
switch (v$1176[0]) { case 0: {return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123,v$1176[1]);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody2"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody3"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.createBody$1181 = function(v$1183){var v$1188 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1188[0]) { case 0: {var v$1199 = v$1188[1];
var v$1196 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1199);
switch (v$1196[0]) { case 0: {(function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123,v$1196[1]);
 break; }default: {0;
} };
var t$10269 = smltojs0$0SmlToJsCompApp$1$2.topelem$1123;
var t$10266;
var attrs$3192 = [["class","claro"],[["id","body"],null]];
var newelem$3193 = document.createElement("body");
var fix$10267 = {};
fix$10267.$app = function(v$3195){lab$app: while (true) {if (v$3195 == null) {return 0;
} else {var v$3196 = v$3195;
var v$3197 = v$3196[0];
var v$3198 = v$3196[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3193,v$3197[0],v$3197[1]);
var t$10268 = v$3198;
var v$3195 = t$10268;
continue lab$app;
};
};
};
var app$3194 = fix$10267.$app;
app$3194(attrs$3192);
t$10266 = newelem$3193;
return (function(e,a){return e.appendChild(a);})(t$10269,t$10266);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"createBody"];
} };
};
var v$6353 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6353[0]) { case 0: {var t$10273 = v$6353[1];
var t$10270;
var attrs$6354 = [["rel","stylesheet"],[["href","dijit/themes/claro/claro.css"],null]];
var newelem$6355 = document.createElement("link");
var fix$10271 = {};
fix$10271.$app = function(v$6357){lab$app: while (true) {if (v$6357 == null) {return 0;
} else {var v$6358 = v$6357;
var v$6359 = v$6358[0];
var v$6360 = v$6358[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6355,v$6359[0],v$6359[1]);
var t$10272 = v$6360;
var v$6357 = t$10272;
continue lab$app;
};
};
};
var app$6356 = fix$10271.$app;
app$6356(attrs$6354);
t$10270 = newelem$6355;
(function(e,a){return e.appendChild(a);})(t$10273,t$10270);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6362 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6362[0]) { case 0: {var t$10277 = v$6362[1];
var t$10274;
var attrs$6363 = [["rel","stylesheet"],[["href","js/codemirror/codemirror.css"],null]];
var newelem$6364 = document.createElement("link");
var fix$10275 = {};
fix$10275.$app = function(v$6366){lab$app: while (true) {if (v$6366 == null) {return 0;
} else {var v$6367 = v$6366;
var v$6368 = v$6367[0];
var v$6369 = v$6367[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6364,v$6368[0],v$6368[1]);
var t$10276 = v$6369;
var v$6366 = t$10276;
continue lab$app;
};
};
};
var app$6365 = fix$10275.$app;
app$6365(attrs$6363);
t$10274 = newelem$6364;
(function(e,a){return e.appendChild(a);})(t$10277,t$10274);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6371 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6371[0]) { case 0: {var t$10281 = v$6371[1];
var t$10278;
var attrs$6372 = [["type","text/javascript"],[["src","js/codemirror/sml.js"],null]];
var newelem$6373 = document.createElement("script");
var fix$10279 = {};
fix$10279.$app = function(v$6375){lab$app: while (true) {if (v$6375 == null) {return 0;
} else {var v$6376 = v$6375;
var v$6377 = v$6376[0];
var v$6378 = v$6376[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6373,v$6377[0],v$6377[1]);
var t$10280 = v$6378;
var v$6375 = t$10280;
continue lab$app;
};
};
};
var app$6374 = fix$10279.$app;
app$6374(attrs$6372);
t$10278 = newelem$6373;
(function(e,a){return e.appendChild(a);})(t$10281,t$10278);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
var v$6380 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6380[0]) { case 0: {var t$10285 = v$6380[1];
var t$10282;
var attrs$6381 = [["rel","stylesheet"],[["href","appfunstyle.css"],null]];
var newelem$6382 = document.createElement("link");
var fix$10283 = {};
fix$10283.$app = function(v$6384){lab$app: while (true) {if (v$6384 == null) {return 0;
} else {var v$6385 = v$6384;
var v$6386 = v$6385[0];
var v$6387 = v$6385[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6382,v$6386[0],v$6386[1]);
var t$10284 = v$6387;
var v$6384 = t$10284;
continue lab$app;
};
};
};
var app$6383 = fix$10283.$app;
app$6383(attrs$6381);
t$10282 = newelem$6382;
(function(e,a){return e.appendChild(a);})(t$10285,t$10282);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6389 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6389[0]) { case 0: {var t$10289 = v$6389[1];
var t$10286;
var attrs$6390 = [["rel","shortcut icon"],[["type","image/x-icon"],[["href","favicon.ico"],null]]];
var newelem$6391 = document.createElement("link");
var fix$10287 = {};
fix$10287.$app = function(v$6393){lab$app: while (true) {if (v$6393 == null) {return 0;
} else {var v$6394 = v$6393;
var v$6395 = v$6394[0];
var v$6396 = v$6394[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6391,v$6395[0],v$6395[1]);
var t$10288 = v$6396;
var v$6393 = t$10288;
continue lab$app;
};
};
};
var app$6392 = fix$10287.$app;
app$6392(attrs$6390);
t$10286 = newelem$6391;
(function(e,a){return e.appendChild(a);})(t$10289,t$10286);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
smltojs0$0SmlToJsCompApp$1$2.createBody$1181(0);
smltojs0$0SmlToJsCompApp$1$2.getElem$1206 = function(id$1209){var v$1214 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,id$1209);
switch (v$1214[0]) { case 0: {return v$1214[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
};
var fix$10290 = {};
fix$10290.$app = function(v$3203){lab$app: while (true) {if (v$3203 == null) {return 0;
} else {var v$3204 = v$3203;
var v$3205 = v$3204[0];
var v$3206 = v$3204[1];
var v$6398 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6398[0]) { case 0: {var t$10294 = v$6398[1];
var t$10291;
var attrs$6399 = [["type","text/javascript"],[["src",v$3205],null]];
var newelem$6400 = document.createElement("script");
var fix$10292 = {};
fix$10292.$app = function(v$6402){lab$app: while (true) {if (v$6402 == null) {return 0;
} else {var v$6403 = v$6402;
var v$6404 = v$6403[0];
var v$6405 = v$6403[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6400,v$6404[0],v$6404[1]);
var t$10293 = v$6405;
var v$6402 = t$10293;
continue lab$app;
};
};
};
var app$6401 = fix$10292.$app;
app$6401(attrs$6399);
t$10291 = newelem$6400;
(function(e,a){return e.appendChild(a);})(t$10294,t$10291);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
var t$10295 = v$3206;
var v$3203 = t$10295;
continue lab$app;
};
};
};
var app$3202 = fix$10290.$app;
app$3202(smltojs0$0SmlToJsCompApp$1$1.script_paths$88);
smltojs0$0SmlToJsCompApp$1$2.mkEditor$1218 = function(inarea$1221){var t$10298;
var fix$10296 = {};
fix$10296.$exists = function(v$3210){lab$exists: while (true) {if (v$3210 == null) {return false;
} else {var v$3211 = v$3210;
var v$3212 = v$3211[0];
var v$3213 = v$3211[1];
if (basis$0String$1.isSubstring$268(v$3212,smltojs0$0SmlToJsCompApp$1$2.agent$940)) {return true;
} else {var t$10297 = v$3213;
var v$3210 = t$10297;
continue lab$exists;
};
};
};
};
var exists$3209 = fix$10296.$exists;
t$10298 = (exists$3209(smltojs0$0SmlToJsCompApp$1$2.touchDevices$941));
if (t$10298) {return [function(v$1227){return (function(e){return e.value;})(inarea$1221);
},function(s$1230){var v$1235 = (function(e){return SmlPrims.option(e.firstChild);})(inarea$1221);
switch (v$1235[0]) { case 0: {var v$1237 = v$1235[1];
return (function(e,a,old){return e.replaceChild(a,old);})(inarea$1221,document.createTextNode(s$1230),v$1237);
 break; }default: {return (function(e,a){return e.appendChild(a);})(inarea$1221,document.createTextNode(s$1230));
} };
}];
} else {var properties$1238;
var t$1239 = (function(){return {};})();
(function(fp,s,v){fp[s] = v;})(t$1239,"textWrapping",true);
(function(fp,s,v){fp[s] = v;})(t$1239,"lineNumbers",true);
(function(fp,s,v){fp[s] = v;})(t$1239,"height","100%");
(function(fp,s,v){fp[s] = v;})(t$1239,"width","100%");
(function(fp,s,v){fp[s] = v;})(t$1239,"mode","sml");
properties$1238 = t$1239;
var ed$1250 = (function(e,props){return CodeMirror.fromTextArea(e,props);})(inarea$1221,properties$1238);
return [function(v$1254){return (function(e){return e.getValue();})(ed$1250);
},function(s$1257){return (function(e,s){return e.setValue(s);})(ed$1250,s$1257);
}];
};
};
smltojs0$0SmlToJsCompApp$1$2.exec_print$1262 = function(f$1265,v$1268){var p_old$1269 = basis$0Control$1.printer_get$55(0);
var buf$1270 = [null];
basis$0Control$1.printer_set$54(function(s$3241){return (buf$1270[0] = [s$3241,buf$1270[0]],0);
});
try {f$1265(v$1268);
} catch(v$10299) {(function(v$1282){return 0;
})(v$10299);
};
var res$1277 = SmlPrims.concat(basis$0List$1.rev$682(buf$1270[0]));
basis$0Control$1.printer_set$54(p_old$1269);
return res$1277;
};
smltojs0$0SmlToJsCompApp$1$2.compileAndRunEditor$1284 = function(f$1287,editor$1290){var res$1291;
var v$3246 = editor$1290[0](0);
var p_old$3247 = basis$0Control$1.printer_get$55(0);
var buf$3248 = [null];
basis$0Control$1.printer_set$54(function(s$3249){return (buf$3248[0] = [s$3249,buf$3248[0]],0);
});
try {smltojs0$0SmlToJsCompApp$1$1.compute$102(f$1287,v$3246);
} catch(v$10300) {(function(v$3251){return 0;
})(v$10300);
};
var res$3252 = SmlPrims.concat(basis$0List$1.rev$682(buf$3248[0]));
basis$0Control$1.printer_set$54(p_old$3247);
res$1291 = res$3252;
return smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0](res$1291);
};
smltojs0$0SmlToJsCompApp$1$2.noop$1296 = function(v$1298){return 0;
};
smltojs0$0SmlToJsCompApp$1$2.put$1299 = function(s$1302,v$1304){var s$3254 = s$1302 + "\n";
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,document.createTextNode(s$3254));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
};
smltojs0$0SmlToJsCompApp$1$2.logo$1305;
var attrs$3261 = [["src","smltojs_logo_transparent_small.png"],[["height","30px"],[["alt","SMLtoJs Online"],null]]];
var newelem$3262 = document.createElement("img");
var fix$10301 = {};
fix$10301.$app = function(v$3264){lab$app: while (true) {if (v$3264 == null) {return 0;
} else {var v$3265 = v$3264;
var v$3266 = v$3265[0];
var v$3267 = v$3265[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3262,v$3266[0],v$3266[1]);
var t$10302 = v$3267;
var v$3264 = t$10302;
continue lab$app;
};
};
};
var app$3263 = fix$10301.$app;
app$3263(attrs$3261);
smltojs0$0SmlToJsCompApp$1$2.logo$1305 = newelem$3262;
smltojs0$0SmlToJsCompApp$1$2.menuStyle$1306 = ["style","border:0;padding:2;"];
smltojs0$0SmlToJsCompApp$1$2.qq$1307 = function(s$1310){return ("'" + s$1310) + "'";
};
smltojs0$0SmlToJsCompApp$1$2.s$rr$1311 = function(v$1322,v$10022){switch (v$1322) { case "0": {return v$10022;
 break; }default: {return (v$1322 + "/") + v$10022;
} };
};
smltojs0$0SmlToJsCompApp$1$2.okExt$1325 = function(s$1328){var fix$10303 = {};
fix$10303.$exists = function(v$3277){lab$exists: while (true) {if (v$3277 == null) {return false;
} else {var v$3278 = v$3277;
var v$3279 = v$3278[0];
var v$3280 = v$3278[1];
if (s$1328 == v$3279) {return true;
} else {var t$10304 = v$3280;
var v$3277 = t$10304;
continue lab$exists;
};
};
};
};
var exists$3276 = fix$10303.$exists;
return exists$3276(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211);
};
smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332 = function(n$1335){if (n$1335.length > 0) {var t$10305;
var c$3293;
if (0 >= n$1335.length) {throw CompilerInitial.exn$Subscript$52;
} else {c$3293 = (n$1335.charCodeAt(0));
};
t$10305 = (((97 <= c$3293)?(c$3293 <= 122):false)?true:((65 <= c$3293)?(c$3293 <= 90):false));
if (t$10305) {var stop$3299 = n$1335.length;
var fix$10306 = {};
fix$10306.$lr = function(j$3301){lab$lr: while (true) {if (j$3301 >= stop$3299) {return true;
} else {var t$10307;
var c$6406 = n$1335.charCodeAt(j$3301);
t$10307 = (((((97 <= c$6406)?(c$6406 <= 122):false)?true:((65 <= c$6406)?(c$6406 <= 90):false))?true:((48 <= c$6406)?(c$6406 <= 57):false))?true:((c$6406 == 95)?true:(c$6406 == 45)));
if (t$10307) {var t$10308 = SmlPrims.chk_ovf_i32(j$3301 + 1);
var j$3301 = t$10308;
continue lab$lr;
} else {return false;
};
};
};
};
var lr$3300 = fix$10306.$lr;
return lr$3300(0);
} else {return false;
};
} else {return false;
};
};
smltojs0$0SmlToJsCompApp$1$2.okFileName$1355 = function(n$1358){var v$1366 = basis$0String$1.fields$231(function(c$1382){return c$1382 == 46;
},n$1358);
if (v$1366 == null) {return false;
} else {var v$1368 = v$1366;
var v$1369 = v$1368[1];
if (v$1369 == null) {return false;
} else {var v$1371 = v$1369;
if (v$1371[1] == null) {var v$1377 = v$1368[0];
var v$1378 = v$1371[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$1377)) {var fix$10309 = {};
fix$10309.$exists = function(v$3305){lab$exists: while (true) {if (v$3305 == null) {return false;
} else {var v$3306 = v$3305;
var v$3307 = v$3306[0];
var v$3308 = v$3306[1];
if (v$1378 == v$3307) {return true;
} else {var t$10310 = v$3308;
var v$3305 = t$10310;
continue lab$exists;
};
};
};
};
var exists$3304 = fix$10309.$exists;
return exists$3304(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211);
} else {return false;
};
} else {return false;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.okFolderPath$1383 = function(p$1386){if (p$1386 == "0") {return true;
} else {var fields$1391 = basis$0String$1.fields$231(function(c$1394){return c$1394 == 47;
},p$1386);
var fix$10311 = {};
fix$10311.$all = function(v$3323){lab$all: while (true) {if (v$3323 == null) {return true;
} else {var v$3324 = v$3323;
var v$3325 = v$3324[0];
var v$3326 = v$3324[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3325)) {var t$10312 = v$3326;
var v$3323 = t$10312;
continue lab$all;
} else {return false;
};
};
};
};
var all$3322 = fix$10311.$all;
return all$3322(fields$1391);
};
};
smltojs0$0SmlToJsCompApp$1$2.okFilePath$1395 = function(p$1398){var fields$1399 = basis$0String$1.fields$231(function(c$1402){return c$1402 == 47;
},p$1398);
var v$1408 = basis$0List$1.rev$682(fields$1399);
if (v$1408 == null) {return false;
} else {var v$1414 = v$1408;
var v$1415 = v$1414[0];
var v$1416 = v$1414[1];
var t$10315;
var v$6409 = basis$0String$1.fields$231(function(c$6410){return c$6410 == 46;
},v$1415);
if (v$6409 == null) {t$10315 = false;
} else {var v$6411 = v$6409;
var v$6412 = v$6411[1];
if (v$6412 == null) {t$10315 = false;
} else {var v$6413 = v$6412;
if (v$6413[1] == null) {var v$6414 = v$6411[0];
var v$6415 = v$6413[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6414)) {var fix$10316 = {};
fix$10316.$exists = function(v$6417){lab$exists: while (true) {if (v$6417 == null) {return false;
} else {var v$6418 = v$6417;
var v$6419 = v$6418[0];
var v$6420 = v$6418[1];
if (v$6415 == v$6419) {return true;
} else {var t$10317 = v$6420;
var v$6417 = t$10317;
continue lab$exists;
};
};
};
};
var exists$6416 = fix$10316.$exists;
t$10315 = (exists$6416(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10315 = false;
};
} else {t$10315 = false;
};
};
};
if (t$10315) {var fix$10313 = {};
fix$10313.$all = function(v$3329){lab$all: while (true) {if (v$3329 == null) {return true;
} else {var v$3330 = v$3329;
var v$3331 = v$3330[0];
var v$3332 = v$3330[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3331)) {var t$10314 = v$3332;
var v$3329 = t$10314;
continue lab$all;
} else {return false;
};
};
};
};
var all$3328 = fix$10313.$all;
return all$3328(v$1416);
} else {return false;
};
};
};
smltojs0$0SmlToJsCompApp$1$2.allfiles$1417 = [null];
smltojs0$0SmlToJsCompApp$1$2.alldirs$1418 = [["0",null]];
smltojs0$0SmlToJsCompApp$1$2.fileStore$1419 = [[1]];
smltojs0$0SmlToJsCompApp$1$2.current$1420 = ["0"];
smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421 = [null];
smltojs0$0SmlToJsCompApp$1$2.splitPath$1422 = function(p$1425){if (p$1425 == "0") {return [p$1425,[1]];
} else {var fields$1430 = basis$0String$1.fields$231(function(c$1433){return c$1433 == 47;
},p$1425);
var v$1442 = basis$0List$1.rev$682(fields$1430);
if (v$1442 == null) {throw [basis$0Initial$1.en$Fail$54,"impossible: splitPath"];
} else {var v$1444 = v$1442;
var v$1445 = v$1444[1];
if (v$1445 == null) {var v$1450 = v$1444[0];
var t$10318;
var v$6423 = basis$0String$1.fields$231(function(c$6424){return c$6424 == 46;
},v$1450);
if (v$6423 == null) {t$10318 = false;
} else {var v$6425 = v$6423;
var v$6426 = v$6425[1];
if (v$6426 == null) {t$10318 = false;
} else {var v$6427 = v$6426;
if (v$6427[1] == null) {var v$6428 = v$6425[0];
var v$6429 = v$6427[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6428)) {var fix$10319 = {};
fix$10319.$exists = function(v$6431){lab$exists: while (true) {if (v$6431 == null) {return false;
} else {var v$6432 = v$6431;
var v$6433 = v$6432[0];
var v$6434 = v$6432[1];
if (v$6429 == v$6433) {return true;
} else {var t$10320 = v$6434;
var v$6431 = t$10320;
continue lab$exists;
};
};
};
};
var exists$6430 = fix$10319.$exists;
t$10318 = (exists$6430(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10318 = false;
};
} else {t$10318 = false;
};
};
};
return t$10318?["0",[0,v$1450]]:[v$1450,[1]];
} else {var v$1455 = v$1444[0];
var t$10321;
var v$6436 = basis$0String$1.fields$231(function(c$6437){return c$6437 == 46;
},v$1455);
if (v$6436 == null) {t$10321 = false;
} else {var v$6438 = v$6436;
var v$6439 = v$6438[1];
if (v$6439 == null) {t$10321 = false;
} else {var v$6440 = v$6439;
if (v$6440[1] == null) {var v$6441 = v$6438[0];
var v$6442 = v$6440[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6441)) {var fix$10322 = {};
fix$10322.$exists = function(v$6444){lab$exists: while (true) {if (v$6444 == null) {return false;
} else {var v$6445 = v$6444;
var v$6446 = v$6445[0];
var v$6447 = v$6445[1];
if (v$6442 == v$6446) {return true;
} else {var t$10323 = v$6447;
var v$6444 = t$10323;
continue lab$exists;
};
};
};
};
var exists$6443 = fix$10322.$exists;
t$10321 = (exists$6443(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10321 = false;
};
} else {t$10321 = false;
};
};
};
return t$10321?[basis$0String$1.concatWith$182("/",basis$0List$1.rev$682(v$1445)),[0,v$1455]]:[p$1425,[1]];
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.splitFolderPath$1456 = function(p$1459){if (p$1459 == "0") {return [p$1459,[1]];
} else {var fields$1464 = basis$0String$1.fields$231(function(c$1467){return c$1467 == 47;
},p$1459);
var v$1476 = basis$0List$1.rev$682(fields$1464);
if (v$1476 == null) {throw [basis$0Initial$1.en$Fail$54,"impossible: splitFolderPath"];
} else {var v$1478 = v$1476;
var v$1479 = v$1478[1];
if (v$1479 == null) {var v$1484 = v$1478[0];
return (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$1484))?["0",[0,v$1484]]:[v$1484,[1]];
} else {var v$1489 = v$1478[0];
return (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$1489))?[basis$0String$1.concatWith$182("/",basis$0List$1.rev$682(v$1479)),[0,v$1489]]:[p$1459,[1]];
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.currentFolder$1490 = function(v$1492){return (smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0];
};
smltojs0$0SmlToJsCompApp$1$2.currentFile$1497 = function(v$1499){var t$10324;
var p$3342 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var fields$3343 = basis$0String$1.fields$231(function(c$3344){return c$3344 == 47;
},p$3342);
var v$3345 = basis$0List$1.rev$682(fields$3343);
if (v$3345 == null) {t$10324 = false;
} else {var v$3346 = v$3345;
var v$3347 = v$3346[0];
var v$3348 = v$3346[1];
var t$10327;
var v$6450 = basis$0String$1.fields$231(function(c$6451){return c$6451 == 46;
},v$3347);
if (v$6450 == null) {t$10327 = false;
} else {var v$6452 = v$6450;
var v$6453 = v$6452[1];
if (v$6453 == null) {t$10327 = false;
} else {var v$6454 = v$6453;
if (v$6454[1] == null) {var v$6455 = v$6452[0];
var v$6456 = v$6454[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6455)) {var fix$10328 = {};
fix$10328.$exists = function(v$6458){lab$exists: while (true) {if (v$6458 == null) {return false;
} else {var v$6459 = v$6458;
var v$6460 = v$6459[0];
var v$6461 = v$6459[1];
if (v$6456 == v$6460) {return true;
} else {var t$10329 = v$6461;
var v$6458 = t$10329;
continue lab$exists;
};
};
};
};
var exists$6457 = fix$10328.$exists;
t$10327 = (exists$6457(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10327 = false;
};
} else {t$10327 = false;
};
};
};
if (t$10327) {var fix$10325 = {};
fix$10325.$all = function(v$3350){lab$all: while (true) {if (v$3350 == null) {return true;
} else {var v$3351 = v$3350;
var v$3352 = v$3351[0];
var v$3353 = v$3351[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3352)) {var t$10326 = v$3353;
var v$3350 = t$10326;
continue lab$all;
} else {return false;
};
};
};
};
var all$3349 = fix$10325.$all;
t$10324 = (all$3349(v$3348));
} else {t$10324 = false;
};
};
return t$10324?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.currentIsFolder$1504 = function(v$1506){var t$10330;
var p$3356 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
if (p$3356 == "0") {t$10330 = true;
} else {var fields$3362 = basis$0String$1.fields$231(function(c$3363){return c$3363 == 47;
},p$3356);
var fix$10331 = {};
fix$10331.$all = function(v$3365){lab$all: while (true) {if (v$3365 == null) {return true;
} else {var v$3366 = v$3365;
var v$3367 = v$3366[0];
var v$3368 = v$3366[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3367)) {var t$10332 = v$3368;
var v$3365 = t$10332;
continue lab$all;
} else {return false;
};
};
};
};
var all$3364 = fix$10331.$all;
t$10330 = (all$3364(fields$3362));
};
return t$10330?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.fileExists$1511 = function(name$1514){var fix$10333 = {};
fix$10333.$exists = function(v$3377){lab$exists: while (true) {if (v$3377 == null) {return false;
} else {var v$3378 = v$3377;
var v$3379 = v$3378[0];
var v$3380 = v$3378[1];
if (v$3379 == name$1514) {return true;
} else {var t$10334 = v$3380;
var v$3377 = t$10334;
continue lab$exists;
};
};
};
};
var exists$3376 = fix$10333.$exists;
return exists$3376(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]);
};
smltojs0$0SmlToJsCompApp$1$2.folderExists$1518 = function(name$1521){var fix$10335 = {};
fix$10335.$exists = function(v$3398){lab$exists: while (true) {if (v$3398 == null) {return false;
} else {var v$3399 = v$3398;
var v$3400 = v$3399[0];
var v$3401 = v$3399[1];
if (v$3400 == name$1521) {return true;
} else {var t$10336 = v$3401;
var v$3398 = t$10336;
continue lab$exists;
};
};
};
};
var exists$3397 = fix$10335.$exists;
return exists$3397(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]);
};
smltojs0$0SmlToJsCompApp$1$2.isServerPath$1525 = function(p$1528){var v$1533 = basis$0String$1.tokens$224(function(c$1540){return c$1540 == 47;
},p$1528);
if (v$1533 == null) {return false;
} else {var v$1535 = v$1533;
switch (v$1535[0]) { case "Server": {return true;
 break; }default: {return false;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.isDropboxPath$1541 = function(p$1544){var v$1549 = basis$0String$1.tokens$224(function(c$1556){return c$1556 == 47;
},p$1544);
if (v$1549 == null) {return false;
} else {var v$1551 = v$1549;
switch (v$1551[0]) { case "Dropbox": {return true;
 break; }default: {return false;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.load$1634 = function(c$1637,fts$1640){(smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0] = [0,c$1637],0);
var t$10365 = appfun2$0dropbox$1.all_files$231;
var t$10364 = c$1637;
var t$10363;
var fix$10337 = {};
fix$10337.$app = function(v$3496){lab$app: while (true) {if (v$3496 == null) {return 0;
} else {var v$3497 = v$3496;
var v$3498 = v$3497[0];
var v$3499 = v$3497[1];
var loadDir$6476 = function(p$6477,n$6478){var d$6479;
switch (p$6477) { case "0": {d$6479 = n$6478;
 break; }default: {d$6479 = ((p$6477 + "/") + n$6478);
} };
var t$10340;
var fix$10338 = {};
fix$10338.$exists = function(v$6481){lab$exists: while (true) {if (v$6481 == null) {return false;
} else {var v$6482 = v$6481;
var v$6483 = v$6482[0];
var v$6484 = v$6482[1];
if (d$6479 == v$6483) {return true;
} else {var t$10339 = v$6484;
var v$6481 = t$10339;
continue lab$exists;
};
};
};
};
var exists$6480 = fix$10338.$exists;
t$10340 = (exists$6480(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10340) {return 0;
} else {var h$6485 = [["id",d$6479],[["parent",p$6477],[["name",n$6478],[["kind","folder"],null]]]];
var t$10346 = fts$1640;
var t$10345;
var fix$10341 = {};
fix$10341.$foldl = function(v$6487,v$6488){lab$foldl: while (true) {if (v$6488 == null) {return v$6487;
} else {var v$6489 = v$6488;
var v$6490 = v$6489[0];
var v$6491 = v$6489[1];
var t$10342;
var v$6492 = v$6490[0];
var v$6493 = v$6490[1];
(function(fp,s,v){fp[s] = v;})(v$6487,v$6492,v$6493);
t$10342 = v$6487;
var t$10343 = t$10342;
var t$10344 = v$6491;
var v$6487 = t$10343;
var v$6488 = t$10344;
continue lab$foldl;
};
};
};
var foldl$6486 = fix$10341.$foldl;
var v$10065 = (function(){return {};})();
t$10345 = (foldl$6486(v$10065,h$6485));
(function(obj,a){return obj.add(a);})(t$10346,t$10345);
return (smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0] = [d$6479,smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]],0);
};
};
var v$6494;
var fields$6495 = basis$0String$1.fields$231((function(env$10347){return function(c$6496){return c$6496 == 47;
};
})([]),v$3498);
var fix$10348 = {};
fix$10348.$loop = function(v$6498,v$6499){lab$loop: while (true) {if (v$6499 == null) {throw [basis$0Initial$1.en$Fail$54,"loadDirs.impossible"];
} else {var v$6500 = v$6499;
var v$6501 = v$6500[1];
if (v$6501 == null) {var v$6502 = v$6500[0];
var t$10350;
var v$6504 = basis$0String$1.fields$231((function(env$10349){return function(c$6505){return c$6505 == 46;
};
})([]),v$6502);
if (v$6504 == null) {t$10350 = false;
} else {var v$6506 = v$6504;
var v$6507 = v$6506[1];
if (v$6507 == null) {t$10350 = false;
} else {var v$6508 = v$6507;
if (v$6508[1] == null) {var v$6509 = v$6506[0];
var v$6510 = v$6508[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6509)) {var fix$10351 = {};
fix$10351.$exists = function(v$6512){lab$exists: while (true) {if (v$6512 == null) {return false;
} else {var v$6513 = v$6512;
var v$6514 = v$6513[0];
var v$6515 = v$6513[1];
if (v$6510 == v$6514) {return true;
} else {var t$10352 = v$6515;
var v$6512 = t$10352;
continue lab$exists;
};
};
};
};
var exists$6511 = fix$10351.$exists;
t$10350 = (exists$6511(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10350 = false;
};
} else {t$10350 = false;
};
};
};
if (t$10350) {return [0,[v$6498,v$6502]];
} else {loadDir$6476(v$6498,v$6502);
return [1];
};
} else {var v$6516 = v$6500[0];
loadDir$6476(v$6498,v$6516);
var t$10353;
switch (v$6498) { case "0": {t$10353 = v$6516;
 break; }default: {t$10353 = ((v$6498 + "/") + v$6516);
} };
var t$10354 = t$10353;
var t$10355 = v$6501;
var v$6498 = t$10354;
var v$6499 = t$10355;
continue lab$loop;
};
};
};
};
var loop$6497 = fix$10348.$loop;
v$6494 = (loop$6497("0",fields$6495));
switch (v$6494[0]) { case 1: {0;
 break; }default: {var v$6517 = v$6494[1];
var v$6518 = v$6517[0];
var v$6519 = v$6517[1];
var h$6520 = [["id",v$3498],[["parent",v$6518],[["name",v$6519],[["kind","leaf"],null]]]];
var t$10361 = fts$1640;
var t$10360;
var fix$10356 = {};
fix$10356.$foldl = function(v$6522,v$6523){lab$foldl: while (true) {if (v$6523 == null) {return v$6522;
} else {var v$6524 = v$6523;
var v$6525 = v$6524[0];
var v$6526 = v$6524[1];
var t$10357;
var v$6527 = v$6525[0];
var v$6528 = v$6525[1];
(function(fp,s,v){fp[s] = v;})(v$6522,v$6527,v$6528);
t$10357 = v$6522;
var t$10358 = t$10357;
var t$10359 = v$6526;
var v$6522 = t$10358;
var v$6523 = t$10359;
continue lab$foldl;
};
};
};
var foldl$6521 = fix$10356.$foldl;
var v$10067 = (function(){return {};})();
t$10360 = (foldl$6521(v$10067,h$6520));
(function(obj,a){return obj.add(a);})(t$10361,t$10360);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = [v$3498,smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]],0);
} };
var t$10362 = v$3499;
var v$3496 = t$10362;
continue lab$app;
};
};
};
var app$3495 = fix$10337.$app;
t$10363 = (function(v$10185){return app$3495(v$10185);
});
return t$10365(t$10364,t$10363);
};
smltojs0$0SmlToJsCompApp$1$2.loadFileContentFromServer$1644 = function(f$1647){var v$1652 = basis$0List$1.rev$682(basis$0String$1.tokens$224(function(c$1661){return c$1661 == 47;
},f$1647));
if (v$1652 == null) {throw [basis$0Initial$1.en$Fail$54,"failed to load server file content for " + f$1647];
} else {var v$1657 = v$1652;
var v$1658 = v$1657[0];
var c$1654;
var file$6529 = ("otests/" + v$1658) + "_";
var file$6530;
var t$10369 = file$6529 + "?_=";
var t$10368;
var t$10367 = basis$0Real$1.toString$153;
var t$10366;
var v$6531 = SmlPrims.getrealtime();
t$10366 = ((v$6531[0] - (-2147483648)) + (v$6531[1] / 1000000.0));
t$10368 = (t$10367(t$10366));
file$6530 = (t$10369 + t$10368);
var r$6532 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$6532,"GET",file$6530,false);
js$0Js$1.send$654(r$6532,[1]);
var v$6533 = (function(r){return SmlPrims.option(r.responseText);})(r$6532);
switch (v$6533[0]) { case 0: {c$1654 = v$6533[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$6530];
} };
var s$3568 = ("loaded file " + (("'" + f$1647) + "'")) + " from server";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$3568);
var s$3570;
var t$10375;
var t$10374;
var t$10373;
var t$10372 = basis$0Date$1.fmt$816;
var t$10371 = "%H:%M:%S";
var t$10370;
var v$10023 = SmlPrims.getrealtime();
t$10370 = (basis$0Date$1.fromTimeLocal$512(v$10023[0],v$10023[1]));
t$10373 = (t$10372(t$10371,t$10370));
t$10374 = (t$10373 + ": ");
t$10375 = (t$10374 + s$3568);
s$3570 = (t$10375 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3570));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return c$1654;
};
};
smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1662 = function(filename$1665,cont$1668){var t$10379;
var fix$10377 = {};
fix$10377.$exists = function(v$3587){lab$exists: while (true) {if (v$3587 == null) {return false;
} else {var v$3588 = v$3587;
var v$3589 = v$3588[0];
var v$3590 = v$3588[1];
if (v$3589[0] == filename$1665) {return true;
} else {var t$10378 = v$3590;
var v$3587 = t$10378;
continue lab$exists;
};
};
};
};
var exists$3586 = fix$10377.$exists;
t$10379 = (exists$3586(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]));
if (t$10379) {(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = filename$1665,0);
return cont$1668([1]);
} else {var t$10376;
var v$3606 = basis$0String$1.tokens$224(function(c$3607){return c$3607 == 47;
},filename$1665);
if (v$3606 == null) {t$10376 = false;
} else {var v$3608 = v$3606;
switch (v$3608[0]) { case "Server": {t$10376 = true;
 break; }default: {t$10376 = false;
} };
};
if (t$10376) {return cont$1668([0,smltojs0$0SmlToJsCompApp$1$2.loadFileContentFromServer$1644(filename$1665)]);
} else {var v$1683 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$1683[0]) { case 0: {var v$1692 = v$1683[1];
return appfun2$0dropbox$1.content$289(v$1692,filename$1665,function(c$1687){(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = filename$1665,0);
var s$3611 = "Loaded file " + (("'" + filename$1665) + "'");
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$3611);
var s$3613;
var t$10385;
var t$10384;
var t$10383;
var t$10382 = basis$0Date$1.fmt$816;
var t$10381 = "%H:%M:%S";
var t$10380;
var v$10024 = SmlPrims.getrealtime();
t$10380 = (basis$0Date$1.fromTimeLocal$512(v$10024[0],v$10024[1]));
t$10383 = (t$10382(t$10381,t$10380));
t$10384 = (t$10383 + ": ");
t$10385 = (t$10384 + s$3611);
s$3613 = (t$10385 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3613));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return cont$1668([0,c$1687]);
});
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"loadFileContent.fileStore not set"];
} };
};
};
};
smltojs0$0SmlToJsCompApp$1$2.treeStoreRemoveExceptServer$1697 = function(fts$1700,id$1703){var t$10386;
var v$3623 = basis$0String$1.tokens$224(function(c$3624){return c$3624 == 47;
},id$1703);
if (v$3623 == null) {t$10386 = false;
} else {var v$3625 = v$3623;
switch (v$3625[0]) { case "Server": {t$10386 = true;
 break; }default: {t$10386 = false;
} };
};
return t$10386?0:((function(obj,a){return obj.remove(a);})(fts$1700,id$1703));
};
smltojs0$0SmlToJsCompApp$1$2.clear$1708 = function(fts$1711,closetab$1714){var fix$10387 = {};
fix$10387.$app = function(v$3630){lab$app: while (true) {if (v$3630 == null) {return 0;
} else {var v$3631 = v$3630;
var v$3632 = v$3631[0];
var v$3633 = v$3631[1];
var t$10389;
var v$6535 = basis$0String$1.tokens$224((function(env$10388){return function(c$6536){return c$6536 == 47;
};
})([]),v$3632);
if (v$6535 == null) {t$10389 = false;
} else {var v$6537 = v$6535;
switch (v$6537[0]) { case "Server": {t$10389 = true;
 break; }default: {t$10389 = false;
} };
};
t$10389?0:((function(obj,a){return obj.remove(a);})(fts$1711,v$3632));
var t$10390 = v$3633;
var v$3630 = t$10390;
continue lab$app;
};
};
};
var app$3629 = fix$10387.$app;
app$3629(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]);
var fix$10391 = {};
fix$10391.$app = function(v$3649){lab$app: while (true) {if (v$3649 == null) {return 0;
} else {var v$3650 = v$3649;
var v$3651 = v$3650[0];
var v$3652 = v$3650[1];
if ((v$3651 == "0")?false:true) {var t$10393;
var v$3673 = basis$0String$1.tokens$224((function(env$10392){return function(c$3674){return c$3674 == 47;
};
})([]),v$3651);
if (v$3673 == null) {t$10393 = false;
} else {var v$3675 = v$3673;
switch (v$3675[0]) { case "Server": {t$10393 = true;
 break; }default: {t$10393 = false;
} };
};
t$10393?0:((function(obj,a){return obj.remove(a);})(fts$1711,v$3651));
} else {0;
};
var t$10394 = v$3652;
var v$3649 = t$10394;
continue lab$app;
};
};
};
var app$3648 = fix$10391.$app;
app$3648(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]);
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0] = ["0",null],0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = null,0);
(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0);
var fix$10395 = {};
fix$10395.$app = function(v$3686){lab$app: while (true) {if (v$3686 == null) {return 0;
} else {var v$3687 = v$3686;
var v$3688 = v$3687[0];
var v$3689 = v$3687[1];
var v$3691 = v$3688[0];
closetab$1714(v$3691);
var t$10396 = v$3689;
var v$3686 = t$10396;
continue lab$app;
};
};
};
var app$3685 = fix$10395.$app;
app$3685(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = null,0);
};
smltojs0$0SmlToJsCompApp$1$2.mkAbsPath$1738 = function(n$1741){var v$1746 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0];
switch (v$1746) { case "0": {return n$1741;
 break; }default: {return (v$1746 + "/") + n$1741;
} };
};
var count$1747 = [0];
smltojs0$0SmlToJsCompApp$1$2.suggestNewFileName$1824 = function(base$1827){var fix$10397 = {};
fix$10397.$suggest = function(f$6552){lab$suggest: while (true) {var num$6553 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6556 = f$6552(num$6553);
var t$10400;
var fix$10398 = {};
fix$10398.$exists = function(v$6559){lab$exists: while (true) {if (v$6559 == null) {return false;
} else {var v$6560 = v$6559;
var v$6561 = v$6560[0];
var v$6562 = v$6560[1];
if (v$6561 == name$6556) {return true;
} else {var t$10399 = v$6562;
var v$6559 = t$10399;
continue lab$exists;
};
};
};
};
var exists$6558 = fix$10398.$exists;
t$10400 = (exists$6558(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10400) {var t$10401 = f$6552;
var f$6552 = t$10401;
continue lab$suggest;
} else {return name$6556;
};
};
};
var suggest$6551 = fix$10397.$suggest;
return suggest$6551(function(num$1830){return ((base$1827 + "-") + (basis$0Int32$1.toString$458(num$1830))) + ".sml";
});
};
smltojs0$0SmlToJsCompApp$1$2.suggestNewFolderName$1831 = function(v$1833){var fix$10402 = {};
fix$10402.$suggest = function(f$6577){lab$suggest: while (true) {var num$6578 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6581 = f$6577(num$6578);
var t$10405;
var fix$10403 = {};
fix$10403.$exists = function(v$6584){lab$exists: while (true) {if (v$6584 == null) {return false;
} else {var v$6585 = v$6584;
var v$6586 = v$6585[0];
var v$6587 = v$6585[1];
if (v$6586 == name$6581) {return true;
} else {var t$10404 = v$6587;
var v$6584 = t$10404;
continue lab$exists;
};
};
};
};
var exists$6583 = fix$10403.$exists;
t$10405 = (exists$6583(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10405) {var t$10406 = f$6577;
var f$6577 = t$10406;
continue lab$suggest;
} else {return name$6581;
};
};
};
var suggest$6576 = fix$10402.$suggest;
return suggest$6576(function(num$1836){return "Folder-" + (basis$0Int32$1.toString$458(num$1836));
});
};
smltojs0$0SmlToJsCompApp$1$2.newFile$1837 = function(fts$1840,content$1843,name$1846){var t$10413;
var fix$10411 = {};
fix$10411.$exists = function(v$3796){lab$exists: while (true) {if (v$3796 == null) {return false;
} else {var v$3797 = v$3796;
var v$3798 = v$3797[0];
var v$3799 = v$3797[1];
if (v$3798 == name$1846) {return true;
} else {var t$10412 = v$3799;
var v$3796 = t$10412;
continue lab$exists;
};
};
};
};
var exists$3795 = fix$10411.$exists;
t$10413 = (exists$3795(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10413) {throw [basis$0Initial$1.en$Fail$54,"file already exists"];
} else {var t$10410;
var t$10407;
var v$6589 = basis$0String$1.fields$231(function(c$6590){return c$6590 == 46;
},name$1846);
if (v$6589 == null) {t$10407 = false;
} else {var v$6591 = v$6589;
var v$6592 = v$6591[1];
if (v$6592 == null) {t$10407 = false;
} else {var v$6593 = v$6592;
if (v$6593[1] == null) {var v$6594 = v$6591[0];
var v$6595 = v$6593[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6594)) {var fix$10408 = {};
fix$10408.$exists = function(v$6597){lab$exists: while (true) {if (v$6597 == null) {return false;
} else {var v$6598 = v$6597;
var v$6599 = v$6598[0];
var v$6600 = v$6598[1];
if (v$6595 == v$6599) {return true;
} else {var t$10409 = v$6600;
var v$6597 = t$10409;
continue lab$exists;
};
};
};
};
var exists$6596 = fix$10408.$exists;
t$10407 = (exists$6596(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10407 = false;
};
} else {t$10407 = false;
};
};
};
t$10410 = (t$10407?false:true);
if (t$10410) {throw [basis$0Initial$1.en$Fail$54,"invalid new file name"];
} else {var lname$3810;
var v$3811 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0];
switch (v$3811) { case "0": {lname$3810 = name$1846;
 break; }default: {lname$3810 = ((v$3811 + "/") + name$1846);
} };
var t$10414;
var v$3815 = basis$0String$1.tokens$224(function(c$3816){return c$3816 == 47;
},lname$3810);
if (v$3815 == null) {t$10414 = false;
} else {var v$3817 = v$3815;
switch (v$3817[0]) { case "Server": {t$10414 = true;
 break; }default: {t$10414 = false;
} };
};
if (t$10414) {throw [basis$0Initial$1.en$Fail$54,"You cannot create new files in the Server folder"];
} else {var v$3818 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$3818[0]) { case 0: {var v$3819 = v$3818[1];
appfun2$0dropbox$1.write_file$302(v$3819,lname$3810,content$1843,function(v$3820){var v$3821 = v$3820[0];
var s$3822 = ((("Wrote file " + lname$3810) + " (") + v$3821) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$3822);
var s$3827;
var t$10420;
var t$10419;
var t$10418;
var t$10417 = basis$0Date$1.fmt$816;
var t$10416 = "%H:%M:%S";
var t$10415;
var v$10025 = SmlPrims.getrealtime();
t$10415 = (basis$0Date$1.fromTimeLocal$512(v$10025[0],v$10025[1]));
t$10418 = (t$10417(t$10416,t$10415));
t$10419 = (t$10418 + ": ");
t$10420 = (t$10419 + s$3822);
s$3827 = (t$10420 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3827));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
 break; }default: {0;
} };
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = [lname$3810,smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]],0);
var h$3834 = [["id",lname$3810],[["parent",(smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0]],[["name",name$1846],[["kind","leaf"],null]]]];
var t$10426 = fts$1840;
var t$10425;
var fix$10421 = {};
fix$10421.$foldl = function(v$3836,v$3837){lab$foldl: while (true) {if (v$3837 == null) {return v$3836;
} else {var v$3838 = v$3837;
var v$3839 = v$3838[0];
var v$3840 = v$3838[1];
var t$10422;
var v$3841 = v$3839[0];
var v$3842 = v$3839[1];
(function(fp,s,v){fp[s] = v;})(v$3836,v$3841,v$3842);
t$10422 = v$3836;
var t$10423 = t$10422;
var t$10424 = v$3840;
var v$3836 = t$10423;
var v$3837 = t$10424;
continue lab$foldl;
};
};
};
var foldl$3835 = fix$10421.$foldl;
var v$10069 = (function(){return {};})();
t$10425 = (foldl$3835(v$10069,h$3834));
(function(obj,a){return obj.add(a);})(t$10426,t$10425);
(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = lname$3810,0);
return lname$3810;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.newFolder$1855 = function(fts$1858,name$1861){var t$10429;
var fix$10427 = {};
fix$10427.$exists = function(v$3846){lab$exists: while (true) {if (v$3846 == null) {return false;
} else {var v$3847 = v$3846;
var v$3848 = v$3847[0];
var v$3849 = v$3847[1];
if (v$3848 == name$1861) {return true;
} else {var t$10428 = v$3849;
var v$3846 = t$10428;
continue lab$exists;
};
};
};
};
var exists$3845 = fix$10427.$exists;
t$10429 = (exists$3845(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10429) {throw [basis$0Initial$1.en$Fail$54,"folder already exists"];
} else {if ((smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(name$1861))?false:true) {throw [basis$0Initial$1.en$Fail$54,"invalid new folder name"];
} else {var lname$3859;
var v$3860 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0];
switch (v$3860) { case "0": {lname$3859 = name$1861;
 break; }default: {lname$3859 = ((v$3860 + "/") + name$1861);
} };
var t$10430;
var v$3864 = basis$0String$1.tokens$224(function(c$3865){return c$3865 == 47;
},lname$3859);
if (v$3864 == null) {t$10430 = false;
} else {var v$3866 = v$3864;
switch (v$3866[0]) { case "Server": {t$10430 = true;
 break; }default: {t$10430 = false;
} };
};
if (t$10430) {throw [basis$0Initial$1.en$Fail$54,"You cannot create new folders in the Server folder"];
} else {var v$3867 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$3867[0]) { case 0: {var v$3868 = v$3867[1];
appfun2$0dropbox$1.mkdir$341(v$3868,lname$3859,function(v$3869){var v$3870 = v$3869[0];
var s$3871 = ((("Created folder " + lname$3859) + " (") + v$3870) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$3871);
var s$3876;
var t$10436;
var t$10435;
var t$10434;
var t$10433 = basis$0Date$1.fmt$816;
var t$10432 = "%H:%M:%S";
var t$10431;
var v$10026 = SmlPrims.getrealtime();
t$10431 = (basis$0Date$1.fromTimeLocal$512(v$10026[0],v$10026[1]));
t$10434 = (t$10433(t$10432,t$10431));
t$10435 = (t$10434 + ": ");
t$10436 = (t$10435 + s$3871);
s$3876 = (t$10436 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3876));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
 break; }default: {0;
} };
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0] = [lname$3859,smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]],0);
var h$3883 = [["id",lname$3859],[["parent",(smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0]],[["name",name$1861],[["kind","folder"],null]]]];
var t$10442 = fts$1858;
var t$10441;
var fix$10437 = {};
fix$10437.$foldl = function(v$3885,v$3886){lab$foldl: while (true) {if (v$3886 == null) {return v$3885;
} else {var v$3887 = v$3886;
var v$3888 = v$3887[0];
var v$3889 = v$3887[1];
var t$10438;
var v$3890 = v$3888[0];
var v$3891 = v$3888[1];
(function(fp,s,v){fp[s] = v;})(v$3885,v$3890,v$3891);
t$10438 = v$3885;
var t$10439 = t$10438;
var t$10440 = v$3889;
var v$3885 = t$10439;
var v$3886 = t$10440;
continue lab$foldl;
};
};
};
var foldl$3884 = fix$10437.$foldl;
var v$10071 = (function(){return {};})();
t$10441 = (foldl$3884(v$10071,h$3883));
(function(obj,a){return obj.add(a);})(t$10442,t$10441);
return lname$3859;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.currentEditor$1870 = function(v$1872){var v$1877;
var t$10443;
var p$3893 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var fields$3894 = basis$0String$1.fields$231(function(c$3895){return c$3895 == 47;
},p$3893);
var v$3896 = basis$0List$1.rev$682(fields$3894);
if (v$3896 == null) {t$10443 = false;
} else {var v$3897 = v$3896;
var v$3898 = v$3897[0];
var v$3899 = v$3897[1];
var t$10446;
var v$6602 = basis$0String$1.fields$231(function(c$6603){return c$6603 == 46;
},v$3898);
if (v$6602 == null) {t$10446 = false;
} else {var v$6604 = v$6602;
var v$6605 = v$6604[1];
if (v$6605 == null) {t$10446 = false;
} else {var v$6606 = v$6605;
if (v$6606[1] == null) {var v$6607 = v$6604[0];
var v$6608 = v$6606[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6607)) {var fix$10447 = {};
fix$10447.$exists = function(v$6610){lab$exists: while (true) {if (v$6610 == null) {return false;
} else {var v$6611 = v$6610;
var v$6612 = v$6611[0];
var v$6613 = v$6611[1];
if (v$6608 == v$6612) {return true;
} else {var t$10448 = v$6613;
var v$6610 = t$10448;
continue lab$exists;
};
};
};
};
var exists$6609 = fix$10447.$exists;
t$10446 = (exists$6609(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10446 = false;
};
} else {t$10446 = false;
};
};
};
if (t$10446) {var fix$10444 = {};
fix$10444.$all = function(v$3901){lab$all: while (true) {if (v$3901 == null) {return true;
} else {var v$3902 = v$3901;
var v$3903 = v$3902[0];
var v$3904 = v$3902[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3903)) {var t$10445 = v$3904;
var v$3901 = t$10445;
continue lab$all;
} else {return false;
};
};
};
};
var all$3900 = fix$10444.$all;
t$10443 = (all$3900(v$3899));
} else {t$10443 = false;
};
};
v$1877 = (t$10443?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$1877[0]) { case 1: {return [1];
 break; }default: {var v$1895 = v$1877[1];
var v$1882 = basis$0List$1.find$392(function(v$1893){return v$1895 == v$1893[0];
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
switch (v$1882[0]) { case 0: {return [0,[v$1895,v$1882[1][2]]];
 break; }default: {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"currentEditor: error");
var s$3912;
var t$10454;
var t$10453;
var t$10452;
var t$10451 = basis$0Date$1.fmt$816;
var t$10450 = "%H:%M:%S";
var t$10449;
var v$10027 = SmlPrims.getrealtime();
t$10449 = (basis$0Date$1.fromTimeLocal$512(v$10027[0],v$10027[1]));
t$10452 = (t$10451(t$10450,t$10449));
t$10453 = (t$10452 + ": ");
t$10454 = (t$10453 + "currentEditor: error");
s$3912 = (t$10454 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3912));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return [1];
} };
} };
};
smltojs0$0SmlToJsCompApp$1$2.showTab$1896 = function(n$1899){return (smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = n$1899,0);
};
smltojs0$0SmlToJsCompApp$1$2.delete$1900 = function(fts$1903,closetab$1906){var v$1913;
var t$10455;
var p$3919 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
if (p$3919 == "0") {t$10455 = true;
} else {var fields$3924 = basis$0String$1.fields$231(function(c$3925){return c$3925 == 47;
},p$3919);
var fix$10456 = {};
fix$10456.$all = function(v$3927){lab$all: while (true) {if (v$3927 == null) {return true;
} else {var v$3928 = v$3927;
var v$3929 = v$3928[0];
var v$3930 = v$3928[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3929)) {var t$10457 = v$3930;
var v$3927 = t$10457;
continue lab$all;
} else {return false;
};
};
};
};
var all$3926 = fix$10456.$all;
t$10455 = (all$3926(fields$3924));
};
v$1913 = (t$10455?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$1913[0]) { case 0: {var v$1915 = v$1913[1];
switch (v$1915) { case "0": {return notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Cannot delete root folder");
 break; }default: {var t$10460;
var v$3932 = basis$0String$1.tokens$224(function(c$3933){return c$3933 == 47;
},v$1915);
if (v$3932 == null) {t$10460 = false;
} else {var v$3934 = v$3932;
switch (v$3934[0]) { case "Server": {t$10460 = true;
 break; }default: {t$10460 = false;
} };
};
if (t$10460) {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"You cannot delete folders in the Server folder");
var s$3937;
var t$10466;
var t$10465;
var t$10464;
var t$10463 = basis$0Date$1.fmt$816;
var t$10462 = "%H:%M:%S";
var t$10461;
var v$10028 = SmlPrims.getrealtime();
t$10461 = (basis$0Date$1.fromTimeLocal$512(v$10028[0],v$10028[1]));
t$10464 = (t$10463(t$10462,t$10461));
t$10465 = (t$10464 + ": ");
t$10466 = (t$10465 + "You cannot delete folders in the Server folder");
s$3937 = (t$10466 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3937));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
} else {var v$1997 = basis$0List$1.partition$449(function(v$2002){var v$2003 = v$2002[0];
var s1$3942 = v$1915 + "/";
var n1$3944 = s1$3942.length;
var n2$3945 = v$2003.length;
var stop$3946 = (n1$3944 < n2$3945)?n1$3944:n2$3945;
var fix$10458 = {};
fix$10458.$h = function(j$3948){lab$h: while (true) {if (j$3948 == stop$3946) {return true;
} else {if ((s1$3942.charCodeAt(j$3948)) == (v$2003.charCodeAt(j$3948))) {var t$10459 = SmlPrims.chk_ovf_i32(j$3948 + 1);
var j$3948 = t$10459;
continue lab$h;
} else {return false;
};
};
};
};
var h$3947 = fix$10458.$h;
if (n1$3944 <= n2$3945) {return h$3947(0);
} else {return false;
};
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
var v$1998 = v$1997[0];
var v$1999 = v$1997[1];
var v$1991 = basis$0List$1.partition$449(function(f$1996){var s1$3951 = v$1915 + "/";
var n1$3953 = s1$3951.length;
var n2$3954 = f$1996.length;
var stop$3955 = (n1$3953 < n2$3954)?n1$3953:n2$3954;
var fix$10467 = {};
fix$10467.$h = function(j$3957){lab$h: while (true) {if (j$3957 == stop$3955) {return true;
} else {if ((s1$3951.charCodeAt(j$3957)) == (f$1996.charCodeAt(j$3957))) {var t$10468 = SmlPrims.chk_ovf_i32(j$3957 + 1);
var j$3957 = t$10468;
continue lab$h;
} else {return false;
};
};
};
};
var h$3956 = fix$10467.$h;
if (n1$3953 <= n2$3954) {return h$3956(0);
} else {return false;
};
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]);
var v$1992 = v$1991[0];
var v$1993 = v$1991[1];
var v$1981 = basis$0List$1.partition$449(function(f$1986){if (f$1986 == v$1915) {return true;
} else {var s1$3964 = v$1915 + "/";
var n1$3966 = s1$3964.length;
var n2$3967 = f$1986.length;
var stop$3968 = (n1$3966 < n2$3967)?n1$3966:n2$3967;
var fix$10469 = {};
fix$10469.$h = function(j$3970){lab$h: while (true) {if (j$3970 == stop$3968) {return true;
} else {if ((s1$3964.charCodeAt(j$3970)) == (f$1986.charCodeAt(j$3970))) {var t$10470 = SmlPrims.chk_ovf_i32(j$3970 + 1);
var j$3970 = t$10470;
continue lab$h;
} else {return false;
};
};
};
};
var h$3969 = fix$10469.$h;
if (n1$3966 <= n2$3967) {return h$3969(0);
} else {return false;
};
};
},smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]);
var v$1982 = v$1981[0];
var v$1983 = v$1981[1];
(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = v$1999,0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = v$1993,0);
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0] = v$1983,0);
var fix$10471 = {};
fix$10471.$app = function(v$4013){lab$app: while (true) {if (v$4013 == null) {return 0;
} else {var v$4014 = v$4013;
var v$4015 = v$4014[0];
var v$4016 = v$4014[1];
var t$10473;
var v$6617 = basis$0String$1.tokens$224((function(env$10472){return function(c$6618){return c$6618 == 47;
};
})([]),v$4015);
if (v$6617 == null) {t$10473 = false;
} else {var v$6619 = v$6617;
switch (v$6619[0]) { case "Server": {t$10473 = true;
 break; }default: {t$10473 = false;
} };
};
t$10473?0:((function(obj,a){return obj.remove(a);})(fts$1903,v$4015));
var t$10474 = v$4016;
var v$4013 = t$10474;
continue lab$app;
};
};
};
var app$4012 = fix$10471.$app;
app$4012(v$1992);
var fix$10475 = {};
fix$10475.$app = function(v$4027){lab$app: while (true) {if (v$4027 == null) {return 0;
} else {var v$4028 = v$4027;
var v$4029 = v$4028[0];
var v$4030 = v$4028[1];
var t$10477;
var v$6621 = basis$0String$1.tokens$224((function(env$10476){return function(c$6622){return c$6622 == 47;
};
})([]),v$4029);
if (v$6621 == null) {t$10477 = false;
} else {var v$6623 = v$6621;
switch (v$6623[0]) { case "Server": {t$10477 = true;
 break; }default: {t$10477 = false;
} };
};
t$10477?0:((function(obj,a){return obj.remove(a);})(fts$1903,v$4029));
var t$10478 = v$4030;
var v$4027 = t$10478;
continue lab$app;
};
};
};
var app$4026 = fix$10475.$app;
app$4026(v$1982);
var fix$10479 = {};
fix$10479.$app = function(v$4044){lab$app: while (true) {if (v$4044 == null) {return 0;
} else {var v$4045 = v$4044;
var v$4046 = v$4045[0];
var v$4047 = v$4045[1];
var v$4049 = v$4046[0];
closetab$1906(v$4049);
var t$10480 = v$4047;
var v$4044 = t$10480;
continue lab$app;
};
};
};
var app$4043 = fix$10479.$app;
app$4043(v$1998);
var fix$10481 = {};
fix$10481.$app = function(v$4052){lab$app: while (true) {if (v$4052 == null) {return 0;
} else {var v$4053 = v$4052;
var v$4054 = v$4053[0];
var v$4055 = v$4053[1];
var v$4075 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$4075[0]) { case 0: {var v$4076 = v$4075[1];
appfun2$0dropbox$1.delete_file$388(v$4076,v$4054,(function(env$10486){return function(v$4077){var v$10482 = env$10486[0];
var v$10483 = env$10486[1];
var v$10484 = env$10486[2];
var v$10485 = env$10486[3];
var v$4078 = v$4077[0];
var s$4079 = ((("Deleted file " + (("'" + v$10485) + "'")) + " (") + v$4078) + ")";
var s$4086;
var t$10492;
var t$10491;
var t$10490;
var t$10489 = v$10484;
var t$10488 = "%H:%M:%S";
var t$10487;
var v$10029 = SmlPrims.getrealtime();
t$10487 = (v$10483(v$10029[0],v$10029[1]));
t$10490 = (t$10489(t$10488,t$10487));
t$10491 = (t$10490 + ": ");
t$10492 = (t$10491 + s$4079);
s$4086 = (t$10492 + "\n");
(function(e,a){return e.appendChild(a);})(v$10482,document.createTextNode(s$4086));
return (function(t){t.scrollTop = t.scrollHeight;})(v$10482);
};
})([smltojs0$0SmlToJsCompApp$1$2.logarea$975,basis$0Date$1.fromTimeLocal$512,basis$0Date$1.fmt$816,v$4054]));
 break; }default: {0;
} };
var t$10493 = v$4055;
var v$4052 = t$10493;
continue lab$app;
};
};
};
var app$4051 = fix$10481.$app;
app$4051(v$1992);
var fix$10494 = {};
fix$10494.$app = function(v$4093){lab$app: while (true) {if (v$4093 == null) {return 0;
} else {var v$4094 = v$4093;
var v$4095 = v$4094[0];
var v$4096 = v$4094[1];
var v$4116 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$4116[0]) { case 0: {var v$4117 = v$4116[1];
appfun2$0dropbox$1.delete_dir$446(v$4117,v$4095,(function(env$10499){return function(v$4118){var v$10495 = env$10499[0];
var v$10496 = env$10499[1];
var v$10497 = env$10499[2];
var v$10498 = env$10499[3];
var v$4119 = v$4118[0];
var s$4120 = ((("Deleted folder " + (("'" + v$10498) + "'")) + " (") + v$4119) + ")";
var s$4127;
var t$10505;
var t$10504;
var t$10503;
var t$10502 = v$10497;
var t$10501 = "%H:%M:%S";
var t$10500;
var v$10030 = SmlPrims.getrealtime();
t$10500 = (v$10496(v$10030[0],v$10030[1]));
t$10503 = (t$10502(t$10501,t$10500));
t$10504 = (t$10503 + ": ");
t$10505 = (t$10504 + s$4120);
s$4127 = (t$10505 + "\n");
(function(e,a){return e.appendChild(a);})(v$10495,document.createTextNode(s$4127));
return (function(t){t.scrollTop = t.scrollHeight;})(v$10495);
};
})([smltojs0$0SmlToJsCompApp$1$2.logarea$975,basis$0Date$1.fromTimeLocal$512,basis$0Date$1.fmt$816,v$4095]));
 break; }default: {0;
} };
var t$10506 = v$4096;
var v$4093 = t$10506;
continue lab$app;
};
};
};
var app$4092 = fix$10494.$app;
app$4092(v$1982);
var s$4132 = ("Deleted folder " + (("'" + v$1915) + "'")) + " completely";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4132);
var s$4134;
var t$10512;
var t$10511;
var t$10510;
var t$10509 = basis$0Date$1.fmt$816;
var t$10508 = "%H:%M:%S";
var t$10507;
var v$10031 = SmlPrims.getrealtime();
t$10507 = (basis$0Date$1.fromTimeLocal$512(v$10031[0],v$10031[1]));
t$10510 = (t$10509(t$10508,t$10507));
t$10511 = (t$10510 + ": ");
t$10512 = (t$10511 + s$4132);
s$4134 = (t$10512 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4134));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
} };
 break; }default: {var f$2004 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var t$10513;
var v$4146 = basis$0String$1.tokens$224(function(c$4147){return c$4147 == 47;
},f$2004);
if (v$4146 == null) {t$10513 = false;
} else {var v$4148 = v$4146;
switch (v$4148[0]) { case "Server": {t$10513 = true;
 break; }default: {t$10513 = false;
} };
};
if (t$10513) {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"You cannot delete files in the Server folder");
var s$4151;
var t$10519;
var t$10518;
var t$10517;
var t$10516 = basis$0Date$1.fmt$816;
var t$10515 = "%H:%M:%S";
var t$10514;
var v$10032 = SmlPrims.getrealtime();
t$10514 = (basis$0Date$1.fromTimeLocal$512(v$10032[0],v$10032[1]));
t$10517 = (t$10516(t$10515,t$10514));
t$10518 = (t$10517 + ": ");
t$10519 = (t$10518 + "You cannot delete files in the Server folder");
s$4151 = (t$10519 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4151));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
} else {(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = (basis$0List$1.filter$417(function(v$2035){var v$2036 = v$2035[0];
return (v$2036 == f$2004)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0])),0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = (basis$0List$1.filter$417(function(f$$2032){return (f$$2032 == f$2004)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0])),0);
var t$10520;
var v$4172 = basis$0String$1.tokens$224(function(c$4173){return c$4173 == 47;
},f$2004);
if (v$4172 == null) {t$10520 = false;
} else {var v$4174 = v$4172;
switch (v$4174[0]) { case "Server": {t$10520 = true;
 break; }default: {t$10520 = false;
} };
};
t$10520?0:((function(obj,a){return obj.remove(a);})(fts$1903,f$2004));
closetab$1906(f$2004);
var v$2023 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$2023[0]) { case 0: {var v$2029 = v$2023[1];
return appfun2$0dropbox$1.delete_file$388(v$2029,f$2004,function(v$2027){var v$2028 = v$2027[0];
var s$4178 = ((("Deleted file " + (("'" + f$2004) + "'")) + " (") + v$2028) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4178);
var s$4180;
var t$10526;
var t$10525;
var t$10524;
var t$10523 = basis$0Date$1.fmt$816;
var t$10522 = "%H:%M:%S";
var t$10521;
var v$10033 = SmlPrims.getrealtime();
t$10521 = (basis$0Date$1.fromTimeLocal$512(v$10033[0],v$10033[1]));
t$10524 = (t$10523(t$10522,t$10521));
t$10525 = (t$10524 + ": ");
t$10526 = (t$10525 + s$4178);
s$4180 = (t$10526 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4180));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
 break; }default: {return 0;
} };
};
} };
};
smltojs0$0SmlToJsCompApp$1$2.addTab$2037 = function(filename$2040,md5$2043,editor$2046){return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = [[filename$2040,[md5$2043],editor$2046],smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]],0);
};
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047 = function(v$2082,v$2083,v$2084){var c$2053 = v$2084[0](0);
var newMd5$2058 = md5$0md5$1.fromString$410(c$2053);
if (v$2083[0] == newMd5$2058) {return 0;
} else {var t$10528;
var v$4200 = basis$0String$1.tokens$224(function(c$4201){return c$4201 == 47;
},v$2082);
if (v$4200 == null) {t$10528 = false;
} else {var v$4202 = v$4200;
switch (v$4202[0]) { case "Server": {t$10528 = true;
 break; }default: {t$10528 = false;
} };
};
if (t$10528) {var s$4203 = ("Modified server file " + (("'" + v$2082) + "'")) + " not saved";
notify0$1026("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4203);
var s$4205;
var t$10534;
var t$10533;
var t$10532;
var t$10531 = basis$0Date$1.fmt$816;
var t$10530 = "%H:%M:%S";
var t$10529;
var v$10034 = SmlPrims.getrealtime();
t$10529 = (basis$0Date$1.fromTimeLocal$512(v$10034[0],v$10034[1]));
t$10532 = (t$10531(t$10530,t$10529));
t$10533 = (t$10532 + ": ");
t$10534 = (t$10533 + s$4203);
s$4205 = (t$10534 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4205));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
} else {try {var v$2071 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$2071[0]) { case 0: {var v$2079 = v$2071[1];
return appfun2$0dropbox$1.write_file$302(v$2079,v$2082,c$2053,function(v$2075){var v$2078 = v$2075[0];
var s$4216 = ((("Saved file " + (("'" + v$2082) + "'")) + " (") + v$2078) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4216);
var s$4218;
var t$10540;
var t$10539;
var t$10538;
var t$10537 = basis$0Date$1.fmt$816;
var t$10536 = "%H:%M:%S";
var t$10535;
var v$10035 = SmlPrims.getrealtime();
t$10535 = (basis$0Date$1.fromTimeLocal$512(v$10035[0],v$10035[1]));
t$10538 = (t$10537(t$10536,t$10535));
t$10539 = (t$10538 + ": ");
t$10540 = (t$10539 + s$4216);
s$4218 = (t$10540 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4218));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return (v$2083[0] = newMd5$2058,0);
});
 break; }default: {return 0;
} };
} catch(v$10527) {return (function(v$2081){return 0;
})(v$10527);
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.autosave$2085 = function(v$2087){var fix$10541 = {};
fix$10541.$app = function(v$4233){lab$app: while (true) {if (v$4233 == null) {return 0;
} else {var v$4234 = v$4233;
var v$4235 = v$4234[0];
var v$4236 = v$4234[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047(v$4235[0],v$4235[1],v$4235[2]);
var t$10542 = v$4236;
var v$4233 = t$10542;
continue lab$app;
};
};
};
var app$4232 = fix$10541.$app;
return app$4232(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
};
smltojs0$0SmlToJsCompApp$1$2.closeTab$2088 = function(n$2091){var v$2116;
var t$10543;
var p$4239 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var fields$4240 = basis$0String$1.fields$231(function(c$4241){return c$4241 == 47;
},p$4239);
var v$4242 = basis$0List$1.rev$682(fields$4240);
if (v$4242 == null) {t$10543 = false;
} else {var v$4243 = v$4242;
var v$4244 = v$4243[0];
var v$4245 = v$4243[1];
var t$10546;
var v$6628 = basis$0String$1.fields$231(function(c$6629){return c$6629 == 46;
},v$4244);
if (v$6628 == null) {t$10546 = false;
} else {var v$6630 = v$6628;
var v$6631 = v$6630[1];
if (v$6631 == null) {t$10546 = false;
} else {var v$6632 = v$6631;
if (v$6632[1] == null) {var v$6633 = v$6630[0];
var v$6634 = v$6632[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6633)) {var fix$10547 = {};
fix$10547.$exists = function(v$6636){lab$exists: while (true) {if (v$6636 == null) {return false;
} else {var v$6637 = v$6636;
var v$6638 = v$6637[0];
var v$6639 = v$6637[1];
if (v$6634 == v$6638) {return true;
} else {var t$10548 = v$6639;
var v$6636 = t$10548;
continue lab$exists;
};
};
};
};
var exists$6635 = fix$10547.$exists;
t$10546 = (exists$6635(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10546 = false;
};
} else {t$10546 = false;
};
};
};
if (t$10546) {var fix$10544 = {};
fix$10544.$all = function(v$4247){lab$all: while (true) {if (v$4247 == null) {return true;
} else {var v$4248 = v$4247;
var v$4249 = v$4248[0];
var v$4250 = v$4248[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4249)) {var t$10545 = v$4250;
var v$4247 = t$10545;
continue lab$all;
} else {return false;
};
};
};
};
var all$4246 = fix$10544.$all;
t$10543 = (all$4246(v$4245));
} else {t$10543 = false;
};
};
v$2116 = (t$10543?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$2116[0]) { case 0: {var v$2122 = v$2116[1];
(n$2091 == v$2122)?(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0):0;
 break; }default: {0;
} };
var v$2104 = basis$0List$1.find$392(function(v$2109){return v$2109[0] == n$2091;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
switch (v$2104[0]) { case 0: {var v$2106 = v$2104[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047(v$2106[0],v$2106[1],v$2106[2]);
 break; }default: {0;
} };
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = (basis$0List$1.filter$417(function(v$2097){var v$2098 = v$2097[0];
return (v$2098 == n$2091)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0])),0);
};
smltojs0$0SmlToJsCompApp$1$2.stripAbsolute$2123 = function(a$2126){var t$10550;
if (a$2126.length > 0) {var t$10549;
if (0 >= a$2126.length) {throw CompilerInitial.exn$Subscript$52;
} else {t$10549 = (a$2126.charCodeAt(0));
};
t$10550 = (t$10549 == 47);
} else {t$10550 = false;
};
return t$10550?[0,basis$0String$1.extract$116(a$2126,1,[1])]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.move$2135 = function(fts$2138,folderpath$2141,filename$2144,newfile$2147){var v$2228;
var t$10553;
var fields$4272 = basis$0String$1.fields$231(function(c$4273){return c$4273 == 47;
},newfile$2147);
var v$4274 = basis$0List$1.rev$682(fields$4272);
if (v$4274 == null) {t$10553 = false;
} else {var v$4275 = v$4274;
var v$4276 = v$4275[0];
var v$4277 = v$4275[1];
var t$10556;
var v$6644 = basis$0String$1.fields$231(function(c$6645){return c$6645 == 46;
},v$4276);
if (v$6644 == null) {t$10556 = false;
} else {var v$6646 = v$6644;
var v$6647 = v$6646[1];
if (v$6647 == null) {t$10556 = false;
} else {var v$6648 = v$6647;
if (v$6648[1] == null) {var v$6649 = v$6646[0];
var v$6650 = v$6648[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6649)) {var fix$10557 = {};
fix$10557.$exists = function(v$6652){lab$exists: while (true) {if (v$6652 == null) {return false;
} else {var v$6653 = v$6652;
var v$6654 = v$6653[0];
var v$6655 = v$6653[1];
if (v$6650 == v$6654) {return true;
} else {var t$10558 = v$6655;
var v$6652 = t$10558;
continue lab$exists;
};
};
};
};
var exists$6651 = fix$10557.$exists;
t$10556 = (exists$6651(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10556 = false;
};
} else {t$10556 = false;
};
};
};
if (t$10556) {var fix$10554 = {};
fix$10554.$all = function(v$4279){lab$all: while (true) {if (v$4279 == null) {return true;
} else {var v$4280 = v$4279;
var v$4281 = v$4280[0];
var v$4282 = v$4280[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4281)) {var t$10555 = v$4282;
var v$4279 = t$10555;
continue lab$all;
} else {return false;
};
};
};
};
var all$4278 = fix$10554.$all;
t$10553 = (all$4278(v$4277));
} else {t$10553 = false;
};
};
if (t$10553) {var v$2241 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(newfile$2147);
var v$2242 = v$2241[1];
switch (v$2242[0]) { case 0: {var v$2249 = v$2241[0];
var t$10561;
switch (folderpath$2141) { case "0": {t$10561 = newfile$2147;
 break; }default: {t$10561 = ((folderpath$2141 + "/") + newfile$2147);
} };
var t$10560 = v$2242[1];
var t$10559;
if (v$2249 == "0") {t$10559 = folderpath$2141;
} else {switch (folderpath$2141) { case "0": {t$10559 = v$2249;
 break; }default: {t$10559 = ((folderpath$2141 + "/") + v$2249);
} };
};
v$2228 = [t$10561,t$10560,t$10559];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"move.impossible: newfile is a file"];
} };
} else {var v$2255;
var t$10552;
if (newfile$2147.length > 0) {var t$10551;
if (0 >= newfile$2147.length) {throw CompilerInitial.exn$Subscript$52;
} else {t$10551 = (newfile$2147.charCodeAt(0));
};
t$10552 = (t$10551 == 47);
} else {t$10552 = false;
};
v$2255 = (t$10552?[0,basis$0String$1.extract$116(newfile$2147,1,[1])]:[1]);
switch (v$2255[0]) { case 0: {var v$2271 = v$2255[1];
var t$10562;
var fields$4302 = basis$0String$1.fields$231(function(c$4303){return c$4303 == 47;
},v$2271);
var v$4304 = basis$0List$1.rev$682(fields$4302);
if (v$4304 == null) {t$10562 = false;
} else {var v$4305 = v$4304;
var v$4306 = v$4305[0];
var v$4307 = v$4305[1];
var t$10565;
var v$6658 = basis$0String$1.fields$231(function(c$6659){return c$6659 == 46;
},v$4306);
if (v$6658 == null) {t$10565 = false;
} else {var v$6660 = v$6658;
var v$6661 = v$6660[1];
if (v$6661 == null) {t$10565 = false;
} else {var v$6662 = v$6661;
if (v$6662[1] == null) {var v$6663 = v$6660[0];
var v$6664 = v$6662[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6663)) {var fix$10566 = {};
fix$10566.$exists = function(v$6666){lab$exists: while (true) {if (v$6666 == null) {return false;
} else {var v$6667 = v$6666;
var v$6668 = v$6667[0];
var v$6669 = v$6667[1];
if (v$6664 == v$6668) {return true;
} else {var t$10567 = v$6669;
var v$6666 = t$10567;
continue lab$exists;
};
};
};
};
var exists$6665 = fix$10566.$exists;
t$10565 = (exists$6665(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10565 = false;
};
} else {t$10565 = false;
};
};
};
if (t$10565) {var fix$10563 = {};
fix$10563.$all = function(v$4309){lab$all: while (true) {if (v$4309 == null) {return true;
} else {var v$4310 = v$4309;
var v$4311 = v$4310[0];
var v$4312 = v$4310[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4311)) {var t$10564 = v$4312;
var v$4309 = t$10564;
continue lab$all;
} else {return false;
};
};
};
};
var all$4308 = fix$10563.$all;
t$10562 = (all$4308(v$4307));
} else {t$10562 = false;
};
};
if (t$10562) {var v$2266 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(v$2271);
var v$2267 = v$2266[1];
switch (v$2267[0]) { case 0: {v$2228 = [v$2271,v$2267[1],v$2266[0]];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"move.impossible: newfile is a file"];
} };
} else {throw [basis$0Initial$1.en$Fail$54,"Invalid target path " + (("'" + newfile$2147) + "'")];
};
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Invalid target path " + (("'" + newfile$2147) + "'")];
} };
};
var v$2229 = v$2228[0];
var v$2230 = v$2228[1];
var v$2231 = v$2228[2];
var filepath$2152;
switch (folderpath$2141) { case "0": {filepath$2152 = filename$2144;
 break; }default: {filepath$2152 = ((folderpath$2141 + "/") + filename$2144);
} };
var v$5981;
var v$4327 = basis$0String$1.tokens$224(function(c$4328){return c$4328 == 47;
},filepath$2152);
if (v$4327 == null) {v$5981 = false;
} else {var v$4329 = v$4327;
switch (v$4329[0]) { case "Dropbox": {v$5981 = true;
 break; }default: {v$5981 = false;
} };
};
var v$5982;
var v$4331 = basis$0String$1.tokens$224(function(c$4332){return c$4332 == 47;
},v$2229);
if (v$4331 == null) {v$5982 = false;
} else {var v$4333 = v$4331;
switch (v$4333[0]) { case "Dropbox": {v$5982 = true;
 break; }default: {v$5982 = false;
} };
};
if (v$5981) {if (v$5982) {0;
} else {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to or from Dropbox paths"];
};
} else {if (v$5982) {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to or from Dropbox paths"];
} else {0;
};
};
var t$10575;
var v$4337 = basis$0String$1.tokens$224(function(c$4338){return c$4338 == 47;
},v$2229);
if (v$4337 == null) {t$10575 = false;
} else {var v$4339 = v$4337;
switch (v$4339[0]) { case "Server": {t$10575 = true;
 break; }default: {t$10575 = false;
} };
};
if (t$10575) {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to the server"];
} else {var t$10574;
var fix$10572 = {};
fix$10572.$exists = function(v$4342){lab$exists: while (true) {if (v$4342 == null) {return false;
} else {var v$4343 = v$4342;
var v$4344 = v$4343[0];
var v$4345 = v$4343[1];
if (v$4344 == v$2229) {return true;
} else {var t$10573 = v$4345;
var v$4342 = t$10573;
continue lab$exists;
};
};
};
};
var exists$4341 = fix$10572.$exists;
t$10574 = (exists$4341(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10574) {throw [basis$0Initial$1.en$Fail$54,("File " + (("'" + v$2229) + "'")) + " already exists"];
} else {var t$10571;
var t$10570;
var fix$10568 = {};
fix$10568.$exists = function(v$4359){lab$exists: while (true) {if (v$4359 == null) {return false;
} else {var v$4360 = v$4359;
var v$4361 = v$4360[0];
var v$4362 = v$4360[1];
if (v$4361 == v$2231) {return true;
} else {var t$10569 = v$4362;
var v$4359 = t$10569;
continue lab$exists;
};
};
};
};
var exists$4358 = fix$10568.$exists;
t$10570 = (exists$4358(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
t$10571 = (t$10570?false:true);
if (t$10571) {throw [basis$0Initial$1.en$Fail$54,("Target folder " + (("'" + v$2231) + "'")) + " does not exist"];
} else {var v$2170 = basis$0List$1.find$392(function(v$2214){return v$2214[0] == filepath$2152;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
switch (v$2170[0]) { case 0: {var v$2210 = v$2170[1];
var v$2211 = v$2210[2];
(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = (basis$0List$1.filter$417(function(v$2208){var v$2209 = v$2208[0];
return (v$2209 == filepath$2152)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0])),0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = (basis$0List$1.map$332(function(n$2201){return ((n$2201 == filepath$2152)?false:true)?n$2201:v$2229;
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0])),0);
var t$10576;
var v$4394 = basis$0String$1.tokens$224(function(c$4395){return c$4395 == 47;
},filepath$2152);
if (v$4394 == null) {t$10576 = false;
} else {var v$4396 = v$4394;
switch (v$4396[0]) { case "Server": {t$10576 = true;
 break; }default: {t$10576 = false;
} };
};
t$10576?0:((function(obj,a){return obj.remove(a);})(fts$2138,filepath$2152));
var h$4400 = [["id",v$2229],[["parent",v$2231],[["name",v$2230],[["kind","leaf"],null]]]];
var t$10582 = fts$2138;
var t$10581;
var fix$10577 = {};
fix$10577.$foldl = function(v$4402,v$4403){lab$foldl: while (true) {if (v$4403 == null) {return v$4402;
} else {var v$4404 = v$4403;
var v$4405 = v$4404[0];
var v$4406 = v$4404[1];
var t$10578;
var v$4407 = v$4405[0];
var v$4408 = v$4405[1];
(function(fp,s,v){fp[s] = v;})(v$4402,v$4407,v$4408);
t$10578 = v$4402;
var t$10579 = t$10578;
var t$10580 = v$4406;
var v$4402 = t$10579;
var v$4403 = t$10580;
continue lab$foldl;
};
};
};
var foldl$4401 = fix$10577.$foldl;
var v$10073 = (function(){return {};})();
t$10581 = (foldl$4401(v$10073,h$4400));
(function(obj,a){return obj.add(a);})(t$10582,t$10581);
var v$2192 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$2192[0]) { case 0: {var v$2198 = v$2192[1];
appfun2$0dropbox$1.move_file$456(v$2198,filepath$2152,v$2229,function(v$2196){var v$2197 = v$2196[0];
var s$4410 = ((((("Moved file " + (("'" + filepath$2152) + "'")) + " to ") + (("'" + v$2229) + "'")) + " (") + v$2197) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4410);
var s$4412;
var t$10588;
var t$10587;
var t$10586;
var t$10585 = basis$0Date$1.fmt$816;
var t$10584 = "%H:%M:%S";
var t$10583;
var v$10036 = SmlPrims.getrealtime();
t$10583 = (basis$0Date$1.fromTimeLocal$512(v$10036[0],v$10036[1]));
t$10586 = (t$10585(t$10584,t$10583));
t$10587 = (t$10586 + ": ");
t$10588 = (t$10587 + s$4410);
s$4412 = (t$10588 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4412));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
 break; }default: {0;
} };
return [v$2229,v$2211[0](0)];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Impossible: cannot locate file in tab structure!"];
} };
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.ftsServer$2272;
var content$2273;
var file$6674;
var t$10592 = "otests/content?_=";
var t$10591;
var t$10590 = basis$0Real$1.toString$153;
var t$10589;
var v$6675 = SmlPrims.getrealtime();
t$10589 = ((v$6675[0] - (-2147483648)) + (v$6675[1] / 1000000.0));
t$10591 = (t$10590(t$10589));
file$6674 = (t$10592 + t$10591);
var r$6676 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$6676,"GET",file$6674,false);
js$0Js$1.send$654(r$6676,[1]);
var v$6677 = (function(r){return SmlPrims.option(r.responseText);})(r$6676);
switch (v$6677[0]) { case 0: {content$2273 = v$6677[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$6674];
} };
var content$2274 = basis$0String$1.translate$217(function(c$2277){return ((c$2277 == 32)?true:((9 <= c$2277)?(c$2277 <= 13):false))?"":(SmlPrims.implode([c$2277,null]));
},content$2273);
var lines$2282 = basis$0String$1.tokens$224(function(c$2285){return c$2285 == 59;
},content$2274);
var t$10614;
var t$10613 = [["id","Server"],[["name","Server"],[["kind","folder"],[["parent","0"],null]]]];
var t$10612;
var t$10593;
var v$6678 = null;
var fix$10594 = {};
fix$10594.$foldr = function(v$6680){if (v$6680 == null) {return v$6678;
} else {var v$6681 = v$6680;
var v$6682 = v$6681[0];
var v$6683 = v$6681[1];
var v$6685 = fix$10594.$foldr(v$6683);
var t$10611 = basis$0List$1.s$n$686;
var t$10595;
var v$6688 = basis$0String$1.tokens$224(function(c$6689){return c$6689 == 61;
},v$6682);
if (v$6688 == null) {t$10595 = null;
} else {var v$6690 = v$6688;
var v$6691 = v$6690[1];
if (v$6691 == null) {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"syntax error in otests/content file");
var s$6715;
var t$10601;
var t$10600;
var t$10599;
var t$10598 = basis$0Date$1.fmt$816;
var t$10597 = "%H:%M:%S";
var t$10596;
var v$10038 = SmlPrims.getrealtime();
t$10596 = (basis$0Date$1.fromTimeLocal$512(v$10038[0],v$10038[1]));
t$10599 = (t$10598(t$10597,t$10596));
t$10600 = (t$10599 + ": ");
t$10601 = (t$10600 + "syntax error in otests/content file");
s$6715 = (t$10601 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$6715));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
t$10595 = null;
} else {var v$6692 = v$6691;
if (v$6692[1] == null) {var v$6693 = v$6690[0];
var v$6694 = v$6692[0];
var sfolder$6695 = "Server/" + v$6693;
var t$10604;
var t$10603 = [["id",sfolder$6695],[["name",v$6693],[["kind","folder"],[["parent","Server"],null]]]];
var t$10602;
var files$6698 = basis$0String$1.tokens$224(function(c$6699){return c$6699 == 44;
},v$6694);
t$10602 = (basis$0List$1.map$332(function(f$6700){return [["id",(sfolder$6695 + "/") + f$6700],[["name",f$6700],[["kind","file"],[["parent",sfolder$6695],null]]]];
},files$6698));
t$10604 = [t$10603,t$10602];
t$10595 = t$10604;
} else {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"syntax error in otests/content file");
var s$6705;
var t$10610;
var t$10609;
var t$10608;
var t$10607 = basis$0Date$1.fmt$816;
var t$10606 = "%H:%M:%S";
var t$10605;
var v$10037 = SmlPrims.getrealtime();
t$10605 = (basis$0Date$1.fromTimeLocal$512(v$10037[0],v$10037[1]));
t$10608 = (t$10607(t$10606,t$10605));
t$10609 = (t$10608 + ": ");
t$10610 = (t$10609 + "syntax error in otests/content file");
s$6705 = (t$10610 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$6705));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
t$10595 = null;
};
};
};
return t$10611(t$10595,v$6685);
};
};
var foldr$6679 = fix$10594.$foldr;
t$10593 = (function(v$10186){return foldr$6679(v$10186);
});
t$10612 = (t$10593(lines$2282));
t$10614 = [t$10613,t$10612];
smltojs0$0SmlToJsCompApp$1$2.ftsServer$2272 = t$10614;
smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334 = function(v$2370,v$2371){return function(filename$2341){return function(content$2344){var inarea$2345;
var attrs$4530 = [["style","border:0;"],null];
var elem$4531 = document.createTextNode(content$2344);
var newelem$4532 = document.createElement("textarea");
var fix$10615 = {};
fix$10615.$app = function(v$4534){lab$app: while (true) {if (v$4534 == null) {return 0;
} else {var v$4535 = v$4534;
var v$4536 = v$4535[0];
var v$4537 = v$4535[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4532,v$4536[0],v$4536[1]);
var t$10616 = v$4537;
var v$4534 = t$10616;
continue lab$app;
};
};
};
var app$4533 = fix$10615.$app;
app$4533(attrs$4530);
(function(e,a){return e.appendChild(a);})(newelem$4532,elem$4531);
inarea$2345 = newelem$4532;
var inputarea$2346;
var attrs$4540 = [["class","textareacontainer"],null];
var newelem$4542 = document.createElement("div");
var fix$10617 = {};
fix$10617.$app = function(v$4544){lab$app: while (true) {if (v$4544 == null) {return 0;
} else {var v$4545 = v$4544;
var v$4546 = v$4545[0];
var v$4547 = v$4545[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4542,v$4546[0],v$4546[1]);
var t$10618 = v$4547;
var v$4544 = t$10618;
continue lab$app;
};
};
};
var app$4543 = fix$10617.$app;
app$4543(attrs$4540);
(function(e,a){return e.appendChild(a);})(newelem$4542,inarea$2345);
inputarea$2346 = newelem$4542;
var m$4548;
var v$6074;
var h$4555 = [["style","height:100%;"],[["title",filename$2341],[["closable","true"],null]]];
v$6074 = (function(f$4557){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$4558){var p$4559;
var t$10624 = Cp$4558;
var t$10623;
var fix$10619 = {};
fix$10619.$foldl = function(v$4561,v$4562){lab$foldl: while (true) {if (v$4562 == null) {return v$4561;
} else {var v$4563 = v$4562;
var v$4564 = v$4563[0];
var v$4565 = v$4563[1];
var t$10620;
var v$4566 = v$4564[0];
var v$4567 = v$4564[1];
(function(fp,s,v){fp[s] = v;})(v$4561,v$4566,v$4567);
t$10620 = v$4561;
var t$10621 = t$10620;
var t$10622 = v$4565;
var v$4561 = t$10621;
var v$4562 = t$10622;
continue lab$foldl;
};
};
};
var foldl$4560 = fix$10619.$foldl;
var v$10075 = (function(){return {};})();
t$10623 = (foldl$4560(v$10075,h$4555));
p$4559 = ((function(c,h){return new c(h);})(t$10624,t$10623));
(function(w,e){w.set('content', e);})(p$4559,inputarea$2346);
return f$4557(p$4559);
});
});
m$4548 = (function(c$4553){return v$6074(function(v$4554){(function(w,f){w.onClose = f;})(v$4554,function(v$6731){smltojs0$0SmlToJsCompApp$1$2.closeTab$2088(filename$2341);
return true;
});
(function(w,f){w.onShow = f;})(v$4554,function(v$6732){return (smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = filename$2341,0);
});
(function(obj,a){return obj.addChild(a);})(v$2370,v$4554);
(function(obj,a1,a2){return obj.selectChild(a1,a2);})(v$2370,v$4554,true);
(v$2371[0] = [[filename$2341,v$4554],v$2371[0]],0);
var a$6733 = 0;
return c$4553(a$6733);
});
});
m$4548(function(x$4549){return x$4549;
});
var editor$2348 = smltojs0$0SmlToJsCompApp$1$2.mkEditor$1218(inarea$2345);
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = [[filename$2341,[md5$0md5$1.fromString$410(content$2344)],editor$2348],smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]],0);
};
};
};
smltojs0$0SmlToJsCompApp$1$2.button$2372 = function(s$2375){var attrs$4587 = [["style","height:25px; width:100px;"],null];
var elem$4588;
var attrs$4596 = null;
var elem$4597 = document.createTextNode(s$2375);
var newelem$4598 = document.createElement("b");
var fix$10625 = {};
fix$10625.$app = function(v$4600){lab$app: while (true) {if (v$4600 == null) {return 0;
} else {var v$4601 = v$4600;
var v$4602 = v$4601[0];
var v$4603 = v$4601[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4598,v$4602[0],v$4602[1]);
var t$10626 = v$4603;
var v$4600 = t$10626;
continue lab$app;
};
};
};
var app$4599 = fix$10625.$app;
app$4599(attrs$4596);
(function(e,a){return e.appendChild(a);})(newelem$4598,elem$4597);
elem$4588 = newelem$4598;
var newelem$4589 = document.createElement("button");
var fix$10627 = {};
fix$10627.$app = function(v$4591){lab$app: while (true) {if (v$4591 == null) {return 0;
} else {var v$4592 = v$4591;
var v$4593 = v$4592[0];
var v$4594 = v$4592[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4589,v$4593[0],v$4593[1]);
var t$10628 = v$4594;
var v$4591 = t$10628;
continue lab$app;
};
};
};
var app$4590 = fix$10627.$app;
app$4590(attrs$4587);
(function(e,a){return e.appendChild(a);})(newelem$4589,elem$4588);
return newelem$4589;
};
smltojs0$0SmlToJsCompApp$1$2.withDialog$2376 = function(v$2427,v$2426,v$2432,v$2429,v$2428,v$2430,v$2431){var msgArea$2386;
var attrs$4606 = [["class","notify_area2"],[["style","opacity:0.0;top:0px;"],null]];
var newelem$4607 = document.createElement("span");
var fix$10629 = {};
fix$10629.$app = function(v$4609){lab$app: while (true) {if (v$4609 == null) {return 0;
} else {var v$4610 = v$4609;
var v$4611 = v$4610[0];
var v$4612 = v$4610[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4607,v$4611[0],v$4611[1]);
var t$10630 = v$4612;
var v$4609 = t$10630;
continue lab$app;
};
};
};
var app$4608 = fix$10629.$app;
app$4608(attrs$4606);
msgArea$2386 = newelem$4607;
var field$2405;
var attrs$4615 = [["type","text"],[["value",v$2430],null]];
var newelem$4616 = document.createElement("input");
var fix$10631 = {};
fix$10631.$app = function(v$4618){lab$app: while (true) {if (v$4618 == null) {return 0;
} else {var v$4619 = v$4618;
var v$4620 = v$4619[0];
var v$4621 = v$4619[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4616,v$4620[0],v$4620[1]);
var t$10632 = v$4621;
var v$4618 = t$10632;
continue lab$app;
};
};
};
var app$4617 = fix$10631.$app;
app$4617(attrs$4615);
field$2405 = newelem$4616;
var but$2406 = smltojs0$0SmlToJsCompApp$1$2.button$2372(v$2427);
var intro$2407;
switch (v$2429[0]) { case 0: {var v$2414 = v$2429[1];
var attrs$4623 = null;
var newelem$4625 = document.createElement("p");
var fix$10633 = {};
fix$10633.$app = function(v$4627){lab$app: while (true) {if (v$4627 == null) {return 0;
} else {var v$4628 = v$4627;
var v$4629 = v$4628[0];
var v$4630 = v$4628[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4625,v$4629[0],v$4629[1]);
var t$10634 = v$4630;
var v$4627 = t$10634;
continue lab$app;
};
};
};
var app$4626 = fix$10633.$app;
app$4626(attrs$4623);
(function(e,a){return e.appendChild(a);})(newelem$4625,v$2414);
intro$2407 = newelem$4625;
 break; }default: {intro$2407 = (document.createTextNode(""));
} };
var content$2415;
var attrs$4633 = [["style","width:400px;"],null];
var elem$4634;
var v$6082;
var v$6085;
var attrs$4650 = null;
var elem$4651;
var v$6086 = document.createTextNode(v$2428 + ": ");
var e$4661 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4661,v$6086);
(function(e,a){return e.appendChild(a);})(e$4661,field$2405);
elem$4651 = e$4661;
var newelem$4652 = document.createElement("p");
var fix$10635 = {};
fix$10635.$app = function(v$4654){lab$app: while (true) {if (v$4654 == null) {return 0;
} else {var v$4655 = v$4654;
var v$4656 = v$4655[0];
var v$4657 = v$4655[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4652,v$4656[0],v$4656[1]);
var t$10636 = v$4657;
var v$4654 = t$10636;
continue lab$app;
};
};
};
var app$4653 = fix$10635.$app;
app$4653(attrs$4650);
(function(e,a){return e.appendChild(a);})(newelem$4652,elem$4651);
v$6085 = newelem$4652;
var e$4648 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4648,intro$2407);
(function(e,a){return e.appendChild(a);})(e$4648,v$6085);
v$6082 = e$4648;
var v$6083;
var attrs$4665 = null;
var elem$4666;
var v$6090;
var v$6093 = document.createTextNode(" ");
var e$4680 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4680,but$2406);
(function(e,a){return e.appendChild(a);})(e$4680,v$6093);
v$6090 = e$4680;
var e$4676 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4676,v$6090);
(function(e,a){return e.appendChild(a);})(e$4676,msgArea$2386);
elem$4666 = e$4676;
var newelem$4667 = document.createElement("p");
var fix$10637 = {};
fix$10637.$app = function(v$4669){lab$app: while (true) {if (v$4669 == null) {return 0;
} else {var v$4670 = v$4669;
var v$4671 = v$4670[0];
var v$4672 = v$4670[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4667,v$4671[0],v$4671[1]);
var t$10638 = v$4672;
var v$4669 = t$10638;
continue lab$app;
};
};
};
var app$4668 = fix$10637.$app;
app$4668(attrs$4665);
(function(e,a){return e.appendChild(a);})(newelem$4667,elem$4666);
v$6083 = newelem$4667;
var e$4644 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4644,v$6082);
(function(e,a){return e.appendChild(a);})(e$4644,v$6083);
elem$4634 = e$4644;
var newelem$4635 = document.createElement("p");
var fix$10639 = {};
fix$10639.$app = function(v$4637){lab$app: while (true) {if (v$4637 == null) {return 0;
} else {var v$4638 = v$4637;
var v$4639 = v$4638[0];
var v$4640 = v$4638[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4635,v$4639[0],v$4639[1]);
var t$10640 = v$4640;
var v$4637 = t$10640;
continue lab$app;
};
};
};
var app$4636 = fix$10639.$app;
app$4636(attrs$4633);
(function(e,a){return e.appendChild(a);})(newelem$4635,elem$4634);
content$2415 = newelem$4635;
var dM$2416;
var v$6094;
var h$4687 = [["title",v$2426],null];
v$6094 = (function(f$4689){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4690){var d$4691;
var t$10646 = D$4690;
var t$10645;
var fix$10641 = {};
fix$10641.$foldl = function(v$4693,v$4694){lab$foldl: while (true) {if (v$4694 == null) {return v$4693;
} else {var v$4695 = v$4694;
var v$4696 = v$4695[0];
var v$4697 = v$4695[1];
var t$10642;
var v$4698 = v$4696[0];
var v$4699 = v$4696[1];
(function(fp,s,v){fp[s] = v;})(v$4693,v$4698,v$4699);
t$10642 = v$4693;
var t$10643 = t$10642;
var t$10644 = v$4697;
var v$4693 = t$10643;
var v$4694 = t$10644;
continue lab$foldl;
};
};
};
var foldl$4692 = fix$10641.$foldl;
var v$10077 = (function(){return {};})();
t$10645 = (foldl$4692(v$10077,h$4687));
d$4691 = ((function(c,h){return new c(h);})(t$10646,t$10645));
(function(w,e){w.set('content', e);})(d$4691,content$2415);
return f$4689(d$4691);
});
});
dM$2416 = (function(c$4685){return v$6094(function(v$4686){js$0Js$1.installEventHandler$197(but$2406,4,function(v$6744){var s$6745 = (function(e){return e.value;})(field$2405);
try {var t$6746 = v$2431(s$6745);
(function(obj){return obj.hide();})(v$4686);
v$2432(t$6746);
return true;
} catch(v$10647) {return (function(v$6747){var t$10648 = v$6747;
if (t$10648[0] == basis$0Initial$1.en$Fail$54) {var msg$6748 = v$6747[1];
notify0$1026("#dd8888",msgArea$2386,msg$6748);
return true;
} else {throw v$6747;
};
})(v$10647);
};
});
(function(obj){return obj.show();})(v$4686);
var a$6749 = 0;
return c$4685(a$6749);
});
});
return dM$2416(function(x$4710){return x$4710;
});
};
smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2433 = function(caption$2436,label$2439,msg$2442,f$2445){var cancel$2446 = smltojs0$0SmlToJsCompApp$1$2.button$2372("Cancel");
var but$2447 = smltojs0$0SmlToJsCompApp$1$2.button$2372(label$2439);
var content$2448;
var attrs$4712 = [["style","width:400px;"],null];
var elem$4713;
var v$6096;
var attrs$4725 = null;
var newelem$4727 = document.createElement("p");
var fix$10649 = {};
fix$10649.$app = function(v$4729){lab$app: while (true) {if (v$4729 == null) {return 0;
} else {var v$4730 = v$4729;
var v$4731 = v$4730[0];
var v$4732 = v$4730[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4727,v$4731[0],v$4731[1]);
var t$10650 = v$4732;
var v$4729 = t$10650;
continue lab$app;
};
};
};
var app$4728 = fix$10649.$app;
app$4728(attrs$4725);
(function(e,a){return e.appendChild(a);})(newelem$4727,msg$2442);
v$6096 = newelem$4727;
var v$6097;
var attrs$4734 = [["style","text-align:center;"],null];
var elem$4735;
var v$6098;
var v$6101 = document.createTextNode(" ");
var e$4749 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4749,cancel$2446);
(function(e,a){return e.appendChild(a);})(e$4749,v$6101);
v$6098 = e$4749;
var e$4745 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4745,v$6098);
(function(e,a){return e.appendChild(a);})(e$4745,but$2447);
elem$4735 = e$4745;
var newelem$4736 = document.createElement("p");
var fix$10651 = {};
fix$10651.$app = function(v$4738){lab$app: while (true) {if (v$4738 == null) {return 0;
} else {var v$4739 = v$4738;
var v$4740 = v$4739[0];
var v$4741 = v$4739[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4736,v$4740[0],v$4740[1]);
var t$10652 = v$4741;
var v$4738 = t$10652;
continue lab$app;
};
};
};
var app$4737 = fix$10651.$app;
app$4737(attrs$4734);
(function(e,a){return e.appendChild(a);})(newelem$4736,elem$4735);
v$6097 = newelem$4736;
var e$4723 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4723,v$6096);
(function(e,a){return e.appendChild(a);})(e$4723,v$6097);
elem$4713 = e$4723;
var newelem$4714 = document.createElement("p");
var fix$10653 = {};
fix$10653.$app = function(v$4716){lab$app: while (true) {if (v$4716 == null) {return 0;
} else {var v$4717 = v$4716;
var v$4718 = v$4717[0];
var v$4719 = v$4717[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4714,v$4718[0],v$4718[1]);
var t$10654 = v$4719;
var v$4716 = t$10654;
continue lab$app;
};
};
};
var app$4715 = fix$10653.$app;
app$4715(attrs$4712);
(function(e,a){return e.appendChild(a);})(newelem$4714,elem$4713);
content$2448 = newelem$4714;
var dM$2449;
var v$6102;
var h$4756 = [["title",caption$2436],null];
v$6102 = (function(f$4758){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4759){var d$4760;
var t$10660 = D$4759;
var t$10659;
var fix$10655 = {};
fix$10655.$foldl = function(v$4762,v$4763){lab$foldl: while (true) {if (v$4763 == null) {return v$4762;
} else {var v$4764 = v$4763;
var v$4765 = v$4764[0];
var v$4766 = v$4764[1];
var t$10656;
var v$4767 = v$4765[0];
var v$4768 = v$4765[1];
(function(fp,s,v){fp[s] = v;})(v$4762,v$4767,v$4768);
t$10656 = v$4762;
var t$10657 = t$10656;
var t$10658 = v$4766;
var v$4762 = t$10657;
var v$4763 = t$10658;
continue lab$foldl;
};
};
};
var foldl$4761 = fix$10655.$foldl;
var v$10079 = (function(){return {};})();
t$10659 = (foldl$4761(v$10079,h$4756));
d$4760 = ((function(c,h){return new c(h);})(t$10660,t$10659));
(function(w,e){w.set('content', e);})(d$4760,content$2448);
return f$4758(d$4760);
});
});
dM$2449 = (function(c$4754){return v$6102(function(v$4755){js$0Js$1.installEventHandler$197(but$2447,4,function(v$6757){(function(obj){return obj.hide();})(v$4755);
f$2445(0);
return true;
});
js$0Js$1.installEventHandler$197(cancel$2446,4,function(v$6758){(function(obj){return obj.hide();})(v$4755);
return true;
});
(function(obj){return obj.show();})(v$4755);
var a$6759 = 0;
return c$4754(a$6759);
});
});
return dM$2449(function(x$4775){return x$4775;
});
};
smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469 = function(buttonlabel$2472,caption$2475,content$2478){var but$2479 = smltojs0$0SmlToJsCompApp$1$2.button$2372(buttonlabel$2472);
var content$2480;
var attrs$4777 = [["style","width:500px;"],null];
var elem$4778;
var v$6105;
var attrs$4790 = [["style","text-align:center;"],null];
var newelem$4792 = document.createElement("p");
var fix$10661 = {};
fix$10661.$app = function(v$4794){lab$app: while (true) {if (v$4794 == null) {return 0;
} else {var v$4795 = v$4794;
var v$4796 = v$4795[0];
var v$4797 = v$4795[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4792,v$4796[0],v$4796[1]);
var t$10662 = v$4797;
var v$4794 = t$10662;
continue lab$app;
};
};
};
var app$4793 = fix$10661.$app;
app$4793(attrs$4790);
(function(e,a){return e.appendChild(a);})(newelem$4792,but$2479);
v$6105 = newelem$4792;
var e$4788 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4788,content$2478);
(function(e,a){return e.appendChild(a);})(e$4788,v$6105);
elem$4778 = e$4788;
var newelem$4779 = document.createElement("p");
var fix$10663 = {};
fix$10663.$app = function(v$4781){lab$app: while (true) {if (v$4781 == null) {return 0;
} else {var v$4782 = v$4781;
var v$4783 = v$4782[0];
var v$4784 = v$4782[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4779,v$4783[0],v$4783[1]);
var t$10664 = v$4784;
var v$4781 = t$10664;
continue lab$app;
};
};
};
var app$4780 = fix$10663.$app;
app$4780(attrs$4777);
(function(e,a){return e.appendChild(a);})(newelem$4779,elem$4778);
content$2480 = newelem$4779;
var dM$2481;
var v$6106;
var h$4803 = [["title",caption$2475],null];
v$6106 = (function(f$4805){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4806){var d$4807;
var t$10670 = D$4806;
var t$10669;
var fix$10665 = {};
fix$10665.$foldl = function(v$4809,v$4810){lab$foldl: while (true) {if (v$4810 == null) {return v$4809;
} else {var v$4811 = v$4810;
var v$4812 = v$4811[0];
var v$4813 = v$4811[1];
var t$10666;
var v$4814 = v$4812[0];
var v$4815 = v$4812[1];
(function(fp,s,v){fp[s] = v;})(v$4809,v$4814,v$4815);
t$10666 = v$4809;
var t$10667 = t$10666;
var t$10668 = v$4813;
var v$4809 = t$10667;
var v$4810 = t$10668;
continue lab$foldl;
};
};
};
var foldl$4808 = fix$10665.$foldl;
var v$10081 = (function(){return {};})();
t$10669 = (foldl$4808(v$10081,h$4803));
d$4807 = ((function(c,h){return new c(h);})(t$10670,t$10669));
(function(w,e){w.set('content', e);})(d$4807,content$2480);
return f$4805(d$4807);
});
});
dM$2481 = (function(c$4801){return v$6106(function(v$4802){js$0Js$1.installEventHandler$197(but$2479,4,function(v$6766){(function(obj){return obj.hide();})(v$4802);
return true;
});
(function(obj){return obj.show();})(v$4802);
var a$6767 = 0;
return c$4801(a$6767);
});
});
return dM$2481(function(x$4821){return x$4821;
});
};
smltojs0$0SmlToJsCompApp$1$2.infoDialogOk$2493 = function(v$10084){return function(v$10085){return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok",v$10084,v$10085);
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_NewNamedFile$2494 = function(tabsmap$2497,fts$2500,v$2502){var content$2503;
var t$10675;
var t$10674 = "(* File created ";
var t$10673;
var t$10672 = basis$0Date$1.toString$826;
var t$10671;
var v$10039 = SmlPrims.getrealtime();
t$10671 = (basis$0Date$1.fromTimeLocal$512(v$10039[0],v$10039[1]));
t$10673 = (t$10672(t$10671));
t$10675 = (t$10674 + t$10673);
content$2503 = (t$10675 + " *)\n");
var t$10687 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2376;
var t$10686 = "Create";
var t$10685 = "New File";
var t$10684 = function(s$2506){return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabsmap$2497[0],tabsmap$2497[1]))(s$2506))(content$2503);
};
var t$10683 = [1];
var t$10682 = "Name";
var t$10681;
var fix$10676 = {};
fix$10676.$suggest = function(f$6771){lab$suggest: while (true) {var num$6772 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6773 = f$6771(num$6772);
var t$10679;
var fix$10677 = {};
fix$10677.$exists = function(v$6776){lab$exists: while (true) {if (v$6776 == null) {return false;
} else {var v$6777 = v$6776;
var v$6778 = v$6777[0];
var v$6779 = v$6777[1];
if (v$6778 == name$6773) {return true;
} else {var t$10678 = v$6779;
var v$6776 = t$10678;
continue lab$exists;
};
};
};
};
var exists$6775 = fix$10677.$exists;
t$10679 = (exists$6775(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10679) {var t$10680 = f$6771;
var f$6771 = t$10680;
continue lab$suggest;
} else {return name$6773;
};
};
};
var suggest$6770 = fix$10676.$suggest;
t$10681 = (suggest$6770(function(num$6780){return ("Untitled-" + (basis$0Int32$1.toString$458(num$6780))) + ".sml";
}));
return t$10687(t$10686,t$10685,t$10684,t$10683,t$10682,t$10681,function(v$10088){return smltojs0$0SmlToJsCompApp$1$2.newFile$1837(fts$2500,content$2503,v$10088);
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_MoveFile$2514 = function(tabsmap$2517,fts$2520,closetab$2523,v$2525){var path$2526 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var intro$2527 = document.createTextNode("Files can be renamed or moved either using relative paths ('..' is not supported) or using absolute paths (starting with '/').");
var v$2534 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(path$2526);
var v$2535 = v$2534[1];
switch (v$2535[0]) { case 0: {var v$2552 = v$2534[0];
var v$2553 = v$2535[1];
return smltojs0$0SmlToJsCompApp$1$2.withDialog$2376("Move","Move/Rename File",function(v$2540){var v$2543 = v$2540[0];
var v$2544 = v$2540[1];
closetab$2523(path$2526);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabsmap$2517[0],tabsmap$2517[1]))(v$2543))(v$2544);
},[0,intro$2527],"New name",v$2553,function(v$10092){return smltojs0$0SmlToJsCompApp$1$2.move$2135(fts$2520,v$2552,v$2553,v$10092);
});
 break; }default: {return notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Renaming of folders not supported");
} };
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_FilesDelete$2555 = function(fts$2558,closetab$2561,v$2563){var msg$2564;
var v$2569;
var t$10688;
var p$4830 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var fields$4831 = basis$0String$1.fields$231(function(c$4832){return c$4832 == 47;
},p$4830);
var v$4833 = basis$0List$1.rev$682(fields$4831);
if (v$4833 == null) {t$10688 = false;
} else {var v$4834 = v$4833;
var v$4835 = v$4834[0];
var v$4836 = v$4834[1];
var t$10691;
var v$6782 = basis$0String$1.fields$231(function(c$6783){return c$6783 == 46;
},v$4835);
if (v$6782 == null) {t$10691 = false;
} else {var v$6784 = v$6782;
var v$6785 = v$6784[1];
if (v$6785 == null) {t$10691 = false;
} else {var v$6786 = v$6785;
if (v$6786[1] == null) {var v$6787 = v$6784[0];
var v$6788 = v$6786[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6787)) {var fix$10692 = {};
fix$10692.$exists = function(v$6790){lab$exists: while (true) {if (v$6790 == null) {return false;
} else {var v$6791 = v$6790;
var v$6792 = v$6791[0];
var v$6793 = v$6791[1];
if (v$6788 == v$6792) {return true;
} else {var t$10693 = v$6793;
var v$6790 = t$10693;
continue lab$exists;
};
};
};
};
var exists$6789 = fix$10692.$exists;
t$10691 = (exists$6789(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10691 = false;
};
} else {t$10691 = false;
};
};
};
if (t$10691) {var fix$10689 = {};
fix$10689.$all = function(v$4838){lab$all: while (true) {if (v$4838 == null) {return true;
} else {var v$4839 = v$4838;
var v$4840 = v$4839[0];
var v$4841 = v$4839[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4840)) {var t$10690 = v$4841;
var v$4838 = t$10690;
continue lab$all;
} else {return false;
};
};
};
};
var all$4837 = fix$10689.$all;
t$10688 = (all$4837(v$4836));
} else {t$10688 = false;
};
};
v$2569 = (t$10688?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$2569[0]) { case 0: {msg$2564 = (("Do you really want to delete the file " + (("'" + v$2569[1]) + "'")) + "?");
 break; }default: {var v$2576;
var t$10694;
var p$4848 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
if (p$4848 == "0") {t$10694 = true;
} else {var fields$4853 = basis$0String$1.fields$231(function(c$4854){return c$4854 == 47;
},p$4848);
var fix$10695 = {};
fix$10695.$all = function(v$4856){lab$all: while (true) {if (v$4856 == null) {return true;
} else {var v$4857 = v$4856;
var v$4858 = v$4857[0];
var v$4859 = v$4857[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4858)) {var t$10696 = v$4859;
var v$4856 = t$10696;
continue lab$all;
} else {return false;
};
};
};
};
var all$4855 = fix$10695.$all;
t$10694 = (all$4855(fields$4853));
};
v$2576 = (t$10694?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$2576[0]) { case 0: {msg$2564 = (("Do you really want to delete the folder " + (("'" + v$2576[1]) + "'")) + " and all its containing files?");
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"menuHandle_FilesDelete.impossible"];
} };
} };
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2433("Confirm Deletion","Delete",document.createTextNode(msg$2564),function(v$2580){return smltojs0$0SmlToJsCompApp$1$2.delete$1900(fts$2558,closetab$2561);
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_Export$2581 = function(v$2583){var v$10133 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Files Export to Zip",v$10133);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_Import$2584 = function(v$2586){var v$10135 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Files Import from Zip",v$10135);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_NewFolder$2587 = function(fts$2590,v$2592){var t$10708 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2376;
var t$10707 = "Create";
var t$10706 = "New Folder";
var t$10705 = function(s$2595){return 0;
};
var t$10704 = [1];
var t$10703 = "Name";
var t$10702;
var fix$10697 = {};
fix$10697.$suggest = function(f$6808){lab$suggest: while (true) {var num$6809 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6812 = f$6808(num$6809);
var t$10700;
var fix$10698 = {};
fix$10698.$exists = function(v$6815){lab$exists: while (true) {if (v$6815 == null) {return false;
} else {var v$6816 = v$6815;
var v$6817 = v$6816[0];
var v$6818 = v$6816[1];
if (v$6817 == name$6812) {return true;
} else {var t$10699 = v$6818;
var v$6815 = t$10699;
continue lab$exists;
};
};
};
};
var exists$6814 = fix$10698.$exists;
t$10700 = (exists$6814(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10700) {var t$10701 = f$6808;
var f$6808 = t$10701;
continue lab$suggest;
} else {return name$6812;
};
};
};
var suggest$6807 = fix$10697.$suggest;
t$10702 = (suggest$6807(function(num$4879){return "Folder-" + (basis$0Int32$1.toString$458(num$4879));
}));
return t$10708(t$10707,t$10706,t$10705,t$10704,t$10703,t$10702,function(v$10094){return smltojs0$0SmlToJsCompApp$1$2.newFolder$1855(fts$2590,v$10094);
});
};
smltojs0$0SmlToJsCompApp$1$2.treeHandle_LoadFile$2603 = function(tabsmap$2606,selecttab$2609,v$2613){var v$2625 = v$2613[0];
var t$10709;
if (v$2625 == "0") {t$10709 = true;
} else {var fields$4887 = basis$0String$1.fields$231(function(c$4888){return c$4888 == 47;
},v$2625);
var fix$10710 = {};
fix$10710.$all = function(v$4890){lab$all: while (true) {if (v$4890 == null) {return true;
} else {var v$4891 = v$4890;
var v$4892 = v$4891[0];
var v$4893 = v$4891[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4892)) {var t$10711 = v$4893;
var v$4890 = t$10711;
continue lab$all;
} else {return false;
};
};
};
};
var all$4889 = fix$10710.$all;
t$10709 = (all$4889(fields$4887));
};
if (t$10709) {return (smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = v$2625,0);
} else {return smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1662(v$2625,function(v$2622){switch (v$2622[0]) { case 0: {var v$2624 = v$2622[1];
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabsmap$2606[0],tabsmap$2606[1]))(v$2625))(v$2624);
 break; }default: {return selecttab$2609(v$2625);
} };
});
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_OpenDemo$2627 = function(tabsmap$2630,fts$2633,demo$2636,v$2638){var name$2639;
var fix$10712 = {};
fix$10712.$suggest = function(f$6821){lab$suggest: while (true) {var num$6822 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6823 = f$6821(num$6822);
var t$10715;
var fix$10713 = {};
fix$10713.$exists = function(v$6826){lab$exists: while (true) {if (v$6826 == null) {return false;
} else {var v$6827 = v$6826;
var v$6828 = v$6827[0];
var v$6829 = v$6827[1];
if (v$6828 == name$6823) {return true;
} else {var t$10714 = v$6829;
var v$6826 = t$10714;
continue lab$exists;
};
};
};
};
var exists$6825 = fix$10713.$exists;
t$10715 = (exists$6825(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10715) {var t$10716 = f$6821;
var f$6821 = t$10716;
continue lab$suggest;
} else {return name$6823;
};
};
};
var suggest$6820 = fix$10712.$suggest;
name$2639 = (suggest$6820(function(num$6830){return ("Demo-" + (basis$0Int32$1.toString$458(num$6830))) + ".sml";
}));
var path$2640 = smltojs0$0SmlToJsCompApp$1$2.newFile$1837(fts$2633,demo$2636,name$2639);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabsmap$2630[0],tabsmap$2630[1]))(path$2640))(demo$2636);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignIn$2641 = function(key$2644,v$2646){var t$10725;
var t$10721;
var t$10717;
var v$6152 = smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0];
var v$6153 = null;
var fix$10718 = {};
fix$10718.$eq_list = function(v$10137,v$10138){lab$eq_list: while (true) {if (v$10137 == null) {return (v$10138 == null)?true:false;
} else {if (v$10138 == null) {return false;
} else {var v$10139 = v$10137;
var v$10140 = v$10138;
if (v$10139[0] == v$10140[0]) {var t$10719 = v$10139[1];
var t$10720 = v$10140[1];
var v$10137 = t$10719;
var v$10138 = t$10720;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$10136 = fix$10718.$eq_list;
t$10717 = (eq_list$10136(v$6152,v$6153));
if (t$10717) {var v$6158 = smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0];
var v$6159 = ["0",null];
var fix$10722 = {};
fix$10722.$eq_list = function(v$10143,v$10144){lab$eq_list: while (true) {if (v$10143 == null) {return (v$10144 == null)?true:false;
} else {if (v$10144 == null) {return false;
} else {var v$10145 = v$10143;
var v$10146 = v$10144;
if (v$10145[0] == v$10146[0]) {var t$10723 = v$10145[1];
var t$10724 = v$10146[1];
var v$10143 = t$10723;
var v$10144 = t$10724;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$10142 = fix$10722.$eq_list;
t$10721 = (eq_list$10142(v$6158,v$6159));
} else {t$10721 = false;
};
t$10725 = (t$10721?true:((basis$0Option$1.isSome$56(0))(smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0])));
if (t$10725) {var c$4929 = ["https://www.dropbox.com/oauth2/authorize",key$2644,"http://localhost:8000"];
return appfun2$0dropbox$1.authorize$69(c$4929);
} else {var msg$2655 = document.createTextNode("Signing in to Dropbox will delete all application data created in this session. If this is the first time you sign in to Dropbox from this application, you will be asked to allow the application to store data in a special area of your Dropbox account.");
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2433("Dropbox Sign In","Sign in",msg$2655,function(v$4931){var c$4932 = ["https://www.dropbox.com/oauth2/authorize",key$2644,"http://localhost:8000"];
return appfun2$0dropbox$1.authorize$69(c$4932);
});
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignOut$2664 = function(c$2667,fts$2670,closetab$2673,v$2675){var msg$2676 = document.createTextNode("Signing out of Dropbox will not delete any files in the Dropbox App folder. You will always be able to sign in again using the \"Sign in\" entry in the Dropbox menu.");
var fix$10726 = {};
fix$10726.$app = function(v$4936){lab$app: while (true) {if (v$4936 == null) {return 0;
} else {var v$4937 = v$4936;
var v$4938 = v$4937[0];
var v$4939 = v$4937[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047(v$4938[0],v$4938[1],v$4938[2]);
var t$10727 = v$4939;
var v$4936 = t$10727;
continue lab$app;
};
};
};
var app$4935 = fix$10726.$app;
app$4935(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2433("Dropbox Sign Out","Sign out",msg$2676,function(v$2680){return appfun2$0dropbox$1.signOut$82(c$2667,function(v$2682){(smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0] = [1],0);
smltojs0$0SmlToJsCompApp$1$2.clear$1708(fts$2670,closetab$2673);
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Signed out of Dropbox");
var s$4943;
var t$10733;
var t$10732;
var t$10731;
var t$10730 = basis$0Date$1.fmt$816;
var t$10729 = "%H:%M:%S";
var t$10728;
var v$10042 = SmlPrims.getrealtime();
t$10728 = (basis$0Date$1.fromTimeLocal$512(v$10042[0],v$10042[1]));
t$10731 = (t$10730(t$10729,t$10728));
t$10732 = (t$10731 + ": ");
t$10733 = (t$10732 + "Signed out of Dropbox");
s$4943 = (t$10733 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4943));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981,"src","nodropbox.png");
});
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_CompileAndRun$2689 = function(v$2691){var v$2697 = smltojs0$0SmlToJsCompApp$1$2.currentEditor$1870(0);
switch (v$2697[0]) { case 0: {var v$2699 = v$2697[1];
var v$2700 = v$2699[0];
var v$2701 = v$2699[1];
var res$4954;
var v$4956 = v$2701[0](0);
var p_old$4957 = basis$0Control$1.printer_get$55(0);
var buf$4958 = [null];
basis$0Control$1.printer_set$54(function(s$4959){return (buf$4958[0] = [s$4959,buf$4958[0]],0);
});
try {smltojs0$0SmlToJsCompApp$1$1.compute$102(v$2700,v$4956);
} catch(v$10734) {(function(v$4961){return 0;
})(v$10734);
};
var res$4962 = SmlPrims.concat(basis$0List$1.rev$682(buf$4958[0]));
basis$0Control$1.printer_set$54(p_old$4957);
res$4954 = res$4962;
return smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0](res$4954);
 break; }default: {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"No file selected");
var s$4966;
var t$10740;
var t$10739;
var t$10738;
var t$10737 = basis$0Date$1.fmt$816;
var t$10736 = "%H:%M:%S";
var t$10735;
var v$10043 = SmlPrims.getrealtime();
t$10735 = (basis$0Date$1.fromTimeLocal$512(v$10043[0],v$10043[1]));
t$10738 = (t$10737(t$10736,t$10735));
t$10739 = (t$10738 + ": ");
t$10740 = (t$10739 + "No file selected");
s$4966 = (t$10740 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4966));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
} };
};
smltojs0$0SmlToJsCompApp$1$2.poweredby$2702 = function(v$2704){var v$6182;
var attrs$5046 = null;
var elem$5047;
var v$6184;
var v$6186;
var v$6188;
var v$6190;
var v$6192;
var v$6194;
var v$6196;
var v$6198;
var v$6200 = document.createTextNode("This IDE is based on ");
var v$6201;
var attrs$6832 = [["href","http://www.smlserver.org/smltojs"],[["target","_blank"],null]];
var elem$6833 = document.createTextNode("SMLtoJs");
var newelem$6834 = document.createElement("a");
var fix$10741 = {};
fix$10741.$app = function(v$6836){lab$app: while (true) {if (v$6836 == null) {return 0;
} else {var v$6837 = v$6836;
var v$6838 = v$6837[0];
var v$6839 = v$6837[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6834,v$6838[0],v$6838[1]);
var t$10742 = v$6839;
var v$6836 = t$10742;
continue lab$app;
};
};
};
var app$6835 = fix$10741.$app;
app$6835(attrs$6832);
(function(e,a){return e.appendChild(a);})(newelem$6834,elem$6833);
v$6201 = newelem$6834;
var e$5089 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5089,v$6200);
(function(e,a){return e.appendChild(a);})(e$5089,v$6201);
v$6198 = e$5089;
var v$6199 = document.createTextNode(", a Standard ML to JavaScript compiler. The front-end uses ");
var e$5085 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5085,v$6198);
(function(e,a){return e.appendChild(a);})(e$5085,v$6199);
v$6196 = e$5085;
var v$6197;
var attrs$6841 = [["href","http://dojotoolkit.org/"],[["target","_blank"],null]];
var elem$6842 = document.createTextNode("Dojo");
var newelem$6843 = document.createElement("a");
var fix$10743 = {};
fix$10743.$app = function(v$6845){lab$app: while (true) {if (v$6845 == null) {return 0;
} else {var v$6846 = v$6845;
var v$6847 = v$6846[0];
var v$6848 = v$6846[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6843,v$6847[0],v$6847[1]);
var t$10744 = v$6848;
var v$6845 = t$10744;
continue lab$app;
};
};
};
var app$6844 = fix$10743.$app;
app$6844(attrs$6841);
(function(e,a){return e.appendChild(a);})(newelem$6843,elem$6842);
v$6197 = newelem$6843;
var e$5081 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5081,v$6196);
(function(e,a){return e.appendChild(a);})(e$5081,v$6197);
v$6194 = e$5081;
var v$6195 = document.createTextNode(" and ");
var e$5077 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5077,v$6194);
(function(e,a){return e.appendChild(a);})(e$5077,v$6195);
v$6192 = e$5077;
var v$6193;
var attrs$6850 = [["href","http://codemirror.net"],[["target","_blank"],null]];
var elem$6851 = document.createTextNode("CodeMirror");
var newelem$6852 = document.createElement("a");
var fix$10745 = {};
fix$10745.$app = function(v$6854){lab$app: while (true) {if (v$6854 == null) {return 0;
} else {var v$6855 = v$6854;
var v$6856 = v$6855[0];
var v$6857 = v$6855[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6852,v$6856[0],v$6856[1]);
var t$10746 = v$6857;
var v$6854 = t$10746;
continue lab$app;
};
};
};
var app$6853 = fix$10745.$app;
app$6853(attrs$6850);
(function(e,a){return e.appendChild(a);})(newelem$6852,elem$6851);
v$6193 = newelem$6852;
var e$5073 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5073,v$6192);
(function(e,a){return e.appendChild(a);})(e$5073,v$6193);
v$6190 = e$5073;
var v$6191 = document.createTextNode(". The IDE ");
var e$5069 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5069,v$6190);
(function(e,a){return e.appendChild(a);})(e$5069,v$6191);
v$6188 = e$5069;
var v$6189 = document.createTextNode(" allows for the user to save source files in a personal Dropbox App folder using ");
var e$5065 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5065,v$6188);
(function(e,a){return e.appendChild(a);})(e$5065,v$6189);
v$6186 = e$5065;
var v$6187;
var attrs$6859 = [["href","https://www.dropbox.com/developers/documentation/http/overview"],[["target","_blank"],null]];
var elem$6860 = document.createTextNode("Dropbox API v2");
var newelem$6861 = document.createElement("a");
var fix$10747 = {};
fix$10747.$app = function(v$6863){lab$app: while (true) {if (v$6863 == null) {return 0;
} else {var v$6864 = v$6863;
var v$6865 = v$6864[0];
var v$6866 = v$6864[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6861,v$6865[0],v$6865[1]);
var t$10748 = v$6866;
var v$6863 = t$10748;
continue lab$app;
};
};
};
var app$6862 = fix$10747.$app;
app$6862(attrs$6859);
(function(e,a){return e.appendChild(a);})(newelem$6861,elem$6860);
v$6187 = newelem$6861;
var e$5061 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5061,v$6186);
(function(e,a){return e.appendChild(a);})(e$5061,v$6187);
v$6184 = e$5061;
var v$6185 = document.createTextNode(".");
var e$5057 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5057,v$6184);
(function(e,a){return e.appendChild(a);})(e$5057,v$6185);
elem$5047 = e$5057;
var newelem$5048 = document.createElement("p");
var fix$10749 = {};
fix$10749.$app = function(v$5050){lab$app: while (true) {if (v$5050 == null) {return 0;
} else {var v$5051 = v$5050;
var v$5052 = v$5051[0];
var v$5053 = v$5051[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$5048,v$5052[0],v$5052[1]);
var t$10750 = v$5053;
var v$5050 = t$10750;
continue lab$app;
};
};
};
var app$5049 = fix$10749.$app;
app$5049(attrs$5046);
(function(e,a){return e.appendChild(a);})(newelem$5048,elem$5047);
v$6182 = newelem$5048;
var v$6183;
var attrs$5097 = null;
var elem$5098;
var v$6202;
var v$6204;
var v$6206;
var v$6208;
var v$6210;
var v$6212;
var v$6214 = document.createTextNode(" The sources for this IDE are");
var v$6215 = document.createTextNode(" available by download from the ");
var e$5132 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5132,v$6214);
(function(e,a){return e.appendChild(a);})(e$5132,v$6215);
v$6212 = e$5132;
var v$6213;
var attrs$6868 = [["href","https://github.com/melsman/mlkit"],[["target","_blank"],null]];
var elem$6869 = document.createTextNode("Github MLKit Repository");
var newelem$6870 = document.createElement("a");
var fix$10751 = {};
fix$10751.$app = function(v$6872){lab$app: while (true) {if (v$6872 == null) {return 0;
} else {var v$6873 = v$6872;
var v$6874 = v$6873[0];
var v$6875 = v$6873[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6870,v$6874[0],v$6874[1]);
var t$10752 = v$6875;
var v$6872 = t$10752;
continue lab$app;
};
};
};
var app$6871 = fix$10751.$app;
app$6871(attrs$6868);
(function(e,a){return e.appendChild(a);})(newelem$6870,elem$6869);
v$6213 = newelem$6870;
var e$5128 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5128,v$6212);
(function(e,a){return e.appendChild(a);})(e$5128,v$6213);
v$6210 = e$5128;
var v$6211 = document.createTextNode(" and are distributed");
var e$5124 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5124,v$6210);
(function(e,a){return e.appendChild(a);})(e$5124,v$6211);
v$6208 = e$5124;
var v$6209 = document.createTextNode(" under the GPL2 license; some parts of the sources are also available under the MIT license.");
var e$5120 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5120,v$6208);
(function(e,a){return e.appendChild(a);})(e$5120,v$6209);
v$6206 = e$5120;
var v$6207 = document.createTextNode(" For information about licenses, please consult the sources at the ");
var e$5116 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5116,v$6206);
(function(e,a){return e.appendChild(a);})(e$5116,v$6207);
v$6204 = e$5116;
var v$6205;
var attrs$6877 = [["href","https://github.com/melsman/mlkit"],[["target","_blank"],null]];
var elem$6878 = document.createTextNode("Github MLKit Repository");
var newelem$6879 = document.createElement("a");
var fix$10753 = {};
fix$10753.$app = function(v$6881){lab$app: while (true) {if (v$6881 == null) {return 0;
} else {var v$6882 = v$6881;
var v$6883 = v$6882[0];
var v$6884 = v$6882[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6879,v$6883[0],v$6883[1]);
var t$10754 = v$6884;
var v$6881 = t$10754;
continue lab$app;
};
};
};
var app$6880 = fix$10753.$app;
app$6880(attrs$6877);
(function(e,a){return e.appendChild(a);})(newelem$6879,elem$6878);
v$6205 = newelem$6879;
var e$5112 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5112,v$6204);
(function(e,a){return e.appendChild(a);})(e$5112,v$6205);
v$6202 = e$5112;
var v$6203 = document.createTextNode(".");
var e$5108 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5108,v$6202);
(function(e,a){return e.appendChild(a);})(e$5108,v$6203);
elem$5098 = e$5108;
var newelem$5099 = document.createElement("p");
var fix$10755 = {};
fix$10755.$app = function(v$5101){lab$app: while (true) {if (v$5101 == null) {return 0;
} else {var v$5102 = v$5101;
var v$5103 = v$5102[0];
var v$5104 = v$5102[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$5099,v$5103[0],v$5103[1]);
var t$10756 = v$5104;
var v$5101 = t$10756;
continue lab$app;
};
};
};
var app$5100 = fix$10755.$app;
app$5100(attrs$5097);
(function(e,a){return e.appendChild(a);})(newelem$5099,elem$5098);
v$6183 = newelem$5099;
var e$5044 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5044,v$6182);
(function(e,a){return e.appendChild(a);})(e$5044,v$6183);
return e$5044;
};
smltojs0$0SmlToJsCompApp$1$2.menu$2719 = function(tabs$2722,fts$2725,closetab$2728){var v$6216;
var h$5144 = [["region","center"],[smltojs0$0SmlToJsCompApp$1$2.menuStyle$1306,null]];
v$6216 = (function(f$5145){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/MenuBar",function(MenuBar$5146){var menubar$5147;
var t$10762 = MenuBar$5146;
var t$10761;
var fix$10757 = {};
fix$10757.$foldl = function(v$5149,v$5150){lab$foldl: while (true) {if (v$5150 == null) {return v$5149;
} else {var v$5151 = v$5150;
var v$5152 = v$5151[0];
var v$5153 = v$5151[1];
var t$10758;
var v$5154 = v$5152[0];
var v$5155 = v$5152[1];
(function(fp,s,v){fp[s] = v;})(v$5149,v$5154,v$5155);
t$10758 = v$5149;
var t$10759 = t$10758;
var t$10760 = v$5153;
var v$5149 = t$10759;
var v$5150 = t$10760;
continue lab$foldl;
};
};
};
var foldl$5148 = fix$10757.$foldl;
var v$10097 = (function(){return {};})();
t$10761 = (foldl$5148(v$10097,h$5144));
menubar$5147 = ((function(c,h){return new c(h);})(t$10762,t$10761));
return f$5145([menubar$5147,[menubar$5147,true]]);
});
});
return function(c$5142){return v$6216(function(v$5143){var v$9040 = v$5143[0];
var v$9041 = v$5143[1];
var v$9042 = (dojo$0dojo$1.menu$801(v$9041[0],v$9041[1]))("File");
return v$9042(function(v$9044){var v$9045 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["New file",[0,dojo$0dojo$1.newPage$3265],function(v$9046){var content$9047;
var t$10767;
var t$10766 = "(* File created ";
var t$10765;
var t$10764 = basis$0Date$1.toString$826;
var t$10763;
var v$10044 = SmlPrims.getrealtime();
t$10763 = (basis$0Date$1.fromTimeLocal$512(v$10044[0],v$10044[1]));
t$10765 = (t$10764(t$10763));
t$10767 = (t$10766 + t$10765);
content$9047 = (t$10767 + " *)\n");
var t$10779 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2376;
var t$10778 = "Create";
var t$10777 = "New File";
var t$10776 = function(s$9048){return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabs$2722[0],tabs$2722[1]))(s$9048))(content$9047);
};
var t$10775 = [1];
var t$10774 = "Name";
var t$10773;
var fix$10768 = {};
fix$10768.$suggest = function(f$9050){lab$suggest: while (true) {var num$9051 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$9052 = f$9050(num$9051);
var t$10771;
var fix$10769 = {};
fix$10769.$exists = function(v$9054){lab$exists: while (true) {if (v$9054 == null) {return false;
} else {var v$9055 = v$9054;
var v$9056 = v$9055[0];
var v$9057 = v$9055[1];
if (v$9056 == name$9052) {return true;
} else {var t$10770 = v$9057;
var v$9054 = t$10770;
continue lab$exists;
};
};
};
};
var exists$9053 = fix$10769.$exists;
t$10771 = (exists$9053(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10771) {var t$10772 = f$9050;
var f$9050 = t$10772;
continue lab$suggest;
} else {return name$9052;
};
};
};
var suggest$9049 = fix$10768.$suggest;
t$10773 = (suggest$9049(function(num$9058){return ("Untitled-" + (basis$0Int32$1.toString$458(num$9058))) + ".sml";
}));
return t$10779(t$10778,t$10777,t$10776,t$10775,t$10774,t$10773,function(v$10101){return smltojs0$0SmlToJsCompApp$1$2.newFile$1837(fts$2725,content$9047,v$10101);
});
}]);
return v$9045(function(v$9059){var v$9060 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["New folder",[0,dojo$0dojo$1.folderClosed$3224],function(v$10006){var t$10791 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2376;
var t$10790 = "Create";
var t$10789 = "New Folder";
var t$10788 = function(s$10007){return 0;
};
var t$10787 = [1];
var t$10786 = "Name";
var t$10785;
var fix$10780 = {};
fix$10780.$suggest = function(f$10009){lab$suggest: while (true) {var num$10010 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$10011 = f$10009(num$10010);
var t$10783;
var fix$10781 = {};
fix$10781.$exists = function(v$10013){lab$exists: while (true) {if (v$10013 == null) {return false;
} else {var v$10014 = v$10013;
var v$10015 = v$10014[0];
var v$10016 = v$10014[1];
if (v$10015 == name$10011) {return true;
} else {var t$10782 = v$10016;
var v$10013 = t$10782;
continue lab$exists;
};
};
};
};
var exists$10012 = fix$10781.$exists;
t$10783 = (exists$10012(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10783) {var t$10784 = f$10009;
var f$10009 = t$10784;
continue lab$suggest;
} else {return name$10011;
};
};
};
var suggest$10008 = fix$10780.$suggest;
t$10785 = (suggest$10008(function(num$10017){return "Folder-" + (basis$0Int32$1.toString$458(num$10017));
}));
return t$10791(t$10790,t$10789,t$10788,t$10787,t$10786,t$10785,function(v$10103){return smltojs0$0SmlToJsCompApp$1$2.newFolder$1855(fts$2725,v$10103);
});
}]);
return v$9060(function(v$9061){var v$9062 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Move",[0,dojo$0dojo$1.paste$3236],function(v$9063){var path$9064 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var intro$9065 = document.createTextNode("Files can be renamed or moved either using relative paths ('..' is not supported) or using absolute paths (starting with '/').");
var v$9066 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(path$9064);
var v$9067 = v$9066[1];
switch (v$9067[0]) { case 0: {var v$9068 = v$9066[0];
var v$9069 = v$9067[1];
return smltojs0$0SmlToJsCompApp$1$2.withDialog$2376("Move","Move/Rename File",function(v$9070){var v$9071 = v$9070[0];
var v$9072 = v$9070[1];
closetab$2728(path$9064);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabs$2722[0],tabs$2722[1]))(v$9071))(v$9072);
},[0,intro$9065],"New name",v$9069,function(v$10107){return smltojs0$0SmlToJsCompApp$1$2.move$2135(fts$2725,v$9068,v$9069,v$10107);
});
 break; }default: {return notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Renaming of folders not supported");
} };
}]);
return v$9062(function(v$9073){var v$9074 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Delete",[0,dojo$0dojo$1.delete$3237],function(v$10110){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_FilesDelete$2555(fts$2725,closetab$2728,v$10110);
}]);
return v$9074(function(v$9075){var v$9076 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Export (zip)",[0,dojo$0dojo$1.indent$3252],function(v$9077){var v$10150 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Files Export to Zip",v$10150);
}]);
return v$9076(function(v$9078){var v$9079 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Import (zip)",[0,dojo$0dojo$1.outdent$3253],function(v$9080){var v$10152 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Files Import from Zip",v$10152);
}]);
return v$9079(function(v$9081){var v$9082;
switch (smltojs0$0SmlToJsCompApp$1$1.demoinput$76[0]) { case 1: {var a$9083 = 0;
v$9082 = (function(f$9084){return f$9084(a$9083);
});
 break; }default: {var v$9085 = smltojs0$0SmlToJsCompApp$1$1.demoinput$76[1];
v$9082 = ((dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Open Demo File",[1],function(v$9086){var name$9087;
var fix$10792 = {};
fix$10792.$suggest = function(f$9089){lab$suggest: while (true) {var num$9090 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$9091 = f$9089(num$9090);
var t$10795;
var fix$10793 = {};
fix$10793.$exists = function(v$9093){lab$exists: while (true) {if (v$9093 == null) {return false;
} else {var v$9094 = v$9093;
var v$9095 = v$9094[0];
var v$9096 = v$9094[1];
if (v$9095 == name$9091) {return true;
} else {var t$10794 = v$9096;
var v$9093 = t$10794;
continue lab$exists;
};
};
};
};
var exists$9092 = fix$10793.$exists;
t$10795 = (exists$9092(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10795) {var t$10796 = f$9089;
var f$9089 = t$10796;
continue lab$suggest;
} else {return name$9091;
};
};
};
var suggest$9088 = fix$10792.$suggest;
name$9087 = (suggest$9088(function(num$9097){return ("Demo-" + (basis$0Int32$1.toString$458(num$9097))) + ".sml";
}));
var path$9098 = smltojs0$0SmlToJsCompApp$1$2.newFile$1837(fts$2725,v$9085,name$9087);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabs$2722[0],tabs$2722[1]))(path$9098))(v$9085);
}]));
} };
return v$9082(function(v$9099){var v$9100;
switch (smltojs0$0SmlToJsCompApp$1$1.dropboxKey$210[0]) { case 1: {var a$9101 = 0;
v$9100 = (function(f$9102){return f$9102(a$9101);
});
 break; }default: {var v$9103 = smltojs0$0SmlToJsCompApp$1$1.dropboxKey$210[1];
var v$9104 = (dojo$0dojo$1.menu$801(v$9041[0],v$9041[1]))("Dropbox");
v$9100 = (function(c$9105){return v$9104(function(v$9106){var c$9107 = ["https://www.dropbox.com/oauth2/authorize",v$9103,"http://localhost:8000"];
if (appfun2$0dropbox$1.isAuthorized$73(c$9107)) {smltojs0$0SmlToJsCompApp$1$2.load$1634(c$9107,fts$2725);
appfun2$0dropbox$1.dropboxUid$186(c$9107,function(uid$9108){var s$9109 = ("Authorized to use " + uid$9108) + "'s Dropbox App Folder";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$9109);
var s$9110;
var t$10802;
var t$10801;
var t$10800;
var t$10799 = basis$0Date$1.fmt$816;
var t$10798 = "%H:%M:%S";
var t$10797;
var v$10045 = SmlPrims.getrealtime();
t$10797 = (basis$0Date$1.fromTimeLocal$512(v$10045[0],v$10045[1]));
t$10800 = (t$10799(t$10798,t$10797));
t$10801 = (t$10800 + ": ");
t$10802 = (t$10801 + s$9109);
s$9110 = (t$10802 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$9110));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
(function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981,"src","dropbox.png");
} else {notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Not Dropbox authorized");
var s$9111;
var t$10808;
var t$10807;
var t$10806;
var t$10805 = basis$0Date$1.fmt$816;
var t$10804 = "%H:%M:%S";
var t$10803;
var v$10046 = SmlPrims.getrealtime();
t$10803 = (basis$0Date$1.fromTimeLocal$512(v$10046[0],v$10046[1]));
t$10806 = (t$10805(t$10804,t$10803));
t$10807 = (t$10806 + ": ");
t$10808 = (t$10807 + "Not Dropbox authorized");
s$9111 = (t$10808 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$9111));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
var m$9112;
var v$9113 = (dojo$0dojo$1.item$827(v$9106[0],v$9106[1]))(["Sign in",[0,dojo$0dojo$1.createLink$3272],function(v$10112){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignIn$2641(v$9103,v$10112);
}]);
m$9112 = (function(c$9114){return v$9113(function(v$9115){return ((dojo$0dojo$1.item$827(v$9106[0],v$9106[1]))(["Sign out",[0,dojo$0dojo$1.unlink$3273],function(v$10116){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignOut$2664(c$9107,fts$2725,closetab$2728,v$10116);
}]))(c$9114);
});
});
m$9112(function(x$9116){return x$9116;
});
var a$9117 = 0;
return c$9105(a$9117);
});
});
} };
return v$9100(function(v$9118){var v$9119 = (dojo$0dojo$1.item$827(v$9041[0],v$9041[1]))(["Compile->Run",[1],function(v$10187){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_CompileAndRun$2689(v$10187);
}]);
return v$9119(function(v$9120){var v$9121 = (dojo$0dojo$1.item$827(v$9041[0],v$9041[1]))(["Clear output",[1],function(v$9122){var fix$10809 = {};
fix$10809.$whileSome = function(g$9124){lab$whileSome: while (true) {var v$9125 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
switch (v$9125[0]) { case 0: {var v$9126 = v$9125[1];
g$9124(v$9126);
var t$10810 = g$9124;
var g$9124 = t$10810;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$9123 = fix$10809.$whileSome;
return whileSome$9123(function(e$9127){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,e$9127);
});
}]);
return v$9121(function(v$9128){var v$9129;
var h$9130 = [["region","left"],[["style","padding:0;padding-right:10;background-color:#eeeeee;"],null]];
v$9129 = (function(f$9131){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9132){var p$9133;
var t$10816 = Cp$9132;
var t$10815;
var fix$10811 = {};
fix$10811.$foldl = function(v$9135,v$9136){lab$foldl: while (true) {if (v$9136 == null) {return v$9135;
} else {var v$9137 = v$9136;
var v$9138 = v$9137[0];
var v$9139 = v$9137[1];
var t$10812;
var v$9140 = v$9138[0];
var v$9141 = v$9138[1];
(function(fp,s,v){fp[s] = v;})(v$9135,v$9140,v$9141);
t$10812 = v$9135;
var t$10813 = t$10812;
var t$10814 = v$9139;
var v$9135 = t$10813;
var v$9136 = t$10814;
continue lab$foldl;
};
};
};
var foldl$9134 = fix$10811.$foldl;
var v$10117 = (function(){return {};})();
t$10815 = (foldl$9134(v$10117,h$9130));
p$9133 = ((function(c,h){return new c(h);})(t$10816,t$10815));
(function(w,e){w.set('content', e);})(p$9133,smltojs0$0SmlToJsCompApp$1$2.logo$1305);
return f$9131(p$9133);
});
});
return v$9129(function(v$9142){var v$9143;
var h$9144 = [["region","right"],[smltojs0$0SmlToJsCompApp$1$2.menuStyle$1306,null]];
v$9143 = (function(f$9145){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/MenuBar",function(MenuBar$9146){var menubar$9147;
var t$10822 = MenuBar$9146;
var t$10821;
var fix$10817 = {};
fix$10817.$foldl = function(v$9149,v$9150){lab$foldl: while (true) {if (v$9150 == null) {return v$9149;
} else {var v$9151 = v$9150;
var v$9152 = v$9151[0];
var v$9153 = v$9151[1];
var t$10818;
var v$9154 = v$9152[0];
var v$9155 = v$9152[1];
(function(fp,s,v){fp[s] = v;})(v$9149,v$9154,v$9155);
t$10818 = v$9149;
var t$10819 = t$10818;
var t$10820 = v$9153;
var v$9149 = t$10819;
var v$9150 = t$10820;
continue lab$foldl;
};
};
};
var foldl$9148 = fix$10817.$foldl;
var v$10119 = (function(){return {};})();
t$10821 = (foldl$9148(v$10119,h$9144));
menubar$9147 = ((function(c,h){return new c(h);})(t$10822,t$10821));
return f$9145([menubar$9147,[menubar$9147,true]]);
});
});
return v$9143(function(v$9156){var v$9157 = v$9156[0];
var v$9158 = v$9156[1];
var v$9159 = (dojo$0dojo$1.menu$801(v$9158[0],v$9158[1]))("Help");
return v$9159(function(v$9160){var v$9161 = (dojo$0dojo$1.item$827(v$9160[0],v$9160[1]))(["About",[0,dojo$0dojo$1.newPage$3265],function(v$9162){var v$10154 = smltojs0$0SmlToJsCompApp$1$1.about$58(0);
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","About SMLtoJs Online",v$10154);
}]);
return v$9161(function(v$9163){var v$9164 = (dojo$0dojo$1.item$827(v$9160[0],v$9160[1]))(["Powered by...",[0,dojo$0dojo$1.newPage$3265],function(v$9165){var v$10156 = smltojs0$0SmlToJsCompApp$1$2.poweredby$2702(0);
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Powered by...",v$10156);
}]);
return v$9164(function(v$9166){return ((dojo$0dojo$1.layoutContainer$316([["region","top"],[["style","height:30px;"],null]]))([v$9142,[v$9040,[v$9157,null]]]))(c$5142);
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
};
};
smltojs0$0SmlToJsCompApp$1$2.everything$2812;
var v$6282 = dojo$0dojo$1.advTabContainer$571([["region","top"],[["splitter","true"],[["style","height:70%;border:0;"],[["tabPosition","bottom"],null]]]]);
smltojs0$0SmlToJsCompApp$1$2.everything$2812 = (function(c$5324){return v$6282(function(v$5325){var v$9895 = v$5325[0];
var v$9896 = v$5325[1];
var v$9897 = v$9896[1];
var v$9898 = v$9896[0];
var v$9899;
var v$10121 = [[["id","0"],[["name","/"],[["kind","folder"],null]]],smltojs0$0SmlToJsCompApp$1$2.ftsServer$2272];
v$9899 = (function(v$10122){return dojo$0dojo$1.treeStore$481(v$10121,v$10122);
});
return v$9899(function(v$9901){var v$9902 = (((dojo$0dojo$1.tree$567([["region","left"],[["splitter","true"],[["style","width:20%;"],null]]]))("0"))(function(v$9903){var v$9904 = v$9903[0];
var t$10823;
if (v$9904 == "0") {t$10823 = true;
} else {var fields$9905 = basis$0String$1.fields$231(function(c$9906){return c$9906 == 47;
},v$9904);
var fix$10824 = {};
fix$10824.$all = function(v$9908){lab$all: while (true) {if (v$9908 == null) {return true;
} else {var v$9909 = v$9908;
var v$9910 = v$9909[0];
var v$9911 = v$9909[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$9910)) {var t$10825 = v$9911;
var v$9908 = t$10825;
continue lab$all;
} else {return false;
};
};
};
};
var all$9907 = fix$10824.$all;
t$10823 = (all$9907(fields$9905));
};
if (t$10823) {return (smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = v$9904,0);
} else {return smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1662(v$9904,function(v$9912){switch (v$9912[0]) { case 0: {var v$9913 = v$9912[1];
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(v$9895[0],v$9895[1]))(v$9904))(v$9913);
 break; }default: {return v$9897(v$9904);
} };
});
};
}))(v$9901);
return v$9902(function(v$9914){var v$9915 = smltojs0$0SmlToJsCompApp$1$2.menu$2719(v$9895,v$9901,v$9898);
return v$9915(function(v$9916){var v$9917;
var h$9918 = [["title","Output"],null];
v$9917 = (function(f$9919){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9920){var p$9921;
var t$10831 = Cp$9920;
var t$10830;
var fix$10826 = {};
fix$10826.$foldl = function(v$9923,v$9924){lab$foldl: while (true) {if (v$9924 == null) {return v$9923;
} else {var v$9925 = v$9924;
var v$9926 = v$9925[0];
var v$9927 = v$9925[1];
var t$10827;
var v$9928 = v$9926[0];
var v$9929 = v$9926[1];
(function(fp,s,v){fp[s] = v;})(v$9923,v$9928,v$9929);
t$10827 = v$9923;
var t$10828 = t$10827;
var t$10829 = v$9927;
var v$9923 = t$10828;
var v$9924 = t$10829;
continue lab$foldl;
};
};
};
var foldl$9922 = fix$10826.$foldl;
var v$10123 = (function(){return {};})();
t$10830 = (foldl$9922(v$10123,h$9918));
p$9921 = ((function(c,h){return new c(h);})(t$10831,t$10830));
(function(w,e){w.set('content', e);})(p$9921,smltojs0$0SmlToJsCompApp$1$2.outareaDiv$974);
return f$9919(p$9921);
});
});
return v$9917(function(v$9930){var v$9931;
var h$9932 = [["title","Message Log"],null];
v$9931 = (function(f$9933){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9934){var p$9935;
var t$10837 = Cp$9934;
var t$10836;
var fix$10832 = {};
fix$10832.$foldl = function(v$9937,v$9938){lab$foldl: while (true) {if (v$9938 == null) {return v$9937;
} else {var v$9939 = v$9938;
var v$9940 = v$9939[0];
var v$9941 = v$9939[1];
var t$10833;
var v$9942 = v$9940[0];
var v$9943 = v$9940[1];
(function(fp,s,v){fp[s] = v;})(v$9937,v$9942,v$9943);
t$10833 = v$9937;
var t$10834 = t$10833;
var t$10835 = v$9941;
var v$9937 = t$10834;
var v$9938 = t$10835;
continue lab$foldl;
};
};
};
var foldl$9936 = fix$10832.$foldl;
var v$10125 = (function(){return {};})();
t$10836 = (foldl$9936(v$10125,h$9932));
p$9935 = ((function(c,h){return new c(h);})(t$10837,t$10836));
(function(w,e){w.set('content', e);})(p$9935,smltojs0$0SmlToJsCompApp$1$2.logareaDiv$976);
return f$9933(p$9935);
});
});
return v$9931(function(v$9944){var v$9945 = (dojo$0dojo$1.tabContainer$314([["region","center"],[["style","height:30%;"],[["tabPosition","bottom"],null]]]))([v$9930,[v$9944,null]]);
return v$9945(function(v$9946){var v$9947 = (dojo$0dojo$1.borderContainer$315([["region","center"],null]))([v$9895[0],[v$9946,null]]);
return v$9947(function(v$9948){var v$9949;
switch (smltojs0$0SmlToJsCompApp$1$1.rightPane$212[0]) { case 0: {var v$9950 = smltojs0$0SmlToJsCompApp$1$1.rightPane$212[1];
var v$9951;
var h$9952 = [["region","right"],[["splitter","true"],null]];
var e$9953 = v$9950(0);
v$9951 = (function(f$9954){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9955){var p$9956;
var t$10843 = Cp$9955;
var t$10842;
var fix$10838 = {};
fix$10838.$foldl = function(v$9958,v$9959){lab$foldl: while (true) {if (v$9959 == null) {return v$9958;
} else {var v$9960 = v$9959;
var v$9961 = v$9960[0];
var v$9962 = v$9960[1];
var t$10839;
var v$9963 = v$9961[0];
var v$9964 = v$9961[1];
(function(fp,s,v){fp[s] = v;})(v$9958,v$9963,v$9964);
t$10839 = v$9958;
var t$10840 = t$10839;
var t$10841 = v$9962;
var v$9958 = t$10840;
var v$9959 = t$10841;
continue lab$foldl;
};
};
};
var foldl$9957 = fix$10838.$foldl;
var v$10127 = (function(){return {};})();
t$10842 = (foldl$9957(v$10127,h$9952));
p$9956 = ((function(c,h){return new c(h);})(t$10843,t$10842));
(function(w,e){w.set('content', e);})(p$9956,e$9953);
return f$9954(p$9956);
});
});
v$9949 = (function(c$9965){return v$9951(function(v$9966){var a$9967 = [v$9966,null];
return c$9965(a$9967);
});
});
 break; }default: {var a$9968 = null;
v$9949 = (function(f$9969){return f$9969(a$9968);
});
} };
return v$9949(function(v$9970){return ((dojo$0dojo$1.borderContainer$315([["style","height: 100%; width: 100%;"],null]))(basis$0List$1.s$n$686([v$9914,[v$9916,[v$9948,null]]],v$9970)))(c$5324);
});
});
});
});
});
});
});
});
});
});
var t$10844;
var v$5417 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5417[0]) { case 0: {t$10844 = v$5417[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
(function(e,a){return e.appendChild(a);})(t$10844,smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980);
var t$10845;
var v$5423 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5423[0]) { case 0: {t$10845 = v$5423[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
(function(e,a){return e.appendChild(a);})(t$10845,smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981);
var t$10847 = dojo$0dojo$1.attachToElement$201;
var t$10846;
var v$5427 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5427[0]) { case 0: {t$10846 = v$5427[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
t$10847(t$10846,smltojs0$0SmlToJsCompApp$1$2.everything$2812,function(v$2883){return 0;
});
smltojs0$0SmlToJsCompApp$1$2.onload$2863 = function(v$2865){var v$5431 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$5431[0]) { case 0: {var v$5432 = v$5431[1];
var v$5433 = (function(e){return SmlPrims.option(e.nextSibling);})(v$5432);
switch (v$5433[0]) { case 0: {var v$5434 = v$5433[1];
var v$5435 = (function(e){return SmlPrims.option(e.nextSibling);})(v$5434);
switch (v$5435[0]) { case 0: {(function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123,v$5435[1]);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody2"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody3"];
} };
(smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0] = (function(s$5440){(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,document.createTextNode(s$5440));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
}),0);
smltojs0$0SmlToJsCompApp$1$1.onloadhook$155(function(s$5445){return smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0](s$5445);
});
(function(i,f){return setInterval(f,i);})(10000,function(v$5448){var fix$10848 = {};
fix$10848.$app = function(v$5450){lab$app: while (true) {if (v$5450 == null) {return 0;
} else {var v$5451 = v$5450;
var v$5452 = v$5451[0];
var v$5453 = v$5451[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047(v$5452[0],v$5452[1],v$5452[2]);
var t$10849 = v$5453;
var v$5450 = t$10849;
continue lab$app;
};
};
};
var app$5449 = fix$10848.$app;
return app$5449(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
});
return 0;
};
smltojs0$0SmlToJsCompApp$1$2.setWindowOnload$2872 = function(f$2875){return (function(a){return window.onload=a;})(f$2875);
};
(function(a){return window.onload=a;})(function(v$10188){return smltojs0$0SmlToJsCompApp$1$2.onload$2863(v$10188);
});
return 0;
})();
