if ((typeof(smltojs0$0SmlToJsCompApp$1$2)) == "undefined") {smltojs0$0SmlToJsCompApp$1$2 = {};
};
(function(){smltojs0$0SmlToJsCompApp$1$2.scrollDown$902 = function(e$905){return (function(t){t.scrollTop = t.scrollHeight;})(e$905);
};
smltojs0$0SmlToJsCompApp$1$2.userAgent$909 = function(v$911){return (function(){return navigator.userAgent;})();
};
smltojs0$0SmlToJsCompApp$1$2.agent$914 = basis$0String$1.translate$217(function(x$2928){return basis$0Char$1.toString$277(((65 <= x$2928)?(x$2928 <= 90):false)?(SmlPrims.chk_ovf_i32(x$2928 + 32)):x$2928);
},(function(){return navigator.userAgent;})());
smltojs0$0SmlToJsCompApp$1$2.touchDevices$915 = ["ipod",["ipad",["iphone",["series60",["symbian",["android",["windows ce",["blackberry",null]]]]]]]];
smltojs0$0SmlToJsCompApp$1$2.touchScreen$916 = function(a$919){var fix$10194 = {};
fix$10194.$exists = function(v$2938){lab$exists: while (true) {if (v$2938 == null) {return false;
} else {var v$2939 = v$2938;
var v$2940 = v$2939[0];
var v$2941 = v$2939[1];
if (basis$0String$1.isSubstring$268(v$2940,a$919)) {return true;
} else {var t$10195 = v$2941;
var v$2938 = t$10195;
continue lab$exists;
};
};
};
};
var exists$2937 = fix$10194.$exists;
return exists$2937(smltojs0$0SmlToJsCompApp$1$2.touchDevices$915);
};
smltojs0$0SmlToJsCompApp$1$2.serverGet$927 = function(file$930){var file$931;
var t$10199 = file$930 + "?_=";
var t$10198;
var t$10197 = basis$0Real$1.toString$160;
var t$10196;
var v$2945 = SmlPrims.getrealtime();
t$10196 = ((v$2945[0] - (-2147483648)) + (v$2945[1] / 1000000.0));
t$10198 = (t$10197(t$10196));
file$931 = (t$10199 + t$10198);
var r$932 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$932,"GET",file$931,false);
js$0Js$1.send$654(r$932,[1]);
var v$939 = (function(r){return SmlPrims.option(r.responseText);})(r$932);
switch (v$939[0]) { case 0: {return v$939[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$931];
} };
};
smltojs0$0SmlToJsCompApp$1$2.outarea$947;
var attrs$2953 = [["readonly","readonly"],null];
var newelem$2954 = document.createElement("textarea");
var fix$10200 = {};
fix$10200.$app = function(v$2956){lab$app: while (true) {if (v$2956 == null) {return 0;
} else {var v$2957 = v$2956;
var v$2958 = v$2957[0];
var v$2959 = v$2957[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2954,v$2958[0],v$2958[1]);
var t$10201 = v$2959;
var v$2956 = t$10201;
continue lab$app;
};
};
};
var app$2955 = fix$10200.$app;
app$2955(attrs$2953);
smltojs0$0SmlToJsCompApp$1$2.outarea$947 = newelem$2954;
smltojs0$0SmlToJsCompApp$1$2.outareaDiv$948;
var attrs$2961 = [["class","textareacontainer"],null];
var newelem$2963 = document.createElement("div");
var fix$10202 = {};
fix$10202.$app = function(v$2965){lab$app: while (true) {if (v$2965 == null) {return 0;
} else {var v$2966 = v$2965;
var v$2967 = v$2966[0];
var v$2968 = v$2966[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2963,v$2967[0],v$2967[1]);
var t$10203 = v$2968;
var v$2965 = t$10203;
continue lab$app;
};
};
};
var app$2964 = fix$10202.$app;
app$2964(attrs$2961);
(function(e,a){return e.appendChild(a);})(newelem$2963,smltojs0$0SmlToJsCompApp$1$2.outarea$947);
smltojs0$0SmlToJsCompApp$1$2.outareaDiv$948 = newelem$2963;
smltojs0$0SmlToJsCompApp$1$2.logarea$949;
var attrs$2970 = [["readonly","readonly"],null];
var newelem$2971 = document.createElement("textarea");
var fix$10204 = {};
fix$10204.$app = function(v$2973){lab$app: while (true) {if (v$2973 == null) {return 0;
} else {var v$2974 = v$2973;
var v$2975 = v$2974[0];
var v$2976 = v$2974[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2971,v$2975[0],v$2975[1]);
var t$10205 = v$2976;
var v$2973 = t$10205;
continue lab$app;
};
};
};
var app$2972 = fix$10204.$app;
app$2972(attrs$2970);
smltojs0$0SmlToJsCompApp$1$2.logarea$949 = newelem$2971;
smltojs0$0SmlToJsCompApp$1$2.logareaDiv$950;
var attrs$2978 = [["class","textareacontainer"],null];
var newelem$2980 = document.createElement("div");
var fix$10206 = {};
fix$10206.$app = function(v$2982){lab$app: while (true) {if (v$2982 == null) {return 0;
} else {var v$2983 = v$2982;
var v$2984 = v$2983[0];
var v$2985 = v$2983[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2980,v$2984[0],v$2984[1]);
var t$10207 = v$2985;
var v$2982 = t$10207;
continue lab$app;
};
};
};
var app$2981 = fix$10206.$app;
app$2981(attrs$2978);
(function(e,a){return e.appendChild(a);})(newelem$2980,smltojs0$0SmlToJsCompApp$1$2.logarea$949);
smltojs0$0SmlToJsCompApp$1$2.logareaDiv$950 = newelem$2980;
smltojs0$0SmlToJsCompApp$1$2.clearoutbutton$951;
var attrs$2987 = [["type","button"],[["value","Clear Output"],null]];
var newelem$2988 = document.createElement("input");
var fix$10208 = {};
fix$10208.$app = function(v$2990){lab$app: while (true) {if (v$2990 == null) {return 0;
} else {var v$2991 = v$2990;
var v$2992 = v$2991[0];
var v$2993 = v$2991[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2988,v$2992[0],v$2992[1]);
var t$10209 = v$2993;
var v$2990 = t$10209;
continue lab$app;
};
};
};
var app$2989 = fix$10208.$app;
app$2989(attrs$2987);
smltojs0$0SmlToJsCompApp$1$2.clearoutbutton$951 = newelem$2988;
smltojs0$0SmlToJsCompApp$1$2.nodropboxPng$952 = "nodropbox.png";
smltojs0$0SmlToJsCompApp$1$2.dropboxPng$953 = "dropbox.png";
smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954;
var attrs$2995 = [["class","notify_area"],null];
var elem$2996 = document.createTextNode("welcome!");
var newelem$2997 = document.createElement("div");
var fix$10210 = {};
fix$10210.$app = function(v$2999){lab$app: while (true) {if (v$2999 == null) {return 0;
} else {var v$3000 = v$2999;
var v$3001 = v$3000[0];
var v$3002 = v$3000[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2997,v$3001[0],v$3001[1]);
var t$10211 = v$3002;
var v$2999 = t$10211;
continue lab$app;
};
};
};
var app$2998 = fix$10210.$app;
app$2998(attrs$2995);
(function(e,a){return e.appendChild(a);})(newelem$2997,elem$2996);
smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954 = newelem$2997;
smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955;
var attrs$3005 = [["src","nodropbox.png"],[["class","dropbox_area"],null]];
var newelem$3006 = document.createElement("img");
var fix$10212 = {};
fix$10212.$app = function(v$3008){lab$app: while (true) {if (v$3008 == null) {return 0;
} else {var v$3009 = v$3008;
var v$3010 = v$3009[0];
var v$3011 = v$3009[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3006,v$3010[0],v$3010[1]);
var t$10213 = v$3011;
var v$3008 = t$10213;
continue lab$app;
};
};
};
var app$3007 = fix$10212.$app;
app$3007(attrs$3005);
smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955 = newelem$3006;
smltojs0$0SmlToJsCompApp$1$2.setNoDropboxPng$956 = function(v$958){return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955,"src","nodropbox.png");
};
smltojs0$0SmlToJsCompApp$1$2.setDropboxPng$959 = function(v$961){return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955,"src","dropbox.png");
};
var notifyTimeout$962 = [[1]];
var notify0$1000 = function(color$1003,e$1006,s$1009){var v$1020 = notifyTimeout$962[0];
switch (v$1020[0]) { case 0: {(function(id){return clearTimeout(id);})(v$1020[1]);
 break; }default: {0;
} };
(function(e,s){e.innerHTML = s;})(e$1006,s$1009);
(function(e,a,b){return e.setAttribute(a,b);})(e$1006,"style",((("opacity:" + (basis$0Real$1.toString$160(1.0))) + "; background-color:") + color$1003) + ";");
var t$10227 = notifyTimeout$962;
var t$10226;
var t$10225;
var t$10224 = 3000;
var t$10223;
var fix$10214 = {};
fix$10214.$fadeNotification = function(opacity$10008,v$10009){lab$fadeNotification: while (true) {if (opacity$10008 < 0.0) {(function(e,a,b){return e.setAttribute(a,b);})(e$1006,"style","opacity:0.0;");
return (notifyTimeout$962[0] = [1],0);
} else {(function(e,a,b){return e.setAttribute(a,b);})(e$1006,"style",((("opacity:" + (basis$0Real$1.toString$160(opacity$10008))) + "; background-color:") + color$1003) + ";");
var t$10222 = notifyTimeout$962;
var t$10221;
var t$10220;
var t$10219 = 50;
var t$10215;
var v$10052 = opacity$10008 - 0.02;
t$10215 = ((function(env$10218){return function(v$10053){var v$10216 = env$10218[0];
var v$10217 = env$10218[1];
return v$10217(v$10216,v$10053);
};
})([v$10052,fix$10214.$fadeNotification]));
t$10220 = ((function(i,f){return setTimeout(f,i);})(t$10219,t$10215));
t$10221 = [0,t$10220];
return (t$10222[0] = t$10221,0);
};
};
};
var fadeNotification$10007 = fix$10214.$fadeNotification;
t$10223 = (function(v$10055){return fadeNotification$10007(0.98,v$10055);
});
t$10225 = ((function(i,f){return setTimeout(f,i);})(t$10224,t$10223));
t$10226 = [0,t$10225];
return (t$10227[0] = t$10226,0);
};
smltojs0$0SmlToJsCompApp$1$2.notify_err$1023 = function(v$10058){return notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,v$10058);
};
smltojs0$0SmlToJsCompApp$1$2.notify_errE$1024 = function(v$10060){return function(v$10061){return notify0$1000("#dd8888",v$10060,v$10061);
};
};
smltojs0$0SmlToJsCompApp$1$2.notify_warn$1025 = function(v$10064){return notify0$1000("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,v$10064);
};
smltojs0$0SmlToJsCompApp$1$2.notify$1026 = function(v$10067){return notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,v$10067);
};
smltojs0$0SmlToJsCompApp$1$2.outRef$1027 = [function(v$1029){throw [basis$0Initial$1.en$Fail$54,"outRef not initialized"];
}];
smltojs0$0SmlToJsCompApp$1$2.out$1030 = function(s$1033){return smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0](s$1033);
};
var fix$10228 = {};
fix$10228.$whileSome = function(f$1037,g$1040){lab$whileSome: while (true) {var v$1045 = f$1037(0);
switch (v$1045[0]) { case 0: {var v$1049 = v$1045[1];
g$1040(v$1049);
var t$10229 = f$1037;
var t$10230 = g$1040;
var f$1037 = t$10229;
var g$1040 = t$10230;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.whileSome$1034 = fix$10228.$whileSome;
smltojs0$0SmlToJsCompApp$1$2.clearoutarea$1050 = function(v$1052){var fix$10231 = {};
fix$10231.$whileSome = function(g$6338){lab$whileSome: while (true) {var v$6339 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
switch (v$6339[0]) { case 0: {var v$6340 = v$6339[1];
g$6338(v$6340);
var t$10232 = g$6338;
var g$6338 = t$10232;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$6337 = fix$10231.$whileSome;
return whileSome$6337(function(e$1057){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,e$1057);
});
};
smltojs0$0SmlToJsCompApp$1$2.outfun$1058 = function(s$1061){(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,document.createTextNode(s$1061));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
};
smltojs0$0SmlToJsCompApp$1$2.clearlogarea$1064 = function(v$1066){var fix$10233 = {};
fix$10233.$whileSome = function(g$6345){lab$whileSome: while (true) {var v$6346 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
switch (v$6346[0]) { case 0: {var v$6347 = v$6346[1];
g$6345(v$6347);
var t$10234 = g$6345;
var g$6345 = t$10234;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$6344 = fix$10233.$whileSome;
return whileSome$6344(function(e$1071){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,e$1071);
});
};
smltojs0$0SmlToJsCompApp$1$2.log0$1072 = function(s$1075){var s$1076;
var t$10240;
var t$10239;
var t$10238;
var t$10237 = basis$0Date$1.fmt$816;
var t$10236 = "%H:%M:%S";
var t$10235;
var v$10023 = SmlPrims.getrealtime();
t$10235 = (basis$0Date$1.fromTimeLocal$512(v$10023[0],v$10023[1]));
t$10238 = (t$10237(t$10236,t$10235));
t$10239 = (t$10238 + ": ");
t$10240 = (t$10239 + s$1075);
s$1076 = (t$10240 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$1076));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
smltojs0$0SmlToJsCompApp$1$2.log$1079 = function(s$1082){notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$1082);
var s$3094;
var t$10246;
var t$10245;
var t$10244;
var t$10243 = basis$0Date$1.fmt$816;
var t$10242 = "%H:%M:%S";
var t$10241;
var v$10024 = SmlPrims.getrealtime();
t$10241 = (basis$0Date$1.fromTimeLocal$512(v$10024[0],v$10024[1]));
t$10244 = (t$10243(t$10242,t$10241));
t$10245 = (t$10244 + ": ");
t$10246 = (t$10245 + s$1082);
s$3094 = (t$10246 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3094));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
smltojs0$0SmlToJsCompApp$1$2.logerr$1085 = function(s$1088){notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$1088);
var s$3103;
var t$10252;
var t$10251;
var t$10250;
var t$10249 = basis$0Date$1.fmt$816;
var t$10248 = "%H:%M:%S";
var t$10247;
var v$10025 = SmlPrims.getrealtime();
t$10247 = (basis$0Date$1.fromTimeLocal$512(v$10025[0],v$10025[1]));
t$10250 = (t$10249(t$10248,t$10247));
t$10251 = (t$10250 + ": ");
t$10252 = (t$10251 + s$1088);
s$3103 = (t$10252 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3103));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
smltojs0$0SmlToJsCompApp$1$2.logwarn$1091 = function(s$1094){notify0$1000("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$1094);
var s$3112;
var t$10258;
var t$10257;
var t$10256;
var t$10255 = basis$0Date$1.fmt$816;
var t$10254 = "%H:%M:%S";
var t$10253;
var v$10026 = SmlPrims.getrealtime();
t$10253 = (basis$0Date$1.fromTimeLocal$512(v$10026[0],v$10026[1]));
t$10256 = (t$10255(t$10254,t$10253));
t$10257 = (t$10256 + ": ");
t$10258 = (t$10257 + s$1094);
s$3112 = (t$10258 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3112));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
smltojs0$0SmlToJsCompApp$1$2.topelem$1097 = (function(d){return d.documentElement;})(js$0Js$1.document$88);
smltojs0$0SmlToJsCompApp$1$2.appendStyleLink$1098 = function(path$1101){var v$1106 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1106[0]) { case 0: {var t$10262 = v$1106[1];
var t$10259;
var attrs$3125 = [["rel","stylesheet"],[["href",path$1101],null]];
var newelem$3126 = document.createElement("link");
var fix$10260 = {};
fix$10260.$app = function(v$3128){lab$app: while (true) {if (v$3128 == null) {return 0;
} else {var v$3129 = v$3128;
var v$3130 = v$3129[0];
var v$3131 = v$3129[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3126,v$3130[0],v$3130[1]);
var t$10261 = v$3131;
var v$3128 = t$10261;
continue lab$app;
};
};
};
var app$3127 = fix$10260.$app;
app$3127(attrs$3125);
t$10259 = newelem$3126;
return (function(e,a){return e.appendChild(a);})(t$10262,t$10259);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.appendIconLink$1109 = function(path$1112){var v$1117 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1117[0]) { case 0: {var t$10266 = v$1117[1];
var t$10263;
var attrs$3136 = [["rel","shortcut icon"],[["type","image/x-icon"],[["href",path$1112],null]]];
var newelem$3137 = document.createElement("link");
var fix$10264 = {};
fix$10264.$app = function(v$3139){lab$app: while (true) {if (v$3139 == null) {return 0;
} else {var v$3140 = v$3139;
var v$3141 = v$3140[0];
var v$3142 = v$3140[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3137,v$3141[0],v$3141[1]);
var t$10265 = v$3142;
var v$3139 = t$10265;
continue lab$app;
};
};
};
var app$3138 = fix$10264.$app;
app$3138(attrs$3136);
t$10263 = newelem$3137;
return (function(e,a){return e.appendChild(a);})(t$10266,t$10263);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.appendScript$1120 = function(path$1123){var v$1128 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1128[0]) { case 0: {var t$10270 = v$1128[1];
var t$10267;
var attrs$3147 = [["type","text/javascript"],[["src",path$1123],null]];
var newelem$3148 = document.createElement("script");
var fix$10268 = {};
fix$10268.$app = function(v$3150){lab$app: while (true) {if (v$3150 == null) {return 0;
} else {var v$3151 = v$3150;
var v$3152 = v$3151[0];
var v$3153 = v$3151[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3148,v$3152[0],v$3152[1]);
var t$10269 = v$3153;
var v$3150 = t$10269;
continue lab$app;
};
};
};
var app$3149 = fix$10268.$app;
app$3149(attrs$3147);
t$10267 = newelem$3148;
return (function(e,a){return e.appendChild(a);})(t$10270,t$10267);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.cleanupBody$1131 = function(v$1133){var v$1138 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1138[0]) { case 0: {var v$1154 = v$1138[1];
var v$1144 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1154);
switch (v$1144[0]) { case 0: {var v$1153 = v$1144[1];
var v$1150 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1153);
switch (v$1150[0]) { case 0: {return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097,v$1150[1]);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody2"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody3"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.createBody$1155 = function(v$1157){var v$1162 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1162[0]) { case 0: {var v$1173 = v$1162[1];
var v$1170 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1173);
switch (v$1170[0]) { case 0: {(function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097,v$1170[1]);
 break; }default: {0;
} };
var t$10274 = smltojs0$0SmlToJsCompApp$1$2.topelem$1097;
var t$10271;
var attrs$3166 = [["class","claro"],[["id","body"],null]];
var newelem$3167 = document.createElement("body");
var fix$10272 = {};
fix$10272.$app = function(v$3169){lab$app: while (true) {if (v$3169 == null) {return 0;
} else {var v$3170 = v$3169;
var v$3171 = v$3170[0];
var v$3172 = v$3170[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3167,v$3171[0],v$3171[1]);
var t$10273 = v$3172;
var v$3169 = t$10273;
continue lab$app;
};
};
};
var app$3168 = fix$10272.$app;
app$3168(attrs$3166);
t$10271 = newelem$3167;
return (function(e,a){return e.appendChild(a);})(t$10274,t$10271);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"createBody"];
} };
};
var v$6350 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6350[0]) { case 0: {var t$10278 = v$6350[1];
var t$10275;
var attrs$6351 = [["rel","stylesheet"],[["href","dijit/themes/claro/claro.css"],null]];
var newelem$6352 = document.createElement("link");
var fix$10276 = {};
fix$10276.$app = function(v$6354){lab$app: while (true) {if (v$6354 == null) {return 0;
} else {var v$6355 = v$6354;
var v$6356 = v$6355[0];
var v$6357 = v$6355[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6352,v$6356[0],v$6356[1]);
var t$10277 = v$6357;
var v$6354 = t$10277;
continue lab$app;
};
};
};
var app$6353 = fix$10276.$app;
app$6353(attrs$6351);
t$10275 = newelem$6352;
(function(e,a){return e.appendChild(a);})(t$10278,t$10275);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6359 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6359[0]) { case 0: {var t$10282 = v$6359[1];
var t$10279;
var attrs$6360 = [["rel","stylesheet"],[["href","js/codemirror/codemirror.css"],null]];
var newelem$6361 = document.createElement("link");
var fix$10280 = {};
fix$10280.$app = function(v$6363){lab$app: while (true) {if (v$6363 == null) {return 0;
} else {var v$6364 = v$6363;
var v$6365 = v$6364[0];
var v$6366 = v$6364[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6361,v$6365[0],v$6365[1]);
var t$10281 = v$6366;
var v$6363 = t$10281;
continue lab$app;
};
};
};
var app$6362 = fix$10280.$app;
app$6362(attrs$6360);
t$10279 = newelem$6361;
(function(e,a){return e.appendChild(a);})(t$10282,t$10279);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6368 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6368[0]) { case 0: {var t$10286 = v$6368[1];
var t$10283;
var attrs$6369 = [["type","text/javascript"],[["src","js/codemirror/sml.js"],null]];
var newelem$6370 = document.createElement("script");
var fix$10284 = {};
fix$10284.$app = function(v$6372){lab$app: while (true) {if (v$6372 == null) {return 0;
} else {var v$6373 = v$6372;
var v$6374 = v$6373[0];
var v$6375 = v$6373[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6370,v$6374[0],v$6374[1]);
var t$10285 = v$6375;
var v$6372 = t$10285;
continue lab$app;
};
};
};
var app$6371 = fix$10284.$app;
app$6371(attrs$6369);
t$10283 = newelem$6370;
(function(e,a){return e.appendChild(a);})(t$10286,t$10283);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
var v$6377 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6377[0]) { case 0: {var t$10290 = v$6377[1];
var t$10287;
var attrs$6378 = [["rel","stylesheet"],[["href","appfunstyle.css"],null]];
var newelem$6379 = document.createElement("link");
var fix$10288 = {};
fix$10288.$app = function(v$6381){lab$app: while (true) {if (v$6381 == null) {return 0;
} else {var v$6382 = v$6381;
var v$6383 = v$6382[0];
var v$6384 = v$6382[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6379,v$6383[0],v$6383[1]);
var t$10289 = v$6384;
var v$6381 = t$10289;
continue lab$app;
};
};
};
var app$6380 = fix$10288.$app;
app$6380(attrs$6378);
t$10287 = newelem$6379;
(function(e,a){return e.appendChild(a);})(t$10290,t$10287);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6386 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6386[0]) { case 0: {var t$10294 = v$6386[1];
var t$10291;
var attrs$6387 = [["rel","shortcut icon"],[["type","image/x-icon"],[["href","favicon.ico"],null]]];
var newelem$6388 = document.createElement("link");
var fix$10292 = {};
fix$10292.$app = function(v$6390){lab$app: while (true) {if (v$6390 == null) {return 0;
} else {var v$6391 = v$6390;
var v$6392 = v$6391[0];
var v$6393 = v$6391[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6388,v$6392[0],v$6392[1]);
var t$10293 = v$6393;
var v$6390 = t$10293;
continue lab$app;
};
};
};
var app$6389 = fix$10292.$app;
app$6389(attrs$6387);
t$10291 = newelem$6388;
(function(e,a){return e.appendChild(a);})(t$10294,t$10291);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
smltojs0$0SmlToJsCompApp$1$2.createBody$1155(0);
smltojs0$0SmlToJsCompApp$1$2.getElem$1180 = function(id$1183){var v$1188 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,id$1183);
switch (v$1188[0]) { case 0: {return v$1188[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
};
var fix$10295 = {};
fix$10295.$app = function(v$3177){lab$app: while (true) {if (v$3177 == null) {return 0;
} else {var v$3178 = v$3177;
var v$3179 = v$3178[0];
var v$3180 = v$3178[1];
var v$6395 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6395[0]) { case 0: {var t$10299 = v$6395[1];
var t$10296;
var attrs$6396 = [["type","text/javascript"],[["src",v$3179],null]];
var newelem$6397 = document.createElement("script");
var fix$10297 = {};
fix$10297.$app = function(v$6399){lab$app: while (true) {if (v$6399 == null) {return 0;
} else {var v$6400 = v$6399;
var v$6401 = v$6400[0];
var v$6402 = v$6400[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6397,v$6401[0],v$6401[1]);
var t$10298 = v$6402;
var v$6399 = t$10298;
continue lab$app;
};
};
};
var app$6398 = fix$10297.$app;
app$6398(attrs$6396);
t$10296 = newelem$6397;
(function(e,a){return e.appendChild(a);})(t$10299,t$10296);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
var t$10300 = v$3180;
var v$3177 = t$10300;
continue lab$app;
};
};
};
var app$3176 = fix$10295.$app;
app$3176(smltojs0$0SmlToJsCompApp$1$1.script_paths$88);
smltojs0$0SmlToJsCompApp$1$2.mkEditor$1192 = function(inarea$1195){var t$10303;
var fix$10301 = {};
fix$10301.$exists = function(v$3184){lab$exists: while (true) {if (v$3184 == null) {return false;
} else {var v$3185 = v$3184;
var v$3186 = v$3185[0];
var v$3187 = v$3185[1];
if (basis$0String$1.isSubstring$268(v$3186,smltojs0$0SmlToJsCompApp$1$2.agent$914)) {return true;
} else {var t$10302 = v$3187;
var v$3184 = t$10302;
continue lab$exists;
};
};
};
};
var exists$3183 = fix$10301.$exists;
t$10303 = (exists$3183(smltojs0$0SmlToJsCompApp$1$2.touchDevices$915));
if (t$10303) {return [function(v$1201){return (function(e){return e.value;})(inarea$1195);
},function(s$1204){var v$1209 = (function(e){return SmlPrims.option(e.firstChild);})(inarea$1195);
switch (v$1209[0]) { case 0: {var v$1211 = v$1209[1];
return (function(e,a,old){return e.replaceChild(a,old);})(inarea$1195,document.createTextNode(s$1204),v$1211);
 break; }default: {return (function(e,a){return e.appendChild(a);})(inarea$1195,document.createTextNode(s$1204));
} };
}];
} else {var properties$1212;
var t$1213 = (function(){return {};})();
(function(fp,s,v){fp[s] = v;})(t$1213,"textWrapping",true);
(function(fp,s,v){fp[s] = v;})(t$1213,"lineNumbers",true);
(function(fp,s,v){fp[s] = v;})(t$1213,"height","100%");
(function(fp,s,v){fp[s] = v;})(t$1213,"width","100%");
(function(fp,s,v){fp[s] = v;})(t$1213,"mode","sml");
properties$1212 = t$1213;
var ed$1224 = (function(e,props){return CodeMirror.fromTextArea(e,props);})(inarea$1195,properties$1212);
return [function(v$1228){return (function(e){return e.getValue();})(ed$1224);
},function(s$1231){return (function(e,s){return e.setValue(s);})(ed$1224,s$1231);
}];
};
};
smltojs0$0SmlToJsCompApp$1$2.exec_print$1236 = function(f$1239,v$1242){var p_old$1243 = basis$0Control$1.printer_get$55(0);
var buf$1244 = [null];
basis$0Control$1.printer_set$54(function(s$3215){return (buf$1244[0] = [s$3215,buf$1244[0]],0);
});
try {f$1239(v$1242);
} catch(v$10304) {(function(v$1256){return 0;
})(v$10304);
};
var res$1251 = SmlPrims.concat(basis$0List$1.rev$682(buf$1244[0]));
basis$0Control$1.printer_set$54(p_old$1243);
return res$1251;
};
smltojs0$0SmlToJsCompApp$1$2.compileAndRunEditor$1258 = function(f$1261,editor$1264){var res$1265;
var v$3220 = editor$1264[0](0);
var p_old$3221 = basis$0Control$1.printer_get$55(0);
var buf$3222 = [null];
basis$0Control$1.printer_set$54(function(s$3223){return (buf$3222[0] = [s$3223,buf$3222[0]],0);
});
try {smltojs0$0SmlToJsCompApp$1$1.compute$94(f$1261,v$3220);
} catch(v$10305) {(function(v$3225){return 0;
})(v$10305);
};
var res$3226 = SmlPrims.concat(basis$0List$1.rev$682(buf$3222[0]));
basis$0Control$1.printer_set$54(p_old$3221);
res$1265 = res$3226;
return smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0](res$1265);
};
smltojs0$0SmlToJsCompApp$1$2.noop$1270 = function(v$1272){return 0;
};
smltojs0$0SmlToJsCompApp$1$2.put$1273 = function(s$1276,v$1278){var s$3228 = s$1276 + "\n";
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,document.createTextNode(s$3228));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
};
smltojs0$0SmlToJsCompApp$1$2.logo$1279;
var attrs$3235 = [["src","smltojs_logo_transparent_small.png"],[["height","30px"],[["alt","SMLtoJs Online"],null]]];
var newelem$3236 = document.createElement("img");
var fix$10306 = {};
fix$10306.$app = function(v$3238){lab$app: while (true) {if (v$3238 == null) {return 0;
} else {var v$3239 = v$3238;
var v$3240 = v$3239[0];
var v$3241 = v$3239[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3236,v$3240[0],v$3240[1]);
var t$10307 = v$3241;
var v$3238 = t$10307;
continue lab$app;
};
};
};
var app$3237 = fix$10306.$app;
app$3237(attrs$3235);
smltojs0$0SmlToJsCompApp$1$2.logo$1279 = newelem$3236;
smltojs0$0SmlToJsCompApp$1$2.menuStyle$1280 = ["style","border:0;padding:2;"];
smltojs0$0SmlToJsCompApp$1$2.qq$1281 = function(s$1284){return ("'" + s$1284) + "'";
};
smltojs0$0SmlToJsCompApp$1$2.s$rr$1285 = function(v$1296,v$10027){switch (v$1296) { case "0": {return v$10027;
 break; }default: {return (v$1296 + "/") + v$10027;
} };
};
smltojs0$0SmlToJsCompApp$1$2.okExt$1299 = function(s$1302){var fix$10308 = {};
fix$10308.$exists = function(v$3251){lab$exists: while (true) {if (v$3251 == null) {return false;
} else {var v$3252 = v$3251;
var v$3253 = v$3252[0];
var v$3254 = v$3252[1];
if (s$1302 == v$3253) {return true;
} else {var t$10309 = v$3254;
var v$3251 = t$10309;
continue lab$exists;
};
};
};
};
var exists$3250 = fix$10308.$exists;
return exists$3250(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203);
};
smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306 = function(n$1309){if (n$1309.length > 0) {var t$10310;
var c$3267;
if (0 >= n$1309.length) {throw CompilerInitial.exn$Subscript$52;
} else {c$3267 = (n$1309.charCodeAt(0));
};
t$10310 = (((97 <= c$3267)?(c$3267 <= 122):false)?true:((65 <= c$3267)?(c$3267 <= 90):false));
if (t$10310) {var stop$3273 = n$1309.length;
var fix$10311 = {};
fix$10311.$lr = function(j$3275){lab$lr: while (true) {if (j$3275 >= stop$3273) {return true;
} else {var t$10312;
var c$6403 = n$1309.charCodeAt(j$3275);
t$10312 = (((((97 <= c$6403)?(c$6403 <= 122):false)?true:((65 <= c$6403)?(c$6403 <= 90):false))?true:((48 <= c$6403)?(c$6403 <= 57):false))?true:((c$6403 == 95)?true:(c$6403 == 45)));
if (t$10312) {var t$10313 = SmlPrims.chk_ovf_i32(j$3275 + 1);
var j$3275 = t$10313;
continue lab$lr;
} else {return false;
};
};
};
};
var lr$3274 = fix$10311.$lr;
return lr$3274(0);
} else {return false;
};
} else {return false;
};
};
smltojs0$0SmlToJsCompApp$1$2.okFileName$1329 = function(n$1332){var v$1340 = basis$0String$1.fields$231(function(c$1356){return c$1356 == 46;
},n$1332);
if (v$1340 == null) {return false;
} else {var v$1342 = v$1340;
var v$1343 = v$1342[1];
if (v$1343 == null) {return false;
} else {var v$1345 = v$1343;
if (v$1345[1] == null) {var v$1351 = v$1342[0];
var v$1352 = v$1345[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$1351)) {var fix$10314 = {};
fix$10314.$exists = function(v$3279){lab$exists: while (true) {if (v$3279 == null) {return false;
} else {var v$3280 = v$3279;
var v$3281 = v$3280[0];
var v$3282 = v$3280[1];
if (v$1352 == v$3281) {return true;
} else {var t$10315 = v$3282;
var v$3279 = t$10315;
continue lab$exists;
};
};
};
};
var exists$3278 = fix$10314.$exists;
return exists$3278(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203);
} else {return false;
};
} else {return false;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.okFolderPath$1357 = function(p$1360){if (p$1360 == "0") {return true;
} else {var fields$1365 = basis$0String$1.fields$231(function(c$1368){return c$1368 == 47;
},p$1360);
var fix$10316 = {};
fix$10316.$all = function(v$3297){lab$all: while (true) {if (v$3297 == null) {return true;
} else {var v$3298 = v$3297;
var v$3299 = v$3298[0];
var v$3300 = v$3298[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3299)) {var t$10317 = v$3300;
var v$3297 = t$10317;
continue lab$all;
} else {return false;
};
};
};
};
var all$3296 = fix$10316.$all;
return all$3296(fields$1365);
};
};
smltojs0$0SmlToJsCompApp$1$2.okFilePath$1369 = function(p$1372){var fields$1373 = basis$0String$1.fields$231(function(c$1376){return c$1376 == 47;
},p$1372);
var v$1382 = basis$0List$1.rev$682(fields$1373);
if (v$1382 == null) {return false;
} else {var v$1388 = v$1382;
var v$1389 = v$1388[0];
var v$1390 = v$1388[1];
var t$10320;
var v$6406 = basis$0String$1.fields$231(function(c$6407){return c$6407 == 46;
},v$1389);
if (v$6406 == null) {t$10320 = false;
} else {var v$6408 = v$6406;
var v$6409 = v$6408[1];
if (v$6409 == null) {t$10320 = false;
} else {var v$6410 = v$6409;
if (v$6410[1] == null) {var v$6411 = v$6408[0];
var v$6412 = v$6410[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6411)) {var fix$10321 = {};
fix$10321.$exists = function(v$6414){lab$exists: while (true) {if (v$6414 == null) {return false;
} else {var v$6415 = v$6414;
var v$6416 = v$6415[0];
var v$6417 = v$6415[1];
if (v$6412 == v$6416) {return true;
} else {var t$10322 = v$6417;
var v$6414 = t$10322;
continue lab$exists;
};
};
};
};
var exists$6413 = fix$10321.$exists;
t$10320 = (exists$6413(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10320 = false;
};
} else {t$10320 = false;
};
};
};
if (t$10320) {var fix$10318 = {};
fix$10318.$all = function(v$3303){lab$all: while (true) {if (v$3303 == null) {return true;
} else {var v$3304 = v$3303;
var v$3305 = v$3304[0];
var v$3306 = v$3304[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3305)) {var t$10319 = v$3306;
var v$3303 = t$10319;
continue lab$all;
} else {return false;
};
};
};
};
var all$3302 = fix$10318.$all;
return all$3302(v$1390);
} else {return false;
};
};
};
smltojs0$0SmlToJsCompApp$1$2.allfiles$1391 = [null];
smltojs0$0SmlToJsCompApp$1$2.alldirs$1392 = [["0",null]];
smltojs0$0SmlToJsCompApp$1$2.fileStore$1393 = [[1]];
smltojs0$0SmlToJsCompApp$1$2.current$1394 = ["0"];
smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395 = [null];
smltojs0$0SmlToJsCompApp$1$2.splitPath$1396 = function(p$1399){if (p$1399 == "0") {return [p$1399,[1]];
} else {var fields$1404 = basis$0String$1.fields$231(function(c$1407){return c$1407 == 47;
},p$1399);
var v$1416 = basis$0List$1.rev$682(fields$1404);
if (v$1416 == null) {throw [basis$0Initial$1.en$Fail$54,"impossible: splitPath"];
} else {var v$1418 = v$1416;
var v$1419 = v$1418[1];
if (v$1419 == null) {var v$1424 = v$1418[0];
var t$10323;
var v$6420 = basis$0String$1.fields$231(function(c$6421){return c$6421 == 46;
},v$1424);
if (v$6420 == null) {t$10323 = false;
} else {var v$6422 = v$6420;
var v$6423 = v$6422[1];
if (v$6423 == null) {t$10323 = false;
} else {var v$6424 = v$6423;
if (v$6424[1] == null) {var v$6425 = v$6422[0];
var v$6426 = v$6424[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6425)) {var fix$10324 = {};
fix$10324.$exists = function(v$6428){lab$exists: while (true) {if (v$6428 == null) {return false;
} else {var v$6429 = v$6428;
var v$6430 = v$6429[0];
var v$6431 = v$6429[1];
if (v$6426 == v$6430) {return true;
} else {var t$10325 = v$6431;
var v$6428 = t$10325;
continue lab$exists;
};
};
};
};
var exists$6427 = fix$10324.$exists;
t$10323 = (exists$6427(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10323 = false;
};
} else {t$10323 = false;
};
};
};
return t$10323?["0",[0,v$1424]]:[v$1424,[1]];
} else {var v$1429 = v$1418[0];
var t$10326;
var v$6433 = basis$0String$1.fields$231(function(c$6434){return c$6434 == 46;
},v$1429);
if (v$6433 == null) {t$10326 = false;
} else {var v$6435 = v$6433;
var v$6436 = v$6435[1];
if (v$6436 == null) {t$10326 = false;
} else {var v$6437 = v$6436;
if (v$6437[1] == null) {var v$6438 = v$6435[0];
var v$6439 = v$6437[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6438)) {var fix$10327 = {};
fix$10327.$exists = function(v$6441){lab$exists: while (true) {if (v$6441 == null) {return false;
} else {var v$6442 = v$6441;
var v$6443 = v$6442[0];
var v$6444 = v$6442[1];
if (v$6439 == v$6443) {return true;
} else {var t$10328 = v$6444;
var v$6441 = t$10328;
continue lab$exists;
};
};
};
};
var exists$6440 = fix$10327.$exists;
t$10326 = (exists$6440(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10326 = false;
};
} else {t$10326 = false;
};
};
};
return t$10326?[basis$0String$1.concatWith$182("/",basis$0List$1.rev$682(v$1419)),[0,v$1429]]:[p$1399,[1]];
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.splitFolderPath$1430 = function(p$1433){if (p$1433 == "0") {return [p$1433,[1]];
} else {var fields$1438 = basis$0String$1.fields$231(function(c$1441){return c$1441 == 47;
},p$1433);
var v$1450 = basis$0List$1.rev$682(fields$1438);
if (v$1450 == null) {throw [basis$0Initial$1.en$Fail$54,"impossible: splitFolderPath"];
} else {var v$1452 = v$1450;
var v$1453 = v$1452[1];
if (v$1453 == null) {var v$1458 = v$1452[0];
return (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$1458))?["0",[0,v$1458]]:[v$1458,[1]];
} else {var v$1463 = v$1452[0];
return (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$1463))?[basis$0String$1.concatWith$182("/",basis$0List$1.rev$682(v$1453)),[0,v$1463]]:[p$1433,[1]];
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.currentFolder$1464 = function(v$1466){return (smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0];
};
smltojs0$0SmlToJsCompApp$1$2.currentFile$1471 = function(v$1473){var t$10329;
var p$3316 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var fields$3317 = basis$0String$1.fields$231(function(c$3318){return c$3318 == 47;
},p$3316);
var v$3319 = basis$0List$1.rev$682(fields$3317);
if (v$3319 == null) {t$10329 = false;
} else {var v$3320 = v$3319;
var v$3321 = v$3320[0];
var v$3322 = v$3320[1];
var t$10332;
var v$6447 = basis$0String$1.fields$231(function(c$6448){return c$6448 == 46;
},v$3321);
if (v$6447 == null) {t$10332 = false;
} else {var v$6449 = v$6447;
var v$6450 = v$6449[1];
if (v$6450 == null) {t$10332 = false;
} else {var v$6451 = v$6450;
if (v$6451[1] == null) {var v$6452 = v$6449[0];
var v$6453 = v$6451[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6452)) {var fix$10333 = {};
fix$10333.$exists = function(v$6455){lab$exists: while (true) {if (v$6455 == null) {return false;
} else {var v$6456 = v$6455;
var v$6457 = v$6456[0];
var v$6458 = v$6456[1];
if (v$6453 == v$6457) {return true;
} else {var t$10334 = v$6458;
var v$6455 = t$10334;
continue lab$exists;
};
};
};
};
var exists$6454 = fix$10333.$exists;
t$10332 = (exists$6454(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10332 = false;
};
} else {t$10332 = false;
};
};
};
if (t$10332) {var fix$10330 = {};
fix$10330.$all = function(v$3324){lab$all: while (true) {if (v$3324 == null) {return true;
} else {var v$3325 = v$3324;
var v$3326 = v$3325[0];
var v$3327 = v$3325[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3326)) {var t$10331 = v$3327;
var v$3324 = t$10331;
continue lab$all;
} else {return false;
};
};
};
};
var all$3323 = fix$10330.$all;
t$10329 = (all$3323(v$3322));
} else {t$10329 = false;
};
};
return t$10329?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.currentIsFolder$1478 = function(v$1480){var t$10335;
var p$3330 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
if (p$3330 == "0") {t$10335 = true;
} else {var fields$3336 = basis$0String$1.fields$231(function(c$3337){return c$3337 == 47;
},p$3330);
var fix$10336 = {};
fix$10336.$all = function(v$3339){lab$all: while (true) {if (v$3339 == null) {return true;
} else {var v$3340 = v$3339;
var v$3341 = v$3340[0];
var v$3342 = v$3340[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3341)) {var t$10337 = v$3342;
var v$3339 = t$10337;
continue lab$all;
} else {return false;
};
};
};
};
var all$3338 = fix$10336.$all;
t$10335 = (all$3338(fields$3336));
};
return t$10335?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.fileExists$1485 = function(name$1488){var fix$10338 = {};
fix$10338.$exists = function(v$3351){lab$exists: while (true) {if (v$3351 == null) {return false;
} else {var v$3352 = v$3351;
var v$3353 = v$3352[0];
var v$3354 = v$3352[1];
if (v$3353 == name$1488) {return true;
} else {var t$10339 = v$3354;
var v$3351 = t$10339;
continue lab$exists;
};
};
};
};
var exists$3350 = fix$10338.$exists;
return exists$3350(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]);
};
smltojs0$0SmlToJsCompApp$1$2.folderExists$1492 = function(name$1495){var fix$10340 = {};
fix$10340.$exists = function(v$3372){lab$exists: while (true) {if (v$3372 == null) {return false;
} else {var v$3373 = v$3372;
var v$3374 = v$3373[0];
var v$3375 = v$3373[1];
if (v$3374 == name$1495) {return true;
} else {var t$10341 = v$3375;
var v$3372 = t$10341;
continue lab$exists;
};
};
};
};
var exists$3371 = fix$10340.$exists;
return exists$3371(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]);
};
smltojs0$0SmlToJsCompApp$1$2.isServerPath$1499 = function(p$1502){var v$1507 = basis$0String$1.tokens$224(function(c$1514){return c$1514 == 47;
},p$1502);
if (v$1507 == null) {return false;
} else {var v$1509 = v$1507;
switch (v$1509[0]) { case "Server": {return true;
 break; }default: {return false;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.isDropboxPath$1515 = function(p$1518){var v$1523 = basis$0String$1.tokens$224(function(c$1530){return c$1530 == 47;
},p$1518);
if (v$1523 == null) {return false;
} else {var v$1525 = v$1523;
switch (v$1525[0]) { case "Dropbox": {return true;
 break; }default: {return false;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.load$1608 = function(c$1611,fts$1614){(smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0] = [0,c$1611],0);
var t$10370 = appfun2$0dropbox$1.all_files$257;
var t$10369 = c$1611;
var t$10368;
var fix$10342 = {};
fix$10342.$app = function(v$3470){lab$app: while (true) {if (v$3470 == null) {return 0;
} else {var v$3471 = v$3470;
var v$3472 = v$3471[0];
var v$3473 = v$3471[1];
var loadDir$6473 = function(p$6474,n$6475){var d$6476;
switch (p$6474) { case "0": {d$6476 = n$6475;
 break; }default: {d$6476 = ((p$6474 + "/") + n$6475);
} };
var t$10345;
var fix$10343 = {};
fix$10343.$exists = function(v$6478){lab$exists: while (true) {if (v$6478 == null) {return false;
} else {var v$6479 = v$6478;
var v$6480 = v$6479[0];
var v$6481 = v$6479[1];
if (d$6476 == v$6480) {return true;
} else {var t$10344 = v$6481;
var v$6478 = t$10344;
continue lab$exists;
};
};
};
};
var exists$6477 = fix$10343.$exists;
t$10345 = (exists$6477(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10345) {return 0;
} else {var h$6482 = [["id",d$6476],[["parent",p$6474],[["name",n$6475],[["kind","folder"],null]]]];
var t$10351 = fts$1614;
var t$10350;
var fix$10346 = {};
fix$10346.$foldl = function(v$6484,v$6485){lab$foldl: while (true) {if (v$6485 == null) {return v$6484;
} else {var v$6486 = v$6485;
var v$6487 = v$6486[0];
var v$6488 = v$6486[1];
var t$10347;
var v$6489 = v$6487[0];
var v$6490 = v$6487[1];
(function(fp,s,v){fp[s] = v;})(v$6484,v$6489,v$6490);
t$10347 = v$6484;
var t$10348 = t$10347;
var t$10349 = v$6488;
var v$6484 = t$10348;
var v$6485 = t$10349;
continue lab$foldl;
};
};
};
var foldl$6483 = fix$10346.$foldl;
var v$10070 = (function(){return {};})();
t$10350 = (foldl$6483(v$10070,h$6482));
(function(obj,a){return obj.add(a);})(t$10351,t$10350);
return (smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0] = [d$6476,smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]],0);
};
};
var v$6491;
var fields$6492 = basis$0String$1.fields$231((function(env$10352){return function(c$6493){return c$6493 == 47;
};
})([]),v$3472);
var fix$10353 = {};
fix$10353.$loop = function(v$6495,v$6496){lab$loop: while (true) {if (v$6496 == null) {throw [basis$0Initial$1.en$Fail$54,"loadDirs.impossible"];
} else {var v$6497 = v$6496;
var v$6498 = v$6497[1];
if (v$6498 == null) {var v$6499 = v$6497[0];
var t$10355;
var v$6501 = basis$0String$1.fields$231((function(env$10354){return function(c$6502){return c$6502 == 46;
};
})([]),v$6499);
if (v$6501 == null) {t$10355 = false;
} else {var v$6503 = v$6501;
var v$6504 = v$6503[1];
if (v$6504 == null) {t$10355 = false;
} else {var v$6505 = v$6504;
if (v$6505[1] == null) {var v$6506 = v$6503[0];
var v$6507 = v$6505[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6506)) {var fix$10356 = {};
fix$10356.$exists = function(v$6509){lab$exists: while (true) {if (v$6509 == null) {return false;
} else {var v$6510 = v$6509;
var v$6511 = v$6510[0];
var v$6512 = v$6510[1];
if (v$6507 == v$6511) {return true;
} else {var t$10357 = v$6512;
var v$6509 = t$10357;
continue lab$exists;
};
};
};
};
var exists$6508 = fix$10356.$exists;
t$10355 = (exists$6508(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10355 = false;
};
} else {t$10355 = false;
};
};
};
if (t$10355) {return [0,[v$6495,v$6499]];
} else {loadDir$6473(v$6495,v$6499);
return [1];
};
} else {var v$6513 = v$6497[0];
loadDir$6473(v$6495,v$6513);
var t$10358;
switch (v$6495) { case "0": {t$10358 = v$6513;
 break; }default: {t$10358 = ((v$6495 + "/") + v$6513);
} };
var t$10359 = t$10358;
var t$10360 = v$6498;
var v$6495 = t$10359;
var v$6496 = t$10360;
continue lab$loop;
};
};
};
};
var loop$6494 = fix$10353.$loop;
v$6491 = (loop$6494("0",fields$6492));
switch (v$6491[0]) { case 1: {0;
 break; }default: {var v$6514 = v$6491[1];
var v$6515 = v$6514[0];
var v$6516 = v$6514[1];
var h$6517 = [["id",v$3472],[["parent",v$6515],[["name",v$6516],[["kind","leaf"],null]]]];
var t$10366 = fts$1614;
var t$10365;
var fix$10361 = {};
fix$10361.$foldl = function(v$6519,v$6520){lab$foldl: while (true) {if (v$6520 == null) {return v$6519;
} else {var v$6521 = v$6520;
var v$6522 = v$6521[0];
var v$6523 = v$6521[1];
var t$10362;
var v$6524 = v$6522[0];
var v$6525 = v$6522[1];
(function(fp,s,v){fp[s] = v;})(v$6519,v$6524,v$6525);
t$10362 = v$6519;
var t$10363 = t$10362;
var t$10364 = v$6523;
var v$6519 = t$10363;
var v$6520 = t$10364;
continue lab$foldl;
};
};
};
var foldl$6518 = fix$10361.$foldl;
var v$10072 = (function(){return {};})();
t$10365 = (foldl$6518(v$10072,h$6517));
(function(obj,a){return obj.add(a);})(t$10366,t$10365);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = [v$3472,smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]],0);
} };
var t$10367 = v$3473;
var v$3470 = t$10367;
continue lab$app;
};
};
};
var app$3469 = fix$10342.$app;
t$10368 = (function(v$10190){return app$3469(v$10190);
});
return t$10370(t$10369,t$10368);
};
smltojs0$0SmlToJsCompApp$1$2.loadFileContentFromServer$1618 = function(f$1621){var v$1626 = basis$0List$1.rev$682(basis$0String$1.tokens$224(function(c$1635){return c$1635 == 47;
},f$1621));
if (v$1626 == null) {throw [basis$0Initial$1.en$Fail$54,"failed to load server file content for " + f$1621];
} else {var v$1631 = v$1626;
var v$1632 = v$1631[0];
var c$1628;
var file$6526 = ("otests/" + v$1632) + "_";
var file$6527;
var t$10374 = file$6526 + "?_=";
var t$10373;
var t$10372 = basis$0Real$1.toString$160;
var t$10371;
var v$6528 = SmlPrims.getrealtime();
t$10371 = ((v$6528[0] - (-2147483648)) + (v$6528[1] / 1000000.0));
t$10373 = (t$10372(t$10371));
file$6527 = (t$10374 + t$10373);
var r$6529 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$6529,"GET",file$6527,false);
js$0Js$1.send$654(r$6529,[1]);
var v$6530 = (function(r){return SmlPrims.option(r.responseText);})(r$6529);
switch (v$6530[0]) { case 0: {c$1628 = v$6530[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$6527];
} };
var s$3542 = ("loaded file " + (("'" + f$1621) + "'")) + " from server";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$3542);
var s$3544;
var t$10380;
var t$10379;
var t$10378;
var t$10377 = basis$0Date$1.fmt$816;
var t$10376 = "%H:%M:%S";
var t$10375;
var v$10028 = SmlPrims.getrealtime();
t$10375 = (basis$0Date$1.fromTimeLocal$512(v$10028[0],v$10028[1]));
t$10378 = (t$10377(t$10376,t$10375));
t$10379 = (t$10378 + ": ");
t$10380 = (t$10379 + s$3542);
s$3544 = (t$10380 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3544));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return c$1628;
};
};
smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1636 = function(filename$1639,cont$1642){var t$10384;
var fix$10382 = {};
fix$10382.$exists = function(v$3561){lab$exists: while (true) {if (v$3561 == null) {return false;
} else {var v$3562 = v$3561;
var v$3563 = v$3562[0];
var v$3564 = v$3562[1];
if (v$3563[0] == filename$1639) {return true;
} else {var t$10383 = v$3564;
var v$3561 = t$10383;
continue lab$exists;
};
};
};
};
var exists$3560 = fix$10382.$exists;
t$10384 = (exists$3560(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]));
if (t$10384) {(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = filename$1639,0);
return cont$1642([1]);
} else {var t$10381;
var v$3580 = basis$0String$1.tokens$224(function(c$3581){return c$3581 == 47;
},filename$1639);
if (v$3580 == null) {t$10381 = false;
} else {var v$3582 = v$3580;
switch (v$3582[0]) { case "Server": {t$10381 = true;
 break; }default: {t$10381 = false;
} };
};
if (t$10381) {return cont$1642([0,smltojs0$0SmlToJsCompApp$1$2.loadFileContentFromServer$1618(filename$1639)]);
} else {var v$1657 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$1657[0]) { case 0: {var v$1666 = v$1657[1];
return appfun2$0dropbox$1.content$315(v$1666,filename$1639,function(c$1661){(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = filename$1639,0);
var s$3585 = "Loaded file " + (("'" + filename$1639) + "'");
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$3585);
var s$3587;
var t$10390;
var t$10389;
var t$10388;
var t$10387 = basis$0Date$1.fmt$816;
var t$10386 = "%H:%M:%S";
var t$10385;
var v$10029 = SmlPrims.getrealtime();
t$10385 = (basis$0Date$1.fromTimeLocal$512(v$10029[0],v$10029[1]));
t$10388 = (t$10387(t$10386,t$10385));
t$10389 = (t$10388 + ": ");
t$10390 = (t$10389 + s$3585);
s$3587 = (t$10390 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3587));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return cont$1642([0,c$1661]);
});
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"loadFileContent.fileStore not set"];
} };
};
};
};
smltojs0$0SmlToJsCompApp$1$2.treeStoreRemoveExceptServer$1671 = function(fts$1674,id$1677){var t$10391;
var v$3597 = basis$0String$1.tokens$224(function(c$3598){return c$3598 == 47;
},id$1677);
if (v$3597 == null) {t$10391 = false;
} else {var v$3599 = v$3597;
switch (v$3599[0]) { case "Server": {t$10391 = true;
 break; }default: {t$10391 = false;
} };
};
return t$10391?0:((function(obj,a){return obj.remove(a);})(fts$1674,id$1677));
};
smltojs0$0SmlToJsCompApp$1$2.clear$1682 = function(fts$1685,closetab$1688){var fix$10392 = {};
fix$10392.$app = function(v$3604){lab$app: while (true) {if (v$3604 == null) {return 0;
} else {var v$3605 = v$3604;
var v$3606 = v$3605[0];
var v$3607 = v$3605[1];
var t$10394;
var v$6532 = basis$0String$1.tokens$224((function(env$10393){return function(c$6533){return c$6533 == 47;
};
})([]),v$3606);
if (v$6532 == null) {t$10394 = false;
} else {var v$6534 = v$6532;
switch (v$6534[0]) { case "Server": {t$10394 = true;
 break; }default: {t$10394 = false;
} };
};
t$10394?0:((function(obj,a){return obj.remove(a);})(fts$1685,v$3606));
var t$10395 = v$3607;
var v$3604 = t$10395;
continue lab$app;
};
};
};
var app$3603 = fix$10392.$app;
app$3603(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]);
var fix$10396 = {};
fix$10396.$app = function(v$3623){lab$app: while (true) {if (v$3623 == null) {return 0;
} else {var v$3624 = v$3623;
var v$3625 = v$3624[0];
var v$3626 = v$3624[1];
if ((v$3625 == "0")?false:true) {var t$10398;
var v$3647 = basis$0String$1.tokens$224((function(env$10397){return function(c$3648){return c$3648 == 47;
};
})([]),v$3625);
if (v$3647 == null) {t$10398 = false;
} else {var v$3649 = v$3647;
switch (v$3649[0]) { case "Server": {t$10398 = true;
 break; }default: {t$10398 = false;
} };
};
t$10398?0:((function(obj,a){return obj.remove(a);})(fts$1685,v$3625));
} else {0;
};
var t$10399 = v$3626;
var v$3623 = t$10399;
continue lab$app;
};
};
};
var app$3622 = fix$10396.$app;
app$3622(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]);
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0] = ["0",null],0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = null,0);
(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0);
var fix$10400 = {};
fix$10400.$app = function(v$3660){lab$app: while (true) {if (v$3660 == null) {return 0;
} else {var v$3661 = v$3660;
var v$3662 = v$3661[0];
var v$3663 = v$3661[1];
var v$3665 = v$3662[0];
closetab$1688(v$3665);
var t$10401 = v$3663;
var v$3660 = t$10401;
continue lab$app;
};
};
};
var app$3659 = fix$10400.$app;
app$3659(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = null,0);
};
smltojs0$0SmlToJsCompApp$1$2.mkAbsPath$1712 = function(n$1715){var v$1720 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0];
switch (v$1720) { case "0": {return n$1715;
 break; }default: {return (v$1720 + "/") + n$1715;
} };
};
var count$1721 = [0];
smltojs0$0SmlToJsCompApp$1$2.suggestNewFileName$1798 = function(base$1801){var fix$10402 = {};
fix$10402.$suggest = function(f$6549){lab$suggest: while (true) {var num$6550 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6553 = f$6549(num$6550);
var t$10405;
var fix$10403 = {};
fix$10403.$exists = function(v$6556){lab$exists: while (true) {if (v$6556 == null) {return false;
} else {var v$6557 = v$6556;
var v$6558 = v$6557[0];
var v$6559 = v$6557[1];
if (v$6558 == name$6553) {return true;
} else {var t$10404 = v$6559;
var v$6556 = t$10404;
continue lab$exists;
};
};
};
};
var exists$6555 = fix$10403.$exists;
t$10405 = (exists$6555(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10405) {var t$10406 = f$6549;
var f$6549 = t$10406;
continue lab$suggest;
} else {return name$6553;
};
};
};
var suggest$6548 = fix$10402.$suggest;
return suggest$6548(function(num$1804){return ((base$1801 + "-") + (basis$0Int32$1.toString$458(num$1804))) + ".sml";
});
};
smltojs0$0SmlToJsCompApp$1$2.suggestNewFolderName$1805 = function(v$1807){var fix$10407 = {};
fix$10407.$suggest = function(f$6574){lab$suggest: while (true) {var num$6575 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6578 = f$6574(num$6575);
var t$10410;
var fix$10408 = {};
fix$10408.$exists = function(v$6581){lab$exists: while (true) {if (v$6581 == null) {return false;
} else {var v$6582 = v$6581;
var v$6583 = v$6582[0];
var v$6584 = v$6582[1];
if (v$6583 == name$6578) {return true;
} else {var t$10409 = v$6584;
var v$6581 = t$10409;
continue lab$exists;
};
};
};
};
var exists$6580 = fix$10408.$exists;
t$10410 = (exists$6580(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10410) {var t$10411 = f$6574;
var f$6574 = t$10411;
continue lab$suggest;
} else {return name$6578;
};
};
};
var suggest$6573 = fix$10407.$suggest;
return suggest$6573(function(num$1810){return "Folder-" + (basis$0Int32$1.toString$458(num$1810));
});
};
smltojs0$0SmlToJsCompApp$1$2.newFile$1811 = function(fts$1814,content$1817,name$1820){var t$10418;
var fix$10416 = {};
fix$10416.$exists = function(v$3770){lab$exists: while (true) {if (v$3770 == null) {return false;
} else {var v$3771 = v$3770;
var v$3772 = v$3771[0];
var v$3773 = v$3771[1];
if (v$3772 == name$1820) {return true;
} else {var t$10417 = v$3773;
var v$3770 = t$10417;
continue lab$exists;
};
};
};
};
var exists$3769 = fix$10416.$exists;
t$10418 = (exists$3769(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10418) {throw [basis$0Initial$1.en$Fail$54,"file already exists"];
} else {var t$10415;
var t$10412;
var v$6586 = basis$0String$1.fields$231(function(c$6587){return c$6587 == 46;
},name$1820);
if (v$6586 == null) {t$10412 = false;
} else {var v$6588 = v$6586;
var v$6589 = v$6588[1];
if (v$6589 == null) {t$10412 = false;
} else {var v$6590 = v$6589;
if (v$6590[1] == null) {var v$6591 = v$6588[0];
var v$6592 = v$6590[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6591)) {var fix$10413 = {};
fix$10413.$exists = function(v$6594){lab$exists: while (true) {if (v$6594 == null) {return false;
} else {var v$6595 = v$6594;
var v$6596 = v$6595[0];
var v$6597 = v$6595[1];
if (v$6592 == v$6596) {return true;
} else {var t$10414 = v$6597;
var v$6594 = t$10414;
continue lab$exists;
};
};
};
};
var exists$6593 = fix$10413.$exists;
t$10412 = (exists$6593(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10412 = false;
};
} else {t$10412 = false;
};
};
};
t$10415 = (t$10412?false:true);
if (t$10415) {throw [basis$0Initial$1.en$Fail$54,"invalid new file name"];
} else {var lname$3784;
var v$3785 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0];
switch (v$3785) { case "0": {lname$3784 = name$1820;
 break; }default: {lname$3784 = ((v$3785 + "/") + name$1820);
} };
var t$10419;
var v$3789 = basis$0String$1.tokens$224(function(c$3790){return c$3790 == 47;
},lname$3784);
if (v$3789 == null) {t$10419 = false;
} else {var v$3791 = v$3789;
switch (v$3791[0]) { case "Server": {t$10419 = true;
 break; }default: {t$10419 = false;
} };
};
if (t$10419) {throw [basis$0Initial$1.en$Fail$54,"You cannot create new files in the Server folder"];
} else {var v$3792 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$3792[0]) { case 0: {var v$3793 = v$3792[1];
appfun2$0dropbox$1.write_file$328(v$3793,lname$3784,content$1817,function(v$3794){var v$3795 = v$3794[0];
var s$3796 = ((("Wrote file " + lname$3784) + " (") + v$3795) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$3796);
var s$3801;
var t$10425;
var t$10424;
var t$10423;
var t$10422 = basis$0Date$1.fmt$816;
var t$10421 = "%H:%M:%S";
var t$10420;
var v$10030 = SmlPrims.getrealtime();
t$10420 = (basis$0Date$1.fromTimeLocal$512(v$10030[0],v$10030[1]));
t$10423 = (t$10422(t$10421,t$10420));
t$10424 = (t$10423 + ": ");
t$10425 = (t$10424 + s$3796);
s$3801 = (t$10425 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3801));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
 break; }default: {0;
} };
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = [lname$3784,smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]],0);
var h$3808 = [["id",lname$3784],[["parent",(smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0]],[["name",name$1820],[["kind","leaf"],null]]]];
var t$10431 = fts$1814;
var t$10430;
var fix$10426 = {};
fix$10426.$foldl = function(v$3810,v$3811){lab$foldl: while (true) {if (v$3811 == null) {return v$3810;
} else {var v$3812 = v$3811;
var v$3813 = v$3812[0];
var v$3814 = v$3812[1];
var t$10427;
var v$3815 = v$3813[0];
var v$3816 = v$3813[1];
(function(fp,s,v){fp[s] = v;})(v$3810,v$3815,v$3816);
t$10427 = v$3810;
var t$10428 = t$10427;
var t$10429 = v$3814;
var v$3810 = t$10428;
var v$3811 = t$10429;
continue lab$foldl;
};
};
};
var foldl$3809 = fix$10426.$foldl;
var v$10074 = (function(){return {};})();
t$10430 = (foldl$3809(v$10074,h$3808));
(function(obj,a){return obj.add(a);})(t$10431,t$10430);
(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = lname$3784,0);
return lname$3784;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.newFolder$1829 = function(fts$1832,name$1835){var t$10434;
var fix$10432 = {};
fix$10432.$exists = function(v$3820){lab$exists: while (true) {if (v$3820 == null) {return false;
} else {var v$3821 = v$3820;
var v$3822 = v$3821[0];
var v$3823 = v$3821[1];
if (v$3822 == name$1835) {return true;
} else {var t$10433 = v$3823;
var v$3820 = t$10433;
continue lab$exists;
};
};
};
};
var exists$3819 = fix$10432.$exists;
t$10434 = (exists$3819(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10434) {throw [basis$0Initial$1.en$Fail$54,"folder already exists"];
} else {if ((smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(name$1835))?false:true) {throw [basis$0Initial$1.en$Fail$54,"invalid new folder name"];
} else {var lname$3833;
var v$3834 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0];
switch (v$3834) { case "0": {lname$3833 = name$1835;
 break; }default: {lname$3833 = ((v$3834 + "/") + name$1835);
} };
var t$10435;
var v$3838 = basis$0String$1.tokens$224(function(c$3839){return c$3839 == 47;
},lname$3833);
if (v$3838 == null) {t$10435 = false;
} else {var v$3840 = v$3838;
switch (v$3840[0]) { case "Server": {t$10435 = true;
 break; }default: {t$10435 = false;
} };
};
if (t$10435) {throw [basis$0Initial$1.en$Fail$54,"You cannot create new folders in the Server folder"];
} else {var v$3841 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$3841[0]) { case 0: {var v$3842 = v$3841[1];
appfun2$0dropbox$1.mkdir$367(v$3842,lname$3833,function(v$3843){var v$3844 = v$3843[0];
var s$3845 = ((("Created folder " + lname$3833) + " (") + v$3844) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$3845);
var s$3850;
var t$10441;
var t$10440;
var t$10439;
var t$10438 = basis$0Date$1.fmt$816;
var t$10437 = "%H:%M:%S";
var t$10436;
var v$10031 = SmlPrims.getrealtime();
t$10436 = (basis$0Date$1.fromTimeLocal$512(v$10031[0],v$10031[1]));
t$10439 = (t$10438(t$10437,t$10436));
t$10440 = (t$10439 + ": ");
t$10441 = (t$10440 + s$3845);
s$3850 = (t$10441 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3850));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
 break; }default: {0;
} };
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0] = [lname$3833,smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]],0);
var h$3857 = [["id",lname$3833],[["parent",(smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0]],[["name",name$1835],[["kind","folder"],null]]]];
var t$10447 = fts$1832;
var t$10446;
var fix$10442 = {};
fix$10442.$foldl = function(v$3859,v$3860){lab$foldl: while (true) {if (v$3860 == null) {return v$3859;
} else {var v$3861 = v$3860;
var v$3862 = v$3861[0];
var v$3863 = v$3861[1];
var t$10443;
var v$3864 = v$3862[0];
var v$3865 = v$3862[1];
(function(fp,s,v){fp[s] = v;})(v$3859,v$3864,v$3865);
t$10443 = v$3859;
var t$10444 = t$10443;
var t$10445 = v$3863;
var v$3859 = t$10444;
var v$3860 = t$10445;
continue lab$foldl;
};
};
};
var foldl$3858 = fix$10442.$foldl;
var v$10076 = (function(){return {};})();
t$10446 = (foldl$3858(v$10076,h$3857));
(function(obj,a){return obj.add(a);})(t$10447,t$10446);
return lname$3833;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.currentEditor$1844 = function(v$1846){var v$1851;
var t$10448;
var p$3867 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var fields$3868 = basis$0String$1.fields$231(function(c$3869){return c$3869 == 47;
},p$3867);
var v$3870 = basis$0List$1.rev$682(fields$3868);
if (v$3870 == null) {t$10448 = false;
} else {var v$3871 = v$3870;
var v$3872 = v$3871[0];
var v$3873 = v$3871[1];
var t$10451;
var v$6599 = basis$0String$1.fields$231(function(c$6600){return c$6600 == 46;
},v$3872);
if (v$6599 == null) {t$10451 = false;
} else {var v$6601 = v$6599;
var v$6602 = v$6601[1];
if (v$6602 == null) {t$10451 = false;
} else {var v$6603 = v$6602;
if (v$6603[1] == null) {var v$6604 = v$6601[0];
var v$6605 = v$6603[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6604)) {var fix$10452 = {};
fix$10452.$exists = function(v$6607){lab$exists: while (true) {if (v$6607 == null) {return false;
} else {var v$6608 = v$6607;
var v$6609 = v$6608[0];
var v$6610 = v$6608[1];
if (v$6605 == v$6609) {return true;
} else {var t$10453 = v$6610;
var v$6607 = t$10453;
continue lab$exists;
};
};
};
};
var exists$6606 = fix$10452.$exists;
t$10451 = (exists$6606(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10451 = false;
};
} else {t$10451 = false;
};
};
};
if (t$10451) {var fix$10449 = {};
fix$10449.$all = function(v$3875){lab$all: while (true) {if (v$3875 == null) {return true;
} else {var v$3876 = v$3875;
var v$3877 = v$3876[0];
var v$3878 = v$3876[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3877)) {var t$10450 = v$3878;
var v$3875 = t$10450;
continue lab$all;
} else {return false;
};
};
};
};
var all$3874 = fix$10449.$all;
t$10448 = (all$3874(v$3873));
} else {t$10448 = false;
};
};
v$1851 = (t$10448?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$1851[0]) { case 1: {return [1];
 break; }default: {var v$1869 = v$1851[1];
var v$1856 = basis$0List$1.find$392(function(v$1867){return v$1869 == v$1867[0];
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
switch (v$1856[0]) { case 0: {return [0,[v$1869,v$1856[1][2]]];
 break; }default: {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"currentEditor: error");
var s$3886;
var t$10459;
var t$10458;
var t$10457;
var t$10456 = basis$0Date$1.fmt$816;
var t$10455 = "%H:%M:%S";
var t$10454;
var v$10032 = SmlPrims.getrealtime();
t$10454 = (basis$0Date$1.fromTimeLocal$512(v$10032[0],v$10032[1]));
t$10457 = (t$10456(t$10455,t$10454));
t$10458 = (t$10457 + ": ");
t$10459 = (t$10458 + "currentEditor: error");
s$3886 = (t$10459 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3886));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return [1];
} };
} };
};
smltojs0$0SmlToJsCompApp$1$2.showTab$1870 = function(n$1873){return (smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = n$1873,0);
};
smltojs0$0SmlToJsCompApp$1$2.delete$1874 = function(fts$1877,closetab$1880){var v$1887;
var t$10460;
var p$3893 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
if (p$3893 == "0") {t$10460 = true;
} else {var fields$3898 = basis$0String$1.fields$231(function(c$3899){return c$3899 == 47;
},p$3893);
var fix$10461 = {};
fix$10461.$all = function(v$3901){lab$all: while (true) {if (v$3901 == null) {return true;
} else {var v$3902 = v$3901;
var v$3903 = v$3902[0];
var v$3904 = v$3902[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3903)) {var t$10462 = v$3904;
var v$3901 = t$10462;
continue lab$all;
} else {return false;
};
};
};
};
var all$3900 = fix$10461.$all;
t$10460 = (all$3900(fields$3898));
};
v$1887 = (t$10460?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$1887[0]) { case 0: {var v$1889 = v$1887[1];
switch (v$1889) { case "0": {return notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Cannot delete root folder");
 break; }default: {var t$10465;
var v$3906 = basis$0String$1.tokens$224(function(c$3907){return c$3907 == 47;
},v$1889);
if (v$3906 == null) {t$10465 = false;
} else {var v$3908 = v$3906;
switch (v$3908[0]) { case "Server": {t$10465 = true;
 break; }default: {t$10465 = false;
} };
};
if (t$10465) {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"You cannot delete folders in the Server folder");
var s$3911;
var t$10471;
var t$10470;
var t$10469;
var t$10468 = basis$0Date$1.fmt$816;
var t$10467 = "%H:%M:%S";
var t$10466;
var v$10033 = SmlPrims.getrealtime();
t$10466 = (basis$0Date$1.fromTimeLocal$512(v$10033[0],v$10033[1]));
t$10469 = (t$10468(t$10467,t$10466));
t$10470 = (t$10469 + ": ");
t$10471 = (t$10470 + "You cannot delete folders in the Server folder");
s$3911 = (t$10471 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3911));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
} else {var v$1971 = basis$0List$1.partition$449(function(v$1976){var v$1977 = v$1976[0];
var s1$3916 = v$1889 + "/";
var n1$3918 = s1$3916.length;
var n2$3919 = v$1977.length;
var stop$3920 = (n1$3918 < n2$3919)?n1$3918:n2$3919;
var fix$10463 = {};
fix$10463.$h = function(j$3922){lab$h: while (true) {if (j$3922 == stop$3920) {return true;
} else {if ((s1$3916.charCodeAt(j$3922)) == (v$1977.charCodeAt(j$3922))) {var t$10464 = SmlPrims.chk_ovf_i32(j$3922 + 1);
var j$3922 = t$10464;
continue lab$h;
} else {return false;
};
};
};
};
var h$3921 = fix$10463.$h;
if (n1$3918 <= n2$3919) {return h$3921(0);
} else {return false;
};
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
var v$1972 = v$1971[0];
var v$1973 = v$1971[1];
var v$1965 = basis$0List$1.partition$449(function(f$1970){var s1$3925 = v$1889 + "/";
var n1$3927 = s1$3925.length;
var n2$3928 = f$1970.length;
var stop$3929 = (n1$3927 < n2$3928)?n1$3927:n2$3928;
var fix$10472 = {};
fix$10472.$h = function(j$3931){lab$h: while (true) {if (j$3931 == stop$3929) {return true;
} else {if ((s1$3925.charCodeAt(j$3931)) == (f$1970.charCodeAt(j$3931))) {var t$10473 = SmlPrims.chk_ovf_i32(j$3931 + 1);
var j$3931 = t$10473;
continue lab$h;
} else {return false;
};
};
};
};
var h$3930 = fix$10472.$h;
if (n1$3927 <= n2$3928) {return h$3930(0);
} else {return false;
};
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]);
var v$1966 = v$1965[0];
var v$1967 = v$1965[1];
var v$1955 = basis$0List$1.partition$449(function(f$1960){if (f$1960 == v$1889) {return true;
} else {var s1$3938 = v$1889 + "/";
var n1$3940 = s1$3938.length;
var n2$3941 = f$1960.length;
var stop$3942 = (n1$3940 < n2$3941)?n1$3940:n2$3941;
var fix$10474 = {};
fix$10474.$h = function(j$3944){lab$h: while (true) {if (j$3944 == stop$3942) {return true;
} else {if ((s1$3938.charCodeAt(j$3944)) == (f$1960.charCodeAt(j$3944))) {var t$10475 = SmlPrims.chk_ovf_i32(j$3944 + 1);
var j$3944 = t$10475;
continue lab$h;
} else {return false;
};
};
};
};
var h$3943 = fix$10474.$h;
if (n1$3940 <= n2$3941) {return h$3943(0);
} else {return false;
};
};
},smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]);
var v$1956 = v$1955[0];
var v$1957 = v$1955[1];
(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = v$1973,0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = v$1967,0);
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0] = v$1957,0);
var fix$10476 = {};
fix$10476.$app = function(v$3990){lab$app: while (true) {if (v$3990 == null) {return 0;
} else {var v$3991 = v$3990;
var v$3992 = v$3991[0];
var v$3993 = v$3991[1];
var t$10478;
var v$6614 = basis$0String$1.tokens$224((function(env$10477){return function(c$6615){return c$6615 == 47;
};
})([]),v$3992);
if (v$6614 == null) {t$10478 = false;
} else {var v$6616 = v$6614;
switch (v$6616[0]) { case "Server": {t$10478 = true;
 break; }default: {t$10478 = false;
} };
};
t$10478?0:((function(obj,a){return obj.remove(a);})(fts$1877,v$3992));
var t$10479 = v$3993;
var v$3990 = t$10479;
continue lab$app;
};
};
};
var app$3989 = fix$10476.$app;
app$3989(v$1966);
var fix$10480 = {};
fix$10480.$app = function(v$4004){lab$app: while (true) {if (v$4004 == null) {return 0;
} else {var v$4005 = v$4004;
var v$4006 = v$4005[0];
var v$4007 = v$4005[1];
var t$10482;
var v$6618 = basis$0String$1.tokens$224((function(env$10481){return function(c$6619){return c$6619 == 47;
};
})([]),v$4006);
if (v$6618 == null) {t$10482 = false;
} else {var v$6620 = v$6618;
switch (v$6620[0]) { case "Server": {t$10482 = true;
 break; }default: {t$10482 = false;
} };
};
t$10482?0:((function(obj,a){return obj.remove(a);})(fts$1877,v$4006));
var t$10483 = v$4007;
var v$4004 = t$10483;
continue lab$app;
};
};
};
var app$4003 = fix$10480.$app;
app$4003(v$1956);
var fix$10484 = {};
fix$10484.$app = function(v$4021){lab$app: while (true) {if (v$4021 == null) {return 0;
} else {var v$4022 = v$4021;
var v$4023 = v$4022[0];
var v$4024 = v$4022[1];
var v$4026 = v$4023[0];
closetab$1880(v$4026);
var t$10485 = v$4024;
var v$4021 = t$10485;
continue lab$app;
};
};
};
var app$4020 = fix$10484.$app;
app$4020(v$1972);
var fix$10486 = {};
fix$10486.$app = function(v$4029){lab$app: while (true) {if (v$4029 == null) {return 0;
} else {var v$4030 = v$4029;
var v$4031 = v$4030[0];
var v$4032 = v$4030[1];
var v$4052 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$4052[0]) { case 0: {var v$4053 = v$4052[1];
appfun2$0dropbox$1.delete_file$414(v$4053,v$4031,(function(env$10491){return function(v$4054){var v$10487 = env$10491[0];
var v$10488 = env$10491[1];
var v$10489 = env$10491[2];
var v$10490 = env$10491[3];
var v$4055 = v$4054[0];
var s$4056 = ((("Deleted file " + (("'" + v$10490) + "'")) + " (") + v$4055) + ")";
var s$4063;
var t$10497;
var t$10496;
var t$10495;
var t$10494 = v$10489;
var t$10493 = "%H:%M:%S";
var t$10492;
var v$10034 = SmlPrims.getrealtime();
t$10492 = (v$10488(v$10034[0],v$10034[1]));
t$10495 = (t$10494(t$10493,t$10492));
t$10496 = (t$10495 + ": ");
t$10497 = (t$10496 + s$4056);
s$4063 = (t$10497 + "\n");
(function(e,a){return e.appendChild(a);})(v$10487,document.createTextNode(s$4063));
return (function(t){t.scrollTop = t.scrollHeight;})(v$10487);
};
})([smltojs0$0SmlToJsCompApp$1$2.logarea$949,basis$0Date$1.fromTimeLocal$512,basis$0Date$1.fmt$816,v$4031]));
 break; }default: {0;
} };
var t$10498 = v$4032;
var v$4029 = t$10498;
continue lab$app;
};
};
};
var app$4028 = fix$10486.$app;
app$4028(v$1966);
var fix$10499 = {};
fix$10499.$app = function(v$4070){lab$app: while (true) {if (v$4070 == null) {return 0;
} else {var v$4071 = v$4070;
var v$4072 = v$4071[0];
var v$4073 = v$4071[1];
var v$4110 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$4110[0]) { case 0: {var v$4111 = v$4110[1];
appfun2$0dropbox$1.delete_file$414(v$4111,v$4072,(function(env$10504){return function(v$4112){var v$10500 = env$10504[0];
var v$10501 = env$10504[1];
var v$10502 = env$10504[2];
var v$10503 = env$10504[3];
var v$4113 = v$4112[0];
var s$4114 = ((("Deleted folder " + (("'" + v$10503) + "'")) + " (") + v$4113) + ")";
var s$4121;
var t$10510;
var t$10509;
var t$10508;
var t$10507 = v$10502;
var t$10506 = "%H:%M:%S";
var t$10505;
var v$10035 = SmlPrims.getrealtime();
t$10505 = (v$10501(v$10035[0],v$10035[1]));
t$10508 = (t$10507(t$10506,t$10505));
t$10509 = (t$10508 + ": ");
t$10510 = (t$10509 + s$4114);
s$4121 = (t$10510 + "\n");
(function(e,a){return e.appendChild(a);})(v$10500,document.createTextNode(s$4121));
return (function(t){t.scrollTop = t.scrollHeight;})(v$10500);
};
})([smltojs0$0SmlToJsCompApp$1$2.logarea$949,basis$0Date$1.fromTimeLocal$512,basis$0Date$1.fmt$816,v$4072]));
 break; }default: {0;
} };
var t$10511 = v$4073;
var v$4070 = t$10511;
continue lab$app;
};
};
};
var app$4069 = fix$10499.$app;
app$4069(v$1956);
var s$4126 = ("Deleted folder " + (("'" + v$1889) + "'")) + " completely";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4126);
var s$4128;
var t$10517;
var t$10516;
var t$10515;
var t$10514 = basis$0Date$1.fmt$816;
var t$10513 = "%H:%M:%S";
var t$10512;
var v$10036 = SmlPrims.getrealtime();
t$10512 = (basis$0Date$1.fromTimeLocal$512(v$10036[0],v$10036[1]));
t$10515 = (t$10514(t$10513,t$10512));
t$10516 = (t$10515 + ": ");
t$10517 = (t$10516 + s$4126);
s$4128 = (t$10517 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4128));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
} };
 break; }default: {var f$1978 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var t$10518;
var v$4140 = basis$0String$1.tokens$224(function(c$4141){return c$4141 == 47;
},f$1978);
if (v$4140 == null) {t$10518 = false;
} else {var v$4142 = v$4140;
switch (v$4142[0]) { case "Server": {t$10518 = true;
 break; }default: {t$10518 = false;
} };
};
if (t$10518) {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"You cannot delete files in the Server folder");
var s$4145;
var t$10524;
var t$10523;
var t$10522;
var t$10521 = basis$0Date$1.fmt$816;
var t$10520 = "%H:%M:%S";
var t$10519;
var v$10037 = SmlPrims.getrealtime();
t$10519 = (basis$0Date$1.fromTimeLocal$512(v$10037[0],v$10037[1]));
t$10522 = (t$10521(t$10520,t$10519));
t$10523 = (t$10522 + ": ");
t$10524 = (t$10523 + "You cannot delete files in the Server folder");
s$4145 = (t$10524 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4145));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
} else {(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = (basis$0List$1.filter$417(function(v$2009){var v$2010 = v$2009[0];
return (v$2010 == f$1978)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0])),0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = (basis$0List$1.filter$417(function(f$$2006){return (f$$2006 == f$1978)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0])),0);
var t$10525;
var v$4166 = basis$0String$1.tokens$224(function(c$4167){return c$4167 == 47;
},f$1978);
if (v$4166 == null) {t$10525 = false;
} else {var v$4168 = v$4166;
switch (v$4168[0]) { case "Server": {t$10525 = true;
 break; }default: {t$10525 = false;
} };
};
t$10525?0:((function(obj,a){return obj.remove(a);})(fts$1877,f$1978));
closetab$1880(f$1978);
var v$1997 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$1997[0]) { case 0: {var v$2003 = v$1997[1];
return appfun2$0dropbox$1.delete_file$414(v$2003,f$1978,function(v$2001){var v$2002 = v$2001[0];
var s$4172 = ((("Deleted file " + (("'" + f$1978) + "'")) + " (") + v$2002) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4172);
var s$4174;
var t$10531;
var t$10530;
var t$10529;
var t$10528 = basis$0Date$1.fmt$816;
var t$10527 = "%H:%M:%S";
var t$10526;
var v$10038 = SmlPrims.getrealtime();
t$10526 = (basis$0Date$1.fromTimeLocal$512(v$10038[0],v$10038[1]));
t$10529 = (t$10528(t$10527,t$10526));
t$10530 = (t$10529 + ": ");
t$10531 = (t$10530 + s$4172);
s$4174 = (t$10531 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4174));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
 break; }default: {return 0;
} };
};
} };
};
smltojs0$0SmlToJsCompApp$1$2.addTab$2011 = function(filename$2014,md5$2017,editor$2020){return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = [[filename$2014,[md5$2017],editor$2020],smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]],0);
};
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021 = function(v$2056,v$2057,v$2058){var c$2027 = v$2058[0](0);
var newMd5$2032 = md5$0md5$1.toHexString$398(md5$0md5$1.final$209(md5$0md5$1.update$210(md5$0md5$1.init$195,c$2027)));
if (v$2057[0] == newMd5$2032) {return 0;
} else {var t$10533;
var v$4195 = basis$0String$1.tokens$224(function(c$4196){return c$4196 == 47;
},v$2056);
if (v$4195 == null) {t$10533 = false;
} else {var v$4197 = v$4195;
switch (v$4197[0]) { case "Server": {t$10533 = true;
 break; }default: {t$10533 = false;
} };
};
if (t$10533) {var s$4198 = ("Modified server file " + (("'" + v$2056) + "'")) + " not saved";
notify0$1000("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4198);
var s$4200;
var t$10539;
var t$10538;
var t$10537;
var t$10536 = basis$0Date$1.fmt$816;
var t$10535 = "%H:%M:%S";
var t$10534;
var v$10039 = SmlPrims.getrealtime();
t$10534 = (basis$0Date$1.fromTimeLocal$512(v$10039[0],v$10039[1]));
t$10537 = (t$10536(t$10535,t$10534));
t$10538 = (t$10537 + ": ");
t$10539 = (t$10538 + s$4198);
s$4200 = (t$10539 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4200));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
} else {try {var v$2045 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$2045[0]) { case 0: {var v$2053 = v$2045[1];
return appfun2$0dropbox$1.write_file$328(v$2053,v$2056,c$2027,function(v$2049){var v$2052 = v$2049[0];
var s$4211 = ((("Saved file " + (("'" + v$2056) + "'")) + " (") + v$2052) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4211);
var s$4213;
var t$10545;
var t$10544;
var t$10543;
var t$10542 = basis$0Date$1.fmt$816;
var t$10541 = "%H:%M:%S";
var t$10540;
var v$10040 = SmlPrims.getrealtime();
t$10540 = (basis$0Date$1.fromTimeLocal$512(v$10040[0],v$10040[1]));
t$10543 = (t$10542(t$10541,t$10540));
t$10544 = (t$10543 + ": ");
t$10545 = (t$10544 + s$4211);
s$4213 = (t$10545 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4213));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return (v$2057[0] = newMd5$2032,0);
});
 break; }default: {return 0;
} };
} catch(v$10532) {return (function(v$2055){return 0;
})(v$10532);
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.autosave$2059 = function(v$2061){var fix$10546 = {};
fix$10546.$app = function(v$4228){lab$app: while (true) {if (v$4228 == null) {return 0;
} else {var v$4229 = v$4228;
var v$4230 = v$4229[0];
var v$4231 = v$4229[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021(v$4230[0],v$4230[1],v$4230[2]);
var t$10547 = v$4231;
var v$4228 = t$10547;
continue lab$app;
};
};
};
var app$4227 = fix$10546.$app;
return app$4227(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
};
smltojs0$0SmlToJsCompApp$1$2.closeTab$2062 = function(n$2065){var v$2090;
var t$10548;
var p$4234 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var fields$4235 = basis$0String$1.fields$231(function(c$4236){return c$4236 == 47;
},p$4234);
var v$4237 = basis$0List$1.rev$682(fields$4235);
if (v$4237 == null) {t$10548 = false;
} else {var v$4238 = v$4237;
var v$4239 = v$4238[0];
var v$4240 = v$4238[1];
var t$10551;
var v$6625 = basis$0String$1.fields$231(function(c$6626){return c$6626 == 46;
},v$4239);
if (v$6625 == null) {t$10551 = false;
} else {var v$6627 = v$6625;
var v$6628 = v$6627[1];
if (v$6628 == null) {t$10551 = false;
} else {var v$6629 = v$6628;
if (v$6629[1] == null) {var v$6630 = v$6627[0];
var v$6631 = v$6629[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6630)) {var fix$10552 = {};
fix$10552.$exists = function(v$6633){lab$exists: while (true) {if (v$6633 == null) {return false;
} else {var v$6634 = v$6633;
var v$6635 = v$6634[0];
var v$6636 = v$6634[1];
if (v$6631 == v$6635) {return true;
} else {var t$10553 = v$6636;
var v$6633 = t$10553;
continue lab$exists;
};
};
};
};
var exists$6632 = fix$10552.$exists;
t$10551 = (exists$6632(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10551 = false;
};
} else {t$10551 = false;
};
};
};
if (t$10551) {var fix$10549 = {};
fix$10549.$all = function(v$4242){lab$all: while (true) {if (v$4242 == null) {return true;
} else {var v$4243 = v$4242;
var v$4244 = v$4243[0];
var v$4245 = v$4243[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4244)) {var t$10550 = v$4245;
var v$4242 = t$10550;
continue lab$all;
} else {return false;
};
};
};
};
var all$4241 = fix$10549.$all;
t$10548 = (all$4241(v$4240));
} else {t$10548 = false;
};
};
v$2090 = (t$10548?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$2090[0]) { case 0: {var v$2096 = v$2090[1];
(n$2065 == v$2096)?(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0):0;
 break; }default: {0;
} };
var v$2078 = basis$0List$1.find$392(function(v$2083){return v$2083[0] == n$2065;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
switch (v$2078[0]) { case 0: {var v$2080 = v$2078[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021(v$2080[0],v$2080[1],v$2080[2]);
 break; }default: {0;
} };
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = (basis$0List$1.filter$417(function(v$2071){var v$2072 = v$2071[0];
return (v$2072 == n$2065)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0])),0);
};
smltojs0$0SmlToJsCompApp$1$2.stripAbsolute$2097 = function(a$2100){var t$10555;
if (a$2100.length > 0) {var t$10554;
if (0 >= a$2100.length) {throw CompilerInitial.exn$Subscript$52;
} else {t$10554 = (a$2100.charCodeAt(0));
};
t$10555 = (t$10554 == 47);
} else {t$10555 = false;
};
return t$10555?[0,basis$0String$1.extract$116(a$2100,1,[1])]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.move$2109 = function(fts$2112,folderpath$2115,filename$2118,newfile$2121){var v$2202;
var t$10558;
var fields$4267 = basis$0String$1.fields$231(function(c$4268){return c$4268 == 47;
},newfile$2121);
var v$4269 = basis$0List$1.rev$682(fields$4267);
if (v$4269 == null) {t$10558 = false;
} else {var v$4270 = v$4269;
var v$4271 = v$4270[0];
var v$4272 = v$4270[1];
var t$10561;
var v$6641 = basis$0String$1.fields$231(function(c$6642){return c$6642 == 46;
},v$4271);
if (v$6641 == null) {t$10561 = false;
} else {var v$6643 = v$6641;
var v$6644 = v$6643[1];
if (v$6644 == null) {t$10561 = false;
} else {var v$6645 = v$6644;
if (v$6645[1] == null) {var v$6646 = v$6643[0];
var v$6647 = v$6645[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6646)) {var fix$10562 = {};
fix$10562.$exists = function(v$6649){lab$exists: while (true) {if (v$6649 == null) {return false;
} else {var v$6650 = v$6649;
var v$6651 = v$6650[0];
var v$6652 = v$6650[1];
if (v$6647 == v$6651) {return true;
} else {var t$10563 = v$6652;
var v$6649 = t$10563;
continue lab$exists;
};
};
};
};
var exists$6648 = fix$10562.$exists;
t$10561 = (exists$6648(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10561 = false;
};
} else {t$10561 = false;
};
};
};
if (t$10561) {var fix$10559 = {};
fix$10559.$all = function(v$4274){lab$all: while (true) {if (v$4274 == null) {return true;
} else {var v$4275 = v$4274;
var v$4276 = v$4275[0];
var v$4277 = v$4275[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4276)) {var t$10560 = v$4277;
var v$4274 = t$10560;
continue lab$all;
} else {return false;
};
};
};
};
var all$4273 = fix$10559.$all;
t$10558 = (all$4273(v$4272));
} else {t$10558 = false;
};
};
if (t$10558) {var v$2215 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(newfile$2121);
var v$2216 = v$2215[1];
switch (v$2216[0]) { case 0: {var v$2223 = v$2215[0];
var t$10566;
switch (folderpath$2115) { case "0": {t$10566 = newfile$2121;
 break; }default: {t$10566 = ((folderpath$2115 + "/") + newfile$2121);
} };
var t$10565 = v$2216[1];
var t$10564;
if (v$2223 == "0") {t$10564 = folderpath$2115;
} else {switch (folderpath$2115) { case "0": {t$10564 = v$2223;
 break; }default: {t$10564 = ((folderpath$2115 + "/") + v$2223);
} };
};
v$2202 = [t$10566,t$10565,t$10564];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"move.impossible: newfile is a file"];
} };
} else {var v$2229;
var t$10557;
if (newfile$2121.length > 0) {var t$10556;
if (0 >= newfile$2121.length) {throw CompilerInitial.exn$Subscript$52;
} else {t$10556 = (newfile$2121.charCodeAt(0));
};
t$10557 = (t$10556 == 47);
} else {t$10557 = false;
};
v$2229 = (t$10557?[0,basis$0String$1.extract$116(newfile$2121,1,[1])]:[1]);
switch (v$2229[0]) { case 0: {var v$2245 = v$2229[1];
var t$10567;
var fields$4297 = basis$0String$1.fields$231(function(c$4298){return c$4298 == 47;
},v$2245);
var v$4299 = basis$0List$1.rev$682(fields$4297);
if (v$4299 == null) {t$10567 = false;
} else {var v$4300 = v$4299;
var v$4301 = v$4300[0];
var v$4302 = v$4300[1];
var t$10570;
var v$6655 = basis$0String$1.fields$231(function(c$6656){return c$6656 == 46;
},v$4301);
if (v$6655 == null) {t$10570 = false;
} else {var v$6657 = v$6655;
var v$6658 = v$6657[1];
if (v$6658 == null) {t$10570 = false;
} else {var v$6659 = v$6658;
if (v$6659[1] == null) {var v$6660 = v$6657[0];
var v$6661 = v$6659[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6660)) {var fix$10571 = {};
fix$10571.$exists = function(v$6663){lab$exists: while (true) {if (v$6663 == null) {return false;
} else {var v$6664 = v$6663;
var v$6665 = v$6664[0];
var v$6666 = v$6664[1];
if (v$6661 == v$6665) {return true;
} else {var t$10572 = v$6666;
var v$6663 = t$10572;
continue lab$exists;
};
};
};
};
var exists$6662 = fix$10571.$exists;
t$10570 = (exists$6662(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10570 = false;
};
} else {t$10570 = false;
};
};
};
if (t$10570) {var fix$10568 = {};
fix$10568.$all = function(v$4304){lab$all: while (true) {if (v$4304 == null) {return true;
} else {var v$4305 = v$4304;
var v$4306 = v$4305[0];
var v$4307 = v$4305[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4306)) {var t$10569 = v$4307;
var v$4304 = t$10569;
continue lab$all;
} else {return false;
};
};
};
};
var all$4303 = fix$10568.$all;
t$10567 = (all$4303(v$4302));
} else {t$10567 = false;
};
};
if (t$10567) {var v$2240 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(v$2245);
var v$2241 = v$2240[1];
switch (v$2241[0]) { case 0: {v$2202 = [v$2245,v$2241[1],v$2240[0]];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"move.impossible: newfile is a file"];
} };
} else {throw [basis$0Initial$1.en$Fail$54,"Invalid target path " + (("'" + newfile$2121) + "'")];
};
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Invalid target path " + (("'" + newfile$2121) + "'")];
} };
};
var v$2203 = v$2202[0];
var v$2204 = v$2202[1];
var v$2205 = v$2202[2];
var filepath$2126;
switch (folderpath$2115) { case "0": {filepath$2126 = filename$2118;
 break; }default: {filepath$2126 = ((folderpath$2115 + "/") + filename$2118);
} };
var v$5978;
var v$4322 = basis$0String$1.tokens$224(function(c$4323){return c$4323 == 47;
},filepath$2126);
if (v$4322 == null) {v$5978 = false;
} else {var v$4324 = v$4322;
switch (v$4324[0]) { case "Dropbox": {v$5978 = true;
 break; }default: {v$5978 = false;
} };
};
var v$5979;
var v$4326 = basis$0String$1.tokens$224(function(c$4327){return c$4327 == 47;
},v$2203);
if (v$4326 == null) {v$5979 = false;
} else {var v$4328 = v$4326;
switch (v$4328[0]) { case "Dropbox": {v$5979 = true;
 break; }default: {v$5979 = false;
} };
};
if (v$5978) {if (v$5979) {0;
} else {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to or from Dropbox paths"];
};
} else {if (v$5979) {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to or from Dropbox paths"];
} else {0;
};
};
var t$10580;
var v$4332 = basis$0String$1.tokens$224(function(c$4333){return c$4333 == 47;
},v$2203);
if (v$4332 == null) {t$10580 = false;
} else {var v$4334 = v$4332;
switch (v$4334[0]) { case "Server": {t$10580 = true;
 break; }default: {t$10580 = false;
} };
};
if (t$10580) {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to the server"];
} else {var t$10579;
var fix$10577 = {};
fix$10577.$exists = function(v$4337){lab$exists: while (true) {if (v$4337 == null) {return false;
} else {var v$4338 = v$4337;
var v$4339 = v$4338[0];
var v$4340 = v$4338[1];
if (v$4339 == v$2203) {return true;
} else {var t$10578 = v$4340;
var v$4337 = t$10578;
continue lab$exists;
};
};
};
};
var exists$4336 = fix$10577.$exists;
t$10579 = (exists$4336(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10579) {throw [basis$0Initial$1.en$Fail$54,("File " + (("'" + v$2203) + "'")) + " already exists"];
} else {var t$10576;
var t$10575;
var fix$10573 = {};
fix$10573.$exists = function(v$4354){lab$exists: while (true) {if (v$4354 == null) {return false;
} else {var v$4355 = v$4354;
var v$4356 = v$4355[0];
var v$4357 = v$4355[1];
if (v$4356 == v$2205) {return true;
} else {var t$10574 = v$4357;
var v$4354 = t$10574;
continue lab$exists;
};
};
};
};
var exists$4353 = fix$10573.$exists;
t$10575 = (exists$4353(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
t$10576 = (t$10575?false:true);
if (t$10576) {throw [basis$0Initial$1.en$Fail$54,("Target folder " + (("'" + v$2205) + "'")) + " does not exist"];
} else {var v$2144 = basis$0List$1.find$392(function(v$2188){return v$2188[0] == filepath$2126;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
switch (v$2144[0]) { case 0: {var v$2184 = v$2144[1];
var v$2185 = v$2184[2];
(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = (basis$0List$1.filter$417(function(v$2182){var v$2183 = v$2182[0];
return (v$2183 == filepath$2126)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0])),0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = (basis$0List$1.map$332(function(n$2175){return ((n$2175 == filepath$2126)?false:true)?n$2175:v$2203;
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0])),0);
var t$10581;
var v$4389 = basis$0String$1.tokens$224(function(c$4390){return c$4390 == 47;
},filepath$2126);
if (v$4389 == null) {t$10581 = false;
} else {var v$4391 = v$4389;
switch (v$4391[0]) { case "Server": {t$10581 = true;
 break; }default: {t$10581 = false;
} };
};
t$10581?0:((function(obj,a){return obj.remove(a);})(fts$2112,filepath$2126));
var h$4395 = [["id",v$2203],[["parent",v$2205],[["name",v$2204],[["kind","leaf"],null]]]];
var t$10587 = fts$2112;
var t$10586;
var fix$10582 = {};
fix$10582.$foldl = function(v$4397,v$4398){lab$foldl: while (true) {if (v$4398 == null) {return v$4397;
} else {var v$4399 = v$4398;
var v$4400 = v$4399[0];
var v$4401 = v$4399[1];
var t$10583;
var v$4402 = v$4400[0];
var v$4403 = v$4400[1];
(function(fp,s,v){fp[s] = v;})(v$4397,v$4402,v$4403);
t$10583 = v$4397;
var t$10584 = t$10583;
var t$10585 = v$4401;
var v$4397 = t$10584;
var v$4398 = t$10585;
continue lab$foldl;
};
};
};
var foldl$4396 = fix$10582.$foldl;
var v$10078 = (function(){return {};})();
t$10586 = (foldl$4396(v$10078,h$4395));
(function(obj,a){return obj.add(a);})(t$10587,t$10586);
var v$2166 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$2166[0]) { case 0: {var v$2172 = v$2166[1];
appfun2$0dropbox$1.move_file$482(v$2172,filepath$2126,v$2203,function(v$2170){var v$2171 = v$2170[0];
var s$4405 = ((((("Moved file " + (("'" + filepath$2126) + "'")) + " to ") + (("'" + v$2203) + "'")) + " (") + v$2171) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4405);
var s$4407;
var t$10593;
var t$10592;
var t$10591;
var t$10590 = basis$0Date$1.fmt$816;
var t$10589 = "%H:%M:%S";
var t$10588;
var v$10041 = SmlPrims.getrealtime();
t$10588 = (basis$0Date$1.fromTimeLocal$512(v$10041[0],v$10041[1]));
t$10591 = (t$10590(t$10589,t$10588));
t$10592 = (t$10591 + ": ");
t$10593 = (t$10592 + s$4405);
s$4407 = (t$10593 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4407));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
 break; }default: {0;
} };
return [v$2203,v$2185[0](0)];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Impossible: cannot locate file in tab structure!"];
} };
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.ftsServer$2246;
var content$2247;
var file$6671;
var t$10597 = "otests/content?_=";
var t$10596;
var t$10595 = basis$0Real$1.toString$160;
var t$10594;
var v$6672 = SmlPrims.getrealtime();
t$10594 = ((v$6672[0] - (-2147483648)) + (v$6672[1] / 1000000.0));
t$10596 = (t$10595(t$10594));
file$6671 = (t$10597 + t$10596);
var r$6673 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$6673,"GET",file$6671,false);
js$0Js$1.send$654(r$6673,[1]);
var v$6674 = (function(r){return SmlPrims.option(r.responseText);})(r$6673);
switch (v$6674[0]) { case 0: {content$2247 = v$6674[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$6671];
} };
var content$2248 = basis$0String$1.translate$217(function(c$2251){return ((c$2251 == 32)?true:((9 <= c$2251)?(c$2251 <= 13):false))?"":(SmlPrims.implode([c$2251,null]));
},content$2247);
var lines$2256 = basis$0String$1.tokens$224(function(c$2259){return c$2259 == 59;
},content$2248);
var t$10619;
var t$10618 = [["id","Server"],[["name","Server"],[["kind","folder"],[["parent","0"],null]]]];
var t$10617;
var t$10598;
var v$6675 = null;
var fix$10599 = {};
fix$10599.$foldr = function(v$6677){if (v$6677 == null) {return v$6675;
} else {var v$6678 = v$6677;
var v$6679 = v$6678[0];
var v$6680 = v$6678[1];
var v$6682 = fix$10599.$foldr(v$6680);
var t$10616 = basis$0List$1.s$n$686;
var t$10600;
var v$6685 = basis$0String$1.tokens$224(function(c$6686){return c$6686 == 61;
},v$6679);
if (v$6685 == null) {t$10600 = null;
} else {var v$6687 = v$6685;
var v$6688 = v$6687[1];
if (v$6688 == null) {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"syntax error in otests/content file");
var s$6712;
var t$10606;
var t$10605;
var t$10604;
var t$10603 = basis$0Date$1.fmt$816;
var t$10602 = "%H:%M:%S";
var t$10601;
var v$10043 = SmlPrims.getrealtime();
t$10601 = (basis$0Date$1.fromTimeLocal$512(v$10043[0],v$10043[1]));
t$10604 = (t$10603(t$10602,t$10601));
t$10605 = (t$10604 + ": ");
t$10606 = (t$10605 + "syntax error in otests/content file");
s$6712 = (t$10606 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$6712));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
t$10600 = null;
} else {var v$6689 = v$6688;
if (v$6689[1] == null) {var v$6690 = v$6687[0];
var v$6691 = v$6689[0];
var sfolder$6692 = "Server/" + v$6690;
var t$10609;
var t$10608 = [["id",sfolder$6692],[["name",v$6690],[["kind","folder"],[["parent","Server"],null]]]];
var t$10607;
var files$6695 = basis$0String$1.tokens$224(function(c$6696){return c$6696 == 44;
},v$6691);
t$10607 = (basis$0List$1.map$332(function(f$6697){return [["id",(sfolder$6692 + "/") + f$6697],[["name",f$6697],[["kind","file"],[["parent",sfolder$6692],null]]]];
},files$6695));
t$10609 = [t$10608,t$10607];
t$10600 = t$10609;
} else {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"syntax error in otests/content file");
var s$6702;
var t$10615;
var t$10614;
var t$10613;
var t$10612 = basis$0Date$1.fmt$816;
var t$10611 = "%H:%M:%S";
var t$10610;
var v$10042 = SmlPrims.getrealtime();
t$10610 = (basis$0Date$1.fromTimeLocal$512(v$10042[0],v$10042[1]));
t$10613 = (t$10612(t$10611,t$10610));
t$10614 = (t$10613 + ": ");
t$10615 = (t$10614 + "syntax error in otests/content file");
s$6702 = (t$10615 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$6702));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
t$10600 = null;
};
};
};
return t$10616(t$10600,v$6682);
};
};
var foldr$6676 = fix$10599.$foldr;
t$10598 = (function(v$10191){return foldr$6676(v$10191);
});
t$10617 = (t$10598(lines$2256));
t$10619 = [t$10618,t$10617];
smltojs0$0SmlToJsCompApp$1$2.ftsServer$2246 = t$10619;
smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308 = function(v$2344,v$2345){return function(filename$2315){return function(content$2318){var inarea$2319;
var attrs$4525 = [["style","border:0;"],null];
var elem$4526 = document.createTextNode(content$2318);
var newelem$4527 = document.createElement("textarea");
var fix$10620 = {};
fix$10620.$app = function(v$4529){lab$app: while (true) {if (v$4529 == null) {return 0;
} else {var v$4530 = v$4529;
var v$4531 = v$4530[0];
var v$4532 = v$4530[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4527,v$4531[0],v$4531[1]);
var t$10621 = v$4532;
var v$4529 = t$10621;
continue lab$app;
};
};
};
var app$4528 = fix$10620.$app;
app$4528(attrs$4525);
(function(e,a){return e.appendChild(a);})(newelem$4527,elem$4526);
inarea$2319 = newelem$4527;
var inputarea$2320;
var attrs$4535 = [["class","textareacontainer"],null];
var newelem$4537 = document.createElement("div");
var fix$10622 = {};
fix$10622.$app = function(v$4539){lab$app: while (true) {if (v$4539 == null) {return 0;
} else {var v$4540 = v$4539;
var v$4541 = v$4540[0];
var v$4542 = v$4540[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4537,v$4541[0],v$4541[1]);
var t$10623 = v$4542;
var v$4539 = t$10623;
continue lab$app;
};
};
};
var app$4538 = fix$10622.$app;
app$4538(attrs$4535);
(function(e,a){return e.appendChild(a);})(newelem$4537,inarea$2319);
inputarea$2320 = newelem$4537;
var m$4543;
var v$6071;
var h$4550 = [["style","height:100%;"],[["title",filename$2315],[["closable","true"],null]]];
v$6071 = (function(f$4552){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$4553){var p$4554;
var t$10629 = Cp$4553;
var t$10628;
var fix$10624 = {};
fix$10624.$foldl = function(v$4556,v$4557){lab$foldl: while (true) {if (v$4557 == null) {return v$4556;
} else {var v$4558 = v$4557;
var v$4559 = v$4558[0];
var v$4560 = v$4558[1];
var t$10625;
var v$4561 = v$4559[0];
var v$4562 = v$4559[1];
(function(fp,s,v){fp[s] = v;})(v$4556,v$4561,v$4562);
t$10625 = v$4556;
var t$10626 = t$10625;
var t$10627 = v$4560;
var v$4556 = t$10626;
var v$4557 = t$10627;
continue lab$foldl;
};
};
};
var foldl$4555 = fix$10624.$foldl;
var v$10080 = (function(){return {};})();
t$10628 = (foldl$4555(v$10080,h$4550));
p$4554 = ((function(c,h){return new c(h);})(t$10629,t$10628));
(function(w,e){w.set('content', e);})(p$4554,inputarea$2320);
return f$4552(p$4554);
});
});
m$4543 = (function(c$4548){return v$6071(function(v$4549){(function(w,f){w.onClose = f;})(v$4549,function(v$6728){smltojs0$0SmlToJsCompApp$1$2.closeTab$2062(filename$2315);
return true;
});
(function(w,f){w.onShow = f;})(v$4549,function(v$6729){return (smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = filename$2315,0);
});
(function(obj,a){return obj.addChild(a);})(v$2344,v$4549);
(function(obj,a1,a2){return obj.selectChild(a1,a2);})(v$2344,v$4549,true);
(v$2345[0] = [[filename$2315,v$4549],v$2345[0]],0);
var a$6730 = 0;
return c$4548(a$6730);
});
});
m$4543(function(x$4544){return x$4544;
});
var editor$2322 = smltojs0$0SmlToJsCompApp$1$2.mkEditor$1192(inarea$2319);
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = [[filename$2315,[md5$0md5$1.toHexString$398(md5$0md5$1.final$209(md5$0md5$1.update$210(md5$0md5$1.init$195,content$2318)))],editor$2322],smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]],0);
};
};
};
smltojs0$0SmlToJsCompApp$1$2.button$2346 = function(s$2349){var attrs$4583 = [["style","height:25px; width:100px;"],null];
var elem$4584;
var attrs$4592 = null;
var elem$4593 = document.createTextNode(s$2349);
var newelem$4594 = document.createElement("b");
var fix$10630 = {};
fix$10630.$app = function(v$4596){lab$app: while (true) {if (v$4596 == null) {return 0;
} else {var v$4597 = v$4596;
var v$4598 = v$4597[0];
var v$4599 = v$4597[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4594,v$4598[0],v$4598[1]);
var t$10631 = v$4599;
var v$4596 = t$10631;
continue lab$app;
};
};
};
var app$4595 = fix$10630.$app;
app$4595(attrs$4592);
(function(e,a){return e.appendChild(a);})(newelem$4594,elem$4593);
elem$4584 = newelem$4594;
var newelem$4585 = document.createElement("button");
var fix$10632 = {};
fix$10632.$app = function(v$4587){lab$app: while (true) {if (v$4587 == null) {return 0;
} else {var v$4588 = v$4587;
var v$4589 = v$4588[0];
var v$4590 = v$4588[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4585,v$4589[0],v$4589[1]);
var t$10633 = v$4590;
var v$4587 = t$10633;
continue lab$app;
};
};
};
var app$4586 = fix$10632.$app;
app$4586(attrs$4583);
(function(e,a){return e.appendChild(a);})(newelem$4585,elem$4584);
return newelem$4585;
};
smltojs0$0SmlToJsCompApp$1$2.withDialog$2350 = function(v$2401,v$2400,v$2406,v$2403,v$2402,v$2404,v$2405){var msgArea$2360;
var attrs$4602 = [["class","notify_area2"],[["style","opacity:0.0;top:0px;"],null]];
var newelem$4603 = document.createElement("span");
var fix$10634 = {};
fix$10634.$app = function(v$4605){lab$app: while (true) {if (v$4605 == null) {return 0;
} else {var v$4606 = v$4605;
var v$4607 = v$4606[0];
var v$4608 = v$4606[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4603,v$4607[0],v$4607[1]);
var t$10635 = v$4608;
var v$4605 = t$10635;
continue lab$app;
};
};
};
var app$4604 = fix$10634.$app;
app$4604(attrs$4602);
msgArea$2360 = newelem$4603;
var field$2379;
var attrs$4611 = [["type","text"],[["value",v$2404],null]];
var newelem$4612 = document.createElement("input");
var fix$10636 = {};
fix$10636.$app = function(v$4614){lab$app: while (true) {if (v$4614 == null) {return 0;
} else {var v$4615 = v$4614;
var v$4616 = v$4615[0];
var v$4617 = v$4615[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4612,v$4616[0],v$4616[1]);
var t$10637 = v$4617;
var v$4614 = t$10637;
continue lab$app;
};
};
};
var app$4613 = fix$10636.$app;
app$4613(attrs$4611);
field$2379 = newelem$4612;
var but$2380 = smltojs0$0SmlToJsCompApp$1$2.button$2346(v$2401);
var intro$2381;
switch (v$2403[0]) { case 0: {var v$2388 = v$2403[1];
var attrs$4619 = null;
var newelem$4621 = document.createElement("p");
var fix$10638 = {};
fix$10638.$app = function(v$4623){lab$app: while (true) {if (v$4623 == null) {return 0;
} else {var v$4624 = v$4623;
var v$4625 = v$4624[0];
var v$4626 = v$4624[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4621,v$4625[0],v$4625[1]);
var t$10639 = v$4626;
var v$4623 = t$10639;
continue lab$app;
};
};
};
var app$4622 = fix$10638.$app;
app$4622(attrs$4619);
(function(e,a){return e.appendChild(a);})(newelem$4621,v$2388);
intro$2381 = newelem$4621;
 break; }default: {intro$2381 = (document.createTextNode(""));
} };
var content$2389;
var attrs$4629 = [["style","width:400px;"],null];
var elem$4630;
var v$6079;
var v$6082;
var attrs$4646 = null;
var elem$4647;
var v$6083 = document.createTextNode(v$2402 + ": ");
var e$4657 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4657,v$6083);
(function(e,a){return e.appendChild(a);})(e$4657,field$2379);
elem$4647 = e$4657;
var newelem$4648 = document.createElement("p");
var fix$10640 = {};
fix$10640.$app = function(v$4650){lab$app: while (true) {if (v$4650 == null) {return 0;
} else {var v$4651 = v$4650;
var v$4652 = v$4651[0];
var v$4653 = v$4651[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4648,v$4652[0],v$4652[1]);
var t$10641 = v$4653;
var v$4650 = t$10641;
continue lab$app;
};
};
};
var app$4649 = fix$10640.$app;
app$4649(attrs$4646);
(function(e,a){return e.appendChild(a);})(newelem$4648,elem$4647);
v$6082 = newelem$4648;
var e$4644 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4644,intro$2381);
(function(e,a){return e.appendChild(a);})(e$4644,v$6082);
v$6079 = e$4644;
var v$6080;
var attrs$4661 = null;
var elem$4662;
var v$6087;
var v$6090 = document.createTextNode(" ");
var e$4676 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4676,but$2380);
(function(e,a){return e.appendChild(a);})(e$4676,v$6090);
v$6087 = e$4676;
var e$4672 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4672,v$6087);
(function(e,a){return e.appendChild(a);})(e$4672,msgArea$2360);
elem$4662 = e$4672;
var newelem$4663 = document.createElement("p");
var fix$10642 = {};
fix$10642.$app = function(v$4665){lab$app: while (true) {if (v$4665 == null) {return 0;
} else {var v$4666 = v$4665;
var v$4667 = v$4666[0];
var v$4668 = v$4666[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4663,v$4667[0],v$4667[1]);
var t$10643 = v$4668;
var v$4665 = t$10643;
continue lab$app;
};
};
};
var app$4664 = fix$10642.$app;
app$4664(attrs$4661);
(function(e,a){return e.appendChild(a);})(newelem$4663,elem$4662);
v$6080 = newelem$4663;
var e$4640 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4640,v$6079);
(function(e,a){return e.appendChild(a);})(e$4640,v$6080);
elem$4630 = e$4640;
var newelem$4631 = document.createElement("p");
var fix$10644 = {};
fix$10644.$app = function(v$4633){lab$app: while (true) {if (v$4633 == null) {return 0;
} else {var v$4634 = v$4633;
var v$4635 = v$4634[0];
var v$4636 = v$4634[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4631,v$4635[0],v$4635[1]);
var t$10645 = v$4636;
var v$4633 = t$10645;
continue lab$app;
};
};
};
var app$4632 = fix$10644.$app;
app$4632(attrs$4629);
(function(e,a){return e.appendChild(a);})(newelem$4631,elem$4630);
content$2389 = newelem$4631;
var dM$2390;
var v$6091;
var h$4683 = [["title",v$2400],null];
v$6091 = (function(f$4685){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4686){var d$4687;
var t$10651 = D$4686;
var t$10650;
var fix$10646 = {};
fix$10646.$foldl = function(v$4689,v$4690){lab$foldl: while (true) {if (v$4690 == null) {return v$4689;
} else {var v$4691 = v$4690;
var v$4692 = v$4691[0];
var v$4693 = v$4691[1];
var t$10647;
var v$4694 = v$4692[0];
var v$4695 = v$4692[1];
(function(fp,s,v){fp[s] = v;})(v$4689,v$4694,v$4695);
t$10647 = v$4689;
var t$10648 = t$10647;
var t$10649 = v$4693;
var v$4689 = t$10648;
var v$4690 = t$10649;
continue lab$foldl;
};
};
};
var foldl$4688 = fix$10646.$foldl;
var v$10082 = (function(){return {};})();
t$10650 = (foldl$4688(v$10082,h$4683));
d$4687 = ((function(c,h){return new c(h);})(t$10651,t$10650));
(function(w,e){w.set('content', e);})(d$4687,content$2389);
return f$4685(d$4687);
});
});
dM$2390 = (function(c$4681){return v$6091(function(v$4682){js$0Js$1.installEventHandler$197(but$2380,4,function(v$6741){var s$6742 = (function(e){return e.value;})(field$2379);
try {var t$6743 = v$2405(s$6742);
(function(obj){return obj.hide();})(v$4682);
v$2406(t$6743);
return true;
} catch(v$10652) {return (function(v$6744){var t$10653 = v$6744;
if (t$10653[0] == basis$0Initial$1.en$Fail$54) {var msg$6745 = v$6744[1];
notify0$1000("#dd8888",msgArea$2360,msg$6745);
return true;
} else {throw v$6744;
};
})(v$10652);
};
});
(function(obj){return obj.show();})(v$4682);
var a$6746 = 0;
return c$4681(a$6746);
});
});
return dM$2390(function(x$4706){return x$4706;
});
};
smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2407 = function(caption$2410,label$2413,msg$2416,f$2419){var cancel$2420 = smltojs0$0SmlToJsCompApp$1$2.button$2346("Cancel");
var but$2421 = smltojs0$0SmlToJsCompApp$1$2.button$2346(label$2413);
var content$2422;
var attrs$4708 = [["style","width:400px;"],null];
var elem$4709;
var v$6093;
var attrs$4721 = null;
var newelem$4723 = document.createElement("p");
var fix$10654 = {};
fix$10654.$app = function(v$4725){lab$app: while (true) {if (v$4725 == null) {return 0;
} else {var v$4726 = v$4725;
var v$4727 = v$4726[0];
var v$4728 = v$4726[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4723,v$4727[0],v$4727[1]);
var t$10655 = v$4728;
var v$4725 = t$10655;
continue lab$app;
};
};
};
var app$4724 = fix$10654.$app;
app$4724(attrs$4721);
(function(e,a){return e.appendChild(a);})(newelem$4723,msg$2416);
v$6093 = newelem$4723;
var v$6094;
var attrs$4730 = [["style","text-align:center;"],null];
var elem$4731;
var v$6095;
var v$6098 = document.createTextNode(" ");
var e$4745 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4745,cancel$2420);
(function(e,a){return e.appendChild(a);})(e$4745,v$6098);
v$6095 = e$4745;
var e$4741 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4741,v$6095);
(function(e,a){return e.appendChild(a);})(e$4741,but$2421);
elem$4731 = e$4741;
var newelem$4732 = document.createElement("p");
var fix$10656 = {};
fix$10656.$app = function(v$4734){lab$app: while (true) {if (v$4734 == null) {return 0;
} else {var v$4735 = v$4734;
var v$4736 = v$4735[0];
var v$4737 = v$4735[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4732,v$4736[0],v$4736[1]);
var t$10657 = v$4737;
var v$4734 = t$10657;
continue lab$app;
};
};
};
var app$4733 = fix$10656.$app;
app$4733(attrs$4730);
(function(e,a){return e.appendChild(a);})(newelem$4732,elem$4731);
v$6094 = newelem$4732;
var e$4719 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4719,v$6093);
(function(e,a){return e.appendChild(a);})(e$4719,v$6094);
elem$4709 = e$4719;
var newelem$4710 = document.createElement("p");
var fix$10658 = {};
fix$10658.$app = function(v$4712){lab$app: while (true) {if (v$4712 == null) {return 0;
} else {var v$4713 = v$4712;
var v$4714 = v$4713[0];
var v$4715 = v$4713[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4710,v$4714[0],v$4714[1]);
var t$10659 = v$4715;
var v$4712 = t$10659;
continue lab$app;
};
};
};
var app$4711 = fix$10658.$app;
app$4711(attrs$4708);
(function(e,a){return e.appendChild(a);})(newelem$4710,elem$4709);
content$2422 = newelem$4710;
var dM$2423;
var v$6099;
var h$4752 = [["title",caption$2410],null];
v$6099 = (function(f$4754){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4755){var d$4756;
var t$10665 = D$4755;
var t$10664;
var fix$10660 = {};
fix$10660.$foldl = function(v$4758,v$4759){lab$foldl: while (true) {if (v$4759 == null) {return v$4758;
} else {var v$4760 = v$4759;
var v$4761 = v$4760[0];
var v$4762 = v$4760[1];
var t$10661;
var v$4763 = v$4761[0];
var v$4764 = v$4761[1];
(function(fp,s,v){fp[s] = v;})(v$4758,v$4763,v$4764);
t$10661 = v$4758;
var t$10662 = t$10661;
var t$10663 = v$4762;
var v$4758 = t$10662;
var v$4759 = t$10663;
continue lab$foldl;
};
};
};
var foldl$4757 = fix$10660.$foldl;
var v$10084 = (function(){return {};})();
t$10664 = (foldl$4757(v$10084,h$4752));
d$4756 = ((function(c,h){return new c(h);})(t$10665,t$10664));
(function(w,e){w.set('content', e);})(d$4756,content$2422);
return f$4754(d$4756);
});
});
dM$2423 = (function(c$4750){return v$6099(function(v$4751){js$0Js$1.installEventHandler$197(but$2421,4,function(v$6754){(function(obj){return obj.hide();})(v$4751);
f$2419(0);
return true;
});
js$0Js$1.installEventHandler$197(cancel$2420,4,function(v$6755){(function(obj){return obj.hide();})(v$4751);
return true;
});
(function(obj){return obj.show();})(v$4751);
var a$6756 = 0;
return c$4750(a$6756);
});
});
return dM$2423(function(x$4771){return x$4771;
});
};
smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443 = function(buttonlabel$2446,caption$2449,content$2452){var but$2453 = smltojs0$0SmlToJsCompApp$1$2.button$2346(buttonlabel$2446);
var content$2454;
var attrs$4773 = [["style","width:500px;"],null];
var elem$4774;
var v$6102;
var attrs$4786 = [["style","text-align:center;"],null];
var newelem$4788 = document.createElement("p");
var fix$10666 = {};
fix$10666.$app = function(v$4790){lab$app: while (true) {if (v$4790 == null) {return 0;
} else {var v$4791 = v$4790;
var v$4792 = v$4791[0];
var v$4793 = v$4791[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4788,v$4792[0],v$4792[1]);
var t$10667 = v$4793;
var v$4790 = t$10667;
continue lab$app;
};
};
};
var app$4789 = fix$10666.$app;
app$4789(attrs$4786);
(function(e,a){return e.appendChild(a);})(newelem$4788,but$2453);
v$6102 = newelem$4788;
var e$4784 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4784,content$2452);
(function(e,a){return e.appendChild(a);})(e$4784,v$6102);
elem$4774 = e$4784;
var newelem$4775 = document.createElement("p");
var fix$10668 = {};
fix$10668.$app = function(v$4777){lab$app: while (true) {if (v$4777 == null) {return 0;
} else {var v$4778 = v$4777;
var v$4779 = v$4778[0];
var v$4780 = v$4778[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4775,v$4779[0],v$4779[1]);
var t$10669 = v$4780;
var v$4777 = t$10669;
continue lab$app;
};
};
};
var app$4776 = fix$10668.$app;
app$4776(attrs$4773);
(function(e,a){return e.appendChild(a);})(newelem$4775,elem$4774);
content$2454 = newelem$4775;
var dM$2455;
var v$6103;
var h$4799 = [["title",caption$2449],null];
v$6103 = (function(f$4801){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4802){var d$4803;
var t$10675 = D$4802;
var t$10674;
var fix$10670 = {};
fix$10670.$foldl = function(v$4805,v$4806){lab$foldl: while (true) {if (v$4806 == null) {return v$4805;
} else {var v$4807 = v$4806;
var v$4808 = v$4807[0];
var v$4809 = v$4807[1];
var t$10671;
var v$4810 = v$4808[0];
var v$4811 = v$4808[1];
(function(fp,s,v){fp[s] = v;})(v$4805,v$4810,v$4811);
t$10671 = v$4805;
var t$10672 = t$10671;
var t$10673 = v$4809;
var v$4805 = t$10672;
var v$4806 = t$10673;
continue lab$foldl;
};
};
};
var foldl$4804 = fix$10670.$foldl;
var v$10086 = (function(){return {};})();
t$10674 = (foldl$4804(v$10086,h$4799));
d$4803 = ((function(c,h){return new c(h);})(t$10675,t$10674));
(function(w,e){w.set('content', e);})(d$4803,content$2454);
return f$4801(d$4803);
});
});
dM$2455 = (function(c$4797){return v$6103(function(v$4798){js$0Js$1.installEventHandler$197(but$2453,4,function(v$6763){(function(obj){return obj.hide();})(v$4798);
return true;
});
(function(obj){return obj.show();})(v$4798);
var a$6764 = 0;
return c$4797(a$6764);
});
});
return dM$2455(function(x$4817){return x$4817;
});
};
smltojs0$0SmlToJsCompApp$1$2.infoDialogOk$2467 = function(v$10089){return function(v$10090){return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok",v$10089,v$10090);
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_NewNamedFile$2468 = function(tabsmap$2471,fts$2474,v$2476){var content$2477;
var t$10678;
var t$10677 = "(* File created ";
var t$10676;
var d$4820;
var v$10044 = SmlPrims.getrealtime();
d$4820 = (basis$0Date$1.fromTimeLocal$512(v$10044[0],v$10044[1]));
t$10676 = (basis$0Date$1.fmt$816("%a %b %d %H:%M:%S %Y",d$4820));
t$10678 = (t$10677 + t$10676);
content$2477 = (t$10678 + " *)\n");
var t$10690 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2350;
var t$10689 = "Create";
var t$10688 = "New File";
var t$10687 = function(s$2480){return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabsmap$2471[0],tabsmap$2471[1]))(s$2480))(content$2477);
};
var t$10686 = [1];
var t$10685 = "Name";
var t$10684;
var fix$10679 = {};
fix$10679.$suggest = function(f$6768){lab$suggest: while (true) {var num$6769 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6770 = f$6768(num$6769);
var t$10682;
var fix$10680 = {};
fix$10680.$exists = function(v$6773){lab$exists: while (true) {if (v$6773 == null) {return false;
} else {var v$6774 = v$6773;
var v$6775 = v$6774[0];
var v$6776 = v$6774[1];
if (v$6775 == name$6770) {return true;
} else {var t$10681 = v$6776;
var v$6773 = t$10681;
continue lab$exists;
};
};
};
};
var exists$6772 = fix$10680.$exists;
t$10682 = (exists$6772(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10682) {var t$10683 = f$6768;
var f$6768 = t$10683;
continue lab$suggest;
} else {return name$6770;
};
};
};
var suggest$6767 = fix$10679.$suggest;
t$10684 = (suggest$6767(function(num$6777){return ("Untitled-" + (basis$0Int32$1.toString$458(num$6777))) + ".sml";
}));
return t$10690(t$10689,t$10688,t$10687,t$10686,t$10685,t$10684,function(v$10093){return smltojs0$0SmlToJsCompApp$1$2.newFile$1811(fts$2474,content$2477,v$10093);
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_MoveFile$2488 = function(tabsmap$2491,fts$2494,closetab$2497,v$2499){var path$2500 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var intro$2501 = document.createTextNode("Files can be renamed or moved either using relative paths ('..' is not supported) or using absolute paths (starting with '/').");
var v$2508 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(path$2500);
var v$2509 = v$2508[1];
switch (v$2509[0]) { case 0: {var v$2526 = v$2508[0];
var v$2527 = v$2509[1];
return smltojs0$0SmlToJsCompApp$1$2.withDialog$2350("Move","Move/Rename File",function(v$2514){var v$2517 = v$2514[0];
var v$2518 = v$2514[1];
closetab$2497(path$2500);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabsmap$2491[0],tabsmap$2491[1]))(v$2517))(v$2518);
},[0,intro$2501],"New name",v$2527,function(v$10097){return smltojs0$0SmlToJsCompApp$1$2.move$2109(fts$2494,v$2526,v$2527,v$10097);
});
 break; }default: {return notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Renaming of folders not supported");
} };
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_FilesDelete$2529 = function(fts$2532,closetab$2535,v$2537){var msg$2538;
var v$2543;
var t$10691;
var p$4827 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var fields$4828 = basis$0String$1.fields$231(function(c$4829){return c$4829 == 47;
},p$4827);
var v$4830 = basis$0List$1.rev$682(fields$4828);
if (v$4830 == null) {t$10691 = false;
} else {var v$4831 = v$4830;
var v$4832 = v$4831[0];
var v$4833 = v$4831[1];
var t$10694;
var v$6779 = basis$0String$1.fields$231(function(c$6780){return c$6780 == 46;
},v$4832);
if (v$6779 == null) {t$10694 = false;
} else {var v$6781 = v$6779;
var v$6782 = v$6781[1];
if (v$6782 == null) {t$10694 = false;
} else {var v$6783 = v$6782;
if (v$6783[1] == null) {var v$6784 = v$6781[0];
var v$6785 = v$6783[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6784)) {var fix$10695 = {};
fix$10695.$exists = function(v$6787){lab$exists: while (true) {if (v$6787 == null) {return false;
} else {var v$6788 = v$6787;
var v$6789 = v$6788[0];
var v$6790 = v$6788[1];
if (v$6785 == v$6789) {return true;
} else {var t$10696 = v$6790;
var v$6787 = t$10696;
continue lab$exists;
};
};
};
};
var exists$6786 = fix$10695.$exists;
t$10694 = (exists$6786(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10694 = false;
};
} else {t$10694 = false;
};
};
};
if (t$10694) {var fix$10692 = {};
fix$10692.$all = function(v$4835){lab$all: while (true) {if (v$4835 == null) {return true;
} else {var v$4836 = v$4835;
var v$4837 = v$4836[0];
var v$4838 = v$4836[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4837)) {var t$10693 = v$4838;
var v$4835 = t$10693;
continue lab$all;
} else {return false;
};
};
};
};
var all$4834 = fix$10692.$all;
t$10691 = (all$4834(v$4833));
} else {t$10691 = false;
};
};
v$2543 = (t$10691?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$2543[0]) { case 0: {msg$2538 = (("Do you really want to delete the file " + (("'" + v$2543[1]) + "'")) + "?");
 break; }default: {var v$2550;
var t$10697;
var p$4845 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
if (p$4845 == "0") {t$10697 = true;
} else {var fields$4850 = basis$0String$1.fields$231(function(c$4851){return c$4851 == 47;
},p$4845);
var fix$10698 = {};
fix$10698.$all = function(v$4853){lab$all: while (true) {if (v$4853 == null) {return true;
} else {var v$4854 = v$4853;
var v$4855 = v$4854[0];
var v$4856 = v$4854[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4855)) {var t$10699 = v$4856;
var v$4853 = t$10699;
continue lab$all;
} else {return false;
};
};
};
};
var all$4852 = fix$10698.$all;
t$10697 = (all$4852(fields$4850));
};
v$2550 = (t$10697?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$2550[0]) { case 0: {msg$2538 = (("Do you really want to delete the folder " + (("'" + v$2550[1]) + "'")) + " and all its containing files?");
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"menuHandle_FilesDelete.impossible"];
} };
} };
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2407("Confirm Deletion","Delete",document.createTextNode(msg$2538),function(v$2554){return smltojs0$0SmlToJsCompApp$1$2.delete$1874(fts$2532,closetab$2535);
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_Export$2555 = function(v$2557){var v$10138 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Files Export to Zip",v$10138);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_Import$2558 = function(v$2560){var v$10140 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Files Import from Zip",v$10140);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_NewFolder$2561 = function(fts$2564,v$2566){var t$10711 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2350;
var t$10710 = "Create";
var t$10709 = "New Folder";
var t$10708 = function(s$2569){return 0;
};
var t$10707 = [1];
var t$10706 = "Name";
var t$10705;
var fix$10700 = {};
fix$10700.$suggest = function(f$6805){lab$suggest: while (true) {var num$6806 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6809 = f$6805(num$6806);
var t$10703;
var fix$10701 = {};
fix$10701.$exists = function(v$6812){lab$exists: while (true) {if (v$6812 == null) {return false;
} else {var v$6813 = v$6812;
var v$6814 = v$6813[0];
var v$6815 = v$6813[1];
if (v$6814 == name$6809) {return true;
} else {var t$10702 = v$6815;
var v$6812 = t$10702;
continue lab$exists;
};
};
};
};
var exists$6811 = fix$10701.$exists;
t$10703 = (exists$6811(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10703) {var t$10704 = f$6805;
var f$6805 = t$10704;
continue lab$suggest;
} else {return name$6809;
};
};
};
var suggest$6804 = fix$10700.$suggest;
t$10705 = (suggest$6804(function(num$4876){return "Folder-" + (basis$0Int32$1.toString$458(num$4876));
}));
return t$10711(t$10710,t$10709,t$10708,t$10707,t$10706,t$10705,function(v$10099){return smltojs0$0SmlToJsCompApp$1$2.newFolder$1829(fts$2564,v$10099);
});
};
smltojs0$0SmlToJsCompApp$1$2.treeHandle_LoadFile$2577 = function(tabsmap$2580,selecttab$2583,v$2587){var v$2599 = v$2587[0];
var t$10712;
if (v$2599 == "0") {t$10712 = true;
} else {var fields$4884 = basis$0String$1.fields$231(function(c$4885){return c$4885 == 47;
},v$2599);
var fix$10713 = {};
fix$10713.$all = function(v$4887){lab$all: while (true) {if (v$4887 == null) {return true;
} else {var v$4888 = v$4887;
var v$4889 = v$4888[0];
var v$4890 = v$4888[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4889)) {var t$10714 = v$4890;
var v$4887 = t$10714;
continue lab$all;
} else {return false;
};
};
};
};
var all$4886 = fix$10713.$all;
t$10712 = (all$4886(fields$4884));
};
if (t$10712) {return (smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = v$2599,0);
} else {return smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1636(v$2599,function(v$2596){switch (v$2596[0]) { case 0: {var v$2598 = v$2596[1];
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabsmap$2580[0],tabsmap$2580[1]))(v$2599))(v$2598);
 break; }default: {return selecttab$2583(v$2599);
} };
});
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_OpenDemo$2601 = function(tabsmap$2604,fts$2607,demo$2610,v$2612){var name$2613;
var fix$10715 = {};
fix$10715.$suggest = function(f$6818){lab$suggest: while (true) {var num$6819 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6820 = f$6818(num$6819);
var t$10718;
var fix$10716 = {};
fix$10716.$exists = function(v$6823){lab$exists: while (true) {if (v$6823 == null) {return false;
} else {var v$6824 = v$6823;
var v$6825 = v$6824[0];
var v$6826 = v$6824[1];
if (v$6825 == name$6820) {return true;
} else {var t$10717 = v$6826;
var v$6823 = t$10717;
continue lab$exists;
};
};
};
};
var exists$6822 = fix$10716.$exists;
t$10718 = (exists$6822(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10718) {var t$10719 = f$6818;
var f$6818 = t$10719;
continue lab$suggest;
} else {return name$6820;
};
};
};
var suggest$6817 = fix$10715.$suggest;
name$2613 = (suggest$6817(function(num$6827){return ("Demo-" + (basis$0Int32$1.toString$458(num$6827))) + ".sml";
}));
var path$2614 = smltojs0$0SmlToJsCompApp$1$2.newFile$1811(fts$2607,demo$2610,name$2613);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabsmap$2604[0],tabsmap$2604[1]))(path$2614))(demo$2610);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignIn$2615 = function(key$2618,v$2620){var t$10728;
var t$10724;
var t$10720;
var v$6149 = smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0];
var v$6150 = null;
var fix$10721 = {};
fix$10721.$eq_list = function(v$10142,v$10143){lab$eq_list: while (true) {if (v$10142 == null) {return (v$10143 == null)?true:false;
} else {if (v$10143 == null) {return false;
} else {var v$10144 = v$10142;
var v$10145 = v$10143;
if (v$10144[0] == v$10145[0]) {var t$10722 = v$10144[1];
var t$10723 = v$10145[1];
var v$10142 = t$10722;
var v$10143 = t$10723;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$10141 = fix$10721.$eq_list;
t$10720 = (eq_list$10141(v$6149,v$6150));
if (t$10720) {var v$6155 = smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0];
var v$6156 = ["0",null];
var fix$10725 = {};
fix$10725.$eq_list = function(v$10148,v$10149){lab$eq_list: while (true) {if (v$10148 == null) {return (v$10149 == null)?true:false;
} else {if (v$10149 == null) {return false;
} else {var v$10150 = v$10148;
var v$10151 = v$10149;
if (v$10150[0] == v$10151[0]) {var t$10726 = v$10150[1];
var t$10727 = v$10151[1];
var v$10148 = t$10726;
var v$10149 = t$10727;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$10147 = fix$10725.$eq_list;
t$10724 = (eq_list$10147(v$6155,v$6156));
} else {t$10724 = false;
};
t$10728 = (t$10724?true:((basis$0Option$1.isSome$56(0))(smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0])));
if (t$10728) {var c$4925 = appfun2$0dropbox$1.client$91(key$2618);
return appfun2$0dropbox$1.authorize$95(c$4925);
} else {var msg$2629 = document.createTextNode("Signing in to Dropbox will delete all application data created in this session. If this is the first time you sign in to Dropbox from this application, you will be asked to allow the application to store data in a special area of your Dropbox account.");
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2407("Dropbox Sign In","Sign in",msg$2629,function(v$4927){var c$4928 = appfun2$0dropbox$1.client$91(key$2618);
return appfun2$0dropbox$1.authorize$95(c$4928);
});
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignOut$2638 = function(c$2641,fts$2644,closetab$2647,v$2649){var msg$2650 = document.createTextNode("Signing out of Dropbox will not delete any files in the Dropbox App folder. You will always be able to sign in again using the \"Sign in\" entry in the Dropbox menu.");
var fix$10729 = {};
fix$10729.$app = function(v$4932){lab$app: while (true) {if (v$4932 == null) {return 0;
} else {var v$4933 = v$4932;
var v$4934 = v$4933[0];
var v$4935 = v$4933[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021(v$4934[0],v$4934[1],v$4934[2]);
var t$10730 = v$4935;
var v$4932 = t$10730;
continue lab$app;
};
};
};
var app$4931 = fix$10729.$app;
app$4931(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2407("Dropbox Sign Out","Sign out",msg$2650,function(v$2654){return appfun2$0dropbox$1.signOut$108(c$2641,function(v$2656){(smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0] = [1],0);
smltojs0$0SmlToJsCompApp$1$2.clear$1682(fts$2644,closetab$2647);
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Signed out of Dropbox");
var s$4939;
var t$10736;
var t$10735;
var t$10734;
var t$10733 = basis$0Date$1.fmt$816;
var t$10732 = "%H:%M:%S";
var t$10731;
var v$10047 = SmlPrims.getrealtime();
t$10731 = (basis$0Date$1.fromTimeLocal$512(v$10047[0],v$10047[1]));
t$10734 = (t$10733(t$10732,t$10731));
t$10735 = (t$10734 + ": ");
t$10736 = (t$10735 + "Signed out of Dropbox");
s$4939 = (t$10736 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4939));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955,"src","nodropbox.png");
});
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_CompileAndRun$2663 = function(v$2665){var v$2671 = smltojs0$0SmlToJsCompApp$1$2.currentEditor$1844(0);
switch (v$2671[0]) { case 0: {var v$2673 = v$2671[1];
var v$2674 = v$2673[0];
var v$2675 = v$2673[1];
var res$4950;
var v$4952 = v$2675[0](0);
var p_old$4953 = basis$0Control$1.printer_get$55(0);
var buf$4954 = [null];
basis$0Control$1.printer_set$54(function(s$4955){return (buf$4954[0] = [s$4955,buf$4954[0]],0);
});
try {smltojs0$0SmlToJsCompApp$1$1.compute$94(v$2674,v$4952);
} catch(v$10737) {(function(v$4957){return 0;
})(v$10737);
};
var res$4958 = SmlPrims.concat(basis$0List$1.rev$682(buf$4954[0]));
basis$0Control$1.printer_set$54(p_old$4953);
res$4950 = res$4958;
return smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0](res$4950);
 break; }default: {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"No file selected");
var s$4962;
var t$10743;
var t$10742;
var t$10741;
var t$10740 = basis$0Date$1.fmt$816;
var t$10739 = "%H:%M:%S";
var t$10738;
var v$10048 = SmlPrims.getrealtime();
t$10738 = (basis$0Date$1.fromTimeLocal$512(v$10048[0],v$10048[1]));
t$10741 = (t$10740(t$10739,t$10738));
t$10742 = (t$10741 + ": ");
t$10743 = (t$10742 + "No file selected");
s$4962 = (t$10743 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4962));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
} };
};
smltojs0$0SmlToJsCompApp$1$2.poweredby$2676 = function(v$2678){var v$6179;
var attrs$5042 = null;
var elem$5043;
var v$6181;
var v$6183;
var v$6185;
var v$6187;
var v$6189;
var v$6191;
var v$6193;
var v$6195;
var v$6197 = document.createTextNode("This IDE is based on ");
var v$6198;
var attrs$6829 = [["href","http://www.smlserver.org/smltojs"],[["target","_blank"],null]];
var elem$6830 = document.createTextNode("SMLtoJs");
var newelem$6831 = document.createElement("a");
var fix$10744 = {};
fix$10744.$app = function(v$6833){lab$app: while (true) {if (v$6833 == null) {return 0;
} else {var v$6834 = v$6833;
var v$6835 = v$6834[0];
var v$6836 = v$6834[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6831,v$6835[0],v$6835[1]);
var t$10745 = v$6836;
var v$6833 = t$10745;
continue lab$app;
};
};
};
var app$6832 = fix$10744.$app;
app$6832(attrs$6829);
(function(e,a){return e.appendChild(a);})(newelem$6831,elem$6830);
v$6198 = newelem$6831;
var e$5085 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5085,v$6197);
(function(e,a){return e.appendChild(a);})(e$5085,v$6198);
v$6195 = e$5085;
var v$6196 = document.createTextNode(", a Standard ML to JavaScript compiler. The front-end uses ");
var e$5081 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5081,v$6195);
(function(e,a){return e.appendChild(a);})(e$5081,v$6196);
v$6193 = e$5081;
var v$6194;
var attrs$6838 = [["href","http://dojotoolkit.org/"],[["target","_blank"],null]];
var elem$6839 = document.createTextNode("Dojo");
var newelem$6840 = document.createElement("a");
var fix$10746 = {};
fix$10746.$app = function(v$6842){lab$app: while (true) {if (v$6842 == null) {return 0;
} else {var v$6843 = v$6842;
var v$6844 = v$6843[0];
var v$6845 = v$6843[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6840,v$6844[0],v$6844[1]);
var t$10747 = v$6845;
var v$6842 = t$10747;
continue lab$app;
};
};
};
var app$6841 = fix$10746.$app;
app$6841(attrs$6838);
(function(e,a){return e.appendChild(a);})(newelem$6840,elem$6839);
v$6194 = newelem$6840;
var e$5077 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5077,v$6193);
(function(e,a){return e.appendChild(a);})(e$5077,v$6194);
v$6191 = e$5077;
var v$6192 = document.createTextNode(" and ");
var e$5073 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5073,v$6191);
(function(e,a){return e.appendChild(a);})(e$5073,v$6192);
v$6189 = e$5073;
var v$6190;
var attrs$6847 = [["href","http://codemirror.net"],[["target","_blank"],null]];
var elem$6848 = document.createTextNode("CodeMirror");
var newelem$6849 = document.createElement("a");
var fix$10748 = {};
fix$10748.$app = function(v$6851){lab$app: while (true) {if (v$6851 == null) {return 0;
} else {var v$6852 = v$6851;
var v$6853 = v$6852[0];
var v$6854 = v$6852[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6849,v$6853[0],v$6853[1]);
var t$10749 = v$6854;
var v$6851 = t$10749;
continue lab$app;
};
};
};
var app$6850 = fix$10748.$app;
app$6850(attrs$6847);
(function(e,a){return e.appendChild(a);})(newelem$6849,elem$6848);
v$6190 = newelem$6849;
var e$5069 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5069,v$6189);
(function(e,a){return e.appendChild(a);})(e$5069,v$6190);
v$6187 = e$5069;
var v$6188 = document.createTextNode(". The IDE ");
var e$5065 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5065,v$6187);
(function(e,a){return e.appendChild(a);})(e$5065,v$6188);
v$6185 = e$5065;
var v$6186 = document.createTextNode(" allows for the user to save source files in a personal Dropbox App folder using ");
var e$5061 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5061,v$6185);
(function(e,a){return e.appendChild(a);})(e$5061,v$6186);
v$6183 = e$5061;
var v$6184;
var attrs$6856 = [["href","https://www.dropbox.com/developers/documentation/http/overview"],[["target","_blank"],null]];
var elem$6857 = document.createTextNode("Dropbox API v2");
var newelem$6858 = document.createElement("a");
var fix$10750 = {};
fix$10750.$app = function(v$6860){lab$app: while (true) {if (v$6860 == null) {return 0;
} else {var v$6861 = v$6860;
var v$6862 = v$6861[0];
var v$6863 = v$6861[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6858,v$6862[0],v$6862[1]);
var t$10751 = v$6863;
var v$6860 = t$10751;
continue lab$app;
};
};
};
var app$6859 = fix$10750.$app;
app$6859(attrs$6856);
(function(e,a){return e.appendChild(a);})(newelem$6858,elem$6857);
v$6184 = newelem$6858;
var e$5057 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5057,v$6183);
(function(e,a){return e.appendChild(a);})(e$5057,v$6184);
v$6181 = e$5057;
var v$6182 = document.createTextNode(".");
var e$5053 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5053,v$6181);
(function(e,a){return e.appendChild(a);})(e$5053,v$6182);
elem$5043 = e$5053;
var newelem$5044 = document.createElement("p");
var fix$10752 = {};
fix$10752.$app = function(v$5046){lab$app: while (true) {if (v$5046 == null) {return 0;
} else {var v$5047 = v$5046;
var v$5048 = v$5047[0];
var v$5049 = v$5047[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$5044,v$5048[0],v$5048[1]);
var t$10753 = v$5049;
var v$5046 = t$10753;
continue lab$app;
};
};
};
var app$5045 = fix$10752.$app;
app$5045(attrs$5042);
(function(e,a){return e.appendChild(a);})(newelem$5044,elem$5043);
v$6179 = newelem$5044;
var v$6180;
var attrs$5093 = null;
var elem$5094;
var v$6199;
var v$6201;
var v$6203;
var v$6205;
var v$6207;
var v$6209;
var v$6211 = document.createTextNode(" The sources for this IDE are");
var v$6212 = document.createTextNode(" available by download from the ");
var e$5128 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5128,v$6211);
(function(e,a){return e.appendChild(a);})(e$5128,v$6212);
v$6209 = e$5128;
var v$6210;
var attrs$6865 = [["href","https://github.com/melsman/mlkit"],[["target","_blank"],null]];
var elem$6866 = document.createTextNode("Github MLKit Repository");
var newelem$6867 = document.createElement("a");
var fix$10754 = {};
fix$10754.$app = function(v$6869){lab$app: while (true) {if (v$6869 == null) {return 0;
} else {var v$6870 = v$6869;
var v$6871 = v$6870[0];
var v$6872 = v$6870[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6867,v$6871[0],v$6871[1]);
var t$10755 = v$6872;
var v$6869 = t$10755;
continue lab$app;
};
};
};
var app$6868 = fix$10754.$app;
app$6868(attrs$6865);
(function(e,a){return e.appendChild(a);})(newelem$6867,elem$6866);
v$6210 = newelem$6867;
var e$5124 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5124,v$6209);
(function(e,a){return e.appendChild(a);})(e$5124,v$6210);
v$6207 = e$5124;
var v$6208 = document.createTextNode(" and are distributed");
var e$5120 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5120,v$6207);
(function(e,a){return e.appendChild(a);})(e$5120,v$6208);
v$6205 = e$5120;
var v$6206 = document.createTextNode(" under the GPL2 license; some parts of the sources are also available under the MIT license.");
var e$5116 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5116,v$6205);
(function(e,a){return e.appendChild(a);})(e$5116,v$6206);
v$6203 = e$5116;
var v$6204 = document.createTextNode(" For information about licenses, please consult the sources at the ");
var e$5112 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5112,v$6203);
(function(e,a){return e.appendChild(a);})(e$5112,v$6204);
v$6201 = e$5112;
var v$6202;
var attrs$6874 = [["href","https://github.com/melsman/mlkit"],[["target","_blank"],null]];
var elem$6875 = document.createTextNode("Github MLKit Repository");
var newelem$6876 = document.createElement("a");
var fix$10756 = {};
fix$10756.$app = function(v$6878){lab$app: while (true) {if (v$6878 == null) {return 0;
} else {var v$6879 = v$6878;
var v$6880 = v$6879[0];
var v$6881 = v$6879[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6876,v$6880[0],v$6880[1]);
var t$10757 = v$6881;
var v$6878 = t$10757;
continue lab$app;
};
};
};
var app$6877 = fix$10756.$app;
app$6877(attrs$6874);
(function(e,a){return e.appendChild(a);})(newelem$6876,elem$6875);
v$6202 = newelem$6876;
var e$5108 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5108,v$6201);
(function(e,a){return e.appendChild(a);})(e$5108,v$6202);
v$6199 = e$5108;
var v$6200 = document.createTextNode(".");
var e$5104 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5104,v$6199);
(function(e,a){return e.appendChild(a);})(e$5104,v$6200);
elem$5094 = e$5104;
var newelem$5095 = document.createElement("p");
var fix$10758 = {};
fix$10758.$app = function(v$5097){lab$app: while (true) {if (v$5097 == null) {return 0;
} else {var v$5098 = v$5097;
var v$5099 = v$5098[0];
var v$5100 = v$5098[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$5095,v$5099[0],v$5099[1]);
var t$10759 = v$5100;
var v$5097 = t$10759;
continue lab$app;
};
};
};
var app$5096 = fix$10758.$app;
app$5096(attrs$5093);
(function(e,a){return e.appendChild(a);})(newelem$5095,elem$5094);
v$6180 = newelem$5095;
var e$5040 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5040,v$6179);
(function(e,a){return e.appendChild(a);})(e$5040,v$6180);
return e$5040;
};
smltojs0$0SmlToJsCompApp$1$2.menu$2693 = function(tabs$2696,fts$2699,closetab$2702){var v$6213;
var h$5140 = [["region","center"],[smltojs0$0SmlToJsCompApp$1$2.menuStyle$1280,null]];
v$6213 = (function(f$5141){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/MenuBar",function(MenuBar$5142){var menubar$5143;
var t$10765 = MenuBar$5142;
var t$10764;
var fix$10760 = {};
fix$10760.$foldl = function(v$5145,v$5146){lab$foldl: while (true) {if (v$5146 == null) {return v$5145;
} else {var v$5147 = v$5146;
var v$5148 = v$5147[0];
var v$5149 = v$5147[1];
var t$10761;
var v$5150 = v$5148[0];
var v$5151 = v$5148[1];
(function(fp,s,v){fp[s] = v;})(v$5145,v$5150,v$5151);
t$10761 = v$5145;
var t$10762 = t$10761;
var t$10763 = v$5149;
var v$5145 = t$10762;
var v$5146 = t$10763;
continue lab$foldl;
};
};
};
var foldl$5144 = fix$10760.$foldl;
var v$10102 = (function(){return {};})();
t$10764 = (foldl$5144(v$10102,h$5140));
menubar$5143 = ((function(c,h){return new c(h);})(t$10765,t$10764));
return f$5141([menubar$5143,[menubar$5143,true]]);
});
});
return function(c$5138){return v$6213(function(v$5139){var v$9040 = v$5139[0];
var v$9041 = v$5139[1];
var v$9042 = (dojo$0dojo$1.menu$801(v$9041[0],v$9041[1]))("File");
return v$9042(function(v$9044){var v$9045 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["New file",[0,dojo$0dojo$1.newPage$3265],function(v$9046){var content$9047;
var t$10768;
var t$10767 = "(* File created ";
var t$10766;
var d$9048;
var v$10049 = SmlPrims.getrealtime();
d$9048 = (basis$0Date$1.fromTimeLocal$512(v$10049[0],v$10049[1]));
t$10766 = (basis$0Date$1.fmt$816("%a %b %d %H:%M:%S %Y",d$9048));
t$10768 = (t$10767 + t$10766);
content$9047 = (t$10768 + " *)\n");
var t$10780 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2350;
var t$10779 = "Create";
var t$10778 = "New File";
var t$10777 = function(s$9049){return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabs$2696[0],tabs$2696[1]))(s$9049))(content$9047);
};
var t$10776 = [1];
var t$10775 = "Name";
var t$10774;
var fix$10769 = {};
fix$10769.$suggest = function(f$9051){lab$suggest: while (true) {var num$9052 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$9053 = f$9051(num$9052);
var t$10772;
var fix$10770 = {};
fix$10770.$exists = function(v$9055){lab$exists: while (true) {if (v$9055 == null) {return false;
} else {var v$9056 = v$9055;
var v$9057 = v$9056[0];
var v$9058 = v$9056[1];
if (v$9057 == name$9053) {return true;
} else {var t$10771 = v$9058;
var v$9055 = t$10771;
continue lab$exists;
};
};
};
};
var exists$9054 = fix$10770.$exists;
t$10772 = (exists$9054(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10772) {var t$10773 = f$9051;
var f$9051 = t$10773;
continue lab$suggest;
} else {return name$9053;
};
};
};
var suggest$9050 = fix$10769.$suggest;
t$10774 = (suggest$9050(function(num$9059){return ("Untitled-" + (basis$0Int32$1.toString$458(num$9059))) + ".sml";
}));
return t$10780(t$10779,t$10778,t$10777,t$10776,t$10775,t$10774,function(v$10106){return smltojs0$0SmlToJsCompApp$1$2.newFile$1811(fts$2699,content$9047,v$10106);
});
}]);
return v$9045(function(v$9060){var v$9061 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["New folder",[0,dojo$0dojo$1.folderClosed$3224],function(v$10011){var t$10792 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2350;
var t$10791 = "Create";
var t$10790 = "New Folder";
var t$10789 = function(s$10012){return 0;
};
var t$10788 = [1];
var t$10787 = "Name";
var t$10786;
var fix$10781 = {};
fix$10781.$suggest = function(f$10014){lab$suggest: while (true) {var num$10015 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$10016 = f$10014(num$10015);
var t$10784;
var fix$10782 = {};
fix$10782.$exists = function(v$10018){lab$exists: while (true) {if (v$10018 == null) {return false;
} else {var v$10019 = v$10018;
var v$10020 = v$10019[0];
var v$10021 = v$10019[1];
if (v$10020 == name$10016) {return true;
} else {var t$10783 = v$10021;
var v$10018 = t$10783;
continue lab$exists;
};
};
};
};
var exists$10017 = fix$10782.$exists;
t$10784 = (exists$10017(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10784) {var t$10785 = f$10014;
var f$10014 = t$10785;
continue lab$suggest;
} else {return name$10016;
};
};
};
var suggest$10013 = fix$10781.$suggest;
t$10786 = (suggest$10013(function(num$10022){return "Folder-" + (basis$0Int32$1.toString$458(num$10022));
}));
return t$10792(t$10791,t$10790,t$10789,t$10788,t$10787,t$10786,function(v$10108){return smltojs0$0SmlToJsCompApp$1$2.newFolder$1829(fts$2699,v$10108);
});
}]);
return v$9061(function(v$9062){var v$9063 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Move",[0,dojo$0dojo$1.paste$3236],function(v$9064){var path$9065 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var intro$9066 = document.createTextNode("Files can be renamed or moved either using relative paths ('..' is not supported) or using absolute paths (starting with '/').");
var v$9067 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(path$9065);
var v$9068 = v$9067[1];
switch (v$9068[0]) { case 0: {var v$9069 = v$9067[0];
var v$9070 = v$9068[1];
return smltojs0$0SmlToJsCompApp$1$2.withDialog$2350("Move","Move/Rename File",function(v$9071){var v$9072 = v$9071[0];
var v$9073 = v$9071[1];
closetab$2702(path$9065);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabs$2696[0],tabs$2696[1]))(v$9072))(v$9073);
},[0,intro$9066],"New name",v$9070,function(v$10112){return smltojs0$0SmlToJsCompApp$1$2.move$2109(fts$2699,v$9069,v$9070,v$10112);
});
 break; }default: {return notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Renaming of folders not supported");
} };
}]);
return v$9063(function(v$9074){var v$9075 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Delete",[0,dojo$0dojo$1.delete$3237],function(v$10115){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_FilesDelete$2529(fts$2699,closetab$2702,v$10115);
}]);
return v$9075(function(v$9076){var v$9077 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Export (zip)",[0,dojo$0dojo$1.indent$3252],function(v$9078){var v$10155 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Files Export to Zip",v$10155);
}]);
return v$9077(function(v$9079){var v$9080 = (dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Import (zip)",[0,dojo$0dojo$1.outdent$3253],function(v$9081){var v$10157 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Files Import from Zip",v$10157);
}]);
return v$9080(function(v$9082){var v$9083;
switch (smltojs0$0SmlToJsCompApp$1$1.demoinput$76[0]) { case 1: {var a$9084 = 0;
v$9083 = (function(f$9085){return f$9085(a$9084);
});
 break; }default: {var v$9086 = smltojs0$0SmlToJsCompApp$1$1.demoinput$76[1];
v$9083 = ((dojo$0dojo$1.item$827(v$9044[0],v$9044[1]))(["Open Demo File",[1],function(v$9087){var name$9088;
var fix$10793 = {};
fix$10793.$suggest = function(f$9090){lab$suggest: while (true) {var num$9091 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$9092 = f$9090(num$9091);
var t$10796;
var fix$10794 = {};
fix$10794.$exists = function(v$9094){lab$exists: while (true) {if (v$9094 == null) {return false;
} else {var v$9095 = v$9094;
var v$9096 = v$9095[0];
var v$9097 = v$9095[1];
if (v$9096 == name$9092) {return true;
} else {var t$10795 = v$9097;
var v$9094 = t$10795;
continue lab$exists;
};
};
};
};
var exists$9093 = fix$10794.$exists;
t$10796 = (exists$9093(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10796) {var t$10797 = f$9090;
var f$9090 = t$10797;
continue lab$suggest;
} else {return name$9092;
};
};
};
var suggest$9089 = fix$10793.$suggest;
name$9088 = (suggest$9089(function(num$9098){return ("Demo-" + (basis$0Int32$1.toString$458(num$9098))) + ".sml";
}));
var path$9099 = smltojs0$0SmlToJsCompApp$1$2.newFile$1811(fts$2699,v$9086,name$9088);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabs$2696[0],tabs$2696[1]))(path$9099))(v$9086);
}]));
} };
return v$9083(function(v$9100){var v$9101;
switch (smltojs0$0SmlToJsCompApp$1$1.dropboxKey$202[0]) { case 1: {var a$9102 = 0;
v$9101 = (function(f$9103){return f$9103(a$9102);
});
 break; }default: {var v$9104 = smltojs0$0SmlToJsCompApp$1$1.dropboxKey$202[1];
var v$9105 = (dojo$0dojo$1.menu$801(v$9041[0],v$9041[1]))("Dropbox");
v$9101 = (function(c$9106){return v$9105(function(v$9107){var c$9108 = appfun2$0dropbox$1.client$91(v$9104);
if (appfun2$0dropbox$1.isAuthorized$99(c$9108)) {smltojs0$0SmlToJsCompApp$1$2.load$1608(c$9108,fts$2699);
appfun2$0dropbox$1.dropboxUid$212(c$9108,function(uid$9109){var s$9110 = ("Authorized to use " + uid$9109) + "'s Dropbox App Folder";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$9110);
var s$9111;
var t$10803;
var t$10802;
var t$10801;
var t$10800 = basis$0Date$1.fmt$816;
var t$10799 = "%H:%M:%S";
var t$10798;
var v$10050 = SmlPrims.getrealtime();
t$10798 = (basis$0Date$1.fromTimeLocal$512(v$10050[0],v$10050[1]));
t$10801 = (t$10800(t$10799,t$10798));
t$10802 = (t$10801 + ": ");
t$10803 = (t$10802 + s$9110);
s$9111 = (t$10803 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$9111));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
(function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955,"src","dropbox.png");
} else {notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Not Dropbox authorized");
var s$9112;
var t$10809;
var t$10808;
var t$10807;
var t$10806 = basis$0Date$1.fmt$816;
var t$10805 = "%H:%M:%S";
var t$10804;
var v$10051 = SmlPrims.getrealtime();
t$10804 = (basis$0Date$1.fromTimeLocal$512(v$10051[0],v$10051[1]));
t$10807 = (t$10806(t$10805,t$10804));
t$10808 = (t$10807 + ": ");
t$10809 = (t$10808 + "Not Dropbox authorized");
s$9112 = (t$10809 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$9112));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
var m$9113;
var v$9114 = (dojo$0dojo$1.item$827(v$9107[0],v$9107[1]))(["Sign in",[0,dojo$0dojo$1.createLink$3272],function(v$10117){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignIn$2615(v$9104,v$10117);
}]);
m$9113 = (function(c$9115){return v$9114(function(v$9116){return ((dojo$0dojo$1.item$827(v$9107[0],v$9107[1]))(["Sign out",[0,dojo$0dojo$1.unlink$3273],function(v$10121){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignOut$2638(c$9108,fts$2699,closetab$2702,v$10121);
}]))(c$9115);
});
});
m$9113(function(x$9117){return x$9117;
});
var a$9118 = 0;
return c$9106(a$9118);
});
});
} };
return v$9101(function(v$9119){var v$9120 = (dojo$0dojo$1.item$827(v$9041[0],v$9041[1]))(["Compile->Run",[1],function(v$10192){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_CompileAndRun$2663(v$10192);
}]);
return v$9120(function(v$9121){var v$9122 = (dojo$0dojo$1.item$827(v$9041[0],v$9041[1]))(["Clear output",[1],function(v$9123){var fix$10810 = {};
fix$10810.$whileSome = function(g$9125){lab$whileSome: while (true) {var v$9126 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
switch (v$9126[0]) { case 0: {var v$9127 = v$9126[1];
g$9125(v$9127);
var t$10811 = g$9125;
var g$9125 = t$10811;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$9124 = fix$10810.$whileSome;
return whileSome$9124(function(e$9128){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,e$9128);
});
}]);
return v$9122(function(v$9129){var v$9130;
var h$9131 = [["region","left"],[["style","padding:0;padding-right:10;background-color:#eeeeee;"],null]];
v$9130 = (function(f$9132){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9133){var p$9134;
var t$10817 = Cp$9133;
var t$10816;
var fix$10812 = {};
fix$10812.$foldl = function(v$9136,v$9137){lab$foldl: while (true) {if (v$9137 == null) {return v$9136;
} else {var v$9138 = v$9137;
var v$9139 = v$9138[0];
var v$9140 = v$9138[1];
var t$10813;
var v$9141 = v$9139[0];
var v$9142 = v$9139[1];
(function(fp,s,v){fp[s] = v;})(v$9136,v$9141,v$9142);
t$10813 = v$9136;
var t$10814 = t$10813;
var t$10815 = v$9140;
var v$9136 = t$10814;
var v$9137 = t$10815;
continue lab$foldl;
};
};
};
var foldl$9135 = fix$10812.$foldl;
var v$10122 = (function(){return {};})();
t$10816 = (foldl$9135(v$10122,h$9131));
p$9134 = ((function(c,h){return new c(h);})(t$10817,t$10816));
(function(w,e){w.set('content', e);})(p$9134,smltojs0$0SmlToJsCompApp$1$2.logo$1279);
return f$9132(p$9134);
});
});
return v$9130(function(v$9143){var v$9144;
var h$9145 = [["region","right"],[smltojs0$0SmlToJsCompApp$1$2.menuStyle$1280,null]];
v$9144 = (function(f$9146){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/MenuBar",function(MenuBar$9147){var menubar$9148;
var t$10823 = MenuBar$9147;
var t$10822;
var fix$10818 = {};
fix$10818.$foldl = function(v$9150,v$9151){lab$foldl: while (true) {if (v$9151 == null) {return v$9150;
} else {var v$9152 = v$9151;
var v$9153 = v$9152[0];
var v$9154 = v$9152[1];
var t$10819;
var v$9155 = v$9153[0];
var v$9156 = v$9153[1];
(function(fp,s,v){fp[s] = v;})(v$9150,v$9155,v$9156);
t$10819 = v$9150;
var t$10820 = t$10819;
var t$10821 = v$9154;
var v$9150 = t$10820;
var v$9151 = t$10821;
continue lab$foldl;
};
};
};
var foldl$9149 = fix$10818.$foldl;
var v$10124 = (function(){return {};})();
t$10822 = (foldl$9149(v$10124,h$9145));
menubar$9148 = ((function(c,h){return new c(h);})(t$10823,t$10822));
return f$9146([menubar$9148,[menubar$9148,true]]);
});
});
return v$9144(function(v$9157){var v$9158 = v$9157[0];
var v$9159 = v$9157[1];
var v$9160 = (dojo$0dojo$1.menu$801(v$9159[0],v$9159[1]))("Help");
return v$9160(function(v$9161){var v$9162 = (dojo$0dojo$1.item$827(v$9161[0],v$9161[1]))(["About",[0,dojo$0dojo$1.newPage$3265],function(v$9163){var v$10159 = smltojs0$0SmlToJsCompApp$1$1.about$58(0);
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","About SMLtoJs Online",v$10159);
}]);
return v$9162(function(v$9164){var v$9165 = (dojo$0dojo$1.item$827(v$9161[0],v$9161[1]))(["Powered by...",[0,dojo$0dojo$1.newPage$3265],function(v$9166){var v$10161 = smltojs0$0SmlToJsCompApp$1$2.poweredby$2676(0);
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Powered by...",v$10161);
}]);
return v$9165(function(v$9167){return ((dojo$0dojo$1.layoutContainer$316([["region","top"],[["style","height:30px;"],null]]))([v$9143,[v$9040,[v$9158,null]]]))(c$5138);
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
};
};
smltojs0$0SmlToJsCompApp$1$2.everything$2786;
var v$6279 = dojo$0dojo$1.advTabContainer$571([["region","top"],[["splitter","true"],[["style","height:70%;border:0;"],[["tabPosition","bottom"],null]]]]);
smltojs0$0SmlToJsCompApp$1$2.everything$2786 = (function(c$5320){return v$6279(function(v$5321){var v$9899 = v$5321[0];
var v$9900 = v$5321[1];
var v$9901 = v$9900[1];
var v$9902 = v$9900[0];
var v$9903;
var v$10126 = [[["id","0"],[["name","/"],[["kind","folder"],null]]],smltojs0$0SmlToJsCompApp$1$2.ftsServer$2246];
v$9903 = (function(v$10127){return dojo$0dojo$1.treeStore$481(v$10126,v$10127);
});
return v$9903(function(v$9905){var v$9906;
var t$10829;
var t$10828;
var t$10827;
var h$9907 = [["region","left"],[["splitter","true"],[["style","width:20%;"],null]]];
t$10827 = (dojo$0dojo$1.treeWidget$519(h$9907,[true]));
t$10828 = (t$10827("0"));
t$10829 = (t$10828(function(v$9908){var v$9909 = v$9908[0];
var t$10824;
if (v$9909 == "0") {t$10824 = true;
} else {var fields$9910 = basis$0String$1.fields$231(function(c$9911){return c$9911 == 47;
},v$9909);
var fix$10825 = {};
fix$10825.$all = function(v$9913){lab$all: while (true) {if (v$9913 == null) {return true;
} else {var v$9914 = v$9913;
var v$9915 = v$9914[0];
var v$9916 = v$9914[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$9915)) {var t$10826 = v$9916;
var v$9913 = t$10826;
continue lab$all;
} else {return false;
};
};
};
};
var all$9912 = fix$10825.$all;
t$10824 = (all$9912(fields$9910));
};
if (t$10824) {return (smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = v$9909,0);
} else {return smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1636(v$9909,function(v$9917){switch (v$9917[0]) { case 0: {var v$9918 = v$9917[1];
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(v$9899[0],v$9899[1]))(v$9909))(v$9918);
 break; }default: {return v$9901(v$9909);
} };
});
};
}));
v$9906 = (t$10829(v$9905));
return v$9906(function(v$9919){var v$9920 = smltojs0$0SmlToJsCompApp$1$2.menu$2693(v$9899,v$9905,v$9902);
return v$9920(function(v$9921){var v$9922;
var h$9923 = [["title","Output"],null];
v$9922 = (function(f$9924){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9925){var p$9926;
var t$10835 = Cp$9925;
var t$10834;
var fix$10830 = {};
fix$10830.$foldl = function(v$9928,v$9929){lab$foldl: while (true) {if (v$9929 == null) {return v$9928;
} else {var v$9930 = v$9929;
var v$9931 = v$9930[0];
var v$9932 = v$9930[1];
var t$10831;
var v$9933 = v$9931[0];
var v$9934 = v$9931[1];
(function(fp,s,v){fp[s] = v;})(v$9928,v$9933,v$9934);
t$10831 = v$9928;
var t$10832 = t$10831;
var t$10833 = v$9932;
var v$9928 = t$10832;
var v$9929 = t$10833;
continue lab$foldl;
};
};
};
var foldl$9927 = fix$10830.$foldl;
var v$10128 = (function(){return {};})();
t$10834 = (foldl$9927(v$10128,h$9923));
p$9926 = ((function(c,h){return new c(h);})(t$10835,t$10834));
(function(w,e){w.set('content', e);})(p$9926,smltojs0$0SmlToJsCompApp$1$2.outareaDiv$948);
return f$9924(p$9926);
});
});
return v$9922(function(v$9935){var v$9936;
var h$9937 = [["title","Message Log"],null];
v$9936 = (function(f$9938){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9939){var p$9940;
var t$10841 = Cp$9939;
var t$10840;
var fix$10836 = {};
fix$10836.$foldl = function(v$9942,v$9943){lab$foldl: while (true) {if (v$9943 == null) {return v$9942;
} else {var v$9944 = v$9943;
var v$9945 = v$9944[0];
var v$9946 = v$9944[1];
var t$10837;
var v$9947 = v$9945[0];
var v$9948 = v$9945[1];
(function(fp,s,v){fp[s] = v;})(v$9942,v$9947,v$9948);
t$10837 = v$9942;
var t$10838 = t$10837;
var t$10839 = v$9946;
var v$9942 = t$10838;
var v$9943 = t$10839;
continue lab$foldl;
};
};
};
var foldl$9941 = fix$10836.$foldl;
var v$10130 = (function(){return {};})();
t$10840 = (foldl$9941(v$10130,h$9937));
p$9940 = ((function(c,h){return new c(h);})(t$10841,t$10840));
(function(w,e){w.set('content', e);})(p$9940,smltojs0$0SmlToJsCompApp$1$2.logareaDiv$950);
return f$9938(p$9940);
});
});
return v$9936(function(v$9949){var v$9950 = (dojo$0dojo$1.tabContainer$314([["region","center"],[["style","height:30%;"],[["tabPosition","bottom"],null]]]))([v$9935,[v$9949,null]]);
return v$9950(function(v$9951){var v$9952 = (dojo$0dojo$1.borderContainer$315([["region","center"],null]))([v$9899[0],[v$9951,null]]);
return v$9952(function(v$9953){var v$9954;
switch (smltojs0$0SmlToJsCompApp$1$1.rightPane$204[0]) { case 0: {var v$9955 = smltojs0$0SmlToJsCompApp$1$1.rightPane$204[1];
var v$9956;
var h$9957 = [["region","right"],[["splitter","true"],null]];
var e$9958 = v$9955(0);
v$9956 = (function(f$9959){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9960){var p$9961;
var t$10847 = Cp$9960;
var t$10846;
var fix$10842 = {};
fix$10842.$foldl = function(v$9963,v$9964){lab$foldl: while (true) {if (v$9964 == null) {return v$9963;
} else {var v$9965 = v$9964;
var v$9966 = v$9965[0];
var v$9967 = v$9965[1];
var t$10843;
var v$9968 = v$9966[0];
var v$9969 = v$9966[1];
(function(fp,s,v){fp[s] = v;})(v$9963,v$9968,v$9969);
t$10843 = v$9963;
var t$10844 = t$10843;
var t$10845 = v$9967;
var v$9963 = t$10844;
var v$9964 = t$10845;
continue lab$foldl;
};
};
};
var foldl$9962 = fix$10842.$foldl;
var v$10132 = (function(){return {};})();
t$10846 = (foldl$9962(v$10132,h$9957));
p$9961 = ((function(c,h){return new c(h);})(t$10847,t$10846));
(function(w,e){w.set('content', e);})(p$9961,e$9958);
return f$9959(p$9961);
});
});
v$9954 = (function(c$9970){return v$9956(function(v$9971){var a$9972 = [v$9971,null];
return c$9970(a$9972);
});
});
 break; }default: {var a$9973 = null;
v$9954 = (function(f$9974){return f$9974(a$9973);
});
} };
return v$9954(function(v$9975){return ((dojo$0dojo$1.borderContainer$315([["style","height: 100%; width: 100%;"],null]))(basis$0List$1.s$n$686([v$9919,[v$9921,[v$9953,null]]],v$9975)))(c$5320);
});
});
});
});
});
});
});
});
});
});
var t$10848;
var v$5414 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5414[0]) { case 0: {t$10848 = v$5414[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
(function(e,a){return e.appendChild(a);})(t$10848,smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954);
var t$10849;
var v$5420 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5420[0]) { case 0: {t$10849 = v$5420[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
(function(e,a){return e.appendChild(a);})(t$10849,smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955);
var t$10851 = dojo$0dojo$1.attachToElement$201;
var t$10850;
var v$5424 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5424[0]) { case 0: {t$10850 = v$5424[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
t$10851(t$10850,smltojs0$0SmlToJsCompApp$1$2.everything$2786,function(v$2857){return 0;
});
smltojs0$0SmlToJsCompApp$1$2.onload$2837 = function(v$2839){var v$5428 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$5428[0]) { case 0: {var v$5429 = v$5428[1];
var v$5430 = (function(e){return SmlPrims.option(e.nextSibling);})(v$5429);
switch (v$5430[0]) { case 0: {var v$5431 = v$5430[1];
var v$5432 = (function(e){return SmlPrims.option(e.nextSibling);})(v$5431);
switch (v$5432[0]) { case 0: {(function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097,v$5432[1]);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody2"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody3"];
} };
(smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0] = (function(s$5437){(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,document.createTextNode(s$5437));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
}),0);
smltojs0$0SmlToJsCompApp$1$1.onloadhook$147(function(s$5442){return smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0](s$5442);
});
(function(i,f){return setInterval(f,i);})(10000,function(v$5445){var fix$10852 = {};
fix$10852.$app = function(v$5447){lab$app: while (true) {if (v$5447 == null) {return 0;
} else {var v$5448 = v$5447;
var v$5449 = v$5448[0];
var v$5450 = v$5448[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021(v$5449[0],v$5449[1],v$5449[2]);
var t$10853 = v$5450;
var v$5447 = t$10853;
continue lab$app;
};
};
};
var app$5446 = fix$10852.$app;
return app$5446(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
});
return 0;
};
smltojs0$0SmlToJsCompApp$1$2.setWindowOnload$2846 = function(f$2849){return (function(a){return window.onload=a;})(f$2849);
};
(function(a){return window.onload=a;})(function(v$10193){return smltojs0$0SmlToJsCompApp$1$2.onload$2837(v$10193);
});
return 0;
})();
