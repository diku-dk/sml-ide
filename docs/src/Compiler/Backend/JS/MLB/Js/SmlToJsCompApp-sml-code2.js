if ((typeof(smltojs0$0SmlToJsCompApp$1$2)) == "undefined") {smltojs0$0SmlToJsCompApp$1$2 = {};
};
(function(){smltojs0$0SmlToJsCompApp$1$2.scrollDown$928 = function(e$931){return (function(t){t.scrollTop = t.scrollHeight;})(e$931);
};
smltojs0$0SmlToJsCompApp$1$2.userAgent$935 = function(v$937){return (function(){return navigator.userAgent;})();
};
smltojs0$0SmlToJsCompApp$1$2.agent$940 = basis$0String$1.translate$217(function(x$2954){return basis$0Char$1.toString$277(((65 <= x$2954)?(x$2954 <= 90):false)?(SmlPrims.chk_ovf_i32(x$2954 + 32)):x$2954);
},(function(){return navigator.userAgent;})());
smltojs0$0SmlToJsCompApp$1$2.touchDevices$941 = ["ipod",["ipad",["iphone",["series60",["symbian",["android",["windows ce",["blackberry",null]]]]]]]];
smltojs0$0SmlToJsCompApp$1$2.touchScreen$942 = function(a$945){var fix$10187 = {};
fix$10187.$exists = function(v$2964){lab$exists: while (true) {if (v$2964 == null) {return false;
} else {var v$2965 = v$2964;
var v$2966 = v$2965[0];
var v$2967 = v$2965[1];
if (basis$0String$1.isSubstring$268(v$2966,a$945)) {return true;
} else {var t$10188 = v$2967;
var v$2964 = t$10188;
continue lab$exists;
};
};
};
};
var exists$2963 = fix$10187.$exists;
return exists$2963(smltojs0$0SmlToJsCompApp$1$2.touchDevices$941);
};
smltojs0$0SmlToJsCompApp$1$2.serverGet$953 = function(file$956){var file$957;
var t$10192 = file$956 + "?_=";
var t$10191;
var t$10190 = basis$0Real$1.toString$153;
var t$10189;
var v$2971 = SmlPrims.getrealtime();
t$10189 = ((v$2971[0] - (-2147483648)) + (v$2971[1] / 1000000.0));
t$10191 = (t$10190(t$10189));
file$957 = (t$10192 + t$10191);
var r$958 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$958,"GET",file$957,false);
js$0Js$1.send$654(r$958,[1]);
var v$965 = (function(r){return SmlPrims.option(r.responseText);})(r$958);
switch (v$965[0]) { case 0: {return v$965[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$957];
} };
};
smltojs0$0SmlToJsCompApp$1$2.outarea$973;
var attrs$2979 = [["readonly","readonly"],null];
var newelem$2980 = document.createElement("textarea");
var fix$10193 = {};
fix$10193.$app = function(v$2982){lab$app: while (true) {if (v$2982 == null) {return 0;
} else {var v$2983 = v$2982;
var v$2984 = v$2983[0];
var v$2985 = v$2983[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2980,v$2984[0],v$2984[1]);
var t$10194 = v$2985;
var v$2982 = t$10194;
continue lab$app;
};
};
};
var app$2981 = fix$10193.$app;
app$2981(attrs$2979);
smltojs0$0SmlToJsCompApp$1$2.outarea$973 = newelem$2980;
smltojs0$0SmlToJsCompApp$1$2.outareaDiv$974;
var attrs$2987 = [["class","textareacontainer"],null];
var newelem$2989 = document.createElement("div");
var fix$10195 = {};
fix$10195.$app = function(v$2991){lab$app: while (true) {if (v$2991 == null) {return 0;
} else {var v$2992 = v$2991;
var v$2993 = v$2992[0];
var v$2994 = v$2992[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2989,v$2993[0],v$2993[1]);
var t$10196 = v$2994;
var v$2991 = t$10196;
continue lab$app;
};
};
};
var app$2990 = fix$10195.$app;
app$2990(attrs$2987);
(function(e,a){return e.appendChild(a);})(newelem$2989,smltojs0$0SmlToJsCompApp$1$2.outarea$973);
smltojs0$0SmlToJsCompApp$1$2.outareaDiv$974 = newelem$2989;
smltojs0$0SmlToJsCompApp$1$2.logarea$975;
var attrs$2996 = [["readonly","readonly"],null];
var newelem$2997 = document.createElement("textarea");
var fix$10197 = {};
fix$10197.$app = function(v$2999){lab$app: while (true) {if (v$2999 == null) {return 0;
} else {var v$3000 = v$2999;
var v$3001 = v$3000[0];
var v$3002 = v$3000[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2997,v$3001[0],v$3001[1]);
var t$10198 = v$3002;
var v$2999 = t$10198;
continue lab$app;
};
};
};
var app$2998 = fix$10197.$app;
app$2998(attrs$2996);
smltojs0$0SmlToJsCompApp$1$2.logarea$975 = newelem$2997;
smltojs0$0SmlToJsCompApp$1$2.logareaDiv$976;
var attrs$3004 = [["class","textareacontainer"],null];
var newelem$3006 = document.createElement("div");
var fix$10199 = {};
fix$10199.$app = function(v$3008){lab$app: while (true) {if (v$3008 == null) {return 0;
} else {var v$3009 = v$3008;
var v$3010 = v$3009[0];
var v$3011 = v$3009[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3006,v$3010[0],v$3010[1]);
var t$10200 = v$3011;
var v$3008 = t$10200;
continue lab$app;
};
};
};
var app$3007 = fix$10199.$app;
app$3007(attrs$3004);
(function(e,a){return e.appendChild(a);})(newelem$3006,smltojs0$0SmlToJsCompApp$1$2.logarea$975);
smltojs0$0SmlToJsCompApp$1$2.logareaDiv$976 = newelem$3006;
smltojs0$0SmlToJsCompApp$1$2.clearoutbutton$977;
var attrs$3013 = [["type","button"],[["value","Clear Output"],null]];
var newelem$3014 = document.createElement("input");
var fix$10201 = {};
fix$10201.$app = function(v$3016){lab$app: while (true) {if (v$3016 == null) {return 0;
} else {var v$3017 = v$3016;
var v$3018 = v$3017[0];
var v$3019 = v$3017[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3014,v$3018[0],v$3018[1]);
var t$10202 = v$3019;
var v$3016 = t$10202;
continue lab$app;
};
};
};
var app$3015 = fix$10201.$app;
app$3015(attrs$3013);
smltojs0$0SmlToJsCompApp$1$2.clearoutbutton$977 = newelem$3014;
smltojs0$0SmlToJsCompApp$1$2.nodropboxPng$978 = "nodropbox.png";
smltojs0$0SmlToJsCompApp$1$2.dropboxPng$979 = "dropbox.png";
smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980;
var attrs$3021 = [["class","notify_area"],null];
var elem$3022 = document.createTextNode("welcome!");
var newelem$3023 = document.createElement("div");
var fix$10203 = {};
fix$10203.$app = function(v$3025){lab$app: while (true) {if (v$3025 == null) {return 0;
} else {var v$3026 = v$3025;
var v$3027 = v$3026[0];
var v$3028 = v$3026[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3023,v$3027[0],v$3027[1]);
var t$10204 = v$3028;
var v$3025 = t$10204;
continue lab$app;
};
};
};
var app$3024 = fix$10203.$app;
app$3024(attrs$3021);
(function(e,a){return e.appendChild(a);})(newelem$3023,elem$3022);
smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980 = newelem$3023;
smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981;
var attrs$3031 = [["src","nodropbox.png"],[["class","dropbox_area"],null]];
var newelem$3032 = document.createElement("img");
var fix$10205 = {};
fix$10205.$app = function(v$3034){lab$app: while (true) {if (v$3034 == null) {return 0;
} else {var v$3035 = v$3034;
var v$3036 = v$3035[0];
var v$3037 = v$3035[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3032,v$3036[0],v$3036[1]);
var t$10206 = v$3037;
var v$3034 = t$10206;
continue lab$app;
};
};
};
var app$3033 = fix$10205.$app;
app$3033(attrs$3031);
smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981 = newelem$3032;
smltojs0$0SmlToJsCompApp$1$2.setNoDropboxPng$982 = function(v$984){return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981,"src","nodropbox.png");
};
smltojs0$0SmlToJsCompApp$1$2.setDropboxPng$985 = function(v$987){return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981,"src","dropbox.png");
};
var notifyTimeout$988 = [[1]];
var notify0$1026 = function(color$1029,e$1032,s$1035){var v$1046 = notifyTimeout$988[0];
switch (v$1046[0]) { case 0: {(function(id){return clearTimeout(id);})(v$1046[1]);
 break; }default: {0;
} };
(function(e,s){e.innerHTML = s;})(e$1032,s$1035);
(function(e,a,b){return e.setAttribute(a,b);})(e$1032,"style",((("opacity:" + (basis$0Real$1.toString$153(1.0))) + "; background-color:") + color$1029) + ";");
var t$10220 = notifyTimeout$988;
var t$10219;
var t$10218;
var t$10217 = 3000;
var t$10216;
var fix$10207 = {};
fix$10207.$fadeNotification = function(opacity$10001,v$10002){lab$fadeNotification: while (true) {if (opacity$10001 < 0.0) {(function(e,a,b){return e.setAttribute(a,b);})(e$1032,"style","opacity:0.0;");
return (notifyTimeout$988[0] = [1],0);
} else {(function(e,a,b){return e.setAttribute(a,b);})(e$1032,"style",((("opacity:" + (basis$0Real$1.toString$153(opacity$10001))) + "; background-color:") + color$1029) + ";");
var t$10215 = notifyTimeout$988;
var t$10214;
var t$10213;
var t$10212 = 50;
var t$10208;
var v$10045 = opacity$10001 - 0.02;
t$10208 = ((function(env$10211){return function(v$10046){var v$10209 = env$10211[0];
var v$10210 = env$10211[1];
return v$10210(v$10209,v$10046);
};
})([v$10045,fix$10207.$fadeNotification]));
t$10213 = ((function(i,f){return setTimeout(f,i);})(t$10212,t$10208));
t$10214 = [0,t$10213];
return (t$10215[0] = t$10214,0);
};
};
};
var fadeNotification$10000 = fix$10207.$fadeNotification;
t$10216 = (function(v$10048){return fadeNotification$10000(0.98,v$10048);
});
t$10218 = ((function(i,f){return setTimeout(f,i);})(t$10217,t$10216));
t$10219 = [0,t$10218];
return (t$10220[0] = t$10219,0);
};
smltojs0$0SmlToJsCompApp$1$2.notify_err$1049 = function(v$10051){return notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,v$10051);
};
smltojs0$0SmlToJsCompApp$1$2.notify_errE$1050 = function(v$10053){return function(v$10054){return notify0$1026("#dd8888",v$10053,v$10054);
};
};
smltojs0$0SmlToJsCompApp$1$2.notify_warn$1051 = function(v$10057){return notify0$1026("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,v$10057);
};
smltojs0$0SmlToJsCompApp$1$2.notify$1052 = function(v$10060){return notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,v$10060);
};
smltojs0$0SmlToJsCompApp$1$2.outRef$1053 = [function(v$1055){throw [basis$0Initial$1.en$Fail$54,"outRef not initialized"];
}];
smltojs0$0SmlToJsCompApp$1$2.out$1056 = function(s$1059){return smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0](s$1059);
};
var fix$10221 = {};
fix$10221.$whileSome = function(f$1063,g$1066){lab$whileSome: while (true) {var v$1071 = f$1063(0);
switch (v$1071[0]) { case 0: {var v$1075 = v$1071[1];
g$1066(v$1075);
var t$10222 = f$1063;
var t$10223 = g$1066;
var f$1063 = t$10222;
var g$1066 = t$10223;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.whileSome$1060 = fix$10221.$whileSome;
smltojs0$0SmlToJsCompApp$1$2.clearoutarea$1076 = function(v$1078){var fix$10224 = {};
fix$10224.$whileSome = function(g$6339){lab$whileSome: while (true) {var v$6340 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
switch (v$6340[0]) { case 0: {var v$6341 = v$6340[1];
g$6339(v$6341);
var t$10225 = g$6339;
var g$6339 = t$10225;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$6338 = fix$10224.$whileSome;
return whileSome$6338(function(e$1083){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,e$1083);
});
};
smltojs0$0SmlToJsCompApp$1$2.outfun$1084 = function(s$1087){(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,document.createTextNode(s$1087));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
};
smltojs0$0SmlToJsCompApp$1$2.clearlogarea$1090 = function(v$1092){var fix$10226 = {};
fix$10226.$whileSome = function(g$6346){lab$whileSome: while (true) {var v$6347 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
switch (v$6347[0]) { case 0: {var v$6348 = v$6347[1];
g$6346(v$6348);
var t$10227 = g$6346;
var g$6346 = t$10227;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$6345 = fix$10226.$whileSome;
return whileSome$6345(function(e$1097){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,e$1097);
});
};
smltojs0$0SmlToJsCompApp$1$2.log0$1098 = function(s$1101){var s$1102;
var t$10233;
var t$10232;
var t$10231;
var t$10230 = basis$0Date$1.fmt$816;
var t$10229 = "%H:%M:%S";
var t$10228;
var v$10016 = SmlPrims.getrealtime();
t$10228 = (basis$0Date$1.fromTimeLocal$512(v$10016[0],v$10016[1]));
t$10231 = (t$10230(t$10229,t$10228));
t$10232 = (t$10231 + ": ");
t$10233 = (t$10232 + s$1101);
s$1102 = (t$10233 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$1102));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
smltojs0$0SmlToJsCompApp$1$2.log$1105 = function(s$1108){notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$1108);
var s$3120;
var t$10239;
var t$10238;
var t$10237;
var t$10236 = basis$0Date$1.fmt$816;
var t$10235 = "%H:%M:%S";
var t$10234;
var v$10017 = SmlPrims.getrealtime();
t$10234 = (basis$0Date$1.fromTimeLocal$512(v$10017[0],v$10017[1]));
t$10237 = (t$10236(t$10235,t$10234));
t$10238 = (t$10237 + ": ");
t$10239 = (t$10238 + s$1108);
s$3120 = (t$10239 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3120));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
smltojs0$0SmlToJsCompApp$1$2.logerr$1111 = function(s$1114){notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$1114);
var s$3129;
var t$10245;
var t$10244;
var t$10243;
var t$10242 = basis$0Date$1.fmt$816;
var t$10241 = "%H:%M:%S";
var t$10240;
var v$10018 = SmlPrims.getrealtime();
t$10240 = (basis$0Date$1.fromTimeLocal$512(v$10018[0],v$10018[1]));
t$10243 = (t$10242(t$10241,t$10240));
t$10244 = (t$10243 + ": ");
t$10245 = (t$10244 + s$1114);
s$3129 = (t$10245 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3129));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
smltojs0$0SmlToJsCompApp$1$2.logwarn$1117 = function(s$1120){notify0$1026("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$1120);
var s$3138;
var t$10251;
var t$10250;
var t$10249;
var t$10248 = basis$0Date$1.fmt$816;
var t$10247 = "%H:%M:%S";
var t$10246;
var v$10019 = SmlPrims.getrealtime();
t$10246 = (basis$0Date$1.fromTimeLocal$512(v$10019[0],v$10019[1]));
t$10249 = (t$10248(t$10247,t$10246));
t$10250 = (t$10249 + ": ");
t$10251 = (t$10250 + s$1120);
s$3138 = (t$10251 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3138));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
smltojs0$0SmlToJsCompApp$1$2.topelem$1123 = (function(d){return d.documentElement;})(js$0Js$1.document$88);
smltojs0$0SmlToJsCompApp$1$2.appendStyleLink$1124 = function(path$1127){var v$1132 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1132[0]) { case 0: {var t$10255 = v$1132[1];
var t$10252;
var attrs$3151 = [["rel","stylesheet"],[["href",path$1127],null]];
var newelem$3152 = document.createElement("link");
var fix$10253 = {};
fix$10253.$app = function(v$3154){lab$app: while (true) {if (v$3154 == null) {return 0;
} else {var v$3155 = v$3154;
var v$3156 = v$3155[0];
var v$3157 = v$3155[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3152,v$3156[0],v$3156[1]);
var t$10254 = v$3157;
var v$3154 = t$10254;
continue lab$app;
};
};
};
var app$3153 = fix$10253.$app;
app$3153(attrs$3151);
t$10252 = newelem$3152;
return (function(e,a){return e.appendChild(a);})(t$10255,t$10252);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.appendIconLink$1135 = function(path$1138){var v$1143 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1143[0]) { case 0: {var t$10259 = v$1143[1];
var t$10256;
var attrs$3162 = [["rel","shortcut icon"],[["type","image/x-icon"],[["href",path$1138],null]]];
var newelem$3163 = document.createElement("link");
var fix$10257 = {};
fix$10257.$app = function(v$3165){lab$app: while (true) {if (v$3165 == null) {return 0;
} else {var v$3166 = v$3165;
var v$3167 = v$3166[0];
var v$3168 = v$3166[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3163,v$3167[0],v$3167[1]);
var t$10258 = v$3168;
var v$3165 = t$10258;
continue lab$app;
};
};
};
var app$3164 = fix$10257.$app;
app$3164(attrs$3162);
t$10256 = newelem$3163;
return (function(e,a){return e.appendChild(a);})(t$10259,t$10256);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.appendScript$1146 = function(path$1149){var v$1154 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1154[0]) { case 0: {var t$10263 = v$1154[1];
var t$10260;
var attrs$3173 = [["type","text/javascript"],[["src",path$1149],null]];
var newelem$3174 = document.createElement("script");
var fix$10261 = {};
fix$10261.$app = function(v$3176){lab$app: while (true) {if (v$3176 == null) {return 0;
} else {var v$3177 = v$3176;
var v$3178 = v$3177[0];
var v$3179 = v$3177[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3174,v$3178[0],v$3178[1]);
var t$10262 = v$3179;
var v$3176 = t$10262;
continue lab$app;
};
};
};
var app$3175 = fix$10261.$app;
app$3175(attrs$3173);
t$10260 = newelem$3174;
return (function(e,a){return e.appendChild(a);})(t$10263,t$10260);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.cleanupBody$1157 = function(v$1159){var v$1164 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1164[0]) { case 0: {var v$1180 = v$1164[1];
var v$1170 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1180);
switch (v$1170[0]) { case 0: {var v$1179 = v$1170[1];
var v$1176 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1179);
switch (v$1176[0]) { case 0: {return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123,v$1176[1]);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody2"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody3"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.createBody$1181 = function(v$1183){var v$1188 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$1188[0]) { case 0: {var v$1199 = v$1188[1];
var v$1196 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1199);
switch (v$1196[0]) { case 0: {(function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123,v$1196[1]);
 break; }default: {0;
} };
var t$10267 = smltojs0$0SmlToJsCompApp$1$2.topelem$1123;
var t$10264;
var attrs$3192 = [["class","claro"],[["id","body"],null]];
var newelem$3193 = document.createElement("body");
var fix$10265 = {};
fix$10265.$app = function(v$3195){lab$app: while (true) {if (v$3195 == null) {return 0;
} else {var v$3196 = v$3195;
var v$3197 = v$3196[0];
var v$3198 = v$3196[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3193,v$3197[0],v$3197[1]);
var t$10266 = v$3198;
var v$3195 = t$10266;
continue lab$app;
};
};
};
var app$3194 = fix$10265.$app;
app$3194(attrs$3192);
t$10264 = newelem$3193;
return (function(e,a){return e.appendChild(a);})(t$10267,t$10264);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"createBody"];
} };
};
var v$6351 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6351[0]) { case 0: {var t$10271 = v$6351[1];
var t$10268;
var attrs$6352 = [["rel","stylesheet"],[["href","dijit/themes/claro/claro.css"],null]];
var newelem$6353 = document.createElement("link");
var fix$10269 = {};
fix$10269.$app = function(v$6355){lab$app: while (true) {if (v$6355 == null) {return 0;
} else {var v$6356 = v$6355;
var v$6357 = v$6356[0];
var v$6358 = v$6356[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6353,v$6357[0],v$6357[1]);
var t$10270 = v$6358;
var v$6355 = t$10270;
continue lab$app;
};
};
};
var app$6354 = fix$10269.$app;
app$6354(attrs$6352);
t$10268 = newelem$6353;
(function(e,a){return e.appendChild(a);})(t$10271,t$10268);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6360 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6360[0]) { case 0: {var t$10275 = v$6360[1];
var t$10272;
var attrs$6361 = [["rel","stylesheet"],[["href","js/codemirror/codemirror.css"],null]];
var newelem$6362 = document.createElement("link");
var fix$10273 = {};
fix$10273.$app = function(v$6364){lab$app: while (true) {if (v$6364 == null) {return 0;
} else {var v$6365 = v$6364;
var v$6366 = v$6365[0];
var v$6367 = v$6365[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6362,v$6366[0],v$6366[1]);
var t$10274 = v$6367;
var v$6364 = t$10274;
continue lab$app;
};
};
};
var app$6363 = fix$10273.$app;
app$6363(attrs$6361);
t$10272 = newelem$6362;
(function(e,a){return e.appendChild(a);})(t$10275,t$10272);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6369 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6369[0]) { case 0: {var t$10279 = v$6369[1];
var t$10276;
var attrs$6370 = [["type","text/javascript"],[["src","js/codemirror/sml.js"],null]];
var newelem$6371 = document.createElement("script");
var fix$10277 = {};
fix$10277.$app = function(v$6373){lab$app: while (true) {if (v$6373 == null) {return 0;
} else {var v$6374 = v$6373;
var v$6375 = v$6374[0];
var v$6376 = v$6374[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6371,v$6375[0],v$6375[1]);
var t$10278 = v$6376;
var v$6373 = t$10278;
continue lab$app;
};
};
};
var app$6372 = fix$10277.$app;
app$6372(attrs$6370);
t$10276 = newelem$6371;
(function(e,a){return e.appendChild(a);})(t$10279,t$10276);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
var v$6378 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6378[0]) { case 0: {var t$10283 = v$6378[1];
var t$10280;
var attrs$6379 = [["rel","stylesheet"],[["href","appfunstyle.css"],null]];
var newelem$6380 = document.createElement("link");
var fix$10281 = {};
fix$10281.$app = function(v$6382){lab$app: while (true) {if (v$6382 == null) {return 0;
} else {var v$6383 = v$6382;
var v$6384 = v$6383[0];
var v$6385 = v$6383[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6380,v$6384[0],v$6384[1]);
var t$10282 = v$6385;
var v$6382 = t$10282;
continue lab$app;
};
};
};
var app$6381 = fix$10281.$app;
app$6381(attrs$6379);
t$10280 = newelem$6380;
(function(e,a){return e.appendChild(a);})(t$10283,t$10280);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6387 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6387[0]) { case 0: {var t$10287 = v$6387[1];
var t$10284;
var attrs$6388 = [["rel","shortcut icon"],[["type","image/x-icon"],[["href","favicon.ico"],null]]];
var newelem$6389 = document.createElement("link");
var fix$10285 = {};
fix$10285.$app = function(v$6391){lab$app: while (true) {if (v$6391 == null) {return 0;
} else {var v$6392 = v$6391;
var v$6393 = v$6392[0];
var v$6394 = v$6392[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6389,v$6393[0],v$6393[1]);
var t$10286 = v$6394;
var v$6391 = t$10286;
continue lab$app;
};
};
};
var app$6390 = fix$10285.$app;
app$6390(attrs$6388);
t$10284 = newelem$6389;
(function(e,a){return e.appendChild(a);})(t$10287,t$10284);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
smltojs0$0SmlToJsCompApp$1$2.createBody$1181(0);
smltojs0$0SmlToJsCompApp$1$2.getElem$1206 = function(id$1209){var v$1214 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,id$1209);
switch (v$1214[0]) { case 0: {return v$1214[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
};
var fix$10288 = {};
fix$10288.$app = function(v$3203){lab$app: while (true) {if (v$3203 == null) {return 0;
} else {var v$3204 = v$3203;
var v$3205 = v$3204[0];
var v$3206 = v$3204[1];
var v$6396 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$6396[0]) { case 0: {var t$10292 = v$6396[1];
var t$10289;
var attrs$6397 = [["type","text/javascript"],[["src",v$3205],null]];
var newelem$6398 = document.createElement("script");
var fix$10290 = {};
fix$10290.$app = function(v$6400){lab$app: while (true) {if (v$6400 == null) {return 0;
} else {var v$6401 = v$6400;
var v$6402 = v$6401[0];
var v$6403 = v$6401[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6398,v$6402[0],v$6402[1]);
var t$10291 = v$6403;
var v$6400 = t$10291;
continue lab$app;
};
};
};
var app$6399 = fix$10290.$app;
app$6399(attrs$6397);
t$10289 = newelem$6398;
(function(e,a){return e.appendChild(a);})(t$10292,t$10289);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
var t$10293 = v$3206;
var v$3203 = t$10293;
continue lab$app;
};
};
};
var app$3202 = fix$10288.$app;
app$3202(smltojs0$0SmlToJsCompApp$1$1.script_paths$88);
smltojs0$0SmlToJsCompApp$1$2.mkEditor$1218 = function(inarea$1221){var t$10296;
var fix$10294 = {};
fix$10294.$exists = function(v$3210){lab$exists: while (true) {if (v$3210 == null) {return false;
} else {var v$3211 = v$3210;
var v$3212 = v$3211[0];
var v$3213 = v$3211[1];
if (basis$0String$1.isSubstring$268(v$3212,smltojs0$0SmlToJsCompApp$1$2.agent$940)) {return true;
} else {var t$10295 = v$3213;
var v$3210 = t$10295;
continue lab$exists;
};
};
};
};
var exists$3209 = fix$10294.$exists;
t$10296 = (exists$3209(smltojs0$0SmlToJsCompApp$1$2.touchDevices$941));
if (t$10296) {return [function(v$1227){return (function(e){return e.value;})(inarea$1221);
},function(s$1230){var v$1235 = (function(e){return SmlPrims.option(e.firstChild);})(inarea$1221);
switch (v$1235[0]) { case 0: {var v$1237 = v$1235[1];
return (function(e,a,old){return e.replaceChild(a,old);})(inarea$1221,document.createTextNode(s$1230),v$1237);
 break; }default: {return (function(e,a){return e.appendChild(a);})(inarea$1221,document.createTextNode(s$1230));
} };
}];
} else {var properties$1238;
var t$1239 = (function(){return {};})();
(function(fp,s,v){fp[s] = v;})(t$1239,"textWrapping",true);
(function(fp,s,v){fp[s] = v;})(t$1239,"lineNumbers",true);
(function(fp,s,v){fp[s] = v;})(t$1239,"height","100%");
(function(fp,s,v){fp[s] = v;})(t$1239,"width","100%");
(function(fp,s,v){fp[s] = v;})(t$1239,"mode","sml");
properties$1238 = t$1239;
var ed$1250 = (function(e,props){return CodeMirror.fromTextArea(e,props);})(inarea$1221,properties$1238);
return [function(v$1254){return (function(e){return e.getValue();})(ed$1250);
},function(s$1257){return (function(e,s){return e.setValue(s);})(ed$1250,s$1257);
}];
};
};
smltojs0$0SmlToJsCompApp$1$2.exec_print$1262 = function(f$1265,v$1268){var p_old$1269 = basis$0Control$1.printer_get$55(0);
var buf$1270 = [null];
basis$0Control$1.printer_set$54(function(s$3241){return (buf$1270[0] = [s$3241,buf$1270[0]],0);
});
try {f$1265(v$1268);
} catch(v$10297) {(function(v$1282){return 0;
})(v$10297);
};
var res$1277 = SmlPrims.concat(basis$0List$1.rev$682(buf$1270[0]));
basis$0Control$1.printer_set$54(p_old$1269);
return res$1277;
};
smltojs0$0SmlToJsCompApp$1$2.compileAndRunEditor$1284 = function(f$1287,editor$1290){var res$1291;
var v$3246 = editor$1290[0](0);
var p_old$3247 = basis$0Control$1.printer_get$55(0);
var buf$3248 = [null];
basis$0Control$1.printer_set$54(function(s$3249){return (buf$3248[0] = [s$3249,buf$3248[0]],0);
});
try {smltojs0$0SmlToJsCompApp$1$1.compute$102(f$1287,v$3246);
} catch(v$10298) {(function(v$3251){return 0;
})(v$10298);
};
var res$3252 = SmlPrims.concat(basis$0List$1.rev$682(buf$3248[0]));
basis$0Control$1.printer_set$54(p_old$3247);
res$1291 = res$3252;
return smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0](res$1291);
};
smltojs0$0SmlToJsCompApp$1$2.noop$1296 = function(v$1298){return 0;
};
smltojs0$0SmlToJsCompApp$1$2.put$1299 = function(s$1302,v$1304){var s$3254 = s$1302 + "\n";
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,document.createTextNode(s$3254));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
};
smltojs0$0SmlToJsCompApp$1$2.logo$1305;
var attrs$3261 = [["src","smltojs_logo_transparent_small.png"],[["height","30px"],[["alt","SMLtoJs Online"],null]]];
var newelem$3262 = document.createElement("img");
var fix$10299 = {};
fix$10299.$app = function(v$3264){lab$app: while (true) {if (v$3264 == null) {return 0;
} else {var v$3265 = v$3264;
var v$3266 = v$3265[0];
var v$3267 = v$3265[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3262,v$3266[0],v$3266[1]);
var t$10300 = v$3267;
var v$3264 = t$10300;
continue lab$app;
};
};
};
var app$3263 = fix$10299.$app;
app$3263(attrs$3261);
smltojs0$0SmlToJsCompApp$1$2.logo$1305 = newelem$3262;
smltojs0$0SmlToJsCompApp$1$2.menuStyle$1306 = ["style","border:0;padding:2;"];
smltojs0$0SmlToJsCompApp$1$2.qq$1307 = function(s$1310){return ("'" + s$1310) + "'";
};
smltojs0$0SmlToJsCompApp$1$2.s$rr$1311 = function(v$1322,v$10020){switch (v$1322) { case "0": {return v$10020;
 break; }default: {return (v$1322 + "/") + v$10020;
} };
};
smltojs0$0SmlToJsCompApp$1$2.okExt$1325 = function(s$1328){var fix$10301 = {};
fix$10301.$exists = function(v$3277){lab$exists: while (true) {if (v$3277 == null) {return false;
} else {var v$3278 = v$3277;
var v$3279 = v$3278[0];
var v$3280 = v$3278[1];
if (s$1328 == v$3279) {return true;
} else {var t$10302 = v$3280;
var v$3277 = t$10302;
continue lab$exists;
};
};
};
};
var exists$3276 = fix$10301.$exists;
return exists$3276(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211);
};
smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332 = function(n$1335){if (n$1335.length > 0) {var t$10303;
var c$3293;
if (0 >= n$1335.length) {throw CompilerInitial.exn$Subscript$52;
} else {c$3293 = (n$1335.charCodeAt(0));
};
t$10303 = (((97 <= c$3293)?(c$3293 <= 122):false)?true:((65 <= c$3293)?(c$3293 <= 90):false));
if (t$10303) {var stop$3299 = n$1335.length;
var fix$10304 = {};
fix$10304.$lr = function(j$3301){lab$lr: while (true) {if (j$3301 >= stop$3299) {return true;
} else {var t$10305;
var c$6404 = n$1335.charCodeAt(j$3301);
t$10305 = (((((97 <= c$6404)?(c$6404 <= 122):false)?true:((65 <= c$6404)?(c$6404 <= 90):false))?true:((48 <= c$6404)?(c$6404 <= 57):false))?true:((c$6404 == 95)?true:(c$6404 == 45)));
if (t$10305) {var t$10306 = SmlPrims.chk_ovf_i32(j$3301 + 1);
var j$3301 = t$10306;
continue lab$lr;
} else {return false;
};
};
};
};
var lr$3300 = fix$10304.$lr;
return lr$3300(0);
} else {return false;
};
} else {return false;
};
};
smltojs0$0SmlToJsCompApp$1$2.okFileName$1355 = function(n$1358){var v$1366 = basis$0String$1.fields$231(function(c$1382){return c$1382 == 46;
},n$1358);
if (v$1366 == null) {return false;
} else {var v$1368 = v$1366;
var v$1369 = v$1368[1];
if (v$1369 == null) {return false;
} else {var v$1371 = v$1369;
if (v$1371[1] == null) {var v$1377 = v$1368[0];
var v$1378 = v$1371[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$1377)) {var fix$10307 = {};
fix$10307.$exists = function(v$3305){lab$exists: while (true) {if (v$3305 == null) {return false;
} else {var v$3306 = v$3305;
var v$3307 = v$3306[0];
var v$3308 = v$3306[1];
if (v$1378 == v$3307) {return true;
} else {var t$10308 = v$3308;
var v$3305 = t$10308;
continue lab$exists;
};
};
};
};
var exists$3304 = fix$10307.$exists;
return exists$3304(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211);
} else {return false;
};
} else {return false;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.okFolderPath$1383 = function(p$1386){if (p$1386 == "0") {return true;
} else {var fields$1391 = basis$0String$1.fields$231(function(c$1394){return c$1394 == 47;
},p$1386);
var fix$10309 = {};
fix$10309.$all = function(v$3323){lab$all: while (true) {if (v$3323 == null) {return true;
} else {var v$3324 = v$3323;
var v$3325 = v$3324[0];
var v$3326 = v$3324[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3325)) {var t$10310 = v$3326;
var v$3323 = t$10310;
continue lab$all;
} else {return false;
};
};
};
};
var all$3322 = fix$10309.$all;
return all$3322(fields$1391);
};
};
smltojs0$0SmlToJsCompApp$1$2.okFilePath$1395 = function(p$1398){var fields$1399 = basis$0String$1.fields$231(function(c$1402){return c$1402 == 47;
},p$1398);
var v$1408 = basis$0List$1.rev$682(fields$1399);
if (v$1408 == null) {return false;
} else {var v$1414 = v$1408;
var v$1415 = v$1414[0];
var v$1416 = v$1414[1];
var t$10313;
var v$6407 = basis$0String$1.fields$231(function(c$6408){return c$6408 == 46;
},v$1415);
if (v$6407 == null) {t$10313 = false;
} else {var v$6409 = v$6407;
var v$6410 = v$6409[1];
if (v$6410 == null) {t$10313 = false;
} else {var v$6411 = v$6410;
if (v$6411[1] == null) {var v$6412 = v$6409[0];
var v$6413 = v$6411[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6412)) {var fix$10314 = {};
fix$10314.$exists = function(v$6415){lab$exists: while (true) {if (v$6415 == null) {return false;
} else {var v$6416 = v$6415;
var v$6417 = v$6416[0];
var v$6418 = v$6416[1];
if (v$6413 == v$6417) {return true;
} else {var t$10315 = v$6418;
var v$6415 = t$10315;
continue lab$exists;
};
};
};
};
var exists$6414 = fix$10314.$exists;
t$10313 = (exists$6414(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10313 = false;
};
} else {t$10313 = false;
};
};
};
if (t$10313) {var fix$10311 = {};
fix$10311.$all = function(v$3329){lab$all: while (true) {if (v$3329 == null) {return true;
} else {var v$3330 = v$3329;
var v$3331 = v$3330[0];
var v$3332 = v$3330[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3331)) {var t$10312 = v$3332;
var v$3329 = t$10312;
continue lab$all;
} else {return false;
};
};
};
};
var all$3328 = fix$10311.$all;
return all$3328(v$1416);
} else {return false;
};
};
};
smltojs0$0SmlToJsCompApp$1$2.allfiles$1417 = [null];
smltojs0$0SmlToJsCompApp$1$2.alldirs$1418 = [["0",null]];
smltojs0$0SmlToJsCompApp$1$2.fileStore$1419 = [[1]];
smltojs0$0SmlToJsCompApp$1$2.current$1420 = ["0"];
smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421 = [null];
smltojs0$0SmlToJsCompApp$1$2.splitPath$1422 = function(p$1425){if (p$1425 == "0") {return [p$1425,[1]];
} else {var fields$1430 = basis$0String$1.fields$231(function(c$1433){return c$1433 == 47;
},p$1425);
var v$1442 = basis$0List$1.rev$682(fields$1430);
if (v$1442 == null) {throw [basis$0Initial$1.en$Fail$54,"impossible: splitPath"];
} else {var v$1444 = v$1442;
var v$1445 = v$1444[1];
if (v$1445 == null) {var v$1450 = v$1444[0];
var t$10316;
var v$6421 = basis$0String$1.fields$231(function(c$6422){return c$6422 == 46;
},v$1450);
if (v$6421 == null) {t$10316 = false;
} else {var v$6423 = v$6421;
var v$6424 = v$6423[1];
if (v$6424 == null) {t$10316 = false;
} else {var v$6425 = v$6424;
if (v$6425[1] == null) {var v$6426 = v$6423[0];
var v$6427 = v$6425[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6426)) {var fix$10317 = {};
fix$10317.$exists = function(v$6429){lab$exists: while (true) {if (v$6429 == null) {return false;
} else {var v$6430 = v$6429;
var v$6431 = v$6430[0];
var v$6432 = v$6430[1];
if (v$6427 == v$6431) {return true;
} else {var t$10318 = v$6432;
var v$6429 = t$10318;
continue lab$exists;
};
};
};
};
var exists$6428 = fix$10317.$exists;
t$10316 = (exists$6428(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10316 = false;
};
} else {t$10316 = false;
};
};
};
return t$10316?["0",[0,v$1450]]:[v$1450,[1]];
} else {var v$1455 = v$1444[0];
var t$10319;
var v$6434 = basis$0String$1.fields$231(function(c$6435){return c$6435 == 46;
},v$1455);
if (v$6434 == null) {t$10319 = false;
} else {var v$6436 = v$6434;
var v$6437 = v$6436[1];
if (v$6437 == null) {t$10319 = false;
} else {var v$6438 = v$6437;
if (v$6438[1] == null) {var v$6439 = v$6436[0];
var v$6440 = v$6438[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6439)) {var fix$10320 = {};
fix$10320.$exists = function(v$6442){lab$exists: while (true) {if (v$6442 == null) {return false;
} else {var v$6443 = v$6442;
var v$6444 = v$6443[0];
var v$6445 = v$6443[1];
if (v$6440 == v$6444) {return true;
} else {var t$10321 = v$6445;
var v$6442 = t$10321;
continue lab$exists;
};
};
};
};
var exists$6441 = fix$10320.$exists;
t$10319 = (exists$6441(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10319 = false;
};
} else {t$10319 = false;
};
};
};
return t$10319?[basis$0String$1.concatWith$182("/",basis$0List$1.rev$682(v$1445)),[0,v$1455]]:[p$1425,[1]];
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.splitFolderPath$1456 = function(p$1459){if (p$1459 == "0") {return [p$1459,[1]];
} else {var fields$1464 = basis$0String$1.fields$231(function(c$1467){return c$1467 == 47;
},p$1459);
var v$1476 = basis$0List$1.rev$682(fields$1464);
if (v$1476 == null) {throw [basis$0Initial$1.en$Fail$54,"impossible: splitFolderPath"];
} else {var v$1478 = v$1476;
var v$1479 = v$1478[1];
if (v$1479 == null) {var v$1484 = v$1478[0];
return (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$1484))?["0",[0,v$1484]]:[v$1484,[1]];
} else {var v$1489 = v$1478[0];
return (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$1489))?[basis$0String$1.concatWith$182("/",basis$0List$1.rev$682(v$1479)),[0,v$1489]]:[p$1459,[1]];
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.currentFolder$1490 = function(v$1492){return (smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0];
};
smltojs0$0SmlToJsCompApp$1$2.currentFile$1497 = function(v$1499){var t$10322;
var p$3342 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var fields$3343 = basis$0String$1.fields$231(function(c$3344){return c$3344 == 47;
},p$3342);
var v$3345 = basis$0List$1.rev$682(fields$3343);
if (v$3345 == null) {t$10322 = false;
} else {var v$3346 = v$3345;
var v$3347 = v$3346[0];
var v$3348 = v$3346[1];
var t$10325;
var v$6448 = basis$0String$1.fields$231(function(c$6449){return c$6449 == 46;
},v$3347);
if (v$6448 == null) {t$10325 = false;
} else {var v$6450 = v$6448;
var v$6451 = v$6450[1];
if (v$6451 == null) {t$10325 = false;
} else {var v$6452 = v$6451;
if (v$6452[1] == null) {var v$6453 = v$6450[0];
var v$6454 = v$6452[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6453)) {var fix$10326 = {};
fix$10326.$exists = function(v$6456){lab$exists: while (true) {if (v$6456 == null) {return false;
} else {var v$6457 = v$6456;
var v$6458 = v$6457[0];
var v$6459 = v$6457[1];
if (v$6454 == v$6458) {return true;
} else {var t$10327 = v$6459;
var v$6456 = t$10327;
continue lab$exists;
};
};
};
};
var exists$6455 = fix$10326.$exists;
t$10325 = (exists$6455(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10325 = false;
};
} else {t$10325 = false;
};
};
};
if (t$10325) {var fix$10323 = {};
fix$10323.$all = function(v$3350){lab$all: while (true) {if (v$3350 == null) {return true;
} else {var v$3351 = v$3350;
var v$3352 = v$3351[0];
var v$3353 = v$3351[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3352)) {var t$10324 = v$3353;
var v$3350 = t$10324;
continue lab$all;
} else {return false;
};
};
};
};
var all$3349 = fix$10323.$all;
t$10322 = (all$3349(v$3348));
} else {t$10322 = false;
};
};
return t$10322?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.currentIsFolder$1504 = function(v$1506){var t$10328;
var p$3356 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
if (p$3356 == "0") {t$10328 = true;
} else {var fields$3362 = basis$0String$1.fields$231(function(c$3363){return c$3363 == 47;
},p$3356);
var fix$10329 = {};
fix$10329.$all = function(v$3365){lab$all: while (true) {if (v$3365 == null) {return true;
} else {var v$3366 = v$3365;
var v$3367 = v$3366[0];
var v$3368 = v$3366[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3367)) {var t$10330 = v$3368;
var v$3365 = t$10330;
continue lab$all;
} else {return false;
};
};
};
};
var all$3364 = fix$10329.$all;
t$10328 = (all$3364(fields$3362));
};
return t$10328?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.fileExists$1511 = function(name$1514){var fix$10331 = {};
fix$10331.$exists = function(v$3377){lab$exists: while (true) {if (v$3377 == null) {return false;
} else {var v$3378 = v$3377;
var v$3379 = v$3378[0];
var v$3380 = v$3378[1];
if (v$3379 == name$1514) {return true;
} else {var t$10332 = v$3380;
var v$3377 = t$10332;
continue lab$exists;
};
};
};
};
var exists$3376 = fix$10331.$exists;
return exists$3376(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]);
};
smltojs0$0SmlToJsCompApp$1$2.folderExists$1518 = function(name$1521){var fix$10333 = {};
fix$10333.$exists = function(v$3398){lab$exists: while (true) {if (v$3398 == null) {return false;
} else {var v$3399 = v$3398;
var v$3400 = v$3399[0];
var v$3401 = v$3399[1];
if (v$3400 == name$1521) {return true;
} else {var t$10334 = v$3401;
var v$3398 = t$10334;
continue lab$exists;
};
};
};
};
var exists$3397 = fix$10333.$exists;
return exists$3397(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]);
};
smltojs0$0SmlToJsCompApp$1$2.isServerPath$1525 = function(p$1528){var v$1533 = basis$0String$1.tokens$224(function(c$1540){return c$1540 == 47;
},p$1528);
if (v$1533 == null) {return false;
} else {var v$1535 = v$1533;
switch (v$1535[0]) { case "Server": {return true;
 break; }default: {return false;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.isDropboxPath$1541 = function(p$1544){var v$1549 = basis$0String$1.tokens$224(function(c$1556){return c$1556 == 47;
},p$1544);
if (v$1549 == null) {return false;
} else {var v$1551 = v$1549;
switch (v$1551[0]) { case "Dropbox": {return true;
 break; }default: {return false;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.load$1634 = function(c$1637,fts$1640){(smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0] = [0,c$1637],0);
var t$10363 = appfun2$0dropbox$1.all_files$257;
var t$10362 = c$1637;
var t$10361;
var fix$10335 = {};
fix$10335.$app = function(v$3496){lab$app: while (true) {if (v$3496 == null) {return 0;
} else {var v$3497 = v$3496;
var v$3498 = v$3497[0];
var v$3499 = v$3497[1];
var loadDir$6474 = function(p$6475,n$6476){var d$6477;
switch (p$6475) { case "0": {d$6477 = n$6476;
 break; }default: {d$6477 = ((p$6475 + "/") + n$6476);
} };
var t$10338;
var fix$10336 = {};
fix$10336.$exists = function(v$6479){lab$exists: while (true) {if (v$6479 == null) {return false;
} else {var v$6480 = v$6479;
var v$6481 = v$6480[0];
var v$6482 = v$6480[1];
if (d$6477 == v$6481) {return true;
} else {var t$10337 = v$6482;
var v$6479 = t$10337;
continue lab$exists;
};
};
};
};
var exists$6478 = fix$10336.$exists;
t$10338 = (exists$6478(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10338) {return 0;
} else {var h$6483 = [["id",d$6477],[["parent",p$6475],[["name",n$6476],[["kind","folder"],null]]]];
var t$10344 = fts$1640;
var t$10343;
var fix$10339 = {};
fix$10339.$foldl = function(v$6485,v$6486){lab$foldl: while (true) {if (v$6486 == null) {return v$6485;
} else {var v$6487 = v$6486;
var v$6488 = v$6487[0];
var v$6489 = v$6487[1];
var t$10340;
var v$6490 = v$6488[0];
var v$6491 = v$6488[1];
(function(fp,s,v){fp[s] = v;})(v$6485,v$6490,v$6491);
t$10340 = v$6485;
var t$10341 = t$10340;
var t$10342 = v$6489;
var v$6485 = t$10341;
var v$6486 = t$10342;
continue lab$foldl;
};
};
};
var foldl$6484 = fix$10339.$foldl;
var v$10063 = (function(){return {};})();
t$10343 = (foldl$6484(v$10063,h$6483));
(function(obj,a){return obj.add(a);})(t$10344,t$10343);
return (smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0] = [d$6477,smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]],0);
};
};
var v$6492;
var fields$6493 = basis$0String$1.fields$231((function(env$10345){return function(c$6494){return c$6494 == 47;
};
})([]),v$3498);
var fix$10346 = {};
fix$10346.$loop = function(v$6496,v$6497){lab$loop: while (true) {if (v$6497 == null) {throw [basis$0Initial$1.en$Fail$54,"loadDirs.impossible"];
} else {var v$6498 = v$6497;
var v$6499 = v$6498[1];
if (v$6499 == null) {var v$6500 = v$6498[0];
var t$10348;
var v$6502 = basis$0String$1.fields$231((function(env$10347){return function(c$6503){return c$6503 == 46;
};
})([]),v$6500);
if (v$6502 == null) {t$10348 = false;
} else {var v$6504 = v$6502;
var v$6505 = v$6504[1];
if (v$6505 == null) {t$10348 = false;
} else {var v$6506 = v$6505;
if (v$6506[1] == null) {var v$6507 = v$6504[0];
var v$6508 = v$6506[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6507)) {var fix$10349 = {};
fix$10349.$exists = function(v$6510){lab$exists: while (true) {if (v$6510 == null) {return false;
} else {var v$6511 = v$6510;
var v$6512 = v$6511[0];
var v$6513 = v$6511[1];
if (v$6508 == v$6512) {return true;
} else {var t$10350 = v$6513;
var v$6510 = t$10350;
continue lab$exists;
};
};
};
};
var exists$6509 = fix$10349.$exists;
t$10348 = (exists$6509(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10348 = false;
};
} else {t$10348 = false;
};
};
};
if (t$10348) {return [0,[v$6496,v$6500]];
} else {loadDir$6474(v$6496,v$6500);
return [1];
};
} else {var v$6514 = v$6498[0];
loadDir$6474(v$6496,v$6514);
var t$10351;
switch (v$6496) { case "0": {t$10351 = v$6514;
 break; }default: {t$10351 = ((v$6496 + "/") + v$6514);
} };
var t$10352 = t$10351;
var t$10353 = v$6499;
var v$6496 = t$10352;
var v$6497 = t$10353;
continue lab$loop;
};
};
};
};
var loop$6495 = fix$10346.$loop;
v$6492 = (loop$6495("0",fields$6493));
switch (v$6492[0]) { case 1: {0;
 break; }default: {var v$6515 = v$6492[1];
var v$6516 = v$6515[0];
var v$6517 = v$6515[1];
var h$6518 = [["id",v$3498],[["parent",v$6516],[["name",v$6517],[["kind","leaf"],null]]]];
var t$10359 = fts$1640;
var t$10358;
var fix$10354 = {};
fix$10354.$foldl = function(v$6520,v$6521){lab$foldl: while (true) {if (v$6521 == null) {return v$6520;
} else {var v$6522 = v$6521;
var v$6523 = v$6522[0];
var v$6524 = v$6522[1];
var t$10355;
var v$6525 = v$6523[0];
var v$6526 = v$6523[1];
(function(fp,s,v){fp[s] = v;})(v$6520,v$6525,v$6526);
t$10355 = v$6520;
var t$10356 = t$10355;
var t$10357 = v$6524;
var v$6520 = t$10356;
var v$6521 = t$10357;
continue lab$foldl;
};
};
};
var foldl$6519 = fix$10354.$foldl;
var v$10065 = (function(){return {};})();
t$10358 = (foldl$6519(v$10065,h$6518));
(function(obj,a){return obj.add(a);})(t$10359,t$10358);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = [v$3498,smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]],0);
} };
var t$10360 = v$3499;
var v$3496 = t$10360;
continue lab$app;
};
};
};
var app$3495 = fix$10335.$app;
t$10361 = (function(v$10183){return app$3495(v$10183);
});
return t$10363(t$10362,t$10361);
};
smltojs0$0SmlToJsCompApp$1$2.loadFileContentFromServer$1644 = function(f$1647){var v$1652 = basis$0List$1.rev$682(basis$0String$1.tokens$224(function(c$1661){return c$1661 == 47;
},f$1647));
if (v$1652 == null) {throw [basis$0Initial$1.en$Fail$54,"failed to load server file content for " + f$1647];
} else {var v$1657 = v$1652;
var v$1658 = v$1657[0];
var c$1654;
var file$6527 = ("otests/" + v$1658) + "_";
var file$6528;
var t$10367 = file$6527 + "?_=";
var t$10366;
var t$10365 = basis$0Real$1.toString$153;
var t$10364;
var v$6529 = SmlPrims.getrealtime();
t$10364 = ((v$6529[0] - (-2147483648)) + (v$6529[1] / 1000000.0));
t$10366 = (t$10365(t$10364));
file$6528 = (t$10367 + t$10366);
var r$6530 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$6530,"GET",file$6528,false);
js$0Js$1.send$654(r$6530,[1]);
var v$6531 = (function(r){return SmlPrims.option(r.responseText);})(r$6530);
switch (v$6531[0]) { case 0: {c$1654 = v$6531[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$6528];
} };
var s$3568 = ("loaded file " + (("'" + f$1647) + "'")) + " from server";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$3568);
var s$3570;
var t$10373;
var t$10372;
var t$10371;
var t$10370 = basis$0Date$1.fmt$816;
var t$10369 = "%H:%M:%S";
var t$10368;
var v$10021 = SmlPrims.getrealtime();
t$10368 = (basis$0Date$1.fromTimeLocal$512(v$10021[0],v$10021[1]));
t$10371 = (t$10370(t$10369,t$10368));
t$10372 = (t$10371 + ": ");
t$10373 = (t$10372 + s$3568);
s$3570 = (t$10373 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3570));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return c$1654;
};
};
smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1662 = function(filename$1665,cont$1668){var t$10377;
var fix$10375 = {};
fix$10375.$exists = function(v$3587){lab$exists: while (true) {if (v$3587 == null) {return false;
} else {var v$3588 = v$3587;
var v$3589 = v$3588[0];
var v$3590 = v$3588[1];
if (v$3589[0] == filename$1665) {return true;
} else {var t$10376 = v$3590;
var v$3587 = t$10376;
continue lab$exists;
};
};
};
};
var exists$3586 = fix$10375.$exists;
t$10377 = (exists$3586(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]));
if (t$10377) {(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = filename$1665,0);
return cont$1668([1]);
} else {var t$10374;
var v$3606 = basis$0String$1.tokens$224(function(c$3607){return c$3607 == 47;
},filename$1665);
if (v$3606 == null) {t$10374 = false;
} else {var v$3608 = v$3606;
switch (v$3608[0]) { case "Server": {t$10374 = true;
 break; }default: {t$10374 = false;
} };
};
if (t$10374) {return cont$1668([0,smltojs0$0SmlToJsCompApp$1$2.loadFileContentFromServer$1644(filename$1665)]);
} else {var v$1683 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$1683[0]) { case 0: {var v$1692 = v$1683[1];
return appfun2$0dropbox$1.content$315(v$1692,filename$1665,function(c$1687){(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = filename$1665,0);
var s$3611 = "Loaded file " + (("'" + filename$1665) + "'");
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$3611);
var s$3613;
var t$10383;
var t$10382;
var t$10381;
var t$10380 = basis$0Date$1.fmt$816;
var t$10379 = "%H:%M:%S";
var t$10378;
var v$10022 = SmlPrims.getrealtime();
t$10378 = (basis$0Date$1.fromTimeLocal$512(v$10022[0],v$10022[1]));
t$10381 = (t$10380(t$10379,t$10378));
t$10382 = (t$10381 + ": ");
t$10383 = (t$10382 + s$3611);
s$3613 = (t$10383 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3613));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return cont$1668([0,c$1687]);
});
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"loadFileContent.fileStore not set"];
} };
};
};
};
smltojs0$0SmlToJsCompApp$1$2.treeStoreRemoveExceptServer$1697 = function(fts$1700,id$1703){var t$10384;
var v$3623 = basis$0String$1.tokens$224(function(c$3624){return c$3624 == 47;
},id$1703);
if (v$3623 == null) {t$10384 = false;
} else {var v$3625 = v$3623;
switch (v$3625[0]) { case "Server": {t$10384 = true;
 break; }default: {t$10384 = false;
} };
};
return t$10384?0:((function(obj,a){return obj.remove(a);})(fts$1700,id$1703));
};
smltojs0$0SmlToJsCompApp$1$2.clear$1708 = function(fts$1711,closetab$1714){var fix$10385 = {};
fix$10385.$app = function(v$3630){lab$app: while (true) {if (v$3630 == null) {return 0;
} else {var v$3631 = v$3630;
var v$3632 = v$3631[0];
var v$3633 = v$3631[1];
var t$10387;
var v$6533 = basis$0String$1.tokens$224((function(env$10386){return function(c$6534){return c$6534 == 47;
};
})([]),v$3632);
if (v$6533 == null) {t$10387 = false;
} else {var v$6535 = v$6533;
switch (v$6535[0]) { case "Server": {t$10387 = true;
 break; }default: {t$10387 = false;
} };
};
t$10387?0:((function(obj,a){return obj.remove(a);})(fts$1711,v$3632));
var t$10388 = v$3633;
var v$3630 = t$10388;
continue lab$app;
};
};
};
var app$3629 = fix$10385.$app;
app$3629(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]);
var fix$10389 = {};
fix$10389.$app = function(v$3649){lab$app: while (true) {if (v$3649 == null) {return 0;
} else {var v$3650 = v$3649;
var v$3651 = v$3650[0];
var v$3652 = v$3650[1];
if ((v$3651 == "0")?false:true) {var t$10391;
var v$3673 = basis$0String$1.tokens$224((function(env$10390){return function(c$3674){return c$3674 == 47;
};
})([]),v$3651);
if (v$3673 == null) {t$10391 = false;
} else {var v$3675 = v$3673;
switch (v$3675[0]) { case "Server": {t$10391 = true;
 break; }default: {t$10391 = false;
} };
};
t$10391?0:((function(obj,a){return obj.remove(a);})(fts$1711,v$3651));
} else {0;
};
var t$10392 = v$3652;
var v$3649 = t$10392;
continue lab$app;
};
};
};
var app$3648 = fix$10389.$app;
app$3648(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]);
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0] = ["0",null],0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = null,0);
(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0);
var fix$10393 = {};
fix$10393.$app = function(v$3686){lab$app: while (true) {if (v$3686 == null) {return 0;
} else {var v$3687 = v$3686;
var v$3688 = v$3687[0];
var v$3689 = v$3687[1];
var v$3691 = v$3688[0];
closetab$1714(v$3691);
var t$10394 = v$3689;
var v$3686 = t$10394;
continue lab$app;
};
};
};
var app$3685 = fix$10393.$app;
app$3685(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = null,0);
};
smltojs0$0SmlToJsCompApp$1$2.mkAbsPath$1738 = function(n$1741){var v$1746 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0];
switch (v$1746) { case "0": {return n$1741;
 break; }default: {return (v$1746 + "/") + n$1741;
} };
};
var count$1747 = [0];
smltojs0$0SmlToJsCompApp$1$2.suggestNewFileName$1824 = function(base$1827){var fix$10395 = {};
fix$10395.$suggest = function(f$6550){lab$suggest: while (true) {var num$6551 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6554 = f$6550(num$6551);
var t$10398;
var fix$10396 = {};
fix$10396.$exists = function(v$6557){lab$exists: while (true) {if (v$6557 == null) {return false;
} else {var v$6558 = v$6557;
var v$6559 = v$6558[0];
var v$6560 = v$6558[1];
if (v$6559 == name$6554) {return true;
} else {var t$10397 = v$6560;
var v$6557 = t$10397;
continue lab$exists;
};
};
};
};
var exists$6556 = fix$10396.$exists;
t$10398 = (exists$6556(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10398) {var t$10399 = f$6550;
var f$6550 = t$10399;
continue lab$suggest;
} else {return name$6554;
};
};
};
var suggest$6549 = fix$10395.$suggest;
return suggest$6549(function(num$1830){return ((base$1827 + "-") + (basis$0Int32$1.toString$458(num$1830))) + ".sml";
});
};
smltojs0$0SmlToJsCompApp$1$2.suggestNewFolderName$1831 = function(v$1833){var fix$10400 = {};
fix$10400.$suggest = function(f$6575){lab$suggest: while (true) {var num$6576 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6579 = f$6575(num$6576);
var t$10403;
var fix$10401 = {};
fix$10401.$exists = function(v$6582){lab$exists: while (true) {if (v$6582 == null) {return false;
} else {var v$6583 = v$6582;
var v$6584 = v$6583[0];
var v$6585 = v$6583[1];
if (v$6584 == name$6579) {return true;
} else {var t$10402 = v$6585;
var v$6582 = t$10402;
continue lab$exists;
};
};
};
};
var exists$6581 = fix$10401.$exists;
t$10403 = (exists$6581(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10403) {var t$10404 = f$6575;
var f$6575 = t$10404;
continue lab$suggest;
} else {return name$6579;
};
};
};
var suggest$6574 = fix$10400.$suggest;
return suggest$6574(function(num$1836){return "Folder-" + (basis$0Int32$1.toString$458(num$1836));
});
};
smltojs0$0SmlToJsCompApp$1$2.newFile$1837 = function(fts$1840,content$1843,name$1846){var t$10411;
var fix$10409 = {};
fix$10409.$exists = function(v$3796){lab$exists: while (true) {if (v$3796 == null) {return false;
} else {var v$3797 = v$3796;
var v$3798 = v$3797[0];
var v$3799 = v$3797[1];
if (v$3798 == name$1846) {return true;
} else {var t$10410 = v$3799;
var v$3796 = t$10410;
continue lab$exists;
};
};
};
};
var exists$3795 = fix$10409.$exists;
t$10411 = (exists$3795(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10411) {throw [basis$0Initial$1.en$Fail$54,"file already exists"];
} else {var t$10408;
var t$10405;
var v$6587 = basis$0String$1.fields$231(function(c$6588){return c$6588 == 46;
},name$1846);
if (v$6587 == null) {t$10405 = false;
} else {var v$6589 = v$6587;
var v$6590 = v$6589[1];
if (v$6590 == null) {t$10405 = false;
} else {var v$6591 = v$6590;
if (v$6591[1] == null) {var v$6592 = v$6589[0];
var v$6593 = v$6591[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6592)) {var fix$10406 = {};
fix$10406.$exists = function(v$6595){lab$exists: while (true) {if (v$6595 == null) {return false;
} else {var v$6596 = v$6595;
var v$6597 = v$6596[0];
var v$6598 = v$6596[1];
if (v$6593 == v$6597) {return true;
} else {var t$10407 = v$6598;
var v$6595 = t$10407;
continue lab$exists;
};
};
};
};
var exists$6594 = fix$10406.$exists;
t$10405 = (exists$6594(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10405 = false;
};
} else {t$10405 = false;
};
};
};
t$10408 = (t$10405?false:true);
if (t$10408) {throw [basis$0Initial$1.en$Fail$54,"invalid new file name"];
} else {var lname$3810;
var v$3811 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0];
switch (v$3811) { case "0": {lname$3810 = name$1846;
 break; }default: {lname$3810 = ((v$3811 + "/") + name$1846);
} };
var t$10412;
var v$3815 = basis$0String$1.tokens$224(function(c$3816){return c$3816 == 47;
},lname$3810);
if (v$3815 == null) {t$10412 = false;
} else {var v$3817 = v$3815;
switch (v$3817[0]) { case "Server": {t$10412 = true;
 break; }default: {t$10412 = false;
} };
};
if (t$10412) {throw [basis$0Initial$1.en$Fail$54,"You cannot create new files in the Server folder"];
} else {var v$3818 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$3818[0]) { case 0: {var v$3819 = v$3818[1];
appfun2$0dropbox$1.write_file$328(v$3819,lname$3810,content$1843,function(v$3820){var v$3821 = v$3820[0];
var s$3822 = ((("Wrote file " + lname$3810) + " (") + v$3821) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$3822);
var s$3827;
var t$10418;
var t$10417;
var t$10416;
var t$10415 = basis$0Date$1.fmt$816;
var t$10414 = "%H:%M:%S";
var t$10413;
var v$10023 = SmlPrims.getrealtime();
t$10413 = (basis$0Date$1.fromTimeLocal$512(v$10023[0],v$10023[1]));
t$10416 = (t$10415(t$10414,t$10413));
t$10417 = (t$10416 + ": ");
t$10418 = (t$10417 + s$3822);
s$3827 = (t$10418 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3827));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
 break; }default: {0;
} };
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = [lname$3810,smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]],0);
var h$3834 = [["id",lname$3810],[["parent",(smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0]],[["name",name$1846],[["kind","leaf"],null]]]];
var t$10424 = fts$1840;
var t$10423;
var fix$10419 = {};
fix$10419.$foldl = function(v$3836,v$3837){lab$foldl: while (true) {if (v$3837 == null) {return v$3836;
} else {var v$3838 = v$3837;
var v$3839 = v$3838[0];
var v$3840 = v$3838[1];
var t$10420;
var v$3841 = v$3839[0];
var v$3842 = v$3839[1];
(function(fp,s,v){fp[s] = v;})(v$3836,v$3841,v$3842);
t$10420 = v$3836;
var t$10421 = t$10420;
var t$10422 = v$3840;
var v$3836 = t$10421;
var v$3837 = t$10422;
continue lab$foldl;
};
};
};
var foldl$3835 = fix$10419.$foldl;
var v$10067 = (function(){return {};})();
t$10423 = (foldl$3835(v$10067,h$3834));
(function(obj,a){return obj.add(a);})(t$10424,t$10423);
(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = lname$3810,0);
return lname$3810;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.newFolder$1855 = function(fts$1858,name$1861){var t$10427;
var fix$10425 = {};
fix$10425.$exists = function(v$3846){lab$exists: while (true) {if (v$3846 == null) {return false;
} else {var v$3847 = v$3846;
var v$3848 = v$3847[0];
var v$3849 = v$3847[1];
if (v$3848 == name$1861) {return true;
} else {var t$10426 = v$3849;
var v$3846 = t$10426;
continue lab$exists;
};
};
};
};
var exists$3845 = fix$10425.$exists;
t$10427 = (exists$3845(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10427) {throw [basis$0Initial$1.en$Fail$54,"folder already exists"];
} else {if ((smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(name$1861))?false:true) {throw [basis$0Initial$1.en$Fail$54,"invalid new folder name"];
} else {var lname$3859;
var v$3860 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0];
switch (v$3860) { case "0": {lname$3859 = name$1861;
 break; }default: {lname$3859 = ((v$3860 + "/") + name$1861);
} };
var t$10428;
var v$3864 = basis$0String$1.tokens$224(function(c$3865){return c$3865 == 47;
},lname$3859);
if (v$3864 == null) {t$10428 = false;
} else {var v$3866 = v$3864;
switch (v$3866[0]) { case "Server": {t$10428 = true;
 break; }default: {t$10428 = false;
} };
};
if (t$10428) {throw [basis$0Initial$1.en$Fail$54,"You cannot create new folders in the Server folder"];
} else {var v$3867 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$3867[0]) { case 0: {var v$3868 = v$3867[1];
appfun2$0dropbox$1.mkdir$367(v$3868,lname$3859,function(v$3869){var v$3870 = v$3869[0];
var s$3871 = ((("Created folder " + lname$3859) + " (") + v$3870) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$3871);
var s$3876;
var t$10434;
var t$10433;
var t$10432;
var t$10431 = basis$0Date$1.fmt$816;
var t$10430 = "%H:%M:%S";
var t$10429;
var v$10024 = SmlPrims.getrealtime();
t$10429 = (basis$0Date$1.fromTimeLocal$512(v$10024[0],v$10024[1]));
t$10432 = (t$10431(t$10430,t$10429));
t$10433 = (t$10432 + ": ");
t$10434 = (t$10433 + s$3871);
s$3876 = (t$10434 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3876));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
 break; }default: {0;
} };
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0] = [lname$3859,smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]],0);
var h$3883 = [["id",lname$3859],[["parent",(smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(smltojs0$0SmlToJsCompApp$1$2.current$1420[0]))[0]],[["name",name$1861],[["kind","folder"],null]]]];
var t$10440 = fts$1858;
var t$10439;
var fix$10435 = {};
fix$10435.$foldl = function(v$3885,v$3886){lab$foldl: while (true) {if (v$3886 == null) {return v$3885;
} else {var v$3887 = v$3886;
var v$3888 = v$3887[0];
var v$3889 = v$3887[1];
var t$10436;
var v$3890 = v$3888[0];
var v$3891 = v$3888[1];
(function(fp,s,v){fp[s] = v;})(v$3885,v$3890,v$3891);
t$10436 = v$3885;
var t$10437 = t$10436;
var t$10438 = v$3889;
var v$3885 = t$10437;
var v$3886 = t$10438;
continue lab$foldl;
};
};
};
var foldl$3884 = fix$10435.$foldl;
var v$10069 = (function(){return {};})();
t$10439 = (foldl$3884(v$10069,h$3883));
(function(obj,a){return obj.add(a);})(t$10440,t$10439);
return lname$3859;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.currentEditor$1870 = function(v$1872){var v$1877;
var t$10441;
var p$3893 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var fields$3894 = basis$0String$1.fields$231(function(c$3895){return c$3895 == 47;
},p$3893);
var v$3896 = basis$0List$1.rev$682(fields$3894);
if (v$3896 == null) {t$10441 = false;
} else {var v$3897 = v$3896;
var v$3898 = v$3897[0];
var v$3899 = v$3897[1];
var t$10444;
var v$6600 = basis$0String$1.fields$231(function(c$6601){return c$6601 == 46;
},v$3898);
if (v$6600 == null) {t$10444 = false;
} else {var v$6602 = v$6600;
var v$6603 = v$6602[1];
if (v$6603 == null) {t$10444 = false;
} else {var v$6604 = v$6603;
if (v$6604[1] == null) {var v$6605 = v$6602[0];
var v$6606 = v$6604[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6605)) {var fix$10445 = {};
fix$10445.$exists = function(v$6608){lab$exists: while (true) {if (v$6608 == null) {return false;
} else {var v$6609 = v$6608;
var v$6610 = v$6609[0];
var v$6611 = v$6609[1];
if (v$6606 == v$6610) {return true;
} else {var t$10446 = v$6611;
var v$6608 = t$10446;
continue lab$exists;
};
};
};
};
var exists$6607 = fix$10445.$exists;
t$10444 = (exists$6607(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10444 = false;
};
} else {t$10444 = false;
};
};
};
if (t$10444) {var fix$10442 = {};
fix$10442.$all = function(v$3901){lab$all: while (true) {if (v$3901 == null) {return true;
} else {var v$3902 = v$3901;
var v$3903 = v$3902[0];
var v$3904 = v$3902[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3903)) {var t$10443 = v$3904;
var v$3901 = t$10443;
continue lab$all;
} else {return false;
};
};
};
};
var all$3900 = fix$10442.$all;
t$10441 = (all$3900(v$3899));
} else {t$10441 = false;
};
};
v$1877 = (t$10441?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$1877[0]) { case 1: {return [1];
 break; }default: {var v$1895 = v$1877[1];
var v$1882 = basis$0List$1.find$392(function(v$1893){return v$1895 == v$1893[0];
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
switch (v$1882[0]) { case 0: {return [0,[v$1895,v$1882[1][2]]];
 break; }default: {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"currentEditor: error");
var s$3912;
var t$10452;
var t$10451;
var t$10450;
var t$10449 = basis$0Date$1.fmt$816;
var t$10448 = "%H:%M:%S";
var t$10447;
var v$10025 = SmlPrims.getrealtime();
t$10447 = (basis$0Date$1.fromTimeLocal$512(v$10025[0],v$10025[1]));
t$10450 = (t$10449(t$10448,t$10447));
t$10451 = (t$10450 + ": ");
t$10452 = (t$10451 + "currentEditor: error");
s$3912 = (t$10452 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3912));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return [1];
} };
} };
};
smltojs0$0SmlToJsCompApp$1$2.showTab$1896 = function(n$1899){return (smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = n$1899,0);
};
smltojs0$0SmlToJsCompApp$1$2.delete$1900 = function(fts$1903,closetab$1906){var v$1913;
var t$10453;
var p$3919 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
if (p$3919 == "0") {t$10453 = true;
} else {var fields$3924 = basis$0String$1.fields$231(function(c$3925){return c$3925 == 47;
},p$3919);
var fix$10454 = {};
fix$10454.$all = function(v$3927){lab$all: while (true) {if (v$3927 == null) {return true;
} else {var v$3928 = v$3927;
var v$3929 = v$3928[0];
var v$3930 = v$3928[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$3929)) {var t$10455 = v$3930;
var v$3927 = t$10455;
continue lab$all;
} else {return false;
};
};
};
};
var all$3926 = fix$10454.$all;
t$10453 = (all$3926(fields$3924));
};
v$1913 = (t$10453?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$1913[0]) { case 0: {var v$1915 = v$1913[1];
switch (v$1915) { case "0": {return notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Cannot delete root folder");
 break; }default: {var t$10458;
var v$3932 = basis$0String$1.tokens$224(function(c$3933){return c$3933 == 47;
},v$1915);
if (v$3932 == null) {t$10458 = false;
} else {var v$3934 = v$3932;
switch (v$3934[0]) { case "Server": {t$10458 = true;
 break; }default: {t$10458 = false;
} };
};
if (t$10458) {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"You cannot delete folders in the Server folder");
var s$3937;
var t$10464;
var t$10463;
var t$10462;
var t$10461 = basis$0Date$1.fmt$816;
var t$10460 = "%H:%M:%S";
var t$10459;
var v$10026 = SmlPrims.getrealtime();
t$10459 = (basis$0Date$1.fromTimeLocal$512(v$10026[0],v$10026[1]));
t$10462 = (t$10461(t$10460,t$10459));
t$10463 = (t$10462 + ": ");
t$10464 = (t$10463 + "You cannot delete folders in the Server folder");
s$3937 = (t$10464 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$3937));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
} else {var v$1997 = basis$0List$1.partition$449(function(v$2002){var v$2003 = v$2002[0];
var s1$3942 = v$1915 + "/";
var n1$3944 = s1$3942.length;
var n2$3945 = v$2003.length;
var stop$3946 = (n1$3944 < n2$3945)?n1$3944:n2$3945;
var fix$10456 = {};
fix$10456.$h = function(j$3948){lab$h: while (true) {if (j$3948 == stop$3946) {return true;
} else {if ((s1$3942.charCodeAt(j$3948)) == (v$2003.charCodeAt(j$3948))) {var t$10457 = SmlPrims.chk_ovf_i32(j$3948 + 1);
var j$3948 = t$10457;
continue lab$h;
} else {return false;
};
};
};
};
var h$3947 = fix$10456.$h;
if (n1$3944 <= n2$3945) {return h$3947(0);
} else {return false;
};
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
var v$1998 = v$1997[0];
var v$1999 = v$1997[1];
var v$1991 = basis$0List$1.partition$449(function(f$1996){var s1$3951 = v$1915 + "/";
var n1$3953 = s1$3951.length;
var n2$3954 = f$1996.length;
var stop$3955 = (n1$3953 < n2$3954)?n1$3953:n2$3954;
var fix$10465 = {};
fix$10465.$h = function(j$3957){lab$h: while (true) {if (j$3957 == stop$3955) {return true;
} else {if ((s1$3951.charCodeAt(j$3957)) == (f$1996.charCodeAt(j$3957))) {var t$10466 = SmlPrims.chk_ovf_i32(j$3957 + 1);
var j$3957 = t$10466;
continue lab$h;
} else {return false;
};
};
};
};
var h$3956 = fix$10465.$h;
if (n1$3953 <= n2$3954) {return h$3956(0);
} else {return false;
};
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]);
var v$1992 = v$1991[0];
var v$1993 = v$1991[1];
var v$1981 = basis$0List$1.partition$449(function(f$1986){if (f$1986 == v$1915) {return true;
} else {var s1$3964 = v$1915 + "/";
var n1$3966 = s1$3964.length;
var n2$3967 = f$1986.length;
var stop$3968 = (n1$3966 < n2$3967)?n1$3966:n2$3967;
var fix$10467 = {};
fix$10467.$h = function(j$3970){lab$h: while (true) {if (j$3970 == stop$3968) {return true;
} else {if ((s1$3964.charCodeAt(j$3970)) == (f$1986.charCodeAt(j$3970))) {var t$10468 = SmlPrims.chk_ovf_i32(j$3970 + 1);
var j$3970 = t$10468;
continue lab$h;
} else {return false;
};
};
};
};
var h$3969 = fix$10467.$h;
if (n1$3966 <= n2$3967) {return h$3969(0);
} else {return false;
};
};
},smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]);
var v$1982 = v$1981[0];
var v$1983 = v$1981[1];
(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = v$1999,0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = v$1993,0);
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0] = v$1983,0);
var fix$10469 = {};
fix$10469.$app = function(v$4013){lab$app: while (true) {if (v$4013 == null) {return 0;
} else {var v$4014 = v$4013;
var v$4015 = v$4014[0];
var v$4016 = v$4014[1];
var t$10471;
var v$6615 = basis$0String$1.tokens$224((function(env$10470){return function(c$6616){return c$6616 == 47;
};
})([]),v$4015);
if (v$6615 == null) {t$10471 = false;
} else {var v$6617 = v$6615;
switch (v$6617[0]) { case "Server": {t$10471 = true;
 break; }default: {t$10471 = false;
} };
};
t$10471?0:((function(obj,a){return obj.remove(a);})(fts$1903,v$4015));
var t$10472 = v$4016;
var v$4013 = t$10472;
continue lab$app;
};
};
};
var app$4012 = fix$10469.$app;
app$4012(v$1992);
var fix$10473 = {};
fix$10473.$app = function(v$4027){lab$app: while (true) {if (v$4027 == null) {return 0;
} else {var v$4028 = v$4027;
var v$4029 = v$4028[0];
var v$4030 = v$4028[1];
var t$10475;
var v$6619 = basis$0String$1.tokens$224((function(env$10474){return function(c$6620){return c$6620 == 47;
};
})([]),v$4029);
if (v$6619 == null) {t$10475 = false;
} else {var v$6621 = v$6619;
switch (v$6621[0]) { case "Server": {t$10475 = true;
 break; }default: {t$10475 = false;
} };
};
t$10475?0:((function(obj,a){return obj.remove(a);})(fts$1903,v$4029));
var t$10476 = v$4030;
var v$4027 = t$10476;
continue lab$app;
};
};
};
var app$4026 = fix$10473.$app;
app$4026(v$1982);
var fix$10477 = {};
fix$10477.$app = function(v$4044){lab$app: while (true) {if (v$4044 == null) {return 0;
} else {var v$4045 = v$4044;
var v$4046 = v$4045[0];
var v$4047 = v$4045[1];
var v$4049 = v$4046[0];
closetab$1906(v$4049);
var t$10478 = v$4047;
var v$4044 = t$10478;
continue lab$app;
};
};
};
var app$4043 = fix$10477.$app;
app$4043(v$1998);
var fix$10479 = {};
fix$10479.$app = function(v$4052){lab$app: while (true) {if (v$4052 == null) {return 0;
} else {var v$4053 = v$4052;
var v$4054 = v$4053[0];
var v$4055 = v$4053[1];
var v$4075 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$4075[0]) { case 0: {var v$4076 = v$4075[1];
appfun2$0dropbox$1.delete_file$414(v$4076,v$4054,(function(env$10484){return function(v$4077){var v$10480 = env$10484[0];
var v$10481 = env$10484[1];
var v$10482 = env$10484[2];
var v$10483 = env$10484[3];
var v$4078 = v$4077[0];
var s$4079 = ((("Deleted file " + (("'" + v$10483) + "'")) + " (") + v$4078) + ")";
var s$4086;
var t$10490;
var t$10489;
var t$10488;
var t$10487 = v$10482;
var t$10486 = "%H:%M:%S";
var t$10485;
var v$10027 = SmlPrims.getrealtime();
t$10485 = (v$10481(v$10027[0],v$10027[1]));
t$10488 = (t$10487(t$10486,t$10485));
t$10489 = (t$10488 + ": ");
t$10490 = (t$10489 + s$4079);
s$4086 = (t$10490 + "\n");
(function(e,a){return e.appendChild(a);})(v$10480,document.createTextNode(s$4086));
return (function(t){t.scrollTop = t.scrollHeight;})(v$10480);
};
})([smltojs0$0SmlToJsCompApp$1$2.logarea$975,basis$0Date$1.fromTimeLocal$512,basis$0Date$1.fmt$816,v$4054]));
 break; }default: {0;
} };
var t$10491 = v$4055;
var v$4052 = t$10491;
continue lab$app;
};
};
};
var app$4051 = fix$10479.$app;
app$4051(v$1992);
var fix$10492 = {};
fix$10492.$app = function(v$4093){lab$app: while (true) {if (v$4093 == null) {return 0;
} else {var v$4094 = v$4093;
var v$4095 = v$4094[0];
var v$4096 = v$4094[1];
var v$4116 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$4116[0]) { case 0: {var v$4117 = v$4116[1];
appfun2$0dropbox$1.delete_dir$472(v$4117,v$4095,(function(env$10497){return function(v$4118){var v$10493 = env$10497[0];
var v$10494 = env$10497[1];
var v$10495 = env$10497[2];
var v$10496 = env$10497[3];
var v$4119 = v$4118[0];
var s$4120 = ((("Deleted folder " + (("'" + v$10496) + "'")) + " (") + v$4119) + ")";
var s$4127;
var t$10503;
var t$10502;
var t$10501;
var t$10500 = v$10495;
var t$10499 = "%H:%M:%S";
var t$10498;
var v$10028 = SmlPrims.getrealtime();
t$10498 = (v$10494(v$10028[0],v$10028[1]));
t$10501 = (t$10500(t$10499,t$10498));
t$10502 = (t$10501 + ": ");
t$10503 = (t$10502 + s$4120);
s$4127 = (t$10503 + "\n");
(function(e,a){return e.appendChild(a);})(v$10493,document.createTextNode(s$4127));
return (function(t){t.scrollTop = t.scrollHeight;})(v$10493);
};
})([smltojs0$0SmlToJsCompApp$1$2.logarea$975,basis$0Date$1.fromTimeLocal$512,basis$0Date$1.fmt$816,v$4095]));
 break; }default: {0;
} };
var t$10504 = v$4096;
var v$4093 = t$10504;
continue lab$app;
};
};
};
var app$4092 = fix$10492.$app;
app$4092(v$1982);
var s$4132 = ("Deleted folder " + (("'" + v$1915) + "'")) + " completely";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4132);
var s$4134;
var t$10510;
var t$10509;
var t$10508;
var t$10507 = basis$0Date$1.fmt$816;
var t$10506 = "%H:%M:%S";
var t$10505;
var v$10029 = SmlPrims.getrealtime();
t$10505 = (basis$0Date$1.fromTimeLocal$512(v$10029[0],v$10029[1]));
t$10508 = (t$10507(t$10506,t$10505));
t$10509 = (t$10508 + ": ");
t$10510 = (t$10509 + s$4132);
s$4134 = (t$10510 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4134));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
} };
 break; }default: {var f$2004 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var t$10511;
var v$4146 = basis$0String$1.tokens$224(function(c$4147){return c$4147 == 47;
},f$2004);
if (v$4146 == null) {t$10511 = false;
} else {var v$4148 = v$4146;
switch (v$4148[0]) { case "Server": {t$10511 = true;
 break; }default: {t$10511 = false;
} };
};
if (t$10511) {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"You cannot delete files in the Server folder");
var s$4151;
var t$10517;
var t$10516;
var t$10515;
var t$10514 = basis$0Date$1.fmt$816;
var t$10513 = "%H:%M:%S";
var t$10512;
var v$10030 = SmlPrims.getrealtime();
t$10512 = (basis$0Date$1.fromTimeLocal$512(v$10030[0],v$10030[1]));
t$10515 = (t$10514(t$10513,t$10512));
t$10516 = (t$10515 + ": ");
t$10517 = (t$10516 + "You cannot delete files in the Server folder");
s$4151 = (t$10517 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4151));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
} else {(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = (basis$0List$1.filter$417(function(v$2035){var v$2036 = v$2035[0];
return (v$2036 == f$2004)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0])),0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = (basis$0List$1.filter$417(function(f$$2032){return (f$$2032 == f$2004)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0])),0);
var t$10518;
var v$4172 = basis$0String$1.tokens$224(function(c$4173){return c$4173 == 47;
},f$2004);
if (v$4172 == null) {t$10518 = false;
} else {var v$4174 = v$4172;
switch (v$4174[0]) { case "Server": {t$10518 = true;
 break; }default: {t$10518 = false;
} };
};
t$10518?0:((function(obj,a){return obj.remove(a);})(fts$1903,f$2004));
closetab$1906(f$2004);
var v$2023 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$2023[0]) { case 0: {var v$2029 = v$2023[1];
return appfun2$0dropbox$1.delete_file$414(v$2029,f$2004,function(v$2027){var v$2028 = v$2027[0];
var s$4178 = ((("Deleted file " + (("'" + f$2004) + "'")) + " (") + v$2028) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4178);
var s$4180;
var t$10524;
var t$10523;
var t$10522;
var t$10521 = basis$0Date$1.fmt$816;
var t$10520 = "%H:%M:%S";
var t$10519;
var v$10031 = SmlPrims.getrealtime();
t$10519 = (basis$0Date$1.fromTimeLocal$512(v$10031[0],v$10031[1]));
t$10522 = (t$10521(t$10520,t$10519));
t$10523 = (t$10522 + ": ");
t$10524 = (t$10523 + s$4178);
s$4180 = (t$10524 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4180));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
 break; }default: {return 0;
} };
};
} };
};
smltojs0$0SmlToJsCompApp$1$2.addTab$2037 = function(filename$2040,md5$2043,editor$2046){return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = [[filename$2040,[md5$2043],editor$2046],smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]],0);
};
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047 = function(v$2082,v$2083,v$2084){var c$2053 = v$2084[0](0);
var newMd5$2058 = md5$0md5$1.fromString$410(c$2053);
if (v$2083[0] == newMd5$2058) {return 0;
} else {var t$10526;
var v$4200 = basis$0String$1.tokens$224(function(c$4201){return c$4201 == 47;
},v$2082);
if (v$4200 == null) {t$10526 = false;
} else {var v$4202 = v$4200;
switch (v$4202[0]) { case "Server": {t$10526 = true;
 break; }default: {t$10526 = false;
} };
};
if (t$10526) {var s$4203 = ("Modified server file " + (("'" + v$2082) + "'")) + " not saved";
notify0$1026("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4203);
var s$4205;
var t$10532;
var t$10531;
var t$10530;
var t$10529 = basis$0Date$1.fmt$816;
var t$10528 = "%H:%M:%S";
var t$10527;
var v$10032 = SmlPrims.getrealtime();
t$10527 = (basis$0Date$1.fromTimeLocal$512(v$10032[0],v$10032[1]));
t$10530 = (t$10529(t$10528,t$10527));
t$10531 = (t$10530 + ": ");
t$10532 = (t$10531 + s$4203);
s$4205 = (t$10532 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4205));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
} else {try {var v$2071 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$2071[0]) { case 0: {var v$2079 = v$2071[1];
return appfun2$0dropbox$1.write_file$328(v$2079,v$2082,c$2053,function(v$2075){var v$2078 = v$2075[0];
var s$4216 = ((("Saved file " + (("'" + v$2082) + "'")) + " (") + v$2078) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4216);
var s$4218;
var t$10538;
var t$10537;
var t$10536;
var t$10535 = basis$0Date$1.fmt$816;
var t$10534 = "%H:%M:%S";
var t$10533;
var v$10033 = SmlPrims.getrealtime();
t$10533 = (basis$0Date$1.fromTimeLocal$512(v$10033[0],v$10033[1]));
t$10536 = (t$10535(t$10534,t$10533));
t$10537 = (t$10536 + ": ");
t$10538 = (t$10537 + s$4216);
s$4218 = (t$10538 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4218));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return (v$2083[0] = newMd5$2058,0);
});
 break; }default: {return 0;
} };
} catch(v$10525) {return (function(v$2081){return 0;
})(v$10525);
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.autosave$2085 = function(v$2087){var fix$10539 = {};
fix$10539.$app = function(v$4233){lab$app: while (true) {if (v$4233 == null) {return 0;
} else {var v$4234 = v$4233;
var v$4235 = v$4234[0];
var v$4236 = v$4234[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047(v$4235[0],v$4235[1],v$4235[2]);
var t$10540 = v$4236;
var v$4233 = t$10540;
continue lab$app;
};
};
};
var app$4232 = fix$10539.$app;
return app$4232(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
};
smltojs0$0SmlToJsCompApp$1$2.closeTab$2088 = function(n$2091){var v$2116;
var t$10541;
var p$4239 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var fields$4240 = basis$0String$1.fields$231(function(c$4241){return c$4241 == 47;
},p$4239);
var v$4242 = basis$0List$1.rev$682(fields$4240);
if (v$4242 == null) {t$10541 = false;
} else {var v$4243 = v$4242;
var v$4244 = v$4243[0];
var v$4245 = v$4243[1];
var t$10544;
var v$6626 = basis$0String$1.fields$231(function(c$6627){return c$6627 == 46;
},v$4244);
if (v$6626 == null) {t$10544 = false;
} else {var v$6628 = v$6626;
var v$6629 = v$6628[1];
if (v$6629 == null) {t$10544 = false;
} else {var v$6630 = v$6629;
if (v$6630[1] == null) {var v$6631 = v$6628[0];
var v$6632 = v$6630[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6631)) {var fix$10545 = {};
fix$10545.$exists = function(v$6634){lab$exists: while (true) {if (v$6634 == null) {return false;
} else {var v$6635 = v$6634;
var v$6636 = v$6635[0];
var v$6637 = v$6635[1];
if (v$6632 == v$6636) {return true;
} else {var t$10546 = v$6637;
var v$6634 = t$10546;
continue lab$exists;
};
};
};
};
var exists$6633 = fix$10545.$exists;
t$10544 = (exists$6633(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10544 = false;
};
} else {t$10544 = false;
};
};
};
if (t$10544) {var fix$10542 = {};
fix$10542.$all = function(v$4247){lab$all: while (true) {if (v$4247 == null) {return true;
} else {var v$4248 = v$4247;
var v$4249 = v$4248[0];
var v$4250 = v$4248[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4249)) {var t$10543 = v$4250;
var v$4247 = t$10543;
continue lab$all;
} else {return false;
};
};
};
};
var all$4246 = fix$10542.$all;
t$10541 = (all$4246(v$4245));
} else {t$10541 = false;
};
};
v$2116 = (t$10541?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$2116[0]) { case 0: {var v$2122 = v$2116[1];
(n$2091 == v$2122)?(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0):0;
 break; }default: {0;
} };
var v$2104 = basis$0List$1.find$392(function(v$2109){return v$2109[0] == n$2091;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
switch (v$2104[0]) { case 0: {var v$2106 = v$2104[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047(v$2106[0],v$2106[1],v$2106[2]);
 break; }default: {0;
} };
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = (basis$0List$1.filter$417(function(v$2097){var v$2098 = v$2097[0];
return (v$2098 == n$2091)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0])),0);
};
smltojs0$0SmlToJsCompApp$1$2.stripAbsolute$2123 = function(a$2126){var t$10548;
if (a$2126.length > 0) {var t$10547;
if (0 >= a$2126.length) {throw CompilerInitial.exn$Subscript$52;
} else {t$10547 = (a$2126.charCodeAt(0));
};
t$10548 = (t$10547 == 47);
} else {t$10548 = false;
};
return t$10548?[0,basis$0String$1.extract$116(a$2126,1,[1])]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.move$2135 = function(fts$2138,folderpath$2141,filename$2144,newfile$2147){var v$2228;
var t$10551;
var fields$4272 = basis$0String$1.fields$231(function(c$4273){return c$4273 == 47;
},newfile$2147);
var v$4274 = basis$0List$1.rev$682(fields$4272);
if (v$4274 == null) {t$10551 = false;
} else {var v$4275 = v$4274;
var v$4276 = v$4275[0];
var v$4277 = v$4275[1];
var t$10554;
var v$6642 = basis$0String$1.fields$231(function(c$6643){return c$6643 == 46;
},v$4276);
if (v$6642 == null) {t$10554 = false;
} else {var v$6644 = v$6642;
var v$6645 = v$6644[1];
if (v$6645 == null) {t$10554 = false;
} else {var v$6646 = v$6645;
if (v$6646[1] == null) {var v$6647 = v$6644[0];
var v$6648 = v$6646[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6647)) {var fix$10555 = {};
fix$10555.$exists = function(v$6650){lab$exists: while (true) {if (v$6650 == null) {return false;
} else {var v$6651 = v$6650;
var v$6652 = v$6651[0];
var v$6653 = v$6651[1];
if (v$6648 == v$6652) {return true;
} else {var t$10556 = v$6653;
var v$6650 = t$10556;
continue lab$exists;
};
};
};
};
var exists$6649 = fix$10555.$exists;
t$10554 = (exists$6649(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10554 = false;
};
} else {t$10554 = false;
};
};
};
if (t$10554) {var fix$10552 = {};
fix$10552.$all = function(v$4279){lab$all: while (true) {if (v$4279 == null) {return true;
} else {var v$4280 = v$4279;
var v$4281 = v$4280[0];
var v$4282 = v$4280[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4281)) {var t$10553 = v$4282;
var v$4279 = t$10553;
continue lab$all;
} else {return false;
};
};
};
};
var all$4278 = fix$10552.$all;
t$10551 = (all$4278(v$4277));
} else {t$10551 = false;
};
};
if (t$10551) {var v$2241 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(newfile$2147);
var v$2242 = v$2241[1];
switch (v$2242[0]) { case 0: {var v$2249 = v$2241[0];
var t$10559;
switch (folderpath$2141) { case "0": {t$10559 = newfile$2147;
 break; }default: {t$10559 = ((folderpath$2141 + "/") + newfile$2147);
} };
var t$10558 = v$2242[1];
var t$10557;
if (v$2249 == "0") {t$10557 = folderpath$2141;
} else {switch (folderpath$2141) { case "0": {t$10557 = v$2249;
 break; }default: {t$10557 = ((folderpath$2141 + "/") + v$2249);
} };
};
v$2228 = [t$10559,t$10558,t$10557];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"move.impossible: newfile is a file"];
} };
} else {var v$2255;
var t$10550;
if (newfile$2147.length > 0) {var t$10549;
if (0 >= newfile$2147.length) {throw CompilerInitial.exn$Subscript$52;
} else {t$10549 = (newfile$2147.charCodeAt(0));
};
t$10550 = (t$10549 == 47);
} else {t$10550 = false;
};
v$2255 = (t$10550?[0,basis$0String$1.extract$116(newfile$2147,1,[1])]:[1]);
switch (v$2255[0]) { case 0: {var v$2271 = v$2255[1];
var t$10560;
var fields$4302 = basis$0String$1.fields$231(function(c$4303){return c$4303 == 47;
},v$2271);
var v$4304 = basis$0List$1.rev$682(fields$4302);
if (v$4304 == null) {t$10560 = false;
} else {var v$4305 = v$4304;
var v$4306 = v$4305[0];
var v$4307 = v$4305[1];
var t$10563;
var v$6656 = basis$0String$1.fields$231(function(c$6657){return c$6657 == 46;
},v$4306);
if (v$6656 == null) {t$10563 = false;
} else {var v$6658 = v$6656;
var v$6659 = v$6658[1];
if (v$6659 == null) {t$10563 = false;
} else {var v$6660 = v$6659;
if (v$6660[1] == null) {var v$6661 = v$6658[0];
var v$6662 = v$6660[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6661)) {var fix$10564 = {};
fix$10564.$exists = function(v$6664){lab$exists: while (true) {if (v$6664 == null) {return false;
} else {var v$6665 = v$6664;
var v$6666 = v$6665[0];
var v$6667 = v$6665[1];
if (v$6662 == v$6666) {return true;
} else {var t$10565 = v$6667;
var v$6664 = t$10565;
continue lab$exists;
};
};
};
};
var exists$6663 = fix$10564.$exists;
t$10563 = (exists$6663(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10563 = false;
};
} else {t$10563 = false;
};
};
};
if (t$10563) {var fix$10561 = {};
fix$10561.$all = function(v$4309){lab$all: while (true) {if (v$4309 == null) {return true;
} else {var v$4310 = v$4309;
var v$4311 = v$4310[0];
var v$4312 = v$4310[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4311)) {var t$10562 = v$4312;
var v$4309 = t$10562;
continue lab$all;
} else {return false;
};
};
};
};
var all$4308 = fix$10561.$all;
t$10560 = (all$4308(v$4307));
} else {t$10560 = false;
};
};
if (t$10560) {var v$2266 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(v$2271);
var v$2267 = v$2266[1];
switch (v$2267[0]) { case 0: {v$2228 = [v$2271,v$2267[1],v$2266[0]];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"move.impossible: newfile is a file"];
} };
} else {throw [basis$0Initial$1.en$Fail$54,"Invalid target path " + (("'" + newfile$2147) + "'")];
};
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Invalid target path " + (("'" + newfile$2147) + "'")];
} };
};
var v$2229 = v$2228[0];
var v$2230 = v$2228[1];
var v$2231 = v$2228[2];
var filepath$2152;
switch (folderpath$2141) { case "0": {filepath$2152 = filename$2144;
 break; }default: {filepath$2152 = ((folderpath$2141 + "/") + filename$2144);
} };
var v$5979;
var v$4327 = basis$0String$1.tokens$224(function(c$4328){return c$4328 == 47;
},filepath$2152);
if (v$4327 == null) {v$5979 = false;
} else {var v$4329 = v$4327;
switch (v$4329[0]) { case "Dropbox": {v$5979 = true;
 break; }default: {v$5979 = false;
} };
};
var v$5980;
var v$4331 = basis$0String$1.tokens$224(function(c$4332){return c$4332 == 47;
},v$2229);
if (v$4331 == null) {v$5980 = false;
} else {var v$4333 = v$4331;
switch (v$4333[0]) { case "Dropbox": {v$5980 = true;
 break; }default: {v$5980 = false;
} };
};
if (v$5979) {if (v$5980) {0;
} else {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to or from Dropbox paths"];
};
} else {if (v$5980) {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to or from Dropbox paths"];
} else {0;
};
};
var t$10573;
var v$4337 = basis$0String$1.tokens$224(function(c$4338){return c$4338 == 47;
},v$2229);
if (v$4337 == null) {t$10573 = false;
} else {var v$4339 = v$4337;
switch (v$4339[0]) { case "Server": {t$10573 = true;
 break; }default: {t$10573 = false;
} };
};
if (t$10573) {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to the server"];
} else {var t$10572;
var fix$10570 = {};
fix$10570.$exists = function(v$4342){lab$exists: while (true) {if (v$4342 == null) {return false;
} else {var v$4343 = v$4342;
var v$4344 = v$4343[0];
var v$4345 = v$4343[1];
if (v$4344 == v$2229) {return true;
} else {var t$10571 = v$4345;
var v$4342 = t$10571;
continue lab$exists;
};
};
};
};
var exists$4341 = fix$10570.$exists;
t$10572 = (exists$4341(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10572) {throw [basis$0Initial$1.en$Fail$54,("File " + (("'" + v$2229) + "'")) + " already exists"];
} else {var t$10569;
var t$10568;
var fix$10566 = {};
fix$10566.$exists = function(v$4359){lab$exists: while (true) {if (v$4359 == null) {return false;
} else {var v$4360 = v$4359;
var v$4361 = v$4360[0];
var v$4362 = v$4360[1];
if (v$4361 == v$2231) {return true;
} else {var t$10567 = v$4362;
var v$4359 = t$10567;
continue lab$exists;
};
};
};
};
var exists$4358 = fix$10566.$exists;
t$10568 = (exists$4358(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
t$10569 = (t$10568?false:true);
if (t$10569) {throw [basis$0Initial$1.en$Fail$54,("Target folder " + (("'" + v$2231) + "'")) + " does not exist"];
} else {var v$2170 = basis$0List$1.find$392(function(v$2214){return v$2214[0] == filepath$2152;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
switch (v$2170[0]) { case 0: {var v$2210 = v$2170[1];
var v$2211 = v$2210[2];
(smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = (basis$0List$1.filter$417(function(v$2208){var v$2209 = v$2208[0];
return (v$2209 == filepath$2152)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0])),0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0] = (basis$0List$1.map$332(function(n$2201){return ((n$2201 == filepath$2152)?false:true)?n$2201:v$2229;
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0])),0);
var t$10574;
var v$4394 = basis$0String$1.tokens$224(function(c$4395){return c$4395 == 47;
},filepath$2152);
if (v$4394 == null) {t$10574 = false;
} else {var v$4396 = v$4394;
switch (v$4396[0]) { case "Server": {t$10574 = true;
 break; }default: {t$10574 = false;
} };
};
t$10574?0:((function(obj,a){return obj.remove(a);})(fts$2138,filepath$2152));
var h$4400 = [["id",v$2229],[["parent",v$2231],[["name",v$2230],[["kind","leaf"],null]]]];
var t$10580 = fts$2138;
var t$10579;
var fix$10575 = {};
fix$10575.$foldl = function(v$4402,v$4403){lab$foldl: while (true) {if (v$4403 == null) {return v$4402;
} else {var v$4404 = v$4403;
var v$4405 = v$4404[0];
var v$4406 = v$4404[1];
var t$10576;
var v$4407 = v$4405[0];
var v$4408 = v$4405[1];
(function(fp,s,v){fp[s] = v;})(v$4402,v$4407,v$4408);
t$10576 = v$4402;
var t$10577 = t$10576;
var t$10578 = v$4406;
var v$4402 = t$10577;
var v$4403 = t$10578;
continue lab$foldl;
};
};
};
var foldl$4401 = fix$10575.$foldl;
var v$10071 = (function(){return {};})();
t$10579 = (foldl$4401(v$10071,h$4400));
(function(obj,a){return obj.add(a);})(t$10580,t$10579);
var v$2192 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0];
switch (v$2192[0]) { case 0: {var v$2198 = v$2192[1];
appfun2$0dropbox$1.move_file$482(v$2198,filepath$2152,v$2229,function(v$2196){var v$2197 = v$2196[0];
var s$4410 = ((((("Moved file " + (("'" + filepath$2152) + "'")) + " to ") + (("'" + v$2229) + "'")) + " (") + v$2197) + ")";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$4410);
var s$4412;
var t$10586;
var t$10585;
var t$10584;
var t$10583 = basis$0Date$1.fmt$816;
var t$10582 = "%H:%M:%S";
var t$10581;
var v$10034 = SmlPrims.getrealtime();
t$10581 = (basis$0Date$1.fromTimeLocal$512(v$10034[0],v$10034[1]));
t$10584 = (t$10583(t$10582,t$10581));
t$10585 = (t$10584 + ": ");
t$10586 = (t$10585 + s$4410);
s$4412 = (t$10586 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4412));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
 break; }default: {0;
} };
return [v$2229,v$2211[0](0)];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Impossible: cannot locate file in tab structure!"];
} };
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.ftsServer$2272;
var content$2273;
var file$6672;
var t$10590 = "otests/content?_=";
var t$10589;
var t$10588 = basis$0Real$1.toString$153;
var t$10587;
var v$6673 = SmlPrims.getrealtime();
t$10587 = ((v$6673[0] - (-2147483648)) + (v$6673[1] / 1000000.0));
t$10589 = (t$10588(t$10587));
file$6672 = (t$10590 + t$10589);
var r$6674 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$6674,"GET",file$6672,false);
js$0Js$1.send$654(r$6674,[1]);
var v$6675 = (function(r){return SmlPrims.option(r.responseText);})(r$6674);
switch (v$6675[0]) { case 0: {content$2273 = v$6675[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$6672];
} };
var content$2274 = basis$0String$1.translate$217(function(c$2277){return ((c$2277 == 32)?true:((9 <= c$2277)?(c$2277 <= 13):false))?"":(SmlPrims.implode([c$2277,null]));
},content$2273);
var lines$2282 = basis$0String$1.tokens$224(function(c$2285){return c$2285 == 59;
},content$2274);
var t$10612;
var t$10611 = [["id","Server"],[["name","Server"],[["kind","folder"],[["parent","0"],null]]]];
var t$10610;
var t$10591;
var v$6676 = null;
var fix$10592 = {};
fix$10592.$foldr = function(v$6678){if (v$6678 == null) {return v$6676;
} else {var v$6679 = v$6678;
var v$6680 = v$6679[0];
var v$6681 = v$6679[1];
var v$6683 = fix$10592.$foldr(v$6681);
var t$10609 = basis$0List$1.s$n$686;
var t$10593;
var v$6686 = basis$0String$1.tokens$224(function(c$6687){return c$6687 == 61;
},v$6680);
if (v$6686 == null) {t$10593 = null;
} else {var v$6688 = v$6686;
var v$6689 = v$6688[1];
if (v$6689 == null) {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"syntax error in otests/content file");
var s$6713;
var t$10599;
var t$10598;
var t$10597;
var t$10596 = basis$0Date$1.fmt$816;
var t$10595 = "%H:%M:%S";
var t$10594;
var v$10036 = SmlPrims.getrealtime();
t$10594 = (basis$0Date$1.fromTimeLocal$512(v$10036[0],v$10036[1]));
t$10597 = (t$10596(t$10595,t$10594));
t$10598 = (t$10597 + ": ");
t$10599 = (t$10598 + "syntax error in otests/content file");
s$6713 = (t$10599 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$6713));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
t$10593 = null;
} else {var v$6690 = v$6689;
if (v$6690[1] == null) {var v$6691 = v$6688[0];
var v$6692 = v$6690[0];
var sfolder$6693 = "Server/" + v$6691;
var t$10602;
var t$10601 = [["id",sfolder$6693],[["name",v$6691],[["kind","folder"],[["parent","Server"],null]]]];
var t$10600;
var files$6696 = basis$0String$1.tokens$224(function(c$6697){return c$6697 == 44;
},v$6692);
t$10600 = (basis$0List$1.map$332(function(f$6698){return [["id",(sfolder$6693 + "/") + f$6698],[["name",f$6698],[["kind","file"],[["parent",sfolder$6693],null]]]];
},files$6696));
t$10602 = [t$10601,t$10600];
t$10593 = t$10602;
} else {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"syntax error in otests/content file");
var s$6703;
var t$10608;
var t$10607;
var t$10606;
var t$10605 = basis$0Date$1.fmt$816;
var t$10604 = "%H:%M:%S";
var t$10603;
var v$10035 = SmlPrims.getrealtime();
t$10603 = (basis$0Date$1.fromTimeLocal$512(v$10035[0],v$10035[1]));
t$10606 = (t$10605(t$10604,t$10603));
t$10607 = (t$10606 + ": ");
t$10608 = (t$10607 + "syntax error in otests/content file");
s$6703 = (t$10608 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$6703));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
t$10593 = null;
};
};
};
return t$10609(t$10593,v$6683);
};
};
var foldr$6677 = fix$10592.$foldr;
t$10591 = (function(v$10184){return foldr$6677(v$10184);
});
t$10610 = (t$10591(lines$2282));
t$10612 = [t$10611,t$10610];
smltojs0$0SmlToJsCompApp$1$2.ftsServer$2272 = t$10612;
smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334 = function(v$2370,v$2371){return function(filename$2341){return function(content$2344){var inarea$2345;
var attrs$4530 = [["style","border:0;"],null];
var elem$4531 = document.createTextNode(content$2344);
var newelem$4532 = document.createElement("textarea");
var fix$10613 = {};
fix$10613.$app = function(v$4534){lab$app: while (true) {if (v$4534 == null) {return 0;
} else {var v$4535 = v$4534;
var v$4536 = v$4535[0];
var v$4537 = v$4535[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4532,v$4536[0],v$4536[1]);
var t$10614 = v$4537;
var v$4534 = t$10614;
continue lab$app;
};
};
};
var app$4533 = fix$10613.$app;
app$4533(attrs$4530);
(function(e,a){return e.appendChild(a);})(newelem$4532,elem$4531);
inarea$2345 = newelem$4532;
var inputarea$2346;
var attrs$4540 = [["class","textareacontainer"],null];
var newelem$4542 = document.createElement("div");
var fix$10615 = {};
fix$10615.$app = function(v$4544){lab$app: while (true) {if (v$4544 == null) {return 0;
} else {var v$4545 = v$4544;
var v$4546 = v$4545[0];
var v$4547 = v$4545[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4542,v$4546[0],v$4546[1]);
var t$10616 = v$4547;
var v$4544 = t$10616;
continue lab$app;
};
};
};
var app$4543 = fix$10615.$app;
app$4543(attrs$4540);
(function(e,a){return e.appendChild(a);})(newelem$4542,inarea$2345);
inputarea$2346 = newelem$4542;
var m$4548;
var v$6072;
var h$4555 = [["style","height:100%;"],[["title",filename$2341],[["closable","true"],null]]];
v$6072 = (function(f$4557){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$4558){var p$4559;
var t$10622 = Cp$4558;
var t$10621;
var fix$10617 = {};
fix$10617.$foldl = function(v$4561,v$4562){lab$foldl: while (true) {if (v$4562 == null) {return v$4561;
} else {var v$4563 = v$4562;
var v$4564 = v$4563[0];
var v$4565 = v$4563[1];
var t$10618;
var v$4566 = v$4564[0];
var v$4567 = v$4564[1];
(function(fp,s,v){fp[s] = v;})(v$4561,v$4566,v$4567);
t$10618 = v$4561;
var t$10619 = t$10618;
var t$10620 = v$4565;
var v$4561 = t$10619;
var v$4562 = t$10620;
continue lab$foldl;
};
};
};
var foldl$4560 = fix$10617.$foldl;
var v$10073 = (function(){return {};})();
t$10621 = (foldl$4560(v$10073,h$4555));
p$4559 = ((function(c,h){return new c(h);})(t$10622,t$10621));
(function(w,e){w.set('content', e);})(p$4559,inputarea$2346);
return f$4557(p$4559);
});
});
m$4548 = (function(c$4553){return v$6072(function(v$4554){(function(w,f){w.onClose = f;})(v$4554,function(v$6729){smltojs0$0SmlToJsCompApp$1$2.closeTab$2088(filename$2341);
return true;
});
(function(w,f){w.onShow = f;})(v$4554,function(v$6730){return (smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = filename$2341,0);
});
(function(obj,a){return obj.addChild(a);})(v$2370,v$4554);
(function(obj,a1,a2){return obj.selectChild(a1,a2);})(v$2370,v$4554,true);
(v$2371[0] = [[filename$2341,v$4554],v$2371[0]],0);
var a$6731 = 0;
return c$4553(a$6731);
});
});
m$4548(function(x$4549){return x$4549;
});
var editor$2348 = smltojs0$0SmlToJsCompApp$1$2.mkEditor$1218(inarea$2345);
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0] = [[filename$2341,[md5$0md5$1.fromString$410(content$2344)],editor$2348],smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]],0);
};
};
};
smltojs0$0SmlToJsCompApp$1$2.button$2372 = function(s$2375){var attrs$4587 = [["style","height:25px; width:100px;"],null];
var elem$4588;
var attrs$4596 = null;
var elem$4597 = document.createTextNode(s$2375);
var newelem$4598 = document.createElement("b");
var fix$10623 = {};
fix$10623.$app = function(v$4600){lab$app: while (true) {if (v$4600 == null) {return 0;
} else {var v$4601 = v$4600;
var v$4602 = v$4601[0];
var v$4603 = v$4601[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4598,v$4602[0],v$4602[1]);
var t$10624 = v$4603;
var v$4600 = t$10624;
continue lab$app;
};
};
};
var app$4599 = fix$10623.$app;
app$4599(attrs$4596);
(function(e,a){return e.appendChild(a);})(newelem$4598,elem$4597);
elem$4588 = newelem$4598;
var newelem$4589 = document.createElement("button");
var fix$10625 = {};
fix$10625.$app = function(v$4591){lab$app: while (true) {if (v$4591 == null) {return 0;
} else {var v$4592 = v$4591;
var v$4593 = v$4592[0];
var v$4594 = v$4592[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4589,v$4593[0],v$4593[1]);
var t$10626 = v$4594;
var v$4591 = t$10626;
continue lab$app;
};
};
};
var app$4590 = fix$10625.$app;
app$4590(attrs$4587);
(function(e,a){return e.appendChild(a);})(newelem$4589,elem$4588);
return newelem$4589;
};
smltojs0$0SmlToJsCompApp$1$2.withDialog$2376 = function(v$2427,v$2426,v$2432,v$2429,v$2428,v$2430,v$2431){var msgArea$2386;
var attrs$4606 = [["class","notify_area2"],[["style","opacity:0.0;top:0px;"],null]];
var newelem$4607 = document.createElement("span");
var fix$10627 = {};
fix$10627.$app = function(v$4609){lab$app: while (true) {if (v$4609 == null) {return 0;
} else {var v$4610 = v$4609;
var v$4611 = v$4610[0];
var v$4612 = v$4610[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4607,v$4611[0],v$4611[1]);
var t$10628 = v$4612;
var v$4609 = t$10628;
continue lab$app;
};
};
};
var app$4608 = fix$10627.$app;
app$4608(attrs$4606);
msgArea$2386 = newelem$4607;
var field$2405;
var attrs$4615 = [["type","text"],[["value",v$2430],null]];
var newelem$4616 = document.createElement("input");
var fix$10629 = {};
fix$10629.$app = function(v$4618){lab$app: while (true) {if (v$4618 == null) {return 0;
} else {var v$4619 = v$4618;
var v$4620 = v$4619[0];
var v$4621 = v$4619[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4616,v$4620[0],v$4620[1]);
var t$10630 = v$4621;
var v$4618 = t$10630;
continue lab$app;
};
};
};
var app$4617 = fix$10629.$app;
app$4617(attrs$4615);
field$2405 = newelem$4616;
var but$2406 = smltojs0$0SmlToJsCompApp$1$2.button$2372(v$2427);
var intro$2407;
switch (v$2429[0]) { case 0: {var v$2414 = v$2429[1];
var attrs$4623 = null;
var newelem$4625 = document.createElement("p");
var fix$10631 = {};
fix$10631.$app = function(v$4627){lab$app: while (true) {if (v$4627 == null) {return 0;
} else {var v$4628 = v$4627;
var v$4629 = v$4628[0];
var v$4630 = v$4628[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4625,v$4629[0],v$4629[1]);
var t$10632 = v$4630;
var v$4627 = t$10632;
continue lab$app;
};
};
};
var app$4626 = fix$10631.$app;
app$4626(attrs$4623);
(function(e,a){return e.appendChild(a);})(newelem$4625,v$2414);
intro$2407 = newelem$4625;
 break; }default: {intro$2407 = (document.createTextNode(""));
} };
var content$2415;
var attrs$4633 = [["style","width:400px;"],null];
var elem$4634;
var v$6080;
var v$6083;
var attrs$4650 = null;
var elem$4651;
var v$6084 = document.createTextNode(v$2428 + ": ");
var e$4661 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4661,v$6084);
(function(e,a){return e.appendChild(a);})(e$4661,field$2405);
elem$4651 = e$4661;
var newelem$4652 = document.createElement("p");
var fix$10633 = {};
fix$10633.$app = function(v$4654){lab$app: while (true) {if (v$4654 == null) {return 0;
} else {var v$4655 = v$4654;
var v$4656 = v$4655[0];
var v$4657 = v$4655[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4652,v$4656[0],v$4656[1]);
var t$10634 = v$4657;
var v$4654 = t$10634;
continue lab$app;
};
};
};
var app$4653 = fix$10633.$app;
app$4653(attrs$4650);
(function(e,a){return e.appendChild(a);})(newelem$4652,elem$4651);
v$6083 = newelem$4652;
var e$4648 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4648,intro$2407);
(function(e,a){return e.appendChild(a);})(e$4648,v$6083);
v$6080 = e$4648;
var v$6081;
var attrs$4665 = null;
var elem$4666;
var v$6088;
var v$6091 = document.createTextNode(" ");
var e$4680 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4680,but$2406);
(function(e,a){return e.appendChild(a);})(e$4680,v$6091);
v$6088 = e$4680;
var e$4676 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4676,v$6088);
(function(e,a){return e.appendChild(a);})(e$4676,msgArea$2386);
elem$4666 = e$4676;
var newelem$4667 = document.createElement("p");
var fix$10635 = {};
fix$10635.$app = function(v$4669){lab$app: while (true) {if (v$4669 == null) {return 0;
} else {var v$4670 = v$4669;
var v$4671 = v$4670[0];
var v$4672 = v$4670[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4667,v$4671[0],v$4671[1]);
var t$10636 = v$4672;
var v$4669 = t$10636;
continue lab$app;
};
};
};
var app$4668 = fix$10635.$app;
app$4668(attrs$4665);
(function(e,a){return e.appendChild(a);})(newelem$4667,elem$4666);
v$6081 = newelem$4667;
var e$4644 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4644,v$6080);
(function(e,a){return e.appendChild(a);})(e$4644,v$6081);
elem$4634 = e$4644;
var newelem$4635 = document.createElement("p");
var fix$10637 = {};
fix$10637.$app = function(v$4637){lab$app: while (true) {if (v$4637 == null) {return 0;
} else {var v$4638 = v$4637;
var v$4639 = v$4638[0];
var v$4640 = v$4638[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4635,v$4639[0],v$4639[1]);
var t$10638 = v$4640;
var v$4637 = t$10638;
continue lab$app;
};
};
};
var app$4636 = fix$10637.$app;
app$4636(attrs$4633);
(function(e,a){return e.appendChild(a);})(newelem$4635,elem$4634);
content$2415 = newelem$4635;
var dM$2416;
var v$6092;
var h$4687 = [["title",v$2426],null];
v$6092 = (function(f$4689){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4690){var d$4691;
var t$10644 = D$4690;
var t$10643;
var fix$10639 = {};
fix$10639.$foldl = function(v$4693,v$4694){lab$foldl: while (true) {if (v$4694 == null) {return v$4693;
} else {var v$4695 = v$4694;
var v$4696 = v$4695[0];
var v$4697 = v$4695[1];
var t$10640;
var v$4698 = v$4696[0];
var v$4699 = v$4696[1];
(function(fp,s,v){fp[s] = v;})(v$4693,v$4698,v$4699);
t$10640 = v$4693;
var t$10641 = t$10640;
var t$10642 = v$4697;
var v$4693 = t$10641;
var v$4694 = t$10642;
continue lab$foldl;
};
};
};
var foldl$4692 = fix$10639.$foldl;
var v$10075 = (function(){return {};})();
t$10643 = (foldl$4692(v$10075,h$4687));
d$4691 = ((function(c,h){return new c(h);})(t$10644,t$10643));
(function(w,e){w.set('content', e);})(d$4691,content$2415);
return f$4689(d$4691);
});
});
dM$2416 = (function(c$4685){return v$6092(function(v$4686){js$0Js$1.installEventHandler$197(but$2406,4,function(v$6742){var s$6743 = (function(e){return e.value;})(field$2405);
try {var t$6744 = v$2431(s$6743);
(function(obj){return obj.hide();})(v$4686);
v$2432(t$6744);
return true;
} catch(v$10645) {return (function(v$6745){var t$10646 = v$6745;
if (t$10646[0] == basis$0Initial$1.en$Fail$54) {var msg$6746 = v$6745[1];
notify0$1026("#dd8888",msgArea$2386,msg$6746);
return true;
} else {throw v$6745;
};
})(v$10645);
};
});
(function(obj){return obj.show();})(v$4686);
var a$6747 = 0;
return c$4685(a$6747);
});
});
return dM$2416(function(x$4710){return x$4710;
});
};
smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2433 = function(caption$2436,label$2439,msg$2442,f$2445){var cancel$2446 = smltojs0$0SmlToJsCompApp$1$2.button$2372("Cancel");
var but$2447 = smltojs0$0SmlToJsCompApp$1$2.button$2372(label$2439);
var content$2448;
var attrs$4712 = [["style","width:400px;"],null];
var elem$4713;
var v$6094;
var attrs$4725 = null;
var newelem$4727 = document.createElement("p");
var fix$10647 = {};
fix$10647.$app = function(v$4729){lab$app: while (true) {if (v$4729 == null) {return 0;
} else {var v$4730 = v$4729;
var v$4731 = v$4730[0];
var v$4732 = v$4730[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4727,v$4731[0],v$4731[1]);
var t$10648 = v$4732;
var v$4729 = t$10648;
continue lab$app;
};
};
};
var app$4728 = fix$10647.$app;
app$4728(attrs$4725);
(function(e,a){return e.appendChild(a);})(newelem$4727,msg$2442);
v$6094 = newelem$4727;
var v$6095;
var attrs$4734 = [["style","text-align:center;"],null];
var elem$4735;
var v$6096;
var v$6099 = document.createTextNode(" ");
var e$4749 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4749,cancel$2446);
(function(e,a){return e.appendChild(a);})(e$4749,v$6099);
v$6096 = e$4749;
var e$4745 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4745,v$6096);
(function(e,a){return e.appendChild(a);})(e$4745,but$2447);
elem$4735 = e$4745;
var newelem$4736 = document.createElement("p");
var fix$10649 = {};
fix$10649.$app = function(v$4738){lab$app: while (true) {if (v$4738 == null) {return 0;
} else {var v$4739 = v$4738;
var v$4740 = v$4739[0];
var v$4741 = v$4739[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4736,v$4740[0],v$4740[1]);
var t$10650 = v$4741;
var v$4738 = t$10650;
continue lab$app;
};
};
};
var app$4737 = fix$10649.$app;
app$4737(attrs$4734);
(function(e,a){return e.appendChild(a);})(newelem$4736,elem$4735);
v$6095 = newelem$4736;
var e$4723 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4723,v$6094);
(function(e,a){return e.appendChild(a);})(e$4723,v$6095);
elem$4713 = e$4723;
var newelem$4714 = document.createElement("p");
var fix$10651 = {};
fix$10651.$app = function(v$4716){lab$app: while (true) {if (v$4716 == null) {return 0;
} else {var v$4717 = v$4716;
var v$4718 = v$4717[0];
var v$4719 = v$4717[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4714,v$4718[0],v$4718[1]);
var t$10652 = v$4719;
var v$4716 = t$10652;
continue lab$app;
};
};
};
var app$4715 = fix$10651.$app;
app$4715(attrs$4712);
(function(e,a){return e.appendChild(a);})(newelem$4714,elem$4713);
content$2448 = newelem$4714;
var dM$2449;
var v$6100;
var h$4756 = [["title",caption$2436],null];
v$6100 = (function(f$4758){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4759){var d$4760;
var t$10658 = D$4759;
var t$10657;
var fix$10653 = {};
fix$10653.$foldl = function(v$4762,v$4763){lab$foldl: while (true) {if (v$4763 == null) {return v$4762;
} else {var v$4764 = v$4763;
var v$4765 = v$4764[0];
var v$4766 = v$4764[1];
var t$10654;
var v$4767 = v$4765[0];
var v$4768 = v$4765[1];
(function(fp,s,v){fp[s] = v;})(v$4762,v$4767,v$4768);
t$10654 = v$4762;
var t$10655 = t$10654;
var t$10656 = v$4766;
var v$4762 = t$10655;
var v$4763 = t$10656;
continue lab$foldl;
};
};
};
var foldl$4761 = fix$10653.$foldl;
var v$10077 = (function(){return {};})();
t$10657 = (foldl$4761(v$10077,h$4756));
d$4760 = ((function(c,h){return new c(h);})(t$10658,t$10657));
(function(w,e){w.set('content', e);})(d$4760,content$2448);
return f$4758(d$4760);
});
});
dM$2449 = (function(c$4754){return v$6100(function(v$4755){js$0Js$1.installEventHandler$197(but$2447,4,function(v$6755){(function(obj){return obj.hide();})(v$4755);
f$2445(0);
return true;
});
js$0Js$1.installEventHandler$197(cancel$2446,4,function(v$6756){(function(obj){return obj.hide();})(v$4755);
return true;
});
(function(obj){return obj.show();})(v$4755);
var a$6757 = 0;
return c$4754(a$6757);
});
});
return dM$2449(function(x$4775){return x$4775;
});
};
smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469 = function(buttonlabel$2472,caption$2475,content$2478){var but$2479 = smltojs0$0SmlToJsCompApp$1$2.button$2372(buttonlabel$2472);
var content$2480;
var attrs$4777 = [["style","width:500px;"],null];
var elem$4778;
var v$6103;
var attrs$4790 = [["style","text-align:center;"],null];
var newelem$4792 = document.createElement("p");
var fix$10659 = {};
fix$10659.$app = function(v$4794){lab$app: while (true) {if (v$4794 == null) {return 0;
} else {var v$4795 = v$4794;
var v$4796 = v$4795[0];
var v$4797 = v$4795[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4792,v$4796[0],v$4796[1]);
var t$10660 = v$4797;
var v$4794 = t$10660;
continue lab$app;
};
};
};
var app$4793 = fix$10659.$app;
app$4793(attrs$4790);
(function(e,a){return e.appendChild(a);})(newelem$4792,but$2479);
v$6103 = newelem$4792;
var e$4788 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4788,content$2478);
(function(e,a){return e.appendChild(a);})(e$4788,v$6103);
elem$4778 = e$4788;
var newelem$4779 = document.createElement("p");
var fix$10661 = {};
fix$10661.$app = function(v$4781){lab$app: while (true) {if (v$4781 == null) {return 0;
} else {var v$4782 = v$4781;
var v$4783 = v$4782[0];
var v$4784 = v$4782[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4779,v$4783[0],v$4783[1]);
var t$10662 = v$4784;
var v$4781 = t$10662;
continue lab$app;
};
};
};
var app$4780 = fix$10661.$app;
app$4780(attrs$4777);
(function(e,a){return e.appendChild(a);})(newelem$4779,elem$4778);
content$2480 = newelem$4779;
var dM$2481;
var v$6104;
var h$4803 = [["title",caption$2475],null];
v$6104 = (function(f$4805){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4806){var d$4807;
var t$10668 = D$4806;
var t$10667;
var fix$10663 = {};
fix$10663.$foldl = function(v$4809,v$4810){lab$foldl: while (true) {if (v$4810 == null) {return v$4809;
} else {var v$4811 = v$4810;
var v$4812 = v$4811[0];
var v$4813 = v$4811[1];
var t$10664;
var v$4814 = v$4812[0];
var v$4815 = v$4812[1];
(function(fp,s,v){fp[s] = v;})(v$4809,v$4814,v$4815);
t$10664 = v$4809;
var t$10665 = t$10664;
var t$10666 = v$4813;
var v$4809 = t$10665;
var v$4810 = t$10666;
continue lab$foldl;
};
};
};
var foldl$4808 = fix$10663.$foldl;
var v$10079 = (function(){return {};})();
t$10667 = (foldl$4808(v$10079,h$4803));
d$4807 = ((function(c,h){return new c(h);})(t$10668,t$10667));
(function(w,e){w.set('content', e);})(d$4807,content$2480);
return f$4805(d$4807);
});
});
dM$2481 = (function(c$4801){return v$6104(function(v$4802){js$0Js$1.installEventHandler$197(but$2479,4,function(v$6764){(function(obj){return obj.hide();})(v$4802);
return true;
});
(function(obj){return obj.show();})(v$4802);
var a$6765 = 0;
return c$4801(a$6765);
});
});
return dM$2481(function(x$4821){return x$4821;
});
};
smltojs0$0SmlToJsCompApp$1$2.infoDialogOk$2493 = function(v$10082){return function(v$10083){return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok",v$10082,v$10083);
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_NewNamedFile$2494 = function(tabsmap$2497,fts$2500,v$2502){var content$2503;
var t$10673;
var t$10672 = "(* File created ";
var t$10671;
var t$10670 = basis$0Date$1.toString$826;
var t$10669;
var v$10037 = SmlPrims.getrealtime();
t$10669 = (basis$0Date$1.fromTimeLocal$512(v$10037[0],v$10037[1]));
t$10671 = (t$10670(t$10669));
t$10673 = (t$10672 + t$10671);
content$2503 = (t$10673 + " *)\n");
var t$10685 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2376;
var t$10684 = "Create";
var t$10683 = "New File";
var t$10682 = function(s$2506){return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabsmap$2497[0],tabsmap$2497[1]))(s$2506))(content$2503);
};
var t$10681 = [1];
var t$10680 = "Name";
var t$10679;
var fix$10674 = {};
fix$10674.$suggest = function(f$6769){lab$suggest: while (true) {var num$6770 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6771 = f$6769(num$6770);
var t$10677;
var fix$10675 = {};
fix$10675.$exists = function(v$6774){lab$exists: while (true) {if (v$6774 == null) {return false;
} else {var v$6775 = v$6774;
var v$6776 = v$6775[0];
var v$6777 = v$6775[1];
if (v$6776 == name$6771) {return true;
} else {var t$10676 = v$6777;
var v$6774 = t$10676;
continue lab$exists;
};
};
};
};
var exists$6773 = fix$10675.$exists;
t$10677 = (exists$6773(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10677) {var t$10678 = f$6769;
var f$6769 = t$10678;
continue lab$suggest;
} else {return name$6771;
};
};
};
var suggest$6768 = fix$10674.$suggest;
t$10679 = (suggest$6768(function(num$6778){return ("Untitled-" + (basis$0Int32$1.toString$458(num$6778))) + ".sml";
}));
return t$10685(t$10684,t$10683,t$10682,t$10681,t$10680,t$10679,function(v$10086){return smltojs0$0SmlToJsCompApp$1$2.newFile$1837(fts$2500,content$2503,v$10086);
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_MoveFile$2514 = function(tabsmap$2517,fts$2520,closetab$2523,v$2525){var path$2526 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var intro$2527 = document.createTextNode("Files can be renamed or moved either using relative paths ('..' is not supported) or using absolute paths (starting with '/').");
var v$2534 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(path$2526);
var v$2535 = v$2534[1];
switch (v$2535[0]) { case 0: {var v$2552 = v$2534[0];
var v$2553 = v$2535[1];
return smltojs0$0SmlToJsCompApp$1$2.withDialog$2376("Move","Move/Rename File",function(v$2540){var v$2543 = v$2540[0];
var v$2544 = v$2540[1];
closetab$2523(path$2526);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabsmap$2517[0],tabsmap$2517[1]))(v$2543))(v$2544);
},[0,intro$2527],"New name",v$2553,function(v$10090){return smltojs0$0SmlToJsCompApp$1$2.move$2135(fts$2520,v$2552,v$2553,v$10090);
});
 break; }default: {return notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Renaming of folders not supported");
} };
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_FilesDelete$2555 = function(fts$2558,closetab$2561,v$2563){var msg$2564;
var v$2569;
var t$10686;
var p$4830 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var fields$4831 = basis$0String$1.fields$231(function(c$4832){return c$4832 == 47;
},p$4830);
var v$4833 = basis$0List$1.rev$682(fields$4831);
if (v$4833 == null) {t$10686 = false;
} else {var v$4834 = v$4833;
var v$4835 = v$4834[0];
var v$4836 = v$4834[1];
var t$10689;
var v$6780 = basis$0String$1.fields$231(function(c$6781){return c$6781 == 46;
},v$4835);
if (v$6780 == null) {t$10689 = false;
} else {var v$6782 = v$6780;
var v$6783 = v$6782[1];
if (v$6783 == null) {t$10689 = false;
} else {var v$6784 = v$6783;
if (v$6784[1] == null) {var v$6785 = v$6782[0];
var v$6786 = v$6784[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$6785)) {var fix$10690 = {};
fix$10690.$exists = function(v$6788){lab$exists: while (true) {if (v$6788 == null) {return false;
} else {var v$6789 = v$6788;
var v$6790 = v$6789[0];
var v$6791 = v$6789[1];
if (v$6786 == v$6790) {return true;
} else {var t$10691 = v$6791;
var v$6788 = t$10691;
continue lab$exists;
};
};
};
};
var exists$6787 = fix$10690.$exists;
t$10689 = (exists$6787(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$211));
} else {t$10689 = false;
};
} else {t$10689 = false;
};
};
};
if (t$10689) {var fix$10687 = {};
fix$10687.$all = function(v$4838){lab$all: while (true) {if (v$4838 == null) {return true;
} else {var v$4839 = v$4838;
var v$4840 = v$4839[0];
var v$4841 = v$4839[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4840)) {var t$10688 = v$4841;
var v$4838 = t$10688;
continue lab$all;
} else {return false;
};
};
};
};
var all$4837 = fix$10687.$all;
t$10686 = (all$4837(v$4836));
} else {t$10686 = false;
};
};
v$2569 = (t$10686?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$2569[0]) { case 0: {msg$2564 = (("Do you really want to delete the file " + (("'" + v$2569[1]) + "'")) + "?");
 break; }default: {var v$2576;
var t$10692;
var p$4848 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
if (p$4848 == "0") {t$10692 = true;
} else {var fields$4853 = basis$0String$1.fields$231(function(c$4854){return c$4854 == 47;
},p$4848);
var fix$10693 = {};
fix$10693.$all = function(v$4856){lab$all: while (true) {if (v$4856 == null) {return true;
} else {var v$4857 = v$4856;
var v$4858 = v$4857[0];
var v$4859 = v$4857[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4858)) {var t$10694 = v$4859;
var v$4856 = t$10694;
continue lab$all;
} else {return false;
};
};
};
};
var all$4855 = fix$10693.$all;
t$10692 = (all$4855(fields$4853));
};
v$2576 = (t$10692?[0,smltojs0$0SmlToJsCompApp$1$2.current$1420[0]]:[1]);
switch (v$2576[0]) { case 0: {msg$2564 = (("Do you really want to delete the folder " + (("'" + v$2576[1]) + "'")) + " and all its containing files?");
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"menuHandle_FilesDelete.impossible"];
} };
} };
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2433("Confirm Deletion","Delete",document.createTextNode(msg$2564),function(v$2580){return smltojs0$0SmlToJsCompApp$1$2.delete$1900(fts$2558,closetab$2561);
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_Export$2581 = function(v$2583){var v$10131 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Files Export to Zip",v$10131);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_Import$2584 = function(v$2586){var v$10133 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Files Import from Zip",v$10133);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_NewFolder$2587 = function(fts$2590,v$2592){var t$10706 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2376;
var t$10705 = "Create";
var t$10704 = "New Folder";
var t$10703 = function(s$2595){return 0;
};
var t$10702 = [1];
var t$10701 = "Name";
var t$10700;
var fix$10695 = {};
fix$10695.$suggest = function(f$6806){lab$suggest: while (true) {var num$6807 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6810 = f$6806(num$6807);
var t$10698;
var fix$10696 = {};
fix$10696.$exists = function(v$6813){lab$exists: while (true) {if (v$6813 == null) {return false;
} else {var v$6814 = v$6813;
var v$6815 = v$6814[0];
var v$6816 = v$6814[1];
if (v$6815 == name$6810) {return true;
} else {var t$10697 = v$6816;
var v$6813 = t$10697;
continue lab$exists;
};
};
};
};
var exists$6812 = fix$10696.$exists;
t$10698 = (exists$6812(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10698) {var t$10699 = f$6806;
var f$6806 = t$10699;
continue lab$suggest;
} else {return name$6810;
};
};
};
var suggest$6805 = fix$10695.$suggest;
t$10700 = (suggest$6805(function(num$4879){return "Folder-" + (basis$0Int32$1.toString$458(num$4879));
}));
return t$10706(t$10705,t$10704,t$10703,t$10702,t$10701,t$10700,function(v$10092){return smltojs0$0SmlToJsCompApp$1$2.newFolder$1855(fts$2590,v$10092);
});
};
smltojs0$0SmlToJsCompApp$1$2.treeHandle_LoadFile$2603 = function(tabsmap$2606,selecttab$2609,v$2613){var v$2625 = v$2613[0];
var t$10707;
if (v$2625 == "0") {t$10707 = true;
} else {var fields$4887 = basis$0String$1.fields$231(function(c$4888){return c$4888 == 47;
},v$2625);
var fix$10708 = {};
fix$10708.$all = function(v$4890){lab$all: while (true) {if (v$4890 == null) {return true;
} else {var v$4891 = v$4890;
var v$4892 = v$4891[0];
var v$4893 = v$4891[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$4892)) {var t$10709 = v$4893;
var v$4890 = t$10709;
continue lab$all;
} else {return false;
};
};
};
};
var all$4889 = fix$10708.$all;
t$10707 = (all$4889(fields$4887));
};
if (t$10707) {return (smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = v$2625,0);
} else {return smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1662(v$2625,function(v$2622){switch (v$2622[0]) { case 0: {var v$2624 = v$2622[1];
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabsmap$2606[0],tabsmap$2606[1]))(v$2625))(v$2624);
 break; }default: {return selecttab$2609(v$2625);
} };
});
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_OpenDemo$2627 = function(tabsmap$2630,fts$2633,demo$2636,v$2638){var name$2639;
var fix$10710 = {};
fix$10710.$suggest = function(f$6819){lab$suggest: while (true) {var num$6820 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$6821 = f$6819(num$6820);
var t$10713;
var fix$10711 = {};
fix$10711.$exists = function(v$6824){lab$exists: while (true) {if (v$6824 == null) {return false;
} else {var v$6825 = v$6824;
var v$6826 = v$6825[0];
var v$6827 = v$6825[1];
if (v$6826 == name$6821) {return true;
} else {var t$10712 = v$6827;
var v$6824 = t$10712;
continue lab$exists;
};
};
};
};
var exists$6823 = fix$10711.$exists;
t$10713 = (exists$6823(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10713) {var t$10714 = f$6819;
var f$6819 = t$10714;
continue lab$suggest;
} else {return name$6821;
};
};
};
var suggest$6818 = fix$10710.$suggest;
name$2639 = (suggest$6818(function(num$6828){return ("Demo-" + (basis$0Int32$1.toString$458(num$6828))) + ".sml";
}));
var path$2640 = smltojs0$0SmlToJsCompApp$1$2.newFile$1837(fts$2633,demo$2636,name$2639);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabsmap$2630[0],tabsmap$2630[1]))(path$2640))(demo$2636);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignIn$2641 = function(key$2644,v$2646){var t$10723;
var t$10719;
var t$10715;
var v$6150 = smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0];
var v$6151 = null;
var fix$10716 = {};
fix$10716.$eq_list = function(v$10135,v$10136){lab$eq_list: while (true) {if (v$10135 == null) {return (v$10136 == null)?true:false;
} else {if (v$10136 == null) {return false;
} else {var v$10137 = v$10135;
var v$10138 = v$10136;
if (v$10137[0] == v$10138[0]) {var t$10717 = v$10137[1];
var t$10718 = v$10138[1];
var v$10135 = t$10717;
var v$10136 = t$10718;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$10134 = fix$10716.$eq_list;
t$10715 = (eq_list$10134(v$6150,v$6151));
if (t$10715) {var v$6156 = smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0];
var v$6157 = ["0",null];
var fix$10720 = {};
fix$10720.$eq_list = function(v$10141,v$10142){lab$eq_list: while (true) {if (v$10141 == null) {return (v$10142 == null)?true:false;
} else {if (v$10142 == null) {return false;
} else {var v$10143 = v$10141;
var v$10144 = v$10142;
if (v$10143[0] == v$10144[0]) {var t$10721 = v$10143[1];
var t$10722 = v$10144[1];
var v$10141 = t$10721;
var v$10142 = t$10722;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$10140 = fix$10720.$eq_list;
t$10719 = (eq_list$10140(v$6156,v$6157));
} else {t$10719 = false;
};
t$10723 = (t$10719?true:((basis$0Option$1.isSome$56(0))(smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0])));
if (t$10723) {var c$4928 = appfun2$0dropbox$1.client$91(key$2644);
return appfun2$0dropbox$1.authorize$95(c$4928);
} else {var msg$2655 = document.createTextNode("Signing in to Dropbox will delete all application data created in this session. If this is the first time you sign in to Dropbox from this application, you will be asked to allow the application to store data in a special area of your Dropbox account.");
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2433("Dropbox Sign In","Sign in",msg$2655,function(v$4930){var c$4931 = appfun2$0dropbox$1.client$91(key$2644);
return appfun2$0dropbox$1.authorize$95(c$4931);
});
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignOut$2664 = function(c$2667,fts$2670,closetab$2673,v$2675){var msg$2676 = document.createTextNode("Signing out of Dropbox will not delete any files in the Dropbox App folder. You will always be able to sign in again using the \"Sign in\" entry in the Dropbox menu.");
var fix$10724 = {};
fix$10724.$app = function(v$4935){lab$app: while (true) {if (v$4935 == null) {return 0;
} else {var v$4936 = v$4935;
var v$4937 = v$4936[0];
var v$4938 = v$4936[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047(v$4937[0],v$4937[1],v$4937[2]);
var t$10725 = v$4938;
var v$4935 = t$10725;
continue lab$app;
};
};
};
var app$4934 = fix$10724.$app;
app$4934(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2433("Dropbox Sign Out","Sign out",msg$2676,function(v$2680){return appfun2$0dropbox$1.signOut$108(c$2667,function(v$2682){(smltojs0$0SmlToJsCompApp$1$2.fileStore$1419[0] = [1],0);
smltojs0$0SmlToJsCompApp$1$2.clear$1708(fts$2670,closetab$2673);
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Signed out of Dropbox");
var s$4942;
var t$10731;
var t$10730;
var t$10729;
var t$10728 = basis$0Date$1.fmt$816;
var t$10727 = "%H:%M:%S";
var t$10726;
var v$10040 = SmlPrims.getrealtime();
t$10726 = (basis$0Date$1.fromTimeLocal$512(v$10040[0],v$10040[1]));
t$10729 = (t$10728(t$10727,t$10726));
t$10730 = (t$10729 + ": ");
t$10731 = (t$10730 + "Signed out of Dropbox");
s$4942 = (t$10731 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4942));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981,"src","nodropbox.png");
});
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_CompileAndRun$2689 = function(v$2691){var v$2697 = smltojs0$0SmlToJsCompApp$1$2.currentEditor$1870(0);
switch (v$2697[0]) { case 0: {var v$2699 = v$2697[1];
var v$2700 = v$2699[0];
var v$2701 = v$2699[1];
var res$4953;
var v$4955 = v$2701[0](0);
var p_old$4956 = basis$0Control$1.printer_get$55(0);
var buf$4957 = [null];
basis$0Control$1.printer_set$54(function(s$4958){return (buf$4957[0] = [s$4958,buf$4957[0]],0);
});
try {smltojs0$0SmlToJsCompApp$1$1.compute$102(v$2700,v$4955);
} catch(v$10732) {(function(v$4960){return 0;
})(v$10732);
};
var res$4961 = SmlPrims.concat(basis$0List$1.rev$682(buf$4957[0]));
basis$0Control$1.printer_set$54(p_old$4956);
res$4953 = res$4961;
return smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0](res$4953);
 break; }default: {notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"No file selected");
var s$4965;
var t$10738;
var t$10737;
var t$10736;
var t$10735 = basis$0Date$1.fmt$816;
var t$10734 = "%H:%M:%S";
var t$10733;
var v$10041 = SmlPrims.getrealtime();
t$10733 = (basis$0Date$1.fromTimeLocal$512(v$10041[0],v$10041[1]));
t$10736 = (t$10735(t$10734,t$10733));
t$10737 = (t$10736 + ": ");
t$10738 = (t$10737 + "No file selected");
s$4965 = (t$10738 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$4965));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
} };
};
smltojs0$0SmlToJsCompApp$1$2.poweredby$2702 = function(v$2704){var v$6180;
var attrs$5045 = null;
var elem$5046;
var v$6182;
var v$6184;
var v$6186;
var v$6188;
var v$6190;
var v$6192;
var v$6194;
var v$6196;
var v$6198 = document.createTextNode("This IDE is based on ");
var v$6199;
var attrs$6830 = [["href","http://www.smlserver.org/smltojs"],[["target","_blank"],null]];
var elem$6831 = document.createTextNode("SMLtoJs");
var newelem$6832 = document.createElement("a");
var fix$10739 = {};
fix$10739.$app = function(v$6834){lab$app: while (true) {if (v$6834 == null) {return 0;
} else {var v$6835 = v$6834;
var v$6836 = v$6835[0];
var v$6837 = v$6835[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6832,v$6836[0],v$6836[1]);
var t$10740 = v$6837;
var v$6834 = t$10740;
continue lab$app;
};
};
};
var app$6833 = fix$10739.$app;
app$6833(attrs$6830);
(function(e,a){return e.appendChild(a);})(newelem$6832,elem$6831);
v$6199 = newelem$6832;
var e$5088 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5088,v$6198);
(function(e,a){return e.appendChild(a);})(e$5088,v$6199);
v$6196 = e$5088;
var v$6197 = document.createTextNode(", a Standard ML to JavaScript compiler. The front-end uses ");
var e$5084 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5084,v$6196);
(function(e,a){return e.appendChild(a);})(e$5084,v$6197);
v$6194 = e$5084;
var v$6195;
var attrs$6839 = [["href","http://dojotoolkit.org/"],[["target","_blank"],null]];
var elem$6840 = document.createTextNode("Dojo");
var newelem$6841 = document.createElement("a");
var fix$10741 = {};
fix$10741.$app = function(v$6843){lab$app: while (true) {if (v$6843 == null) {return 0;
} else {var v$6844 = v$6843;
var v$6845 = v$6844[0];
var v$6846 = v$6844[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6841,v$6845[0],v$6845[1]);
var t$10742 = v$6846;
var v$6843 = t$10742;
continue lab$app;
};
};
};
var app$6842 = fix$10741.$app;
app$6842(attrs$6839);
(function(e,a){return e.appendChild(a);})(newelem$6841,elem$6840);
v$6195 = newelem$6841;
var e$5080 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5080,v$6194);
(function(e,a){return e.appendChild(a);})(e$5080,v$6195);
v$6192 = e$5080;
var v$6193 = document.createTextNode(" and ");
var e$5076 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5076,v$6192);
(function(e,a){return e.appendChild(a);})(e$5076,v$6193);
v$6190 = e$5076;
var v$6191;
var attrs$6848 = [["href","http://codemirror.net"],[["target","_blank"],null]];
var elem$6849 = document.createTextNode("CodeMirror");
var newelem$6850 = document.createElement("a");
var fix$10743 = {};
fix$10743.$app = function(v$6852){lab$app: while (true) {if (v$6852 == null) {return 0;
} else {var v$6853 = v$6852;
var v$6854 = v$6853[0];
var v$6855 = v$6853[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6850,v$6854[0],v$6854[1]);
var t$10744 = v$6855;
var v$6852 = t$10744;
continue lab$app;
};
};
};
var app$6851 = fix$10743.$app;
app$6851(attrs$6848);
(function(e,a){return e.appendChild(a);})(newelem$6850,elem$6849);
v$6191 = newelem$6850;
var e$5072 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5072,v$6190);
(function(e,a){return e.appendChild(a);})(e$5072,v$6191);
v$6188 = e$5072;
var v$6189 = document.createTextNode(". The IDE ");
var e$5068 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5068,v$6188);
(function(e,a){return e.appendChild(a);})(e$5068,v$6189);
v$6186 = e$5068;
var v$6187 = document.createTextNode(" allows for the user to save source files in a personal Dropbox App folder using ");
var e$5064 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5064,v$6186);
(function(e,a){return e.appendChild(a);})(e$5064,v$6187);
v$6184 = e$5064;
var v$6185;
var attrs$6857 = [["href","https://www.dropbox.com/developers/documentation/http/overview"],[["target","_blank"],null]];
var elem$6858 = document.createTextNode("Dropbox API v2");
var newelem$6859 = document.createElement("a");
var fix$10745 = {};
fix$10745.$app = function(v$6861){lab$app: while (true) {if (v$6861 == null) {return 0;
} else {var v$6862 = v$6861;
var v$6863 = v$6862[0];
var v$6864 = v$6862[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6859,v$6863[0],v$6863[1]);
var t$10746 = v$6864;
var v$6861 = t$10746;
continue lab$app;
};
};
};
var app$6860 = fix$10745.$app;
app$6860(attrs$6857);
(function(e,a){return e.appendChild(a);})(newelem$6859,elem$6858);
v$6185 = newelem$6859;
var e$5060 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5060,v$6184);
(function(e,a){return e.appendChild(a);})(e$5060,v$6185);
v$6182 = e$5060;
var v$6183 = document.createTextNode(".");
var e$5056 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5056,v$6182);
(function(e,a){return e.appendChild(a);})(e$5056,v$6183);
elem$5046 = e$5056;
var newelem$5047 = document.createElement("p");
var fix$10747 = {};
fix$10747.$app = function(v$5049){lab$app: while (true) {if (v$5049 == null) {return 0;
} else {var v$5050 = v$5049;
var v$5051 = v$5050[0];
var v$5052 = v$5050[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$5047,v$5051[0],v$5051[1]);
var t$10748 = v$5052;
var v$5049 = t$10748;
continue lab$app;
};
};
};
var app$5048 = fix$10747.$app;
app$5048(attrs$5045);
(function(e,a){return e.appendChild(a);})(newelem$5047,elem$5046);
v$6180 = newelem$5047;
var v$6181;
var attrs$5096 = null;
var elem$5097;
var v$6200;
var v$6202;
var v$6204;
var v$6206;
var v$6208;
var v$6210;
var v$6212 = document.createTextNode(" The sources for this IDE are");
var v$6213 = document.createTextNode(" available by download from the ");
var e$5131 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5131,v$6212);
(function(e,a){return e.appendChild(a);})(e$5131,v$6213);
v$6210 = e$5131;
var v$6211;
var attrs$6866 = [["href","https://github.com/melsman/mlkit"],[["target","_blank"],null]];
var elem$6867 = document.createTextNode("Github MLKit Repository");
var newelem$6868 = document.createElement("a");
var fix$10749 = {};
fix$10749.$app = function(v$6870){lab$app: while (true) {if (v$6870 == null) {return 0;
} else {var v$6871 = v$6870;
var v$6872 = v$6871[0];
var v$6873 = v$6871[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6868,v$6872[0],v$6872[1]);
var t$10750 = v$6873;
var v$6870 = t$10750;
continue lab$app;
};
};
};
var app$6869 = fix$10749.$app;
app$6869(attrs$6866);
(function(e,a){return e.appendChild(a);})(newelem$6868,elem$6867);
v$6211 = newelem$6868;
var e$5127 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5127,v$6210);
(function(e,a){return e.appendChild(a);})(e$5127,v$6211);
v$6208 = e$5127;
var v$6209 = document.createTextNode(" and are distributed");
var e$5123 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5123,v$6208);
(function(e,a){return e.appendChild(a);})(e$5123,v$6209);
v$6206 = e$5123;
var v$6207 = document.createTextNode(" under the GPL2 license; some parts of the sources are also available under the MIT license.");
var e$5119 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5119,v$6206);
(function(e,a){return e.appendChild(a);})(e$5119,v$6207);
v$6204 = e$5119;
var v$6205 = document.createTextNode(" For information about licenses, please consult the sources at the ");
var e$5115 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5115,v$6204);
(function(e,a){return e.appendChild(a);})(e$5115,v$6205);
v$6202 = e$5115;
var v$6203;
var attrs$6875 = [["href","https://github.com/melsman/mlkit"],[["target","_blank"],null]];
var elem$6876 = document.createTextNode("Github MLKit Repository");
var newelem$6877 = document.createElement("a");
var fix$10751 = {};
fix$10751.$app = function(v$6879){lab$app: while (true) {if (v$6879 == null) {return 0;
} else {var v$6880 = v$6879;
var v$6881 = v$6880[0];
var v$6882 = v$6880[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6877,v$6881[0],v$6881[1]);
var t$10752 = v$6882;
var v$6879 = t$10752;
continue lab$app;
};
};
};
var app$6878 = fix$10751.$app;
app$6878(attrs$6875);
(function(e,a){return e.appendChild(a);})(newelem$6877,elem$6876);
v$6203 = newelem$6877;
var e$5111 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5111,v$6202);
(function(e,a){return e.appendChild(a);})(e$5111,v$6203);
v$6200 = e$5111;
var v$6201 = document.createTextNode(".");
var e$5107 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5107,v$6200);
(function(e,a){return e.appendChild(a);})(e$5107,v$6201);
elem$5097 = e$5107;
var newelem$5098 = document.createElement("p");
var fix$10753 = {};
fix$10753.$app = function(v$5100){lab$app: while (true) {if (v$5100 == null) {return 0;
} else {var v$5101 = v$5100;
var v$5102 = v$5101[0];
var v$5103 = v$5101[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$5098,v$5102[0],v$5102[1]);
var t$10754 = v$5103;
var v$5100 = t$10754;
continue lab$app;
};
};
};
var app$5099 = fix$10753.$app;
app$5099(attrs$5096);
(function(e,a){return e.appendChild(a);})(newelem$5098,elem$5097);
v$6181 = newelem$5098;
var e$5043 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5043,v$6180);
(function(e,a){return e.appendChild(a);})(e$5043,v$6181);
return e$5043;
};
smltojs0$0SmlToJsCompApp$1$2.menu$2719 = function(tabs$2722,fts$2725,closetab$2728){var v$6214;
var h$5143 = [["region","center"],[smltojs0$0SmlToJsCompApp$1$2.menuStyle$1306,null]];
v$6214 = (function(f$5144){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/MenuBar",function(MenuBar$5145){var menubar$5146;
var t$10760 = MenuBar$5145;
var t$10759;
var fix$10755 = {};
fix$10755.$foldl = function(v$5148,v$5149){lab$foldl: while (true) {if (v$5149 == null) {return v$5148;
} else {var v$5150 = v$5149;
var v$5151 = v$5150[0];
var v$5152 = v$5150[1];
var t$10756;
var v$5153 = v$5151[0];
var v$5154 = v$5151[1];
(function(fp,s,v){fp[s] = v;})(v$5148,v$5153,v$5154);
t$10756 = v$5148;
var t$10757 = t$10756;
var t$10758 = v$5152;
var v$5148 = t$10757;
var v$5149 = t$10758;
continue lab$foldl;
};
};
};
var foldl$5147 = fix$10755.$foldl;
var v$10095 = (function(){return {};})();
t$10759 = (foldl$5147(v$10095,h$5143));
menubar$5146 = ((function(c,h){return new c(h);})(t$10760,t$10759));
return f$5144([menubar$5146,[menubar$5146,true]]);
});
});
return function(c$5141){return v$6214(function(v$5142){var v$9038 = v$5142[0];
var v$9039 = v$5142[1];
var v$9040 = (dojo$0dojo$1.menu$801(v$9039[0],v$9039[1]))("File");
return v$9040(function(v$9042){var v$9043 = (dojo$0dojo$1.item$827(v$9042[0],v$9042[1]))(["New file",[0,dojo$0dojo$1.newPage$3265],function(v$9044){var content$9045;
var t$10765;
var t$10764 = "(* File created ";
var t$10763;
var t$10762 = basis$0Date$1.toString$826;
var t$10761;
var v$10042 = SmlPrims.getrealtime();
t$10761 = (basis$0Date$1.fromTimeLocal$512(v$10042[0],v$10042[1]));
t$10763 = (t$10762(t$10761));
t$10765 = (t$10764 + t$10763);
content$9045 = (t$10765 + " *)\n");
var t$10777 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2376;
var t$10776 = "Create";
var t$10775 = "New File";
var t$10774 = function(s$9046){return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabs$2722[0],tabs$2722[1]))(s$9046))(content$9045);
};
var t$10773 = [1];
var t$10772 = "Name";
var t$10771;
var fix$10766 = {};
fix$10766.$suggest = function(f$9048){lab$suggest: while (true) {var num$9049 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$9050 = f$9048(num$9049);
var t$10769;
var fix$10767 = {};
fix$10767.$exists = function(v$9052){lab$exists: while (true) {if (v$9052 == null) {return false;
} else {var v$9053 = v$9052;
var v$9054 = v$9053[0];
var v$9055 = v$9053[1];
if (v$9054 == name$9050) {return true;
} else {var t$10768 = v$9055;
var v$9052 = t$10768;
continue lab$exists;
};
};
};
};
var exists$9051 = fix$10767.$exists;
t$10769 = (exists$9051(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10769) {var t$10770 = f$9048;
var f$9048 = t$10770;
continue lab$suggest;
} else {return name$9050;
};
};
};
var suggest$9047 = fix$10766.$suggest;
t$10771 = (suggest$9047(function(num$9056){return ("Untitled-" + (basis$0Int32$1.toString$458(num$9056))) + ".sml";
}));
return t$10777(t$10776,t$10775,t$10774,t$10773,t$10772,t$10771,function(v$10099){return smltojs0$0SmlToJsCompApp$1$2.newFile$1837(fts$2725,content$9045,v$10099);
});
}]);
return v$9043(function(v$9057){var v$9058 = (dojo$0dojo$1.item$827(v$9042[0],v$9042[1]))(["New folder",[0,dojo$0dojo$1.folderClosed$3224],function(v$10004){var t$10789 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2376;
var t$10788 = "Create";
var t$10787 = "New Folder";
var t$10786 = function(s$10005){return 0;
};
var t$10785 = [1];
var t$10784 = "Name";
var t$10783;
var fix$10778 = {};
fix$10778.$suggest = function(f$10007){lab$suggest: while (true) {var num$10008 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$10009 = f$10007(num$10008);
var t$10781;
var fix$10779 = {};
fix$10779.$exists = function(v$10011){lab$exists: while (true) {if (v$10011 == null) {return false;
} else {var v$10012 = v$10011;
var v$10013 = v$10012[0];
var v$10014 = v$10012[1];
if (v$10013 == name$10009) {return true;
} else {var t$10780 = v$10014;
var v$10011 = t$10780;
continue lab$exists;
};
};
};
};
var exists$10010 = fix$10779.$exists;
t$10781 = (exists$10010(smltojs0$0SmlToJsCompApp$1$2.alldirs$1418[0]));
if (t$10781) {var t$10782 = f$10007;
var f$10007 = t$10782;
continue lab$suggest;
} else {return name$10009;
};
};
};
var suggest$10006 = fix$10778.$suggest;
t$10783 = (suggest$10006(function(num$10015){return "Folder-" + (basis$0Int32$1.toString$458(num$10015));
}));
return t$10789(t$10788,t$10787,t$10786,t$10785,t$10784,t$10783,function(v$10101){return smltojs0$0SmlToJsCompApp$1$2.newFolder$1855(fts$2725,v$10101);
});
}]);
return v$9058(function(v$9059){var v$9060 = (dojo$0dojo$1.item$827(v$9042[0],v$9042[1]))(["Move",[0,dojo$0dojo$1.paste$3236],function(v$9061){var path$9062 = smltojs0$0SmlToJsCompApp$1$2.current$1420[0];
var intro$9063 = document.createTextNode("Files can be renamed or moved either using relative paths ('..' is not supported) or using absolute paths (starting with '/').");
var v$9064 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1422(path$9062);
var v$9065 = v$9064[1];
switch (v$9065[0]) { case 0: {var v$9066 = v$9064[0];
var v$9067 = v$9065[1];
return smltojs0$0SmlToJsCompApp$1$2.withDialog$2376("Move","Move/Rename File",function(v$9068){var v$9069 = v$9068[0];
var v$9070 = v$9068[1];
closetab$2728(path$9062);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabs$2722[0],tabs$2722[1]))(v$9069))(v$9070);
},[0,intro$9063],"New name",v$9067,function(v$10105){return smltojs0$0SmlToJsCompApp$1$2.move$2135(fts$2725,v$9066,v$9067,v$10105);
});
 break; }default: {return notify0$1026("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Renaming of folders not supported");
} };
}]);
return v$9060(function(v$9071){var v$9072 = (dojo$0dojo$1.item$827(v$9042[0],v$9042[1]))(["Delete",[0,dojo$0dojo$1.delete$3237],function(v$10108){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_FilesDelete$2555(fts$2725,closetab$2728,v$10108);
}]);
return v$9072(function(v$9073){var v$9074 = (dojo$0dojo$1.item$827(v$9042[0],v$9042[1]))(["Export (zip)",[0,dojo$0dojo$1.indent$3252],function(v$9075){var v$10148 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Files Export to Zip",v$10148);
}]);
return v$9074(function(v$9076){var v$9077 = (dojo$0dojo$1.item$827(v$9042[0],v$9042[1]))(["Import (zip)",[0,dojo$0dojo$1.outdent$3253],function(v$9078){var v$10150 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Files Import from Zip",v$10150);
}]);
return v$9077(function(v$9079){var v$9080;
switch (smltojs0$0SmlToJsCompApp$1$1.demoinput$76[0]) { case 1: {var a$9081 = 0;
v$9080 = (function(f$9082){return f$9082(a$9081);
});
 break; }default: {var v$9083 = smltojs0$0SmlToJsCompApp$1$1.demoinput$76[1];
v$9080 = ((dojo$0dojo$1.item$827(v$9042[0],v$9042[1]))(["Open Demo File",[1],function(v$9084){var name$9085;
var fix$10790 = {};
fix$10790.$suggest = function(f$9087){lab$suggest: while (true) {var num$9088 = [count$1747[0],(count$1747[0] = (SmlPrims.chk_ovf_i32(count$1747[0] + 1)),0)][0];
var name$9089 = f$9087(num$9088);
var t$10793;
var fix$10791 = {};
fix$10791.$exists = function(v$9091){lab$exists: while (true) {if (v$9091 == null) {return false;
} else {var v$9092 = v$9091;
var v$9093 = v$9092[0];
var v$9094 = v$9092[1];
if (v$9093 == name$9089) {return true;
} else {var t$10792 = v$9094;
var v$9091 = t$10792;
continue lab$exists;
};
};
};
};
var exists$9090 = fix$10791.$exists;
t$10793 = (exists$9090(smltojs0$0SmlToJsCompApp$1$2.allfiles$1417[0]));
if (t$10793) {var t$10794 = f$9087;
var f$9087 = t$10794;
continue lab$suggest;
} else {return name$9089;
};
};
};
var suggest$9086 = fix$10790.$suggest;
name$9085 = (suggest$9086(function(num$9095){return ("Demo-" + (basis$0Int32$1.toString$458(num$9095))) + ".sml";
}));
var path$9096 = smltojs0$0SmlToJsCompApp$1$2.newFile$1837(fts$2725,v$9083,name$9085);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(tabs$2722[0],tabs$2722[1]))(path$9096))(v$9083);
}]));
} };
return v$9080(function(v$9097){var v$9098;
switch (smltojs0$0SmlToJsCompApp$1$1.dropboxKey$210[0]) { case 1: {var a$9099 = 0;
v$9098 = (function(f$9100){return f$9100(a$9099);
});
 break; }default: {var v$9101 = smltojs0$0SmlToJsCompApp$1$1.dropboxKey$210[1];
var v$9102 = (dojo$0dojo$1.menu$801(v$9039[0],v$9039[1]))("Dropbox");
v$9098 = (function(c$9103){return v$9102(function(v$9104){var c$9105 = appfun2$0dropbox$1.client$91(v$9101);
if (appfun2$0dropbox$1.isAuthorized$99(c$9105)) {smltojs0$0SmlToJsCompApp$1$2.load$1634(c$9105,fts$2725);
appfun2$0dropbox$1.dropboxUid$212(c$9105,function(uid$9106){var s$9107 = ("Authorized to use " + uid$9106) + "'s Dropbox App Folder";
notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,s$9107);
var s$9108;
var t$10800;
var t$10799;
var t$10798;
var t$10797 = basis$0Date$1.fmt$816;
var t$10796 = "%H:%M:%S";
var t$10795;
var v$10043 = SmlPrims.getrealtime();
t$10795 = (basis$0Date$1.fromTimeLocal$512(v$10043[0],v$10043[1]));
t$10798 = (t$10797(t$10796,t$10795));
t$10799 = (t$10798 + ": ");
t$10800 = (t$10799 + s$9107);
s$9108 = (t$10800 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$9108));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
});
(function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981,"src","dropbox.png");
} else {notify0$1026("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980,"Not Dropbox authorized");
var s$9109;
var t$10806;
var t$10805;
var t$10804;
var t$10803 = basis$0Date$1.fmt$816;
var t$10802 = "%H:%M:%S";
var t$10801;
var v$10044 = SmlPrims.getrealtime();
t$10801 = (basis$0Date$1.fromTimeLocal$512(v$10044[0],v$10044[1]));
t$10804 = (t$10803(t$10802,t$10801));
t$10805 = (t$10804 + ": ");
t$10806 = (t$10805 + "Not Dropbox authorized");
s$9109 = (t$10806 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$975,document.createTextNode(s$9109));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$975);
};
var m$9110;
var v$9111 = (dojo$0dojo$1.item$827(v$9104[0],v$9104[1]))(["Sign in",[0,dojo$0dojo$1.createLink$3272],function(v$10110){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignIn$2641(v$9101,v$10110);
}]);
m$9110 = (function(c$9112){return v$9111(function(v$9113){return ((dojo$0dojo$1.item$827(v$9104[0],v$9104[1]))(["Sign out",[0,dojo$0dojo$1.unlink$3273],function(v$10114){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignOut$2664(c$9105,fts$2725,closetab$2728,v$10114);
}]))(c$9112);
});
});
m$9110(function(x$9114){return x$9114;
});
var a$9115 = 0;
return c$9103(a$9115);
});
});
} };
return v$9098(function(v$9116){var v$9117 = (dojo$0dojo$1.item$827(v$9039[0],v$9039[1]))(["Compile->Run",[1],function(v$10185){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_CompileAndRun$2689(v$10185);
}]);
return v$9117(function(v$9118){var v$9119 = (dojo$0dojo$1.item$827(v$9039[0],v$9039[1]))(["Clear output",[1],function(v$9120){var fix$10807 = {};
fix$10807.$whileSome = function(g$9122){lab$whileSome: while (true) {var v$9123 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
switch (v$9123[0]) { case 0: {var v$9124 = v$9123[1];
g$9122(v$9124);
var t$10808 = g$9122;
var g$9122 = t$10808;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$9121 = fix$10807.$whileSome;
return whileSome$9121(function(e$9125){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,e$9125);
});
}]);
return v$9119(function(v$9126){var v$9127;
var h$9128 = [["region","left"],[["style","padding:0;padding-right:10;background-color:#eeeeee;"],null]];
v$9127 = (function(f$9129){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9130){var p$9131;
var t$10814 = Cp$9130;
var t$10813;
var fix$10809 = {};
fix$10809.$foldl = function(v$9133,v$9134){lab$foldl: while (true) {if (v$9134 == null) {return v$9133;
} else {var v$9135 = v$9134;
var v$9136 = v$9135[0];
var v$9137 = v$9135[1];
var t$10810;
var v$9138 = v$9136[0];
var v$9139 = v$9136[1];
(function(fp,s,v){fp[s] = v;})(v$9133,v$9138,v$9139);
t$10810 = v$9133;
var t$10811 = t$10810;
var t$10812 = v$9137;
var v$9133 = t$10811;
var v$9134 = t$10812;
continue lab$foldl;
};
};
};
var foldl$9132 = fix$10809.$foldl;
var v$10115 = (function(){return {};})();
t$10813 = (foldl$9132(v$10115,h$9128));
p$9131 = ((function(c,h){return new c(h);})(t$10814,t$10813));
(function(w,e){w.set('content', e);})(p$9131,smltojs0$0SmlToJsCompApp$1$2.logo$1305);
return f$9129(p$9131);
});
});
return v$9127(function(v$9140){var v$9141;
var h$9142 = [["region","right"],[smltojs0$0SmlToJsCompApp$1$2.menuStyle$1306,null]];
v$9141 = (function(f$9143){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/MenuBar",function(MenuBar$9144){var menubar$9145;
var t$10820 = MenuBar$9144;
var t$10819;
var fix$10815 = {};
fix$10815.$foldl = function(v$9147,v$9148){lab$foldl: while (true) {if (v$9148 == null) {return v$9147;
} else {var v$9149 = v$9148;
var v$9150 = v$9149[0];
var v$9151 = v$9149[1];
var t$10816;
var v$9152 = v$9150[0];
var v$9153 = v$9150[1];
(function(fp,s,v){fp[s] = v;})(v$9147,v$9152,v$9153);
t$10816 = v$9147;
var t$10817 = t$10816;
var t$10818 = v$9151;
var v$9147 = t$10817;
var v$9148 = t$10818;
continue lab$foldl;
};
};
};
var foldl$9146 = fix$10815.$foldl;
var v$10117 = (function(){return {};})();
t$10819 = (foldl$9146(v$10117,h$9142));
menubar$9145 = ((function(c,h){return new c(h);})(t$10820,t$10819));
return f$9143([menubar$9145,[menubar$9145,true]]);
});
});
return v$9141(function(v$9154){var v$9155 = v$9154[0];
var v$9156 = v$9154[1];
var v$9157 = (dojo$0dojo$1.menu$801(v$9156[0],v$9156[1]))("Help");
return v$9157(function(v$9158){var v$9159 = (dojo$0dojo$1.item$827(v$9158[0],v$9158[1]))(["About",[0,dojo$0dojo$1.newPage$3265],function(v$9160){var v$10152 = smltojs0$0SmlToJsCompApp$1$1.about$58(0);
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","About SMLtoJs Online",v$10152);
}]);
return v$9159(function(v$9161){var v$9162 = (dojo$0dojo$1.item$827(v$9158[0],v$9158[1]))(["Powered by...",[0,dojo$0dojo$1.newPage$3265],function(v$9163){var v$10154 = smltojs0$0SmlToJsCompApp$1$2.poweredby$2702(0);
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2469("Ok","Powered by...",v$10154);
}]);
return v$9162(function(v$9164){return ((dojo$0dojo$1.layoutContainer$316([["region","top"],[["style","height:30px;"],null]]))([v$9140,[v$9038,[v$9155,null]]]))(c$5141);
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
};
};
smltojs0$0SmlToJsCompApp$1$2.everything$2812;
var v$6280 = dojo$0dojo$1.advTabContainer$571([["region","top"],[["splitter","true"],[["style","height:70%;border:0;"],[["tabPosition","bottom"],null]]]]);
smltojs0$0SmlToJsCompApp$1$2.everything$2812 = (function(c$5322){return v$6280(function(v$5323){var v$9893 = v$5323[0];
var v$9894 = v$5323[1];
var v$9895 = v$9894[1];
var v$9896 = v$9894[0];
var v$9897;
var v$10119 = [[["id","0"],[["name","/"],[["kind","folder"],null]]],smltojs0$0SmlToJsCompApp$1$2.ftsServer$2272];
v$9897 = (function(v$10120){return dojo$0dojo$1.treeStore$481(v$10119,v$10120);
});
return v$9897(function(v$9899){var v$9900 = (((dojo$0dojo$1.tree$567([["region","left"],[["splitter","true"],[["style","width:20%;"],null]]]))("0"))(function(v$9901){var v$9902 = v$9901[0];
var t$10821;
if (v$9902 == "0") {t$10821 = true;
} else {var fields$9903 = basis$0String$1.fields$231(function(c$9904){return c$9904 == 47;
},v$9902);
var fix$10822 = {};
fix$10822.$all = function(v$9906){lab$all: while (true) {if (v$9906 == null) {return true;
} else {var v$9907 = v$9906;
var v$9908 = v$9907[0];
var v$9909 = v$9907[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1332(v$9908)) {var t$10823 = v$9909;
var v$9906 = t$10823;
continue lab$all;
} else {return false;
};
};
};
};
var all$9905 = fix$10822.$all;
t$10821 = (all$9905(fields$9903));
};
if (t$10821) {return (smltojs0$0SmlToJsCompApp$1$2.current$1420[0] = v$9902,0);
} else {return smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1662(v$9902,function(v$9910){switch (v$9910[0]) { case 0: {var v$9911 = v$9910[1];
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2334(v$9893[0],v$9893[1]))(v$9902))(v$9911);
 break; }default: {return v$9895(v$9902);
} };
});
};
}))(v$9899);
return v$9900(function(v$9912){var v$9913 = smltojs0$0SmlToJsCompApp$1$2.menu$2719(v$9893,v$9899,v$9896);
return v$9913(function(v$9914){var v$9915;
var h$9916 = [["title","Output"],null];
v$9915 = (function(f$9917){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9918){var p$9919;
var t$10829 = Cp$9918;
var t$10828;
var fix$10824 = {};
fix$10824.$foldl = function(v$9921,v$9922){lab$foldl: while (true) {if (v$9922 == null) {return v$9921;
} else {var v$9923 = v$9922;
var v$9924 = v$9923[0];
var v$9925 = v$9923[1];
var t$10825;
var v$9926 = v$9924[0];
var v$9927 = v$9924[1];
(function(fp,s,v){fp[s] = v;})(v$9921,v$9926,v$9927);
t$10825 = v$9921;
var t$10826 = t$10825;
var t$10827 = v$9925;
var v$9921 = t$10826;
var v$9922 = t$10827;
continue lab$foldl;
};
};
};
var foldl$9920 = fix$10824.$foldl;
var v$10121 = (function(){return {};})();
t$10828 = (foldl$9920(v$10121,h$9916));
p$9919 = ((function(c,h){return new c(h);})(t$10829,t$10828));
(function(w,e){w.set('content', e);})(p$9919,smltojs0$0SmlToJsCompApp$1$2.outareaDiv$974);
return f$9917(p$9919);
});
});
return v$9915(function(v$9928){var v$9929;
var h$9930 = [["title","Message Log"],null];
v$9929 = (function(f$9931){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9932){var p$9933;
var t$10835 = Cp$9932;
var t$10834;
var fix$10830 = {};
fix$10830.$foldl = function(v$9935,v$9936){lab$foldl: while (true) {if (v$9936 == null) {return v$9935;
} else {var v$9937 = v$9936;
var v$9938 = v$9937[0];
var v$9939 = v$9937[1];
var t$10831;
var v$9940 = v$9938[0];
var v$9941 = v$9938[1];
(function(fp,s,v){fp[s] = v;})(v$9935,v$9940,v$9941);
t$10831 = v$9935;
var t$10832 = t$10831;
var t$10833 = v$9939;
var v$9935 = t$10832;
var v$9936 = t$10833;
continue lab$foldl;
};
};
};
var foldl$9934 = fix$10830.$foldl;
var v$10123 = (function(){return {};})();
t$10834 = (foldl$9934(v$10123,h$9930));
p$9933 = ((function(c,h){return new c(h);})(t$10835,t$10834));
(function(w,e){w.set('content', e);})(p$9933,smltojs0$0SmlToJsCompApp$1$2.logareaDiv$976);
return f$9931(p$9933);
});
});
return v$9929(function(v$9942){var v$9943 = (dojo$0dojo$1.tabContainer$314([["region","center"],[["style","height:30%;"],[["tabPosition","bottom"],null]]]))([v$9928,[v$9942,null]]);
return v$9943(function(v$9944){var v$9945 = (dojo$0dojo$1.borderContainer$315([["region","center"],null]))([v$9893[0],[v$9944,null]]);
return v$9945(function(v$9946){var v$9947;
switch (smltojs0$0SmlToJsCompApp$1$1.rightPane$212[0]) { case 0: {var v$9948 = smltojs0$0SmlToJsCompApp$1$1.rightPane$212[1];
var v$9949;
var h$9950 = [["region","right"],[["splitter","true"],null]];
var e$9951 = v$9948(0);
v$9949 = (function(f$9952){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9953){var p$9954;
var t$10841 = Cp$9953;
var t$10840;
var fix$10836 = {};
fix$10836.$foldl = function(v$9956,v$9957){lab$foldl: while (true) {if (v$9957 == null) {return v$9956;
} else {var v$9958 = v$9957;
var v$9959 = v$9958[0];
var v$9960 = v$9958[1];
var t$10837;
var v$9961 = v$9959[0];
var v$9962 = v$9959[1];
(function(fp,s,v){fp[s] = v;})(v$9956,v$9961,v$9962);
t$10837 = v$9956;
var t$10838 = t$10837;
var t$10839 = v$9960;
var v$9956 = t$10838;
var v$9957 = t$10839;
continue lab$foldl;
};
};
};
var foldl$9955 = fix$10836.$foldl;
var v$10125 = (function(){return {};})();
t$10840 = (foldl$9955(v$10125,h$9950));
p$9954 = ((function(c,h){return new c(h);})(t$10841,t$10840));
(function(w,e){w.set('content', e);})(p$9954,e$9951);
return f$9952(p$9954);
});
});
v$9947 = (function(c$9963){return v$9949(function(v$9964){var a$9965 = [v$9964,null];
return c$9963(a$9965);
});
});
 break; }default: {var a$9966 = null;
v$9947 = (function(f$9967){return f$9967(a$9966);
});
} };
return v$9947(function(v$9968){return ((dojo$0dojo$1.borderContainer$315([["style","height: 100%; width: 100%;"],null]))(basis$0List$1.s$n$686([v$9912,[v$9914,[v$9946,null]]],v$9968)))(c$5322);
});
});
});
});
});
});
});
});
});
});
var t$10842;
var v$5415 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5415[0]) { case 0: {t$10842 = v$5415[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
(function(e,a){return e.appendChild(a);})(t$10842,smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$980);
var t$10843;
var v$5421 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5421[0]) { case 0: {t$10843 = v$5421[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
(function(e,a){return e.appendChild(a);})(t$10843,smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$981);
var t$10845 = dojo$0dojo$1.attachToElement$201;
var t$10844;
var v$5425 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5425[0]) { case 0: {t$10844 = v$5425[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
t$10845(t$10844,smltojs0$0SmlToJsCompApp$1$2.everything$2812,function(v$2883){return 0;
});
smltojs0$0SmlToJsCompApp$1$2.onload$2863 = function(v$2865){var v$5429 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123);
switch (v$5429[0]) { case 0: {var v$5430 = v$5429[1];
var v$5431 = (function(e){return SmlPrims.option(e.nextSibling);})(v$5430);
switch (v$5431[0]) { case 0: {var v$5432 = v$5431[1];
var v$5433 = (function(e){return SmlPrims.option(e.nextSibling);})(v$5432);
switch (v$5433[0]) { case 0: {(function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1123,v$5433[1]);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody2"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody3"];
} };
(smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0] = (function(s$5438){(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$973,document.createTextNode(s$5438));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$973);
}),0);
smltojs0$0SmlToJsCompApp$1$1.onloadhook$155(function(s$5443){return smltojs0$0SmlToJsCompApp$1$2.outRef$1053[0](s$5443);
});
(function(i,f){return setInterval(f,i);})(10000,function(v$5446){var fix$10846 = {};
fix$10846.$app = function(v$5448){lab$app: while (true) {if (v$5448 == null) {return 0;
} else {var v$5449 = v$5448;
var v$5450 = v$5449[0];
var v$5451 = v$5449[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2047(v$5450[0],v$5450[1],v$5450[2]);
var t$10847 = v$5451;
var v$5448 = t$10847;
continue lab$app;
};
};
};
var app$5447 = fix$10846.$app;
return app$5447(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1421[0]);
});
return 0;
};
smltojs0$0SmlToJsCompApp$1$2.setWindowOnload$2872 = function(f$2875){return (function(a){return window.onload=a;})(f$2875);
};
(function(a){return window.onload=a;})(function(v$10186){return smltojs0$0SmlToJsCompApp$1$2.onload$2863(v$10186);
});
return 0;
})();
