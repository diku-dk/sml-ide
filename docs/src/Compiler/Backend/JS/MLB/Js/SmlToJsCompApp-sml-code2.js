if ((typeof(smltojs0$0SmlToJsCompApp$1$2)) == "undefined") {smltojs0$0SmlToJsCompApp$1$2 = {};
};
(function(){smltojs0$0SmlToJsCompApp$1$2.scrollDown$902 = function(e$905){return (function(t){t.scrollTop = t.scrollHeight;})(e$905);
};
smltojs0$0SmlToJsCompApp$1$2.userAgent$909 = function(v$911){return (function(){return navigator.userAgent;})();
};
smltojs0$0SmlToJsCompApp$1$2.agent$914 = basis$0String$1.translate$217(function(x$2928){return basis$0Char$1.toString$277(((65 <= x$2928)?(x$2928 <= 90):false)?(SmlPrims.chk_ovf_i32(x$2928 + 32)):x$2928);
},(function(){return navigator.userAgent;})());
smltojs0$0SmlToJsCompApp$1$2.touchDevices$915 = ["ipod",["ipad",["iphone",["series60",["symbian",["android",["windows ce",["blackberry",null]]]]]]]];
smltojs0$0SmlToJsCompApp$1$2.touchScreen$916 = function(a$919){var fix$10161 = {};
fix$10161.$exists = function(v$2938){lab$exists: while (true) {if (v$2938 == null) {return false;
} else {var v$2939 = v$2938;
var v$2940 = v$2939[0];
var v$2941 = v$2939[1];
if (basis$0String$1.isSubstring$268(v$2940,a$919)) {return true;
} else {var t$10162 = v$2941;
var v$2938 = t$10162;
continue lab$exists;
};
};
};
};
var exists$2937 = fix$10161.$exists;
return exists$2937(smltojs0$0SmlToJsCompApp$1$2.touchDevices$915);
};
smltojs0$0SmlToJsCompApp$1$2.serverGet$927 = function(file$930){var file$931;
var t$10166 = file$930 + "?_=";
var t$10165;
var t$10164 = basis$0Real$1.toString$153;
var t$10163;
var v$2945 = SmlPrims.getrealtime();
t$10163 = ((v$2945[0] - (-2147483648)) + (v$2945[1] / 1000000.0));
t$10165 = (t$10164(t$10163));
file$931 = (t$10166 + t$10165);
var r$932 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$932,"GET",file$931,false);
js$0Js$1.send$654(r$932,[1]);
var v$939 = (function(r){return SmlPrims.option(r.responseText);})(r$932);
switch (v$939[0]) { case 0: {return v$939[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$931];
} };
};
smltojs0$0SmlToJsCompApp$1$2.outarea$947;
var attrs$2953 = [["readonly","readonly"],null];
var newelem$2954 = document.createElement("textarea");
var fix$10167 = {};
fix$10167.$app = function(v$2956){lab$app: while (true) {if (v$2956 == null) {return 0;
} else {var v$2957 = v$2956;
var v$2958 = v$2957[0];
var v$2959 = v$2957[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2954,v$2958[0],v$2958[1]);
var t$10168 = v$2959;
var v$2956 = t$10168;
continue lab$app;
};
};
};
var app$2955 = fix$10167.$app;
app$2955(attrs$2953);
smltojs0$0SmlToJsCompApp$1$2.outarea$947 = newelem$2954;
smltojs0$0SmlToJsCompApp$1$2.outareaDiv$948;
var attrs$2961 = [["class","textareacontainer"],null];
var newelem$2963 = document.createElement("div");
var fix$10169 = {};
fix$10169.$app = function(v$2965){lab$app: while (true) {if (v$2965 == null) {return 0;
} else {var v$2966 = v$2965;
var v$2967 = v$2966[0];
var v$2968 = v$2966[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2963,v$2967[0],v$2967[1]);
var t$10170 = v$2968;
var v$2965 = t$10170;
continue lab$app;
};
};
};
var app$2964 = fix$10169.$app;
app$2964(attrs$2961);
(function(e,a){return e.appendChild(a);})(newelem$2963,smltojs0$0SmlToJsCompApp$1$2.outarea$947);
smltojs0$0SmlToJsCompApp$1$2.outareaDiv$948 = newelem$2963;
smltojs0$0SmlToJsCompApp$1$2.logarea$949;
var attrs$2970 = [["readonly","readonly"],null];
var newelem$2971 = document.createElement("textarea");
var fix$10171 = {};
fix$10171.$app = function(v$2973){lab$app: while (true) {if (v$2973 == null) {return 0;
} else {var v$2974 = v$2973;
var v$2975 = v$2974[0];
var v$2976 = v$2974[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2971,v$2975[0],v$2975[1]);
var t$10172 = v$2976;
var v$2973 = t$10172;
continue lab$app;
};
};
};
var app$2972 = fix$10171.$app;
app$2972(attrs$2970);
smltojs0$0SmlToJsCompApp$1$2.logarea$949 = newelem$2971;
smltojs0$0SmlToJsCompApp$1$2.logareaDiv$950;
var attrs$2978 = [["class","textareacontainer"],null];
var newelem$2980 = document.createElement("div");
var fix$10173 = {};
fix$10173.$app = function(v$2982){lab$app: while (true) {if (v$2982 == null) {return 0;
} else {var v$2983 = v$2982;
var v$2984 = v$2983[0];
var v$2985 = v$2983[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2980,v$2984[0],v$2984[1]);
var t$10174 = v$2985;
var v$2982 = t$10174;
continue lab$app;
};
};
};
var app$2981 = fix$10173.$app;
app$2981(attrs$2978);
(function(e,a){return e.appendChild(a);})(newelem$2980,smltojs0$0SmlToJsCompApp$1$2.logarea$949);
smltojs0$0SmlToJsCompApp$1$2.logareaDiv$950 = newelem$2980;
smltojs0$0SmlToJsCompApp$1$2.clearoutbutton$951;
var attrs$2987 = [["type","button"],[["value","Clear Output"],null]];
var newelem$2988 = document.createElement("input");
var fix$10175 = {};
fix$10175.$app = function(v$2990){lab$app: while (true) {if (v$2990 == null) {return 0;
} else {var v$2991 = v$2990;
var v$2992 = v$2991[0];
var v$2993 = v$2991[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2988,v$2992[0],v$2992[1]);
var t$10176 = v$2993;
var v$2990 = t$10176;
continue lab$app;
};
};
};
var app$2989 = fix$10175.$app;
app$2989(attrs$2987);
smltojs0$0SmlToJsCompApp$1$2.clearoutbutton$951 = newelem$2988;
smltojs0$0SmlToJsCompApp$1$2.nodropboxPng$952 = "nodropbox.png";
smltojs0$0SmlToJsCompApp$1$2.dropboxPng$953 = "dropbox.png";
smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954;
var attrs$2995 = [["class","notify_area"],null];
var elem$2996 = document.createTextNode("welcome!");
var newelem$2997 = document.createElement("div");
var fix$10177 = {};
fix$10177.$app = function(v$2999){lab$app: while (true) {if (v$2999 == null) {return 0;
} else {var v$3000 = v$2999;
var v$3001 = v$3000[0];
var v$3002 = v$3000[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$2997,v$3001[0],v$3001[1]);
var t$10178 = v$3002;
var v$2999 = t$10178;
continue lab$app;
};
};
};
var app$2998 = fix$10177.$app;
app$2998(attrs$2995);
(function(e,a){return e.appendChild(a);})(newelem$2997,elem$2996);
smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954 = newelem$2997;
smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955;
var attrs$3005 = [["src","nodropbox.png"],[["class","dropbox_area"],null]];
var newelem$3006 = document.createElement("img");
var fix$10179 = {};
fix$10179.$app = function(v$3008){lab$app: while (true) {if (v$3008 == null) {return 0;
} else {var v$3009 = v$3008;
var v$3010 = v$3009[0];
var v$3011 = v$3009[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3006,v$3010[0],v$3010[1]);
var t$10180 = v$3011;
var v$3008 = t$10180;
continue lab$app;
};
};
};
var app$3007 = fix$10179.$app;
app$3007(attrs$3005);
smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955 = newelem$3006;
smltojs0$0SmlToJsCompApp$1$2.setNoDropboxPng$956 = function(v$958){return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955,"src","nodropbox.png");
};
smltojs0$0SmlToJsCompApp$1$2.setDropboxPng$959 = function(v$961){return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955,"src","dropbox.png");
};
var notifyTimeout$962 = [[1]];
var notify0$1000 = function(color$1003,e$1006,s$1009){var v$1020 = notifyTimeout$962[0];
switch (v$1020[0]) { case 0: {(function(id){return clearTimeout(id);})(v$1020[1]);
 break; }default: {0;
} };
(function(e,s){e.innerHTML = s;})(e$1006,s$1009);
(function(e,a,b){return e.setAttribute(a,b);})(e$1006,"style",((("opacity:" + (basis$0Real$1.toString$153(1.0))) + "; background-color:") + color$1003) + ";");
var t$10194 = notifyTimeout$962;
var t$10193;
var t$10192;
var t$10191 = 3000;
var t$10190;
var fix$10181 = {};
fix$10181.$fadeNotification = function(opacity$9975,v$9976){lab$fadeNotification: while (true) {if (opacity$9975 < 0.0) {(function(e,a,b){return e.setAttribute(a,b);})(e$1006,"style","opacity:0.0;");
return (notifyTimeout$962[0] = [1],0);
} else {(function(e,a,b){return e.setAttribute(a,b);})(e$1006,"style",((("opacity:" + (basis$0Real$1.toString$153(opacity$9975))) + "; background-color:") + color$1003) + ";");
var t$10189 = notifyTimeout$962;
var t$10188;
var t$10187;
var t$10186 = 50;
var t$10182;
var v$10019 = opacity$9975 - 0.02;
t$10182 = ((function(env$10185){return function(v$10020){var v$10183 = env$10185[0];
var v$10184 = env$10185[1];
return v$10184(v$10183,v$10020);
};
})([v$10019,fix$10181.$fadeNotification]));
t$10187 = ((function(i,f){return setTimeout(f,i);})(t$10186,t$10182));
t$10188 = [0,t$10187];
return (t$10189[0] = t$10188,0);
};
};
};
var fadeNotification$9974 = fix$10181.$fadeNotification;
t$10190 = (function(v$10022){return fadeNotification$9974(0.98,v$10022);
});
t$10192 = ((function(i,f){return setTimeout(f,i);})(t$10191,t$10190));
t$10193 = [0,t$10192];
return (t$10194[0] = t$10193,0);
};
smltojs0$0SmlToJsCompApp$1$2.notify_err$1023 = function(v$10025){return notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,v$10025);
};
smltojs0$0SmlToJsCompApp$1$2.notify_errE$1024 = function(v$10027){return function(v$10028){return notify0$1000("#dd8888",v$10027,v$10028);
};
};
smltojs0$0SmlToJsCompApp$1$2.notify_warn$1025 = function(v$10031){return notify0$1000("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,v$10031);
};
smltojs0$0SmlToJsCompApp$1$2.notify$1026 = function(v$10034){return notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,v$10034);
};
smltojs0$0SmlToJsCompApp$1$2.outRef$1027 = [function(v$1029){throw [basis$0Initial$1.en$Fail$54,"outRef not initialized"];
}];
smltojs0$0SmlToJsCompApp$1$2.out$1030 = function(s$1033){return smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0](s$1033);
};
var fix$10195 = {};
fix$10195.$whileSome = function(f$1037,g$1040){lab$whileSome: while (true) {var v$1045 = f$1037(0);
switch (v$1045[0]) { case 0: {var v$1049 = v$1045[1];
g$1040(v$1049);
var t$10196 = f$1037;
var t$10197 = g$1040;
var f$1037 = t$10196;
var g$1040 = t$10197;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.whileSome$1034 = fix$10195.$whileSome;
smltojs0$0SmlToJsCompApp$1$2.clearoutarea$1050 = function(v$1052){var fix$10198 = {};
fix$10198.$whileSome = function(g$6313){lab$whileSome: while (true) {var v$6314 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
switch (v$6314[0]) { case 0: {var v$6315 = v$6314[1];
g$6313(v$6315);
var t$10199 = g$6313;
var g$6313 = t$10199;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$6312 = fix$10198.$whileSome;
return whileSome$6312(function(e$1057){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,e$1057);
});
};
smltojs0$0SmlToJsCompApp$1$2.outfun$1058 = function(s$1061){(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,document.createTextNode(s$1061));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
};
smltojs0$0SmlToJsCompApp$1$2.clearlogarea$1064 = function(v$1066){var fix$10200 = {};
fix$10200.$whileSome = function(g$6320){lab$whileSome: while (true) {var v$6321 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
switch (v$6321[0]) { case 0: {var v$6322 = v$6321[1];
g$6320(v$6322);
var t$10201 = g$6320;
var g$6320 = t$10201;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$6319 = fix$10200.$whileSome;
return whileSome$6319(function(e$1071){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,e$1071);
});
};
smltojs0$0SmlToJsCompApp$1$2.log0$1072 = function(s$1075){var s$1076;
var t$10207;
var t$10206;
var t$10205;
var t$10204 = basis$0Date$1.fmt$816;
var t$10203 = "%H:%M:%S";
var t$10202;
var v$9990 = SmlPrims.getrealtime();
t$10202 = (basis$0Date$1.fromTimeLocal$512(v$9990[0],v$9990[1]));
t$10205 = (t$10204(t$10203,t$10202));
t$10206 = (t$10205 + ": ");
t$10207 = (t$10206 + s$1075);
s$1076 = (t$10207 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$1076));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
smltojs0$0SmlToJsCompApp$1$2.log$1079 = function(s$1082){notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$1082);
var s$3094;
var t$10213;
var t$10212;
var t$10211;
var t$10210 = basis$0Date$1.fmt$816;
var t$10209 = "%H:%M:%S";
var t$10208;
var v$9991 = SmlPrims.getrealtime();
t$10208 = (basis$0Date$1.fromTimeLocal$512(v$9991[0],v$9991[1]));
t$10211 = (t$10210(t$10209,t$10208));
t$10212 = (t$10211 + ": ");
t$10213 = (t$10212 + s$1082);
s$3094 = (t$10213 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3094));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
smltojs0$0SmlToJsCompApp$1$2.logerr$1085 = function(s$1088){notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$1088);
var s$3103;
var t$10219;
var t$10218;
var t$10217;
var t$10216 = basis$0Date$1.fmt$816;
var t$10215 = "%H:%M:%S";
var t$10214;
var v$9992 = SmlPrims.getrealtime();
t$10214 = (basis$0Date$1.fromTimeLocal$512(v$9992[0],v$9992[1]));
t$10217 = (t$10216(t$10215,t$10214));
t$10218 = (t$10217 + ": ");
t$10219 = (t$10218 + s$1088);
s$3103 = (t$10219 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3103));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
smltojs0$0SmlToJsCompApp$1$2.logwarn$1091 = function(s$1094){notify0$1000("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$1094);
var s$3112;
var t$10225;
var t$10224;
var t$10223;
var t$10222 = basis$0Date$1.fmt$816;
var t$10221 = "%H:%M:%S";
var t$10220;
var v$9993 = SmlPrims.getrealtime();
t$10220 = (basis$0Date$1.fromTimeLocal$512(v$9993[0],v$9993[1]));
t$10223 = (t$10222(t$10221,t$10220));
t$10224 = (t$10223 + ": ");
t$10225 = (t$10224 + s$1094);
s$3112 = (t$10225 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3112));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
smltojs0$0SmlToJsCompApp$1$2.topelem$1097 = (function(d){return d.documentElement;})(js$0Js$1.document$88);
smltojs0$0SmlToJsCompApp$1$2.appendStyleLink$1098 = function(path$1101){var v$1106 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1106[0]) { case 0: {var t$10229 = v$1106[1];
var t$10226;
var attrs$3125 = [["rel","stylesheet"],[["href",path$1101],null]];
var newelem$3126 = document.createElement("link");
var fix$10227 = {};
fix$10227.$app = function(v$3128){lab$app: while (true) {if (v$3128 == null) {return 0;
} else {var v$3129 = v$3128;
var v$3130 = v$3129[0];
var v$3131 = v$3129[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3126,v$3130[0],v$3130[1]);
var t$10228 = v$3131;
var v$3128 = t$10228;
continue lab$app;
};
};
};
var app$3127 = fix$10227.$app;
app$3127(attrs$3125);
t$10226 = newelem$3126;
return (function(e,a){return e.appendChild(a);})(t$10229,t$10226);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.appendIconLink$1109 = function(path$1112){var v$1117 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1117[0]) { case 0: {var t$10233 = v$1117[1];
var t$10230;
var attrs$3136 = [["rel","shortcut icon"],[["type","image/x-icon"],[["href",path$1112],null]]];
var newelem$3137 = document.createElement("link");
var fix$10231 = {};
fix$10231.$app = function(v$3139){lab$app: while (true) {if (v$3139 == null) {return 0;
} else {var v$3140 = v$3139;
var v$3141 = v$3140[0];
var v$3142 = v$3140[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3137,v$3141[0],v$3141[1]);
var t$10232 = v$3142;
var v$3139 = t$10232;
continue lab$app;
};
};
};
var app$3138 = fix$10231.$app;
app$3138(attrs$3136);
t$10230 = newelem$3137;
return (function(e,a){return e.appendChild(a);})(t$10233,t$10230);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.appendScript$1120 = function(path$1123){var v$1128 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1128[0]) { case 0: {var t$10237 = v$1128[1];
var t$10234;
var attrs$3147 = [["type","text/javascript"],[["src",path$1123],null]];
var newelem$3148 = document.createElement("script");
var fix$10235 = {};
fix$10235.$app = function(v$3150){lab$app: while (true) {if (v$3150 == null) {return 0;
} else {var v$3151 = v$3150;
var v$3152 = v$3151[0];
var v$3153 = v$3151[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3148,v$3152[0],v$3152[1]);
var t$10236 = v$3153;
var v$3150 = t$10236;
continue lab$app;
};
};
};
var app$3149 = fix$10235.$app;
app$3149(attrs$3147);
t$10234 = newelem$3148;
return (function(e,a){return e.appendChild(a);})(t$10237,t$10234);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.cleanupBody$1131 = function(v$1133){var v$1138 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1138[0]) { case 0: {var v$1154 = v$1138[1];
var v$1144 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1154);
switch (v$1144[0]) { case 0: {var v$1153 = v$1144[1];
var v$1150 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1153);
switch (v$1150[0]) { case 0: {return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097,v$1150[1]);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody2"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody3"];
} };
};
smltojs0$0SmlToJsCompApp$1$2.createBody$1155 = function(v$1157){var v$1162 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$1162[0]) { case 0: {var v$1173 = v$1162[1];
var v$1170 = (function(e){return SmlPrims.option(e.nextSibling);})(v$1173);
switch (v$1170[0]) { case 0: {(function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097,v$1170[1]);
 break; }default: {0;
} };
var t$10241 = smltojs0$0SmlToJsCompApp$1$2.topelem$1097;
var t$10238;
var attrs$3166 = [["class","claro"],[["id","body"],null]];
var newelem$3167 = document.createElement("body");
var fix$10239 = {};
fix$10239.$app = function(v$3169){lab$app: while (true) {if (v$3169 == null) {return 0;
} else {var v$3170 = v$3169;
var v$3171 = v$3170[0];
var v$3172 = v$3170[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3167,v$3171[0],v$3171[1]);
var t$10240 = v$3172;
var v$3169 = t$10240;
continue lab$app;
};
};
};
var app$3168 = fix$10239.$app;
app$3168(attrs$3166);
t$10238 = newelem$3167;
return (function(e,a){return e.appendChild(a);})(t$10241,t$10238);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"createBody"];
} };
};
var v$6325 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6325[0]) { case 0: {var t$10245 = v$6325[1];
var t$10242;
var attrs$6326 = [["rel","stylesheet"],[["href","dijit/themes/claro/claro.css"],null]];
var newelem$6327 = document.createElement("link");
var fix$10243 = {};
fix$10243.$app = function(v$6329){lab$app: while (true) {if (v$6329 == null) {return 0;
} else {var v$6330 = v$6329;
var v$6331 = v$6330[0];
var v$6332 = v$6330[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6327,v$6331[0],v$6331[1]);
var t$10244 = v$6332;
var v$6329 = t$10244;
continue lab$app;
};
};
};
var app$6328 = fix$10243.$app;
app$6328(attrs$6326);
t$10242 = newelem$6327;
(function(e,a){return e.appendChild(a);})(t$10245,t$10242);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6334 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6334[0]) { case 0: {var t$10249 = v$6334[1];
var t$10246;
var attrs$6335 = [["rel","stylesheet"],[["href","js/codemirror/codemirror.css"],null]];
var newelem$6336 = document.createElement("link");
var fix$10247 = {};
fix$10247.$app = function(v$6338){lab$app: while (true) {if (v$6338 == null) {return 0;
} else {var v$6339 = v$6338;
var v$6340 = v$6339[0];
var v$6341 = v$6339[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6336,v$6340[0],v$6340[1]);
var t$10248 = v$6341;
var v$6338 = t$10248;
continue lab$app;
};
};
};
var app$6337 = fix$10247.$app;
app$6337(attrs$6335);
t$10246 = newelem$6336;
(function(e,a){return e.appendChild(a);})(t$10249,t$10246);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6343 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6343[0]) { case 0: {var t$10253 = v$6343[1];
var t$10250;
var attrs$6344 = [["type","text/javascript"],[["src","js/codemirror/sml.js"],null]];
var newelem$6345 = document.createElement("script");
var fix$10251 = {};
fix$10251.$app = function(v$6347){lab$app: while (true) {if (v$6347 == null) {return 0;
} else {var v$6348 = v$6347;
var v$6349 = v$6348[0];
var v$6350 = v$6348[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6345,v$6349[0],v$6349[1]);
var t$10252 = v$6350;
var v$6347 = t$10252;
continue lab$app;
};
};
};
var app$6346 = fix$10251.$app;
app$6346(attrs$6344);
t$10250 = newelem$6345;
(function(e,a){return e.appendChild(a);})(t$10253,t$10250);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
var v$6352 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6352[0]) { case 0: {var t$10257 = v$6352[1];
var t$10254;
var attrs$6353 = [["rel","stylesheet"],[["href","appfunstyle.css"],null]];
var newelem$6354 = document.createElement("link");
var fix$10255 = {};
fix$10255.$app = function(v$6356){lab$app: while (true) {if (v$6356 == null) {return 0;
} else {var v$6357 = v$6356;
var v$6358 = v$6357[0];
var v$6359 = v$6357[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6354,v$6358[0],v$6358[1]);
var t$10256 = v$6359;
var v$6356 = t$10256;
continue lab$app;
};
};
};
var app$6355 = fix$10255.$app;
app$6355(attrs$6353);
t$10254 = newelem$6354;
(function(e,a){return e.appendChild(a);})(t$10257,t$10254);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
var v$6361 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6361[0]) { case 0: {var t$10261 = v$6361[1];
var t$10258;
var attrs$6362 = [["rel","shortcut icon"],[["type","image/x-icon"],[["href","favicon.ico"],null]]];
var newelem$6363 = document.createElement("link");
var fix$10259 = {};
fix$10259.$app = function(v$6365){lab$app: while (true) {if (v$6365 == null) {return 0;
} else {var v$6366 = v$6365;
var v$6367 = v$6366[0];
var v$6368 = v$6366[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6363,v$6367[0],v$6367[1]);
var t$10260 = v$6368;
var v$6365 = t$10260;
continue lab$app;
};
};
};
var app$6364 = fix$10259.$app;
app$6364(attrs$6362);
t$10258 = newelem$6363;
(function(e,a){return e.appendChild(a);})(t$10261,t$10258);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendStyleLink"];
} };
smltojs0$0SmlToJsCompApp$1$2.createBody$1155(0);
smltojs0$0SmlToJsCompApp$1$2.getElem$1180 = function(id$1183){var v$1188 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,id$1183);
switch (v$1188[0]) { case 0: {return v$1188[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
};
var fix$10262 = {};
fix$10262.$app = function(v$3177){lab$app: while (true) {if (v$3177 == null) {return 0;
} else {var v$3178 = v$3177;
var v$3179 = v$3178[0];
var v$3180 = v$3178[1];
var v$6370 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$6370[0]) { case 0: {var t$10266 = v$6370[1];
var t$10263;
var attrs$6371 = [["type","text/javascript"],[["src",v$3179],null]];
var newelem$6372 = document.createElement("script");
var fix$10264 = {};
fix$10264.$app = function(v$6374){lab$app: while (true) {if (v$6374 == null) {return 0;
} else {var v$6375 = v$6374;
var v$6376 = v$6375[0];
var v$6377 = v$6375[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6372,v$6376[0],v$6376[1]);
var t$10265 = v$6377;
var v$6374 = t$10265;
continue lab$app;
};
};
};
var app$6373 = fix$10264.$app;
app$6373(attrs$6371);
t$10263 = newelem$6372;
(function(e,a){return e.appendChild(a);})(t$10266,t$10263);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"appendScript"];
} };
var t$10267 = v$3180;
var v$3177 = t$10267;
continue lab$app;
};
};
};
var app$3176 = fix$10262.$app;
app$3176(smltojs0$0SmlToJsCompApp$1$1.script_paths$88);
smltojs0$0SmlToJsCompApp$1$2.mkEditor$1192 = function(inarea$1195){var t$10270;
var fix$10268 = {};
fix$10268.$exists = function(v$3184){lab$exists: while (true) {if (v$3184 == null) {return false;
} else {var v$3185 = v$3184;
var v$3186 = v$3185[0];
var v$3187 = v$3185[1];
if (basis$0String$1.isSubstring$268(v$3186,smltojs0$0SmlToJsCompApp$1$2.agent$914)) {return true;
} else {var t$10269 = v$3187;
var v$3184 = t$10269;
continue lab$exists;
};
};
};
};
var exists$3183 = fix$10268.$exists;
t$10270 = (exists$3183(smltojs0$0SmlToJsCompApp$1$2.touchDevices$915));
if (t$10270) {return [function(v$1201){return (function(e){return e.value;})(inarea$1195);
},function(s$1204){var v$1209 = (function(e){return SmlPrims.option(e.firstChild);})(inarea$1195);
switch (v$1209[0]) { case 0: {var v$1211 = v$1209[1];
return (function(e,a,old){return e.replaceChild(a,old);})(inarea$1195,document.createTextNode(s$1204),v$1211);
 break; }default: {return (function(e,a){return e.appendChild(a);})(inarea$1195,document.createTextNode(s$1204));
} };
}];
} else {var properties$1212;
var t$1213 = (function(){return {};})();
(function(fp,s,v){fp[s] = v;})(t$1213,"textWrapping",true);
(function(fp,s,v){fp[s] = v;})(t$1213,"lineNumbers",true);
(function(fp,s,v){fp[s] = v;})(t$1213,"height","100%");
(function(fp,s,v){fp[s] = v;})(t$1213,"width","100%");
(function(fp,s,v){fp[s] = v;})(t$1213,"mode","sml");
properties$1212 = t$1213;
var ed$1224 = (function(e,props){return CodeMirror.fromTextArea(e,props);})(inarea$1195,properties$1212);
return [function(v$1228){return (function(e){return e.getValue();})(ed$1224);
},function(s$1231){return (function(e,s){return e.setValue(s);})(ed$1224,s$1231);
}];
};
};
smltojs0$0SmlToJsCompApp$1$2.exec_print$1236 = function(f$1239,v$1242){var p_old$1243 = basis$0Control$1.printer_get$55(0);
var buf$1244 = [null];
basis$0Control$1.printer_set$54(function(s$3215){return (buf$1244[0] = [s$3215,buf$1244[0]],0);
});
try {f$1239(v$1242);
} catch(v$10271) {(function(v$1256){return 0;
})(v$10271);
};
var res$1251 = SmlPrims.concat(basis$0List$1.rev$682(buf$1244[0]));
basis$0Control$1.printer_set$54(p_old$1243);
return res$1251;
};
smltojs0$0SmlToJsCompApp$1$2.compileAndRunEditor$1258 = function(f$1261,editor$1264){var res$1265;
var v$3220 = editor$1264[0](0);
var p_old$3221 = basis$0Control$1.printer_get$55(0);
var buf$3222 = [null];
basis$0Control$1.printer_set$54(function(s$3223){return (buf$3222[0] = [s$3223,buf$3222[0]],0);
});
try {smltojs0$0SmlToJsCompApp$1$1.compute$94(f$1261,v$3220);
} catch(v$10272) {(function(v$3225){return 0;
})(v$10272);
};
var res$3226 = SmlPrims.concat(basis$0List$1.rev$682(buf$3222[0]));
basis$0Control$1.printer_set$54(p_old$3221);
res$1265 = res$3226;
return smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0](res$1265);
};
smltojs0$0SmlToJsCompApp$1$2.noop$1270 = function(v$1272){return 0;
};
smltojs0$0SmlToJsCompApp$1$2.put$1273 = function(s$1276,v$1278){var s$3228 = s$1276 + "\n";
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,document.createTextNode(s$3228));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
};
smltojs0$0SmlToJsCompApp$1$2.logo$1279;
var attrs$3235 = [["src","smltojs_logo_transparent_small.png"],[["height","30px"],[["alt","SMLtoJs Online"],null]]];
var newelem$3236 = document.createElement("img");
var fix$10273 = {};
fix$10273.$app = function(v$3238){lab$app: while (true) {if (v$3238 == null) {return 0;
} else {var v$3239 = v$3238;
var v$3240 = v$3239[0];
var v$3241 = v$3239[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$3236,v$3240[0],v$3240[1]);
var t$10274 = v$3241;
var v$3238 = t$10274;
continue lab$app;
};
};
};
var app$3237 = fix$10273.$app;
app$3237(attrs$3235);
smltojs0$0SmlToJsCompApp$1$2.logo$1279 = newelem$3236;
smltojs0$0SmlToJsCompApp$1$2.menuStyle$1280 = ["style","border:0;padding:2;"];
smltojs0$0SmlToJsCompApp$1$2.qq$1281 = function(s$1284){return ("'" + s$1284) + "'";
};
smltojs0$0SmlToJsCompApp$1$2.s$rr$1285 = function(v$1296,v$9994){switch (v$1296) { case "0": {return v$9994;
 break; }default: {return (v$1296 + "/") + v$9994;
} };
};
smltojs0$0SmlToJsCompApp$1$2.okExt$1299 = function(s$1302){var fix$10275 = {};
fix$10275.$exists = function(v$3251){lab$exists: while (true) {if (v$3251 == null) {return false;
} else {var v$3252 = v$3251;
var v$3253 = v$3252[0];
var v$3254 = v$3252[1];
if (s$1302 == v$3253) {return true;
} else {var t$10276 = v$3254;
var v$3251 = t$10276;
continue lab$exists;
};
};
};
};
var exists$3250 = fix$10275.$exists;
return exists$3250(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203);
};
smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306 = function(n$1309){if (n$1309.length > 0) {var t$10277;
var c$3267;
if (0 >= n$1309.length) {throw CompilerInitial.exn$Subscript$52;
} else {c$3267 = (n$1309.charCodeAt(0));
};
t$10277 = (((97 <= c$3267)?(c$3267 <= 122):false)?true:((65 <= c$3267)?(c$3267 <= 90):false));
if (t$10277) {var stop$3273 = n$1309.length;
var fix$10278 = {};
fix$10278.$lr = function(j$3275){lab$lr: while (true) {if (j$3275 >= stop$3273) {return true;
} else {var t$10279;
var c$6378 = n$1309.charCodeAt(j$3275);
t$10279 = (((((97 <= c$6378)?(c$6378 <= 122):false)?true:((65 <= c$6378)?(c$6378 <= 90):false))?true:((48 <= c$6378)?(c$6378 <= 57):false))?true:((c$6378 == 95)?true:(c$6378 == 45)));
if (t$10279) {var t$10280 = SmlPrims.chk_ovf_i32(j$3275 + 1);
var j$3275 = t$10280;
continue lab$lr;
} else {return false;
};
};
};
};
var lr$3274 = fix$10278.$lr;
return lr$3274(0);
} else {return false;
};
} else {return false;
};
};
smltojs0$0SmlToJsCompApp$1$2.okFileName$1329 = function(n$1332){var v$1340 = basis$0String$1.fields$231(function(c$1356){return c$1356 == 46;
},n$1332);
if (v$1340 == null) {return false;
} else {var v$1342 = v$1340;
var v$1343 = v$1342[1];
if (v$1343 == null) {return false;
} else {var v$1345 = v$1343;
if (v$1345[1] == null) {var v$1351 = v$1342[0];
var v$1352 = v$1345[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$1351)) {var fix$10281 = {};
fix$10281.$exists = function(v$3279){lab$exists: while (true) {if (v$3279 == null) {return false;
} else {var v$3280 = v$3279;
var v$3281 = v$3280[0];
var v$3282 = v$3280[1];
if (v$1352 == v$3281) {return true;
} else {var t$10282 = v$3282;
var v$3279 = t$10282;
continue lab$exists;
};
};
};
};
var exists$3278 = fix$10281.$exists;
return exists$3278(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203);
} else {return false;
};
} else {return false;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.okFolderPath$1357 = function(p$1360){if (p$1360 == "0") {return true;
} else {var fields$1365 = basis$0String$1.fields$231(function(c$1368){return c$1368 == 47;
},p$1360);
var fix$10283 = {};
fix$10283.$all = function(v$3297){lab$all: while (true) {if (v$3297 == null) {return true;
} else {var v$3298 = v$3297;
var v$3299 = v$3298[0];
var v$3300 = v$3298[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3299)) {var t$10284 = v$3300;
var v$3297 = t$10284;
continue lab$all;
} else {return false;
};
};
};
};
var all$3296 = fix$10283.$all;
return all$3296(fields$1365);
};
};
smltojs0$0SmlToJsCompApp$1$2.okFilePath$1369 = function(p$1372){var fields$1373 = basis$0String$1.fields$231(function(c$1376){return c$1376 == 47;
},p$1372);
var v$1382 = basis$0List$1.rev$682(fields$1373);
if (v$1382 == null) {return false;
} else {var v$1388 = v$1382;
var v$1389 = v$1388[0];
var v$1390 = v$1388[1];
var t$10287;
var v$6381 = basis$0String$1.fields$231(function(c$6382){return c$6382 == 46;
},v$1389);
if (v$6381 == null) {t$10287 = false;
} else {var v$6383 = v$6381;
var v$6384 = v$6383[1];
if (v$6384 == null) {t$10287 = false;
} else {var v$6385 = v$6384;
if (v$6385[1] == null) {var v$6386 = v$6383[0];
var v$6387 = v$6385[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6386)) {var fix$10288 = {};
fix$10288.$exists = function(v$6389){lab$exists: while (true) {if (v$6389 == null) {return false;
} else {var v$6390 = v$6389;
var v$6391 = v$6390[0];
var v$6392 = v$6390[1];
if (v$6387 == v$6391) {return true;
} else {var t$10289 = v$6392;
var v$6389 = t$10289;
continue lab$exists;
};
};
};
};
var exists$6388 = fix$10288.$exists;
t$10287 = (exists$6388(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10287 = false;
};
} else {t$10287 = false;
};
};
};
if (t$10287) {var fix$10285 = {};
fix$10285.$all = function(v$3303){lab$all: while (true) {if (v$3303 == null) {return true;
} else {var v$3304 = v$3303;
var v$3305 = v$3304[0];
var v$3306 = v$3304[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3305)) {var t$10286 = v$3306;
var v$3303 = t$10286;
continue lab$all;
} else {return false;
};
};
};
};
var all$3302 = fix$10285.$all;
return all$3302(v$1390);
} else {return false;
};
};
};
smltojs0$0SmlToJsCompApp$1$2.allfiles$1391 = [null];
smltojs0$0SmlToJsCompApp$1$2.alldirs$1392 = [["0",null]];
smltojs0$0SmlToJsCompApp$1$2.fileStore$1393 = [[1]];
smltojs0$0SmlToJsCompApp$1$2.current$1394 = ["0"];
smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395 = [null];
smltojs0$0SmlToJsCompApp$1$2.splitPath$1396 = function(p$1399){if (p$1399 == "0") {return [p$1399,[1]];
} else {var fields$1404 = basis$0String$1.fields$231(function(c$1407){return c$1407 == 47;
},p$1399);
var v$1416 = basis$0List$1.rev$682(fields$1404);
if (v$1416 == null) {throw [basis$0Initial$1.en$Fail$54,"impossible: splitPath"];
} else {var v$1418 = v$1416;
var v$1419 = v$1418[1];
if (v$1419 == null) {var v$1424 = v$1418[0];
var t$10290;
var v$6395 = basis$0String$1.fields$231(function(c$6396){return c$6396 == 46;
},v$1424);
if (v$6395 == null) {t$10290 = false;
} else {var v$6397 = v$6395;
var v$6398 = v$6397[1];
if (v$6398 == null) {t$10290 = false;
} else {var v$6399 = v$6398;
if (v$6399[1] == null) {var v$6400 = v$6397[0];
var v$6401 = v$6399[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6400)) {var fix$10291 = {};
fix$10291.$exists = function(v$6403){lab$exists: while (true) {if (v$6403 == null) {return false;
} else {var v$6404 = v$6403;
var v$6405 = v$6404[0];
var v$6406 = v$6404[1];
if (v$6401 == v$6405) {return true;
} else {var t$10292 = v$6406;
var v$6403 = t$10292;
continue lab$exists;
};
};
};
};
var exists$6402 = fix$10291.$exists;
t$10290 = (exists$6402(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10290 = false;
};
} else {t$10290 = false;
};
};
};
return t$10290?["0",[0,v$1424]]:[v$1424,[1]];
} else {var v$1429 = v$1418[0];
var t$10293;
var v$6408 = basis$0String$1.fields$231(function(c$6409){return c$6409 == 46;
},v$1429);
if (v$6408 == null) {t$10293 = false;
} else {var v$6410 = v$6408;
var v$6411 = v$6410[1];
if (v$6411 == null) {t$10293 = false;
} else {var v$6412 = v$6411;
if (v$6412[1] == null) {var v$6413 = v$6410[0];
var v$6414 = v$6412[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6413)) {var fix$10294 = {};
fix$10294.$exists = function(v$6416){lab$exists: while (true) {if (v$6416 == null) {return false;
} else {var v$6417 = v$6416;
var v$6418 = v$6417[0];
var v$6419 = v$6417[1];
if (v$6414 == v$6418) {return true;
} else {var t$10295 = v$6419;
var v$6416 = t$10295;
continue lab$exists;
};
};
};
};
var exists$6415 = fix$10294.$exists;
t$10293 = (exists$6415(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10293 = false;
};
} else {t$10293 = false;
};
};
};
return t$10293?[basis$0String$1.concatWith$182("/",basis$0List$1.rev$682(v$1419)),[0,v$1429]]:[p$1399,[1]];
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.splitFolderPath$1430 = function(p$1433){if (p$1433 == "0") {return [p$1433,[1]];
} else {var fields$1438 = basis$0String$1.fields$231(function(c$1441){return c$1441 == 47;
},p$1433);
var v$1450 = basis$0List$1.rev$682(fields$1438);
if (v$1450 == null) {throw [basis$0Initial$1.en$Fail$54,"impossible: splitFolderPath"];
} else {var v$1452 = v$1450;
var v$1453 = v$1452[1];
if (v$1453 == null) {var v$1458 = v$1452[0];
return (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$1458))?["0",[0,v$1458]]:[v$1458,[1]];
} else {var v$1463 = v$1452[0];
return (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$1463))?[basis$0String$1.concatWith$182("/",basis$0List$1.rev$682(v$1453)),[0,v$1463]]:[p$1433,[1]];
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.currentFolder$1464 = function(v$1466){return (smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0];
};
smltojs0$0SmlToJsCompApp$1$2.currentFile$1471 = function(v$1473){var t$10296;
var p$3316 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var fields$3317 = basis$0String$1.fields$231(function(c$3318){return c$3318 == 47;
},p$3316);
var v$3319 = basis$0List$1.rev$682(fields$3317);
if (v$3319 == null) {t$10296 = false;
} else {var v$3320 = v$3319;
var v$3321 = v$3320[0];
var v$3322 = v$3320[1];
var t$10299;
var v$6422 = basis$0String$1.fields$231(function(c$6423){return c$6423 == 46;
},v$3321);
if (v$6422 == null) {t$10299 = false;
} else {var v$6424 = v$6422;
var v$6425 = v$6424[1];
if (v$6425 == null) {t$10299 = false;
} else {var v$6426 = v$6425;
if (v$6426[1] == null) {var v$6427 = v$6424[0];
var v$6428 = v$6426[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6427)) {var fix$10300 = {};
fix$10300.$exists = function(v$6430){lab$exists: while (true) {if (v$6430 == null) {return false;
} else {var v$6431 = v$6430;
var v$6432 = v$6431[0];
var v$6433 = v$6431[1];
if (v$6428 == v$6432) {return true;
} else {var t$10301 = v$6433;
var v$6430 = t$10301;
continue lab$exists;
};
};
};
};
var exists$6429 = fix$10300.$exists;
t$10299 = (exists$6429(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10299 = false;
};
} else {t$10299 = false;
};
};
};
if (t$10299) {var fix$10297 = {};
fix$10297.$all = function(v$3324){lab$all: while (true) {if (v$3324 == null) {return true;
} else {var v$3325 = v$3324;
var v$3326 = v$3325[0];
var v$3327 = v$3325[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3326)) {var t$10298 = v$3327;
var v$3324 = t$10298;
continue lab$all;
} else {return false;
};
};
};
};
var all$3323 = fix$10297.$all;
t$10296 = (all$3323(v$3322));
} else {t$10296 = false;
};
};
return t$10296?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.currentIsFolder$1478 = function(v$1480){var t$10302;
var p$3330 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
if (p$3330 == "0") {t$10302 = true;
} else {var fields$3336 = basis$0String$1.fields$231(function(c$3337){return c$3337 == 47;
},p$3330);
var fix$10303 = {};
fix$10303.$all = function(v$3339){lab$all: while (true) {if (v$3339 == null) {return true;
} else {var v$3340 = v$3339;
var v$3341 = v$3340[0];
var v$3342 = v$3340[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3341)) {var t$10304 = v$3342;
var v$3339 = t$10304;
continue lab$all;
} else {return false;
};
};
};
};
var all$3338 = fix$10303.$all;
t$10302 = (all$3338(fields$3336));
};
return t$10302?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.fileExists$1485 = function(name$1488){var fix$10305 = {};
fix$10305.$exists = function(v$3351){lab$exists: while (true) {if (v$3351 == null) {return false;
} else {var v$3352 = v$3351;
var v$3353 = v$3352[0];
var v$3354 = v$3352[1];
if (v$3353 == name$1488) {return true;
} else {var t$10306 = v$3354;
var v$3351 = t$10306;
continue lab$exists;
};
};
};
};
var exists$3350 = fix$10305.$exists;
return exists$3350(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]);
};
smltojs0$0SmlToJsCompApp$1$2.folderExists$1492 = function(name$1495){var fix$10307 = {};
fix$10307.$exists = function(v$3372){lab$exists: while (true) {if (v$3372 == null) {return false;
} else {var v$3373 = v$3372;
var v$3374 = v$3373[0];
var v$3375 = v$3373[1];
if (v$3374 == name$1495) {return true;
} else {var t$10308 = v$3375;
var v$3372 = t$10308;
continue lab$exists;
};
};
};
};
var exists$3371 = fix$10307.$exists;
return exists$3371(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]);
};
smltojs0$0SmlToJsCompApp$1$2.isServerPath$1499 = function(p$1502){var v$1507 = basis$0String$1.tokens$224(function(c$1514){return c$1514 == 47;
},p$1502);
if (v$1507 == null) {return false;
} else {var v$1509 = v$1507;
switch (v$1509[0]) { case "Server": {return true;
 break; }default: {return false;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.isDropboxPath$1515 = function(p$1518){var v$1523 = basis$0String$1.tokens$224(function(c$1530){return c$1530 == 47;
},p$1518);
if (v$1523 == null) {return false;
} else {var v$1525 = v$1523;
switch (v$1525[0]) { case "Dropbox": {return true;
 break; }default: {return false;
} };
};
};
smltojs0$0SmlToJsCompApp$1$2.load$1608 = function(c$1611,fts$1614){(smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0] = [0,c$1611],0);
var t$10337 = appfun2$0dropbox$1.all_files$257;
var t$10336 = c$1611;
var t$10335;
var fix$10309 = {};
fix$10309.$app = function(v$3470){lab$app: while (true) {if (v$3470 == null) {return 0;
} else {var v$3471 = v$3470;
var v$3472 = v$3471[0];
var v$3473 = v$3471[1];
var loadDir$6448 = function(p$6449,n$6450){var d$6451;
switch (p$6449) { case "0": {d$6451 = n$6450;
 break; }default: {d$6451 = ((p$6449 + "/") + n$6450);
} };
var t$10312;
var fix$10310 = {};
fix$10310.$exists = function(v$6453){lab$exists: while (true) {if (v$6453 == null) {return false;
} else {var v$6454 = v$6453;
var v$6455 = v$6454[0];
var v$6456 = v$6454[1];
if (d$6451 == v$6455) {return true;
} else {var t$10311 = v$6456;
var v$6453 = t$10311;
continue lab$exists;
};
};
};
};
var exists$6452 = fix$10310.$exists;
t$10312 = (exists$6452(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10312) {return 0;
} else {var h$6457 = [["id",d$6451],[["parent",p$6449],[["name",n$6450],[["kind","folder"],null]]]];
var t$10318 = fts$1614;
var t$10317;
var fix$10313 = {};
fix$10313.$foldl = function(v$6459,v$6460){lab$foldl: while (true) {if (v$6460 == null) {return v$6459;
} else {var v$6461 = v$6460;
var v$6462 = v$6461[0];
var v$6463 = v$6461[1];
var t$10314;
var v$6464 = v$6462[0];
var v$6465 = v$6462[1];
(function(fp,s,v){fp[s] = v;})(v$6459,v$6464,v$6465);
t$10314 = v$6459;
var t$10315 = t$10314;
var t$10316 = v$6463;
var v$6459 = t$10315;
var v$6460 = t$10316;
continue lab$foldl;
};
};
};
var foldl$6458 = fix$10313.$foldl;
var v$10037 = (function(){return {};})();
t$10317 = (foldl$6458(v$10037,h$6457));
(function(obj,a){return obj.add(a);})(t$10318,t$10317);
return (smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0] = [d$6451,smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]],0);
};
};
var v$6466;
var fields$6467 = basis$0String$1.fields$231((function(env$10319){return function(c$6468){return c$6468 == 47;
};
})([]),v$3472);
var fix$10320 = {};
fix$10320.$loop = function(v$6470,v$6471){lab$loop: while (true) {if (v$6471 == null) {throw [basis$0Initial$1.en$Fail$54,"loadDirs.impossible"];
} else {var v$6472 = v$6471;
var v$6473 = v$6472[1];
if (v$6473 == null) {var v$6474 = v$6472[0];
var t$10322;
var v$6476 = basis$0String$1.fields$231((function(env$10321){return function(c$6477){return c$6477 == 46;
};
})([]),v$6474);
if (v$6476 == null) {t$10322 = false;
} else {var v$6478 = v$6476;
var v$6479 = v$6478[1];
if (v$6479 == null) {t$10322 = false;
} else {var v$6480 = v$6479;
if (v$6480[1] == null) {var v$6481 = v$6478[0];
var v$6482 = v$6480[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6481)) {var fix$10323 = {};
fix$10323.$exists = function(v$6484){lab$exists: while (true) {if (v$6484 == null) {return false;
} else {var v$6485 = v$6484;
var v$6486 = v$6485[0];
var v$6487 = v$6485[1];
if (v$6482 == v$6486) {return true;
} else {var t$10324 = v$6487;
var v$6484 = t$10324;
continue lab$exists;
};
};
};
};
var exists$6483 = fix$10323.$exists;
t$10322 = (exists$6483(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10322 = false;
};
} else {t$10322 = false;
};
};
};
if (t$10322) {return [0,[v$6470,v$6474]];
} else {loadDir$6448(v$6470,v$6474);
return [1];
};
} else {var v$6488 = v$6472[0];
loadDir$6448(v$6470,v$6488);
var t$10325;
switch (v$6470) { case "0": {t$10325 = v$6488;
 break; }default: {t$10325 = ((v$6470 + "/") + v$6488);
} };
var t$10326 = t$10325;
var t$10327 = v$6473;
var v$6470 = t$10326;
var v$6471 = t$10327;
continue lab$loop;
};
};
};
};
var loop$6469 = fix$10320.$loop;
v$6466 = (loop$6469("0",fields$6467));
switch (v$6466[0]) { case 1: {0;
 break; }default: {var v$6489 = v$6466[1];
var v$6490 = v$6489[0];
var v$6491 = v$6489[1];
var h$6492 = [["id",v$3472],[["parent",v$6490],[["name",v$6491],[["kind","leaf"],null]]]];
var t$10333 = fts$1614;
var t$10332;
var fix$10328 = {};
fix$10328.$foldl = function(v$6494,v$6495){lab$foldl: while (true) {if (v$6495 == null) {return v$6494;
} else {var v$6496 = v$6495;
var v$6497 = v$6496[0];
var v$6498 = v$6496[1];
var t$10329;
var v$6499 = v$6497[0];
var v$6500 = v$6497[1];
(function(fp,s,v){fp[s] = v;})(v$6494,v$6499,v$6500);
t$10329 = v$6494;
var t$10330 = t$10329;
var t$10331 = v$6498;
var v$6494 = t$10330;
var v$6495 = t$10331;
continue lab$foldl;
};
};
};
var foldl$6493 = fix$10328.$foldl;
var v$10039 = (function(){return {};})();
t$10332 = (foldl$6493(v$10039,h$6492));
(function(obj,a){return obj.add(a);})(t$10333,t$10332);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = [v$3472,smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]],0);
} };
var t$10334 = v$3473;
var v$3470 = t$10334;
continue lab$app;
};
};
};
var app$3469 = fix$10309.$app;
t$10335 = (function(v$10157){return app$3469(v$10157);
});
return t$10337(t$10336,t$10335);
};
smltojs0$0SmlToJsCompApp$1$2.loadFileContentFromServer$1618 = function(f$1621){var v$1626 = basis$0List$1.rev$682(basis$0String$1.tokens$224(function(c$1635){return c$1635 == 47;
},f$1621));
if (v$1626 == null) {throw [basis$0Initial$1.en$Fail$54,"failed to load server file content for " + f$1621];
} else {var v$1631 = v$1626;
var v$1632 = v$1631[0];
var c$1628;
var file$6501 = ("otests/" + v$1632) + "_";
var file$6502;
var t$10341 = file$6501 + "?_=";
var t$10340;
var t$10339 = basis$0Real$1.toString$153;
var t$10338;
var v$6503 = SmlPrims.getrealtime();
t$10338 = ((v$6503[0] - (-2147483648)) + (v$6503[1] / 1000000.0));
t$10340 = (t$10339(t$10338));
file$6502 = (t$10341 + t$10340);
var r$6504 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$6504,"GET",file$6502,false);
js$0Js$1.send$654(r$6504,[1]);
var v$6505 = (function(r){return SmlPrims.option(r.responseText);})(r$6504);
switch (v$6505[0]) { case 0: {c$1628 = v$6505[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$6502];
} };
var s$3542 = ("loaded file " + (("'" + f$1621) + "'")) + " from server";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$3542);
var s$3544;
var t$10347;
var t$10346;
var t$10345;
var t$10344 = basis$0Date$1.fmt$816;
var t$10343 = "%H:%M:%S";
var t$10342;
var v$9995 = SmlPrims.getrealtime();
t$10342 = (basis$0Date$1.fromTimeLocal$512(v$9995[0],v$9995[1]));
t$10345 = (t$10344(t$10343,t$10342));
t$10346 = (t$10345 + ": ");
t$10347 = (t$10346 + s$3542);
s$3544 = (t$10347 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3544));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return c$1628;
};
};
smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1636 = function(filename$1639,cont$1642){var t$10351;
var fix$10349 = {};
fix$10349.$exists = function(v$3561){lab$exists: while (true) {if (v$3561 == null) {return false;
} else {var v$3562 = v$3561;
var v$3563 = v$3562[0];
var v$3564 = v$3562[1];
if (v$3563[0] == filename$1639) {return true;
} else {var t$10350 = v$3564;
var v$3561 = t$10350;
continue lab$exists;
};
};
};
};
var exists$3560 = fix$10349.$exists;
t$10351 = (exists$3560(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]));
if (t$10351) {(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = filename$1639,0);
return cont$1642([1]);
} else {var t$10348;
var v$3580 = basis$0String$1.tokens$224(function(c$3581){return c$3581 == 47;
},filename$1639);
if (v$3580 == null) {t$10348 = false;
} else {var v$3582 = v$3580;
switch (v$3582[0]) { case "Server": {t$10348 = true;
 break; }default: {t$10348 = false;
} };
};
if (t$10348) {return cont$1642([0,smltojs0$0SmlToJsCompApp$1$2.loadFileContentFromServer$1618(filename$1639)]);
} else {var v$1657 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$1657[0]) { case 0: {var v$1666 = v$1657[1];
return appfun2$0dropbox$1.content$315(v$1666,filename$1639,function(c$1661){(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = filename$1639,0);
var s$3585 = "Loaded file " + (("'" + filename$1639) + "'");
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$3585);
var s$3587;
var t$10357;
var t$10356;
var t$10355;
var t$10354 = basis$0Date$1.fmt$816;
var t$10353 = "%H:%M:%S";
var t$10352;
var v$9996 = SmlPrims.getrealtime();
t$10352 = (basis$0Date$1.fromTimeLocal$512(v$9996[0],v$9996[1]));
t$10355 = (t$10354(t$10353,t$10352));
t$10356 = (t$10355 + ": ");
t$10357 = (t$10356 + s$3585);
s$3587 = (t$10357 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3587));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return cont$1642([0,c$1661]);
});
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"loadFileContent.fileStore not set"];
} };
};
};
};
smltojs0$0SmlToJsCompApp$1$2.treeStoreRemoveExceptServer$1671 = function(fts$1674,id$1677){var t$10358;
var v$3597 = basis$0String$1.tokens$224(function(c$3598){return c$3598 == 47;
},id$1677);
if (v$3597 == null) {t$10358 = false;
} else {var v$3599 = v$3597;
switch (v$3599[0]) { case "Server": {t$10358 = true;
 break; }default: {t$10358 = false;
} };
};
return t$10358?0:((function(obj,a){return obj.remove(a);})(fts$1674,id$1677));
};
smltojs0$0SmlToJsCompApp$1$2.clear$1682 = function(fts$1685,closetab$1688){var fix$10359 = {};
fix$10359.$app = function(v$3604){lab$app: while (true) {if (v$3604 == null) {return 0;
} else {var v$3605 = v$3604;
var v$3606 = v$3605[0];
var v$3607 = v$3605[1];
var t$10361;
var v$6507 = basis$0String$1.tokens$224((function(env$10360){return function(c$6508){return c$6508 == 47;
};
})([]),v$3606);
if (v$6507 == null) {t$10361 = false;
} else {var v$6509 = v$6507;
switch (v$6509[0]) { case "Server": {t$10361 = true;
 break; }default: {t$10361 = false;
} };
};
t$10361?0:((function(obj,a){return obj.remove(a);})(fts$1685,v$3606));
var t$10362 = v$3607;
var v$3604 = t$10362;
continue lab$app;
};
};
};
var app$3603 = fix$10359.$app;
app$3603(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]);
var fix$10363 = {};
fix$10363.$app = function(v$3623){lab$app: while (true) {if (v$3623 == null) {return 0;
} else {var v$3624 = v$3623;
var v$3625 = v$3624[0];
var v$3626 = v$3624[1];
if ((v$3625 == "0")?false:true) {var t$10365;
var v$3647 = basis$0String$1.tokens$224((function(env$10364){return function(c$3648){return c$3648 == 47;
};
})([]),v$3625);
if (v$3647 == null) {t$10365 = false;
} else {var v$3649 = v$3647;
switch (v$3649[0]) { case "Server": {t$10365 = true;
 break; }default: {t$10365 = false;
} };
};
t$10365?0:((function(obj,a){return obj.remove(a);})(fts$1685,v$3625));
} else {0;
};
var t$10366 = v$3626;
var v$3623 = t$10366;
continue lab$app;
};
};
};
var app$3622 = fix$10363.$app;
app$3622(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]);
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0] = ["0",null],0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = null,0);
(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0);
var fix$10367 = {};
fix$10367.$app = function(v$3660){lab$app: while (true) {if (v$3660 == null) {return 0;
} else {var v$3661 = v$3660;
var v$3662 = v$3661[0];
var v$3663 = v$3661[1];
var v$3665 = v$3662[0];
closetab$1688(v$3665);
var t$10368 = v$3663;
var v$3660 = t$10368;
continue lab$app;
};
};
};
var app$3659 = fix$10367.$app;
app$3659(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = null,0);
};
smltojs0$0SmlToJsCompApp$1$2.mkAbsPath$1712 = function(n$1715){var v$1720 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0];
switch (v$1720) { case "0": {return n$1715;
 break; }default: {return (v$1720 + "/") + n$1715;
} };
};
var count$1721 = [0];
smltojs0$0SmlToJsCompApp$1$2.suggestNewFileName$1798 = function(base$1801){var fix$10369 = {};
fix$10369.$suggest = function(f$6524){lab$suggest: while (true) {var num$6525 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6528 = f$6524(num$6525);
var t$10372;
var fix$10370 = {};
fix$10370.$exists = function(v$6531){lab$exists: while (true) {if (v$6531 == null) {return false;
} else {var v$6532 = v$6531;
var v$6533 = v$6532[0];
var v$6534 = v$6532[1];
if (v$6533 == name$6528) {return true;
} else {var t$10371 = v$6534;
var v$6531 = t$10371;
continue lab$exists;
};
};
};
};
var exists$6530 = fix$10370.$exists;
t$10372 = (exists$6530(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10372) {var t$10373 = f$6524;
var f$6524 = t$10373;
continue lab$suggest;
} else {return name$6528;
};
};
};
var suggest$6523 = fix$10369.$suggest;
return suggest$6523(function(num$1804){return ((base$1801 + "-") + (basis$0Int32$1.toString$458(num$1804))) + ".sml";
});
};
smltojs0$0SmlToJsCompApp$1$2.suggestNewFolderName$1805 = function(v$1807){var fix$10374 = {};
fix$10374.$suggest = function(f$6549){lab$suggest: while (true) {var num$6550 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6553 = f$6549(num$6550);
var t$10377;
var fix$10375 = {};
fix$10375.$exists = function(v$6556){lab$exists: while (true) {if (v$6556 == null) {return false;
} else {var v$6557 = v$6556;
var v$6558 = v$6557[0];
var v$6559 = v$6557[1];
if (v$6558 == name$6553) {return true;
} else {var t$10376 = v$6559;
var v$6556 = t$10376;
continue lab$exists;
};
};
};
};
var exists$6555 = fix$10375.$exists;
t$10377 = (exists$6555(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10377) {var t$10378 = f$6549;
var f$6549 = t$10378;
continue lab$suggest;
} else {return name$6553;
};
};
};
var suggest$6548 = fix$10374.$suggest;
return suggest$6548(function(num$1810){return "Folder-" + (basis$0Int32$1.toString$458(num$1810));
});
};
smltojs0$0SmlToJsCompApp$1$2.newFile$1811 = function(fts$1814,content$1817,name$1820){var t$10385;
var fix$10383 = {};
fix$10383.$exists = function(v$3770){lab$exists: while (true) {if (v$3770 == null) {return false;
} else {var v$3771 = v$3770;
var v$3772 = v$3771[0];
var v$3773 = v$3771[1];
if (v$3772 == name$1820) {return true;
} else {var t$10384 = v$3773;
var v$3770 = t$10384;
continue lab$exists;
};
};
};
};
var exists$3769 = fix$10383.$exists;
t$10385 = (exists$3769(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10385) {throw [basis$0Initial$1.en$Fail$54,"file already exists"];
} else {var t$10382;
var t$10379;
var v$6561 = basis$0String$1.fields$231(function(c$6562){return c$6562 == 46;
},name$1820);
if (v$6561 == null) {t$10379 = false;
} else {var v$6563 = v$6561;
var v$6564 = v$6563[1];
if (v$6564 == null) {t$10379 = false;
} else {var v$6565 = v$6564;
if (v$6565[1] == null) {var v$6566 = v$6563[0];
var v$6567 = v$6565[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6566)) {var fix$10380 = {};
fix$10380.$exists = function(v$6569){lab$exists: while (true) {if (v$6569 == null) {return false;
} else {var v$6570 = v$6569;
var v$6571 = v$6570[0];
var v$6572 = v$6570[1];
if (v$6567 == v$6571) {return true;
} else {var t$10381 = v$6572;
var v$6569 = t$10381;
continue lab$exists;
};
};
};
};
var exists$6568 = fix$10380.$exists;
t$10379 = (exists$6568(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10379 = false;
};
} else {t$10379 = false;
};
};
};
t$10382 = (t$10379?false:true);
if (t$10382) {throw [basis$0Initial$1.en$Fail$54,"invalid new file name"];
} else {var lname$3784;
var v$3785 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0];
switch (v$3785) { case "0": {lname$3784 = name$1820;
 break; }default: {lname$3784 = ((v$3785 + "/") + name$1820);
} };
var t$10386;
var v$3789 = basis$0String$1.tokens$224(function(c$3790){return c$3790 == 47;
},lname$3784);
if (v$3789 == null) {t$10386 = false;
} else {var v$3791 = v$3789;
switch (v$3791[0]) { case "Server": {t$10386 = true;
 break; }default: {t$10386 = false;
} };
};
if (t$10386) {throw [basis$0Initial$1.en$Fail$54,"You cannot create new files in the Server folder"];
} else {var v$3792 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$3792[0]) { case 0: {var v$3793 = v$3792[1];
appfun2$0dropbox$1.write_file$328(v$3793,lname$3784,content$1817,function(v$3794){var v$3795 = v$3794[0];
var s$3796 = ((("Wrote file " + lname$3784) + " (") + v$3795) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$3796);
var s$3801;
var t$10392;
var t$10391;
var t$10390;
var t$10389 = basis$0Date$1.fmt$816;
var t$10388 = "%H:%M:%S";
var t$10387;
var v$9997 = SmlPrims.getrealtime();
t$10387 = (basis$0Date$1.fromTimeLocal$512(v$9997[0],v$9997[1]));
t$10390 = (t$10389(t$10388,t$10387));
t$10391 = (t$10390 + ": ");
t$10392 = (t$10391 + s$3796);
s$3801 = (t$10392 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3801));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
 break; }default: {0;
} };
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = [lname$3784,smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]],0);
var h$3808 = [["id",lname$3784],[["parent",(smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0]],[["name",name$1820],[["kind","leaf"],null]]]];
var t$10398 = fts$1814;
var t$10397;
var fix$10393 = {};
fix$10393.$foldl = function(v$3810,v$3811){lab$foldl: while (true) {if (v$3811 == null) {return v$3810;
} else {var v$3812 = v$3811;
var v$3813 = v$3812[0];
var v$3814 = v$3812[1];
var t$10394;
var v$3815 = v$3813[0];
var v$3816 = v$3813[1];
(function(fp,s,v){fp[s] = v;})(v$3810,v$3815,v$3816);
t$10394 = v$3810;
var t$10395 = t$10394;
var t$10396 = v$3814;
var v$3810 = t$10395;
var v$3811 = t$10396;
continue lab$foldl;
};
};
};
var foldl$3809 = fix$10393.$foldl;
var v$10041 = (function(){return {};})();
t$10397 = (foldl$3809(v$10041,h$3808));
(function(obj,a){return obj.add(a);})(t$10398,t$10397);
(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = lname$3784,0);
return lname$3784;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.newFolder$1829 = function(fts$1832,name$1835){var t$10401;
var fix$10399 = {};
fix$10399.$exists = function(v$3820){lab$exists: while (true) {if (v$3820 == null) {return false;
} else {var v$3821 = v$3820;
var v$3822 = v$3821[0];
var v$3823 = v$3821[1];
if (v$3822 == name$1835) {return true;
} else {var t$10400 = v$3823;
var v$3820 = t$10400;
continue lab$exists;
};
};
};
};
var exists$3819 = fix$10399.$exists;
t$10401 = (exists$3819(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10401) {throw [basis$0Initial$1.en$Fail$54,"folder already exists"];
} else {if ((smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(name$1835))?false:true) {throw [basis$0Initial$1.en$Fail$54,"invalid new folder name"];
} else {var lname$3833;
var v$3834 = (smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0];
switch (v$3834) { case "0": {lname$3833 = name$1835;
 break; }default: {lname$3833 = ((v$3834 + "/") + name$1835);
} };
var t$10402;
var v$3838 = basis$0String$1.tokens$224(function(c$3839){return c$3839 == 47;
},lname$3833);
if (v$3838 == null) {t$10402 = false;
} else {var v$3840 = v$3838;
switch (v$3840[0]) { case "Server": {t$10402 = true;
 break; }default: {t$10402 = false;
} };
};
if (t$10402) {throw [basis$0Initial$1.en$Fail$54,"You cannot create new folders in the Server folder"];
} else {var v$3841 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$3841[0]) { case 0: {var v$3842 = v$3841[1];
appfun2$0dropbox$1.mkdir$367(v$3842,lname$3833,function(v$3843){var v$3844 = v$3843[0];
var s$3845 = ((("Created folder " + lname$3833) + " (") + v$3844) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$3845);
var s$3850;
var t$10408;
var t$10407;
var t$10406;
var t$10405 = basis$0Date$1.fmt$816;
var t$10404 = "%H:%M:%S";
var t$10403;
var v$9998 = SmlPrims.getrealtime();
t$10403 = (basis$0Date$1.fromTimeLocal$512(v$9998[0],v$9998[1]));
t$10406 = (t$10405(t$10404,t$10403));
t$10407 = (t$10406 + ": ");
t$10408 = (t$10407 + s$3845);
s$3850 = (t$10408 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3850));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
 break; }default: {0;
} };
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0] = [lname$3833,smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]],0);
var h$3857 = [["id",lname$3833],[["parent",(smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(smltojs0$0SmlToJsCompApp$1$2.current$1394[0]))[0]],[["name",name$1835],[["kind","folder"],null]]]];
var t$10414 = fts$1832;
var t$10413;
var fix$10409 = {};
fix$10409.$foldl = function(v$3859,v$3860){lab$foldl: while (true) {if (v$3860 == null) {return v$3859;
} else {var v$3861 = v$3860;
var v$3862 = v$3861[0];
var v$3863 = v$3861[1];
var t$10410;
var v$3864 = v$3862[0];
var v$3865 = v$3862[1];
(function(fp,s,v){fp[s] = v;})(v$3859,v$3864,v$3865);
t$10410 = v$3859;
var t$10411 = t$10410;
var t$10412 = v$3863;
var v$3859 = t$10411;
var v$3860 = t$10412;
continue lab$foldl;
};
};
};
var foldl$3858 = fix$10409.$foldl;
var v$10043 = (function(){return {};})();
t$10413 = (foldl$3858(v$10043,h$3857));
(function(obj,a){return obj.add(a);})(t$10414,t$10413);
return lname$3833;
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.currentEditor$1844 = function(v$1846){var v$1851;
var t$10415;
var p$3867 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var fields$3868 = basis$0String$1.fields$231(function(c$3869){return c$3869 == 47;
},p$3867);
var v$3870 = basis$0List$1.rev$682(fields$3868);
if (v$3870 == null) {t$10415 = false;
} else {var v$3871 = v$3870;
var v$3872 = v$3871[0];
var v$3873 = v$3871[1];
var t$10418;
var v$6574 = basis$0String$1.fields$231(function(c$6575){return c$6575 == 46;
},v$3872);
if (v$6574 == null) {t$10418 = false;
} else {var v$6576 = v$6574;
var v$6577 = v$6576[1];
if (v$6577 == null) {t$10418 = false;
} else {var v$6578 = v$6577;
if (v$6578[1] == null) {var v$6579 = v$6576[0];
var v$6580 = v$6578[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6579)) {var fix$10419 = {};
fix$10419.$exists = function(v$6582){lab$exists: while (true) {if (v$6582 == null) {return false;
} else {var v$6583 = v$6582;
var v$6584 = v$6583[0];
var v$6585 = v$6583[1];
if (v$6580 == v$6584) {return true;
} else {var t$10420 = v$6585;
var v$6582 = t$10420;
continue lab$exists;
};
};
};
};
var exists$6581 = fix$10419.$exists;
t$10418 = (exists$6581(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10418 = false;
};
} else {t$10418 = false;
};
};
};
if (t$10418) {var fix$10416 = {};
fix$10416.$all = function(v$3875){lab$all: while (true) {if (v$3875 == null) {return true;
} else {var v$3876 = v$3875;
var v$3877 = v$3876[0];
var v$3878 = v$3876[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3877)) {var t$10417 = v$3878;
var v$3875 = t$10417;
continue lab$all;
} else {return false;
};
};
};
};
var all$3874 = fix$10416.$all;
t$10415 = (all$3874(v$3873));
} else {t$10415 = false;
};
};
v$1851 = (t$10415?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$1851[0]) { case 1: {return [1];
 break; }default: {var v$1869 = v$1851[1];
var v$1856 = basis$0List$1.find$392(function(v$1867){return v$1869 == v$1867[0];
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
switch (v$1856[0]) { case 0: {return [0,[v$1869,v$1856[1][2]]];
 break; }default: {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"currentEditor: error");
var s$3886;
var t$10426;
var t$10425;
var t$10424;
var t$10423 = basis$0Date$1.fmt$816;
var t$10422 = "%H:%M:%S";
var t$10421;
var v$9999 = SmlPrims.getrealtime();
t$10421 = (basis$0Date$1.fromTimeLocal$512(v$9999[0],v$9999[1]));
t$10424 = (t$10423(t$10422,t$10421));
t$10425 = (t$10424 + ": ");
t$10426 = (t$10425 + "currentEditor: error");
s$3886 = (t$10426 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3886));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return [1];
} };
} };
};
smltojs0$0SmlToJsCompApp$1$2.showTab$1870 = function(n$1873){return (smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = n$1873,0);
};
smltojs0$0SmlToJsCompApp$1$2.delete$1874 = function(fts$1877,closetab$1880){var v$1887;
var t$10427;
var p$3893 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
if (p$3893 == "0") {t$10427 = true;
} else {var fields$3898 = basis$0String$1.fields$231(function(c$3899){return c$3899 == 47;
},p$3893);
var fix$10428 = {};
fix$10428.$all = function(v$3901){lab$all: while (true) {if (v$3901 == null) {return true;
} else {var v$3902 = v$3901;
var v$3903 = v$3902[0];
var v$3904 = v$3902[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$3903)) {var t$10429 = v$3904;
var v$3901 = t$10429;
continue lab$all;
} else {return false;
};
};
};
};
var all$3900 = fix$10428.$all;
t$10427 = (all$3900(fields$3898));
};
v$1887 = (t$10427?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$1887[0]) { case 0: {var v$1889 = v$1887[1];
switch (v$1889) { case "0": {return notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Cannot delete root folder");
 break; }default: {var t$10432;
var v$3906 = basis$0String$1.tokens$224(function(c$3907){return c$3907 == 47;
},v$1889);
if (v$3906 == null) {t$10432 = false;
} else {var v$3908 = v$3906;
switch (v$3908[0]) { case "Server": {t$10432 = true;
 break; }default: {t$10432 = false;
} };
};
if (t$10432) {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"You cannot delete folders in the Server folder");
var s$3911;
var t$10438;
var t$10437;
var t$10436;
var t$10435 = basis$0Date$1.fmt$816;
var t$10434 = "%H:%M:%S";
var t$10433;
var v$10000 = SmlPrims.getrealtime();
t$10433 = (basis$0Date$1.fromTimeLocal$512(v$10000[0],v$10000[1]));
t$10436 = (t$10435(t$10434,t$10433));
t$10437 = (t$10436 + ": ");
t$10438 = (t$10437 + "You cannot delete folders in the Server folder");
s$3911 = (t$10438 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$3911));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
} else {var v$1971 = basis$0List$1.partition$449(function(v$1976){var v$1977 = v$1976[0];
var s1$3916 = v$1889 + "/";
var n1$3918 = s1$3916.length;
var n2$3919 = v$1977.length;
var stop$3920 = (n1$3918 < n2$3919)?n1$3918:n2$3919;
var fix$10430 = {};
fix$10430.$h = function(j$3922){lab$h: while (true) {if (j$3922 == stop$3920) {return true;
} else {if ((s1$3916.charCodeAt(j$3922)) == (v$1977.charCodeAt(j$3922))) {var t$10431 = SmlPrims.chk_ovf_i32(j$3922 + 1);
var j$3922 = t$10431;
continue lab$h;
} else {return false;
};
};
};
};
var h$3921 = fix$10430.$h;
if (n1$3918 <= n2$3919) {return h$3921(0);
} else {return false;
};
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
var v$1972 = v$1971[0];
var v$1973 = v$1971[1];
var v$1965 = basis$0List$1.partition$449(function(f$1970){var s1$3925 = v$1889 + "/";
var n1$3927 = s1$3925.length;
var n2$3928 = f$1970.length;
var stop$3929 = (n1$3927 < n2$3928)?n1$3927:n2$3928;
var fix$10439 = {};
fix$10439.$h = function(j$3931){lab$h: while (true) {if (j$3931 == stop$3929) {return true;
} else {if ((s1$3925.charCodeAt(j$3931)) == (f$1970.charCodeAt(j$3931))) {var t$10440 = SmlPrims.chk_ovf_i32(j$3931 + 1);
var j$3931 = t$10440;
continue lab$h;
} else {return false;
};
};
};
};
var h$3930 = fix$10439.$h;
if (n1$3927 <= n2$3928) {return h$3930(0);
} else {return false;
};
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]);
var v$1966 = v$1965[0];
var v$1967 = v$1965[1];
var v$1955 = basis$0List$1.partition$449(function(f$1960){if (f$1960 == v$1889) {return true;
} else {var s1$3938 = v$1889 + "/";
var n1$3940 = s1$3938.length;
var n2$3941 = f$1960.length;
var stop$3942 = (n1$3940 < n2$3941)?n1$3940:n2$3941;
var fix$10441 = {};
fix$10441.$h = function(j$3944){lab$h: while (true) {if (j$3944 == stop$3942) {return true;
} else {if ((s1$3938.charCodeAt(j$3944)) == (f$1960.charCodeAt(j$3944))) {var t$10442 = SmlPrims.chk_ovf_i32(j$3944 + 1);
var j$3944 = t$10442;
continue lab$h;
} else {return false;
};
};
};
};
var h$3943 = fix$10441.$h;
if (n1$3940 <= n2$3941) {return h$3943(0);
} else {return false;
};
};
},smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]);
var v$1956 = v$1955[0];
var v$1957 = v$1955[1];
(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = v$1973,0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = v$1967,0);
(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0] = v$1957,0);
var fix$10443 = {};
fix$10443.$app = function(v$3987){lab$app: while (true) {if (v$3987 == null) {return 0;
} else {var v$3988 = v$3987;
var v$3989 = v$3988[0];
var v$3990 = v$3988[1];
var t$10445;
var v$6589 = basis$0String$1.tokens$224((function(env$10444){return function(c$6590){return c$6590 == 47;
};
})([]),v$3989);
if (v$6589 == null) {t$10445 = false;
} else {var v$6591 = v$6589;
switch (v$6591[0]) { case "Server": {t$10445 = true;
 break; }default: {t$10445 = false;
} };
};
t$10445?0:((function(obj,a){return obj.remove(a);})(fts$1877,v$3989));
var t$10446 = v$3990;
var v$3987 = t$10446;
continue lab$app;
};
};
};
var app$3986 = fix$10443.$app;
app$3986(v$1966);
var fix$10447 = {};
fix$10447.$app = function(v$4001){lab$app: while (true) {if (v$4001 == null) {return 0;
} else {var v$4002 = v$4001;
var v$4003 = v$4002[0];
var v$4004 = v$4002[1];
var t$10449;
var v$6593 = basis$0String$1.tokens$224((function(env$10448){return function(c$6594){return c$6594 == 47;
};
})([]),v$4003);
if (v$6593 == null) {t$10449 = false;
} else {var v$6595 = v$6593;
switch (v$6595[0]) { case "Server": {t$10449 = true;
 break; }default: {t$10449 = false;
} };
};
t$10449?0:((function(obj,a){return obj.remove(a);})(fts$1877,v$4003));
var t$10450 = v$4004;
var v$4001 = t$10450;
continue lab$app;
};
};
};
var app$4000 = fix$10447.$app;
app$4000(v$1956);
var fix$10451 = {};
fix$10451.$app = function(v$4018){lab$app: while (true) {if (v$4018 == null) {return 0;
} else {var v$4019 = v$4018;
var v$4020 = v$4019[0];
var v$4021 = v$4019[1];
var v$4023 = v$4020[0];
closetab$1880(v$4023);
var t$10452 = v$4021;
var v$4018 = t$10452;
continue lab$app;
};
};
};
var app$4017 = fix$10451.$app;
app$4017(v$1972);
var fix$10453 = {};
fix$10453.$app = function(v$4026){lab$app: while (true) {if (v$4026 == null) {return 0;
} else {var v$4027 = v$4026;
var v$4028 = v$4027[0];
var v$4029 = v$4027[1];
var v$4049 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$4049[0]) { case 0: {var v$4050 = v$4049[1];
appfun2$0dropbox$1.delete_file$414(v$4050,v$4028,(function(env$10458){return function(v$4051){var v$10454 = env$10458[0];
var v$10455 = env$10458[1];
var v$10456 = env$10458[2];
var v$10457 = env$10458[3];
var v$4052 = v$4051[0];
var s$4053 = ((("Deleted file " + (("'" + v$10457) + "'")) + " (") + v$4052) + ")";
var s$4060;
var t$10464;
var t$10463;
var t$10462;
var t$10461 = v$10456;
var t$10460 = "%H:%M:%S";
var t$10459;
var v$10001 = SmlPrims.getrealtime();
t$10459 = (v$10455(v$10001[0],v$10001[1]));
t$10462 = (t$10461(t$10460,t$10459));
t$10463 = (t$10462 + ": ");
t$10464 = (t$10463 + s$4053);
s$4060 = (t$10464 + "\n");
(function(e,a){return e.appendChild(a);})(v$10454,document.createTextNode(s$4060));
return (function(t){t.scrollTop = t.scrollHeight;})(v$10454);
};
})([smltojs0$0SmlToJsCompApp$1$2.logarea$949,basis$0Date$1.fromTimeLocal$512,basis$0Date$1.fmt$816,v$4028]));
 break; }default: {0;
} };
var t$10465 = v$4029;
var v$4026 = t$10465;
continue lab$app;
};
};
};
var app$4025 = fix$10453.$app;
app$4025(v$1966);
var fix$10466 = {};
fix$10466.$app = function(v$4067){lab$app: while (true) {if (v$4067 == null) {return 0;
} else {var v$4068 = v$4067;
var v$4069 = v$4068[0];
var v$4070 = v$4068[1];
var v$4090 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$4090[0]) { case 0: {var v$4091 = v$4090[1];
appfun2$0dropbox$1.delete_dir$472(v$4091,v$4069,(function(env$10471){return function(v$4092){var v$10467 = env$10471[0];
var v$10468 = env$10471[1];
var v$10469 = env$10471[2];
var v$10470 = env$10471[3];
var v$4093 = v$4092[0];
var s$4094 = ((("Deleted folder " + (("'" + v$10470) + "'")) + " (") + v$4093) + ")";
var s$4101;
var t$10477;
var t$10476;
var t$10475;
var t$10474 = v$10469;
var t$10473 = "%H:%M:%S";
var t$10472;
var v$10002 = SmlPrims.getrealtime();
t$10472 = (v$10468(v$10002[0],v$10002[1]));
t$10475 = (t$10474(t$10473,t$10472));
t$10476 = (t$10475 + ": ");
t$10477 = (t$10476 + s$4094);
s$4101 = (t$10477 + "\n");
(function(e,a){return e.appendChild(a);})(v$10467,document.createTextNode(s$4101));
return (function(t){t.scrollTop = t.scrollHeight;})(v$10467);
};
})([smltojs0$0SmlToJsCompApp$1$2.logarea$949,basis$0Date$1.fromTimeLocal$512,basis$0Date$1.fmt$816,v$4069]));
 break; }default: {0;
} };
var t$10478 = v$4070;
var v$4067 = t$10478;
continue lab$app;
};
};
};
var app$4066 = fix$10466.$app;
app$4066(v$1956);
var s$4106 = ("Deleted folder " + (("'" + v$1889) + "'")) + " completely";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4106);
var s$4108;
var t$10484;
var t$10483;
var t$10482;
var t$10481 = basis$0Date$1.fmt$816;
var t$10480 = "%H:%M:%S";
var t$10479;
var v$10003 = SmlPrims.getrealtime();
t$10479 = (basis$0Date$1.fromTimeLocal$512(v$10003[0],v$10003[1]));
t$10482 = (t$10481(t$10480,t$10479));
t$10483 = (t$10482 + ": ");
t$10484 = (t$10483 + s$4106);
s$4108 = (t$10484 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4108));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
} };
 break; }default: {var f$1978 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var t$10485;
var v$4120 = basis$0String$1.tokens$224(function(c$4121){return c$4121 == 47;
},f$1978);
if (v$4120 == null) {t$10485 = false;
} else {var v$4122 = v$4120;
switch (v$4122[0]) { case "Server": {t$10485 = true;
 break; }default: {t$10485 = false;
} };
};
if (t$10485) {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"You cannot delete files in the Server folder");
var s$4125;
var t$10491;
var t$10490;
var t$10489;
var t$10488 = basis$0Date$1.fmt$816;
var t$10487 = "%H:%M:%S";
var t$10486;
var v$10004 = SmlPrims.getrealtime();
t$10486 = (basis$0Date$1.fromTimeLocal$512(v$10004[0],v$10004[1]));
t$10489 = (t$10488(t$10487,t$10486));
t$10490 = (t$10489 + ": ");
t$10491 = (t$10490 + "You cannot delete files in the Server folder");
s$4125 = (t$10491 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4125));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
} else {(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = (basis$0List$1.filter$417(function(v$2009){var v$2010 = v$2009[0];
return (v$2010 == f$1978)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0])),0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = (basis$0List$1.filter$417(function(f$$2006){return (f$$2006 == f$1978)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0])),0);
var t$10492;
var v$4146 = basis$0String$1.tokens$224(function(c$4147){return c$4147 == 47;
},f$1978);
if (v$4146 == null) {t$10492 = false;
} else {var v$4148 = v$4146;
switch (v$4148[0]) { case "Server": {t$10492 = true;
 break; }default: {t$10492 = false;
} };
};
t$10492?0:((function(obj,a){return obj.remove(a);})(fts$1877,f$1978));
closetab$1880(f$1978);
var v$1997 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$1997[0]) { case 0: {var v$2003 = v$1997[1];
return appfun2$0dropbox$1.delete_file$414(v$2003,f$1978,function(v$2001){var v$2002 = v$2001[0];
var s$4152 = ((("Deleted file " + (("'" + f$1978) + "'")) + " (") + v$2002) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4152);
var s$4154;
var t$10498;
var t$10497;
var t$10496;
var t$10495 = basis$0Date$1.fmt$816;
var t$10494 = "%H:%M:%S";
var t$10493;
var v$10005 = SmlPrims.getrealtime();
t$10493 = (basis$0Date$1.fromTimeLocal$512(v$10005[0],v$10005[1]));
t$10496 = (t$10495(t$10494,t$10493));
t$10497 = (t$10496 + ": ");
t$10498 = (t$10497 + s$4152);
s$4154 = (t$10498 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4154));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
 break; }default: {return 0;
} };
};
} };
};
smltojs0$0SmlToJsCompApp$1$2.addTab$2011 = function(filename$2014,md5$2017,editor$2020){return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = [[filename$2014,[md5$2017],editor$2020],smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]],0);
};
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021 = function(v$2056,v$2057,v$2058){var c$2027 = v$2058[0](0);
var newMd5$2032 = md5$0md5$1.fromString$410(c$2027);
if (v$2057[0] == newMd5$2032) {return 0;
} else {var t$10500;
var v$4174 = basis$0String$1.tokens$224(function(c$4175){return c$4175 == 47;
},v$2056);
if (v$4174 == null) {t$10500 = false;
} else {var v$4176 = v$4174;
switch (v$4176[0]) { case "Server": {t$10500 = true;
 break; }default: {t$10500 = false;
} };
};
if (t$10500) {var s$4177 = ("Modified server file " + (("'" + v$2056) + "'")) + " not saved";
notify0$1000("#dddd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4177);
var s$4179;
var t$10506;
var t$10505;
var t$10504;
var t$10503 = basis$0Date$1.fmt$816;
var t$10502 = "%H:%M:%S";
var t$10501;
var v$10006 = SmlPrims.getrealtime();
t$10501 = (basis$0Date$1.fromTimeLocal$512(v$10006[0],v$10006[1]));
t$10504 = (t$10503(t$10502,t$10501));
t$10505 = (t$10504 + ": ");
t$10506 = (t$10505 + s$4177);
s$4179 = (t$10506 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4179));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
} else {try {var v$2045 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$2045[0]) { case 0: {var v$2053 = v$2045[1];
return appfun2$0dropbox$1.write_file$328(v$2053,v$2056,c$2027,function(v$2049){var v$2052 = v$2049[0];
var s$4190 = ((("Saved file " + (("'" + v$2056) + "'")) + " (") + v$2052) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4190);
var s$4192;
var t$10512;
var t$10511;
var t$10510;
var t$10509 = basis$0Date$1.fmt$816;
var t$10508 = "%H:%M:%S";
var t$10507;
var v$10007 = SmlPrims.getrealtime();
t$10507 = (basis$0Date$1.fromTimeLocal$512(v$10007[0],v$10007[1]));
t$10510 = (t$10509(t$10508,t$10507));
t$10511 = (t$10510 + ": ");
t$10512 = (t$10511 + s$4190);
s$4192 = (t$10512 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4192));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return (v$2057[0] = newMd5$2032,0);
});
 break; }default: {return 0;
} };
} catch(v$10499) {return (function(v$2055){return 0;
})(v$10499);
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.autosave$2059 = function(v$2061){var fix$10513 = {};
fix$10513.$app = function(v$4207){lab$app: while (true) {if (v$4207 == null) {return 0;
} else {var v$4208 = v$4207;
var v$4209 = v$4208[0];
var v$4210 = v$4208[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021(v$4209[0],v$4209[1],v$4209[2]);
var t$10514 = v$4210;
var v$4207 = t$10514;
continue lab$app;
};
};
};
var app$4206 = fix$10513.$app;
return app$4206(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
};
smltojs0$0SmlToJsCompApp$1$2.closeTab$2062 = function(n$2065){var v$2090;
var t$10515;
var p$4213 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var fields$4214 = basis$0String$1.fields$231(function(c$4215){return c$4215 == 47;
},p$4213);
var v$4216 = basis$0List$1.rev$682(fields$4214);
if (v$4216 == null) {t$10515 = false;
} else {var v$4217 = v$4216;
var v$4218 = v$4217[0];
var v$4219 = v$4217[1];
var t$10518;
var v$6600 = basis$0String$1.fields$231(function(c$6601){return c$6601 == 46;
},v$4218);
if (v$6600 == null) {t$10518 = false;
} else {var v$6602 = v$6600;
var v$6603 = v$6602[1];
if (v$6603 == null) {t$10518 = false;
} else {var v$6604 = v$6603;
if (v$6604[1] == null) {var v$6605 = v$6602[0];
var v$6606 = v$6604[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6605)) {var fix$10519 = {};
fix$10519.$exists = function(v$6608){lab$exists: while (true) {if (v$6608 == null) {return false;
} else {var v$6609 = v$6608;
var v$6610 = v$6609[0];
var v$6611 = v$6609[1];
if (v$6606 == v$6610) {return true;
} else {var t$10520 = v$6611;
var v$6608 = t$10520;
continue lab$exists;
};
};
};
};
var exists$6607 = fix$10519.$exists;
t$10518 = (exists$6607(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10518 = false;
};
} else {t$10518 = false;
};
};
};
if (t$10518) {var fix$10516 = {};
fix$10516.$all = function(v$4221){lab$all: while (true) {if (v$4221 == null) {return true;
} else {var v$4222 = v$4221;
var v$4223 = v$4222[0];
var v$4224 = v$4222[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4223)) {var t$10517 = v$4224;
var v$4221 = t$10517;
continue lab$all;
} else {return false;
};
};
};
};
var all$4220 = fix$10516.$all;
t$10515 = (all$4220(v$4219));
} else {t$10515 = false;
};
};
v$2090 = (t$10515?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$2090[0]) { case 0: {var v$2096 = v$2090[1];
(n$2065 == v$2096)?(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0):0;
 break; }default: {0;
} };
var v$2078 = basis$0List$1.find$392(function(v$2083){return v$2083[0] == n$2065;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
switch (v$2078[0]) { case 0: {var v$2080 = v$2078[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021(v$2080[0],v$2080[1],v$2080[2]);
 break; }default: {0;
} };
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = (basis$0List$1.filter$417(function(v$2071){var v$2072 = v$2071[0];
return (v$2072 == n$2065)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0])),0);
};
smltojs0$0SmlToJsCompApp$1$2.stripAbsolute$2097 = function(a$2100){var t$10522;
if (a$2100.length > 0) {var t$10521;
if (0 >= a$2100.length) {throw CompilerInitial.exn$Subscript$52;
} else {t$10521 = (a$2100.charCodeAt(0));
};
t$10522 = (t$10521 == 47);
} else {t$10522 = false;
};
return t$10522?[0,basis$0String$1.extract$116(a$2100,1,[1])]:[1];
};
smltojs0$0SmlToJsCompApp$1$2.move$2109 = function(fts$2112,folderpath$2115,filename$2118,newfile$2121){var v$2202;
var t$10525;
var fields$4246 = basis$0String$1.fields$231(function(c$4247){return c$4247 == 47;
},newfile$2121);
var v$4248 = basis$0List$1.rev$682(fields$4246);
if (v$4248 == null) {t$10525 = false;
} else {var v$4249 = v$4248;
var v$4250 = v$4249[0];
var v$4251 = v$4249[1];
var t$10528;
var v$6616 = basis$0String$1.fields$231(function(c$6617){return c$6617 == 46;
},v$4250);
if (v$6616 == null) {t$10528 = false;
} else {var v$6618 = v$6616;
var v$6619 = v$6618[1];
if (v$6619 == null) {t$10528 = false;
} else {var v$6620 = v$6619;
if (v$6620[1] == null) {var v$6621 = v$6618[0];
var v$6622 = v$6620[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6621)) {var fix$10529 = {};
fix$10529.$exists = function(v$6624){lab$exists: while (true) {if (v$6624 == null) {return false;
} else {var v$6625 = v$6624;
var v$6626 = v$6625[0];
var v$6627 = v$6625[1];
if (v$6622 == v$6626) {return true;
} else {var t$10530 = v$6627;
var v$6624 = t$10530;
continue lab$exists;
};
};
};
};
var exists$6623 = fix$10529.$exists;
t$10528 = (exists$6623(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10528 = false;
};
} else {t$10528 = false;
};
};
};
if (t$10528) {var fix$10526 = {};
fix$10526.$all = function(v$4253){lab$all: while (true) {if (v$4253 == null) {return true;
} else {var v$4254 = v$4253;
var v$4255 = v$4254[0];
var v$4256 = v$4254[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4255)) {var t$10527 = v$4256;
var v$4253 = t$10527;
continue lab$all;
} else {return false;
};
};
};
};
var all$4252 = fix$10526.$all;
t$10525 = (all$4252(v$4251));
} else {t$10525 = false;
};
};
if (t$10525) {var v$2215 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(newfile$2121);
var v$2216 = v$2215[1];
switch (v$2216[0]) { case 0: {var v$2223 = v$2215[0];
var t$10533;
switch (folderpath$2115) { case "0": {t$10533 = newfile$2121;
 break; }default: {t$10533 = ((folderpath$2115 + "/") + newfile$2121);
} };
var t$10532 = v$2216[1];
var t$10531;
if (v$2223 == "0") {t$10531 = folderpath$2115;
} else {switch (folderpath$2115) { case "0": {t$10531 = v$2223;
 break; }default: {t$10531 = ((folderpath$2115 + "/") + v$2223);
} };
};
v$2202 = [t$10533,t$10532,t$10531];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"move.impossible: newfile is a file"];
} };
} else {var v$2229;
var t$10524;
if (newfile$2121.length > 0) {var t$10523;
if (0 >= newfile$2121.length) {throw CompilerInitial.exn$Subscript$52;
} else {t$10523 = (newfile$2121.charCodeAt(0));
};
t$10524 = (t$10523 == 47);
} else {t$10524 = false;
};
v$2229 = (t$10524?[0,basis$0String$1.extract$116(newfile$2121,1,[1])]:[1]);
switch (v$2229[0]) { case 0: {var v$2245 = v$2229[1];
var t$10534;
var fields$4276 = basis$0String$1.fields$231(function(c$4277){return c$4277 == 47;
},v$2245);
var v$4278 = basis$0List$1.rev$682(fields$4276);
if (v$4278 == null) {t$10534 = false;
} else {var v$4279 = v$4278;
var v$4280 = v$4279[0];
var v$4281 = v$4279[1];
var t$10537;
var v$6630 = basis$0String$1.fields$231(function(c$6631){return c$6631 == 46;
},v$4280);
if (v$6630 == null) {t$10537 = false;
} else {var v$6632 = v$6630;
var v$6633 = v$6632[1];
if (v$6633 == null) {t$10537 = false;
} else {var v$6634 = v$6633;
if (v$6634[1] == null) {var v$6635 = v$6632[0];
var v$6636 = v$6634[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6635)) {var fix$10538 = {};
fix$10538.$exists = function(v$6638){lab$exists: while (true) {if (v$6638 == null) {return false;
} else {var v$6639 = v$6638;
var v$6640 = v$6639[0];
var v$6641 = v$6639[1];
if (v$6636 == v$6640) {return true;
} else {var t$10539 = v$6641;
var v$6638 = t$10539;
continue lab$exists;
};
};
};
};
var exists$6637 = fix$10538.$exists;
t$10537 = (exists$6637(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10537 = false;
};
} else {t$10537 = false;
};
};
};
if (t$10537) {var fix$10535 = {};
fix$10535.$all = function(v$4283){lab$all: while (true) {if (v$4283 == null) {return true;
} else {var v$4284 = v$4283;
var v$4285 = v$4284[0];
var v$4286 = v$4284[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4285)) {var t$10536 = v$4286;
var v$4283 = t$10536;
continue lab$all;
} else {return false;
};
};
};
};
var all$4282 = fix$10535.$all;
t$10534 = (all$4282(v$4281));
} else {t$10534 = false;
};
};
if (t$10534) {var v$2240 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(v$2245);
var v$2241 = v$2240[1];
switch (v$2241[0]) { case 0: {v$2202 = [v$2245,v$2241[1],v$2240[0]];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"move.impossible: newfile is a file"];
} };
} else {throw [basis$0Initial$1.en$Fail$54,"Invalid target path " + (("'" + newfile$2121) + "'")];
};
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Invalid target path " + (("'" + newfile$2121) + "'")];
} };
};
var v$2203 = v$2202[0];
var v$2204 = v$2202[1];
var v$2205 = v$2202[2];
var filepath$2126;
switch (folderpath$2115) { case "0": {filepath$2126 = filename$2118;
 break; }default: {filepath$2126 = ((folderpath$2115 + "/") + filename$2118);
} };
var v$5953;
var v$4301 = basis$0String$1.tokens$224(function(c$4302){return c$4302 == 47;
},filepath$2126);
if (v$4301 == null) {v$5953 = false;
} else {var v$4303 = v$4301;
switch (v$4303[0]) { case "Dropbox": {v$5953 = true;
 break; }default: {v$5953 = false;
} };
};
var v$5954;
var v$4305 = basis$0String$1.tokens$224(function(c$4306){return c$4306 == 47;
},v$2203);
if (v$4305 == null) {v$5954 = false;
} else {var v$4307 = v$4305;
switch (v$4307[0]) { case "Dropbox": {v$5954 = true;
 break; }default: {v$5954 = false;
} };
};
if (v$5953) {if (v$5954) {0;
} else {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to or from Dropbox paths"];
};
} else {if (v$5954) {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to or from Dropbox paths"];
} else {0;
};
};
var t$10547;
var v$4311 = basis$0String$1.tokens$224(function(c$4312){return c$4312 == 47;
},v$2203);
if (v$4311 == null) {t$10547 = false;
} else {var v$4313 = v$4311;
switch (v$4313[0]) { case "Server": {t$10547 = true;
 break; }default: {t$10547 = false;
} };
};
if (t$10547) {throw [basis$0Initial$1.en$Fail$54,"Files cannot be moved to the server"];
} else {var t$10546;
var fix$10544 = {};
fix$10544.$exists = function(v$4316){lab$exists: while (true) {if (v$4316 == null) {return false;
} else {var v$4317 = v$4316;
var v$4318 = v$4317[0];
var v$4319 = v$4317[1];
if (v$4318 == v$2203) {return true;
} else {var t$10545 = v$4319;
var v$4316 = t$10545;
continue lab$exists;
};
};
};
};
var exists$4315 = fix$10544.$exists;
t$10546 = (exists$4315(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10546) {throw [basis$0Initial$1.en$Fail$54,("File " + (("'" + v$2203) + "'")) + " already exists"];
} else {var t$10543;
var t$10542;
var fix$10540 = {};
fix$10540.$exists = function(v$4333){lab$exists: while (true) {if (v$4333 == null) {return false;
} else {var v$4334 = v$4333;
var v$4335 = v$4334[0];
var v$4336 = v$4334[1];
if (v$4335 == v$2205) {return true;
} else {var t$10541 = v$4336;
var v$4333 = t$10541;
continue lab$exists;
};
};
};
};
var exists$4332 = fix$10540.$exists;
t$10542 = (exists$4332(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
t$10543 = (t$10542?false:true);
if (t$10543) {throw [basis$0Initial$1.en$Fail$54,("Target folder " + (("'" + v$2205) + "'")) + " does not exist"];
} else {var v$2144 = basis$0List$1.find$392(function(v$2188){return v$2188[0] == filepath$2126;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
switch (v$2144[0]) { case 0: {var v$2184 = v$2144[1];
var v$2185 = v$2184[2];
(smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = "0",0);
(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = (basis$0List$1.filter$417(function(v$2182){var v$2183 = v$2182[0];
return (v$2183 == filepath$2126)?false:true;
},smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0])),0);
(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0] = (basis$0List$1.map$332(function(n$2175){return ((n$2175 == filepath$2126)?false:true)?n$2175:v$2203;
},smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0])),0);
var t$10548;
var v$4368 = basis$0String$1.tokens$224(function(c$4369){return c$4369 == 47;
},filepath$2126);
if (v$4368 == null) {t$10548 = false;
} else {var v$4370 = v$4368;
switch (v$4370[0]) { case "Server": {t$10548 = true;
 break; }default: {t$10548 = false;
} };
};
t$10548?0:((function(obj,a){return obj.remove(a);})(fts$2112,filepath$2126));
var h$4374 = [["id",v$2203],[["parent",v$2205],[["name",v$2204],[["kind","leaf"],null]]]];
var t$10554 = fts$2112;
var t$10553;
var fix$10549 = {};
fix$10549.$foldl = function(v$4376,v$4377){lab$foldl: while (true) {if (v$4377 == null) {return v$4376;
} else {var v$4378 = v$4377;
var v$4379 = v$4378[0];
var v$4380 = v$4378[1];
var t$10550;
var v$4381 = v$4379[0];
var v$4382 = v$4379[1];
(function(fp,s,v){fp[s] = v;})(v$4376,v$4381,v$4382);
t$10550 = v$4376;
var t$10551 = t$10550;
var t$10552 = v$4380;
var v$4376 = t$10551;
var v$4377 = t$10552;
continue lab$foldl;
};
};
};
var foldl$4375 = fix$10549.$foldl;
var v$10045 = (function(){return {};})();
t$10553 = (foldl$4375(v$10045,h$4374));
(function(obj,a){return obj.add(a);})(t$10554,t$10553);
var v$2166 = smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0];
switch (v$2166[0]) { case 0: {var v$2172 = v$2166[1];
appfun2$0dropbox$1.move_file$482(v$2172,filepath$2126,v$2203,function(v$2170){var v$2171 = v$2170[0];
var s$4384 = ((((("Moved file " + (("'" + filepath$2126) + "'")) + " to ") + (("'" + v$2203) + "'")) + " (") + v$2171) + ")";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$4384);
var s$4386;
var t$10560;
var t$10559;
var t$10558;
var t$10557 = basis$0Date$1.fmt$816;
var t$10556 = "%H:%M:%S";
var t$10555;
var v$10008 = SmlPrims.getrealtime();
t$10555 = (basis$0Date$1.fromTimeLocal$512(v$10008[0],v$10008[1]));
t$10558 = (t$10557(t$10556,t$10555));
t$10559 = (t$10558 + ": ");
t$10560 = (t$10559 + s$4384);
s$4386 = (t$10560 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4386));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
 break; }default: {0;
} };
return [v$2203,v$2185[0](0)];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"Impossible: cannot locate file in tab structure!"];
} };
};
};
};
};
smltojs0$0SmlToJsCompApp$1$2.ftsServer$2246;
var content$2247;
var file$6646;
var t$10564 = "otests/content?_=";
var t$10563;
var t$10562 = basis$0Real$1.toString$153;
var t$10561;
var v$6647 = SmlPrims.getrealtime();
t$10561 = ((v$6647[0] - (-2147483648)) + (v$6647[1] / 1000000.0));
t$10563 = (t$10562(t$10561));
file$6646 = (t$10564 + t$10563);
var r$6648 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$6648,"GET",file$6646,false);
js$0Js$1.send$654(r$6648,[1]);
var v$6649 = (function(r){return SmlPrims.option(r.responseText);})(r$6648);
switch (v$6649[0]) { case 0: {content$2247 = v$6649[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"serverGet failed on file " + file$6646];
} };
var content$2248 = basis$0String$1.translate$217(function(c$2251){return ((c$2251 == 32)?true:((9 <= c$2251)?(c$2251 <= 13):false))?"":(SmlPrims.implode([c$2251,null]));
},content$2247);
var lines$2256 = basis$0String$1.tokens$224(function(c$2259){return c$2259 == 59;
},content$2248);
var t$10586;
var t$10585 = [["id","Server"],[["name","Server"],[["kind","folder"],[["parent","0"],null]]]];
var t$10584;
var t$10565;
var v$6650 = null;
var fix$10566 = {};
fix$10566.$foldr = function(v$6652){if (v$6652 == null) {return v$6650;
} else {var v$6653 = v$6652;
var v$6654 = v$6653[0];
var v$6655 = v$6653[1];
var v$6657 = fix$10566.$foldr(v$6655);
var t$10583 = basis$0List$1.s$n$686;
var t$10567;
var v$6660 = basis$0String$1.tokens$224(function(c$6661){return c$6661 == 61;
},v$6654);
if (v$6660 == null) {t$10567 = null;
} else {var v$6662 = v$6660;
var v$6663 = v$6662[1];
if (v$6663 == null) {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"syntax error in otests/content file");
var s$6687;
var t$10573;
var t$10572;
var t$10571;
var t$10570 = basis$0Date$1.fmt$816;
var t$10569 = "%H:%M:%S";
var t$10568;
var v$10010 = SmlPrims.getrealtime();
t$10568 = (basis$0Date$1.fromTimeLocal$512(v$10010[0],v$10010[1]));
t$10571 = (t$10570(t$10569,t$10568));
t$10572 = (t$10571 + ": ");
t$10573 = (t$10572 + "syntax error in otests/content file");
s$6687 = (t$10573 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$6687));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
t$10567 = null;
} else {var v$6664 = v$6663;
if (v$6664[1] == null) {var v$6665 = v$6662[0];
var v$6666 = v$6664[0];
var sfolder$6667 = "Server/" + v$6665;
var t$10576;
var t$10575 = [["id",sfolder$6667],[["name",v$6665],[["kind","folder"],[["parent","Server"],null]]]];
var t$10574;
var files$6670 = basis$0String$1.tokens$224(function(c$6671){return c$6671 == 44;
},v$6666);
t$10574 = (basis$0List$1.map$332(function(f$6672){return [["id",(sfolder$6667 + "/") + f$6672],[["name",f$6672],[["kind","file"],[["parent",sfolder$6667],null]]]];
},files$6670));
t$10576 = [t$10575,t$10574];
t$10567 = t$10576;
} else {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"syntax error in otests/content file");
var s$6677;
var t$10582;
var t$10581;
var t$10580;
var t$10579 = basis$0Date$1.fmt$816;
var t$10578 = "%H:%M:%S";
var t$10577;
var v$10009 = SmlPrims.getrealtime();
t$10577 = (basis$0Date$1.fromTimeLocal$512(v$10009[0],v$10009[1]));
t$10580 = (t$10579(t$10578,t$10577));
t$10581 = (t$10580 + ": ");
t$10582 = (t$10581 + "syntax error in otests/content file");
s$6677 = (t$10582 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$6677));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
t$10567 = null;
};
};
};
return t$10583(t$10567,v$6657);
};
};
var foldr$6651 = fix$10566.$foldr;
t$10565 = (function(v$10158){return foldr$6651(v$10158);
});
t$10584 = (t$10565(lines$2256));
t$10586 = [t$10585,t$10584];
smltojs0$0SmlToJsCompApp$1$2.ftsServer$2246 = t$10586;
smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308 = function(v$2344,v$2345){return function(filename$2315){return function(content$2318){var inarea$2319;
var attrs$4504 = [["style","border:0;"],null];
var elem$4505 = document.createTextNode(content$2318);
var newelem$4506 = document.createElement("textarea");
var fix$10587 = {};
fix$10587.$app = function(v$4508){lab$app: while (true) {if (v$4508 == null) {return 0;
} else {var v$4509 = v$4508;
var v$4510 = v$4509[0];
var v$4511 = v$4509[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4506,v$4510[0],v$4510[1]);
var t$10588 = v$4511;
var v$4508 = t$10588;
continue lab$app;
};
};
};
var app$4507 = fix$10587.$app;
app$4507(attrs$4504);
(function(e,a){return e.appendChild(a);})(newelem$4506,elem$4505);
inarea$2319 = newelem$4506;
var inputarea$2320;
var attrs$4514 = [["class","textareacontainer"],null];
var newelem$4516 = document.createElement("div");
var fix$10589 = {};
fix$10589.$app = function(v$4518){lab$app: while (true) {if (v$4518 == null) {return 0;
} else {var v$4519 = v$4518;
var v$4520 = v$4519[0];
var v$4521 = v$4519[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4516,v$4520[0],v$4520[1]);
var t$10590 = v$4521;
var v$4518 = t$10590;
continue lab$app;
};
};
};
var app$4517 = fix$10589.$app;
app$4517(attrs$4514);
(function(e,a){return e.appendChild(a);})(newelem$4516,inarea$2319);
inputarea$2320 = newelem$4516;
var m$4522;
var v$6046;
var h$4529 = [["style","height:100%;"],[["title",filename$2315],[["closable","true"],null]]];
v$6046 = (function(f$4531){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$4532){var p$4533;
var t$10596 = Cp$4532;
var t$10595;
var fix$10591 = {};
fix$10591.$foldl = function(v$4535,v$4536){lab$foldl: while (true) {if (v$4536 == null) {return v$4535;
} else {var v$4537 = v$4536;
var v$4538 = v$4537[0];
var v$4539 = v$4537[1];
var t$10592;
var v$4540 = v$4538[0];
var v$4541 = v$4538[1];
(function(fp,s,v){fp[s] = v;})(v$4535,v$4540,v$4541);
t$10592 = v$4535;
var t$10593 = t$10592;
var t$10594 = v$4539;
var v$4535 = t$10593;
var v$4536 = t$10594;
continue lab$foldl;
};
};
};
var foldl$4534 = fix$10591.$foldl;
var v$10047 = (function(){return {};})();
t$10595 = (foldl$4534(v$10047,h$4529));
p$4533 = ((function(c,h){return new c(h);})(t$10596,t$10595));
(function(w,e){w.set('content', e);})(p$4533,inputarea$2320);
return f$4531(p$4533);
});
});
m$4522 = (function(c$4527){return v$6046(function(v$4528){(function(w,f){w.onClose = f;})(v$4528,function(v$6703){smltojs0$0SmlToJsCompApp$1$2.closeTab$2062(filename$2315);
return true;
});
(function(w,f){w.onShow = f;})(v$4528,function(v$6704){return (smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = filename$2315,0);
});
(function(obj,a){return obj.addChild(a);})(v$2344,v$4528);
(function(obj,a1,a2){return obj.selectChild(a1,a2);})(v$2344,v$4528,true);
(v$2345[0] = [[filename$2315,v$4528],v$2345[0]],0);
var a$6705 = 0;
return c$4527(a$6705);
});
});
m$4522(function(x$4523){return x$4523;
});
var editor$2322 = smltojs0$0SmlToJsCompApp$1$2.mkEditor$1192(inarea$2319);
return (smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0] = [[filename$2315,[md5$0md5$1.fromString$410(content$2318)],editor$2322],smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]],0);
};
};
};
smltojs0$0SmlToJsCompApp$1$2.button$2346 = function(s$2349){var attrs$4561 = [["style","height:25px; width:100px;"],null];
var elem$4562;
var attrs$4570 = null;
var elem$4571 = document.createTextNode(s$2349);
var newelem$4572 = document.createElement("b");
var fix$10597 = {};
fix$10597.$app = function(v$4574){lab$app: while (true) {if (v$4574 == null) {return 0;
} else {var v$4575 = v$4574;
var v$4576 = v$4575[0];
var v$4577 = v$4575[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4572,v$4576[0],v$4576[1]);
var t$10598 = v$4577;
var v$4574 = t$10598;
continue lab$app;
};
};
};
var app$4573 = fix$10597.$app;
app$4573(attrs$4570);
(function(e,a){return e.appendChild(a);})(newelem$4572,elem$4571);
elem$4562 = newelem$4572;
var newelem$4563 = document.createElement("button");
var fix$10599 = {};
fix$10599.$app = function(v$4565){lab$app: while (true) {if (v$4565 == null) {return 0;
} else {var v$4566 = v$4565;
var v$4567 = v$4566[0];
var v$4568 = v$4566[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4563,v$4567[0],v$4567[1]);
var t$10600 = v$4568;
var v$4565 = t$10600;
continue lab$app;
};
};
};
var app$4564 = fix$10599.$app;
app$4564(attrs$4561);
(function(e,a){return e.appendChild(a);})(newelem$4563,elem$4562);
return newelem$4563;
};
smltojs0$0SmlToJsCompApp$1$2.withDialog$2350 = function(v$2401,v$2400,v$2406,v$2403,v$2402,v$2404,v$2405){var msgArea$2360;
var attrs$4580 = [["class","notify_area2"],[["style","opacity:0.0;top:0px;"],null]];
var newelem$4581 = document.createElement("span");
var fix$10601 = {};
fix$10601.$app = function(v$4583){lab$app: while (true) {if (v$4583 == null) {return 0;
} else {var v$4584 = v$4583;
var v$4585 = v$4584[0];
var v$4586 = v$4584[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4581,v$4585[0],v$4585[1]);
var t$10602 = v$4586;
var v$4583 = t$10602;
continue lab$app;
};
};
};
var app$4582 = fix$10601.$app;
app$4582(attrs$4580);
msgArea$2360 = newelem$4581;
var field$2379;
var attrs$4589 = [["type","text"],[["value",v$2404],null]];
var newelem$4590 = document.createElement("input");
var fix$10603 = {};
fix$10603.$app = function(v$4592){lab$app: while (true) {if (v$4592 == null) {return 0;
} else {var v$4593 = v$4592;
var v$4594 = v$4593[0];
var v$4595 = v$4593[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4590,v$4594[0],v$4594[1]);
var t$10604 = v$4595;
var v$4592 = t$10604;
continue lab$app;
};
};
};
var app$4591 = fix$10603.$app;
app$4591(attrs$4589);
field$2379 = newelem$4590;
var but$2380 = smltojs0$0SmlToJsCompApp$1$2.button$2346(v$2401);
var intro$2381;
switch (v$2403[0]) { case 0: {var v$2388 = v$2403[1];
var attrs$4597 = null;
var newelem$4599 = document.createElement("p");
var fix$10605 = {};
fix$10605.$app = function(v$4601){lab$app: while (true) {if (v$4601 == null) {return 0;
} else {var v$4602 = v$4601;
var v$4603 = v$4602[0];
var v$4604 = v$4602[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4599,v$4603[0],v$4603[1]);
var t$10606 = v$4604;
var v$4601 = t$10606;
continue lab$app;
};
};
};
var app$4600 = fix$10605.$app;
app$4600(attrs$4597);
(function(e,a){return e.appendChild(a);})(newelem$4599,v$2388);
intro$2381 = newelem$4599;
 break; }default: {intro$2381 = (document.createTextNode(""));
} };
var content$2389;
var attrs$4607 = [["style","width:400px;"],null];
var elem$4608;
var v$6054;
var v$6057;
var attrs$4624 = null;
var elem$4625;
var v$6058 = document.createTextNode(v$2402 + ": ");
var e$4635 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4635,v$6058);
(function(e,a){return e.appendChild(a);})(e$4635,field$2379);
elem$4625 = e$4635;
var newelem$4626 = document.createElement("p");
var fix$10607 = {};
fix$10607.$app = function(v$4628){lab$app: while (true) {if (v$4628 == null) {return 0;
} else {var v$4629 = v$4628;
var v$4630 = v$4629[0];
var v$4631 = v$4629[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4626,v$4630[0],v$4630[1]);
var t$10608 = v$4631;
var v$4628 = t$10608;
continue lab$app;
};
};
};
var app$4627 = fix$10607.$app;
app$4627(attrs$4624);
(function(e,a){return e.appendChild(a);})(newelem$4626,elem$4625);
v$6057 = newelem$4626;
var e$4622 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4622,intro$2381);
(function(e,a){return e.appendChild(a);})(e$4622,v$6057);
v$6054 = e$4622;
var v$6055;
var attrs$4639 = null;
var elem$4640;
var v$6062;
var v$6065 = document.createTextNode(" ");
var e$4654 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4654,but$2380);
(function(e,a){return e.appendChild(a);})(e$4654,v$6065);
v$6062 = e$4654;
var e$4650 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4650,v$6062);
(function(e,a){return e.appendChild(a);})(e$4650,msgArea$2360);
elem$4640 = e$4650;
var newelem$4641 = document.createElement("p");
var fix$10609 = {};
fix$10609.$app = function(v$4643){lab$app: while (true) {if (v$4643 == null) {return 0;
} else {var v$4644 = v$4643;
var v$4645 = v$4644[0];
var v$4646 = v$4644[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4641,v$4645[0],v$4645[1]);
var t$10610 = v$4646;
var v$4643 = t$10610;
continue lab$app;
};
};
};
var app$4642 = fix$10609.$app;
app$4642(attrs$4639);
(function(e,a){return e.appendChild(a);})(newelem$4641,elem$4640);
v$6055 = newelem$4641;
var e$4618 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4618,v$6054);
(function(e,a){return e.appendChild(a);})(e$4618,v$6055);
elem$4608 = e$4618;
var newelem$4609 = document.createElement("p");
var fix$10611 = {};
fix$10611.$app = function(v$4611){lab$app: while (true) {if (v$4611 == null) {return 0;
} else {var v$4612 = v$4611;
var v$4613 = v$4612[0];
var v$4614 = v$4612[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4609,v$4613[0],v$4613[1]);
var t$10612 = v$4614;
var v$4611 = t$10612;
continue lab$app;
};
};
};
var app$4610 = fix$10611.$app;
app$4610(attrs$4607);
(function(e,a){return e.appendChild(a);})(newelem$4609,elem$4608);
content$2389 = newelem$4609;
var dM$2390;
var v$6066;
var h$4661 = [["title",v$2400],null];
v$6066 = (function(f$4663){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4664){var d$4665;
var t$10618 = D$4664;
var t$10617;
var fix$10613 = {};
fix$10613.$foldl = function(v$4667,v$4668){lab$foldl: while (true) {if (v$4668 == null) {return v$4667;
} else {var v$4669 = v$4668;
var v$4670 = v$4669[0];
var v$4671 = v$4669[1];
var t$10614;
var v$4672 = v$4670[0];
var v$4673 = v$4670[1];
(function(fp,s,v){fp[s] = v;})(v$4667,v$4672,v$4673);
t$10614 = v$4667;
var t$10615 = t$10614;
var t$10616 = v$4671;
var v$4667 = t$10615;
var v$4668 = t$10616;
continue lab$foldl;
};
};
};
var foldl$4666 = fix$10613.$foldl;
var v$10049 = (function(){return {};})();
t$10617 = (foldl$4666(v$10049,h$4661));
d$4665 = ((function(c,h){return new c(h);})(t$10618,t$10617));
(function(w,e){w.set('content', e);})(d$4665,content$2389);
return f$4663(d$4665);
});
});
dM$2390 = (function(c$4659){return v$6066(function(v$4660){js$0Js$1.installEventHandler$197(but$2380,4,function(v$6716){var s$6717 = (function(e){return e.value;})(field$2379);
try {var t$6718 = v$2405(s$6717);
(function(obj){return obj.hide();})(v$4660);
v$2406(t$6718);
return true;
} catch(v$10619) {return (function(v$6719){var t$10620 = v$6719;
if (t$10620[0] == basis$0Initial$1.en$Fail$54) {var msg$6720 = v$6719[1];
notify0$1000("#dd8888",msgArea$2360,msg$6720);
return true;
} else {throw v$6719;
};
})(v$10619);
};
});
(function(obj){return obj.show();})(v$4660);
var a$6721 = 0;
return c$4659(a$6721);
});
});
return dM$2390(function(x$4684){return x$4684;
});
};
smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2407 = function(caption$2410,label$2413,msg$2416,f$2419){var cancel$2420 = smltojs0$0SmlToJsCompApp$1$2.button$2346("Cancel");
var but$2421 = smltojs0$0SmlToJsCompApp$1$2.button$2346(label$2413);
var content$2422;
var attrs$4686 = [["style","width:400px;"],null];
var elem$4687;
var v$6068;
var attrs$4699 = null;
var newelem$4701 = document.createElement("p");
var fix$10621 = {};
fix$10621.$app = function(v$4703){lab$app: while (true) {if (v$4703 == null) {return 0;
} else {var v$4704 = v$4703;
var v$4705 = v$4704[0];
var v$4706 = v$4704[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4701,v$4705[0],v$4705[1]);
var t$10622 = v$4706;
var v$4703 = t$10622;
continue lab$app;
};
};
};
var app$4702 = fix$10621.$app;
app$4702(attrs$4699);
(function(e,a){return e.appendChild(a);})(newelem$4701,msg$2416);
v$6068 = newelem$4701;
var v$6069;
var attrs$4708 = [["style","text-align:center;"],null];
var elem$4709;
var v$6070;
var v$6073 = document.createTextNode(" ");
var e$4723 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4723,cancel$2420);
(function(e,a){return e.appendChild(a);})(e$4723,v$6073);
v$6070 = e$4723;
var e$4719 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4719,v$6070);
(function(e,a){return e.appendChild(a);})(e$4719,but$2421);
elem$4709 = e$4719;
var newelem$4710 = document.createElement("p");
var fix$10623 = {};
fix$10623.$app = function(v$4712){lab$app: while (true) {if (v$4712 == null) {return 0;
} else {var v$4713 = v$4712;
var v$4714 = v$4713[0];
var v$4715 = v$4713[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4710,v$4714[0],v$4714[1]);
var t$10624 = v$4715;
var v$4712 = t$10624;
continue lab$app;
};
};
};
var app$4711 = fix$10623.$app;
app$4711(attrs$4708);
(function(e,a){return e.appendChild(a);})(newelem$4710,elem$4709);
v$6069 = newelem$4710;
var e$4697 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4697,v$6068);
(function(e,a){return e.appendChild(a);})(e$4697,v$6069);
elem$4687 = e$4697;
var newelem$4688 = document.createElement("p");
var fix$10625 = {};
fix$10625.$app = function(v$4690){lab$app: while (true) {if (v$4690 == null) {return 0;
} else {var v$4691 = v$4690;
var v$4692 = v$4691[0];
var v$4693 = v$4691[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4688,v$4692[0],v$4692[1]);
var t$10626 = v$4693;
var v$4690 = t$10626;
continue lab$app;
};
};
};
var app$4689 = fix$10625.$app;
app$4689(attrs$4686);
(function(e,a){return e.appendChild(a);})(newelem$4688,elem$4687);
content$2422 = newelem$4688;
var dM$2423;
var v$6074;
var h$4730 = [["title",caption$2410],null];
v$6074 = (function(f$4732){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4733){var d$4734;
var t$10632 = D$4733;
var t$10631;
var fix$10627 = {};
fix$10627.$foldl = function(v$4736,v$4737){lab$foldl: while (true) {if (v$4737 == null) {return v$4736;
} else {var v$4738 = v$4737;
var v$4739 = v$4738[0];
var v$4740 = v$4738[1];
var t$10628;
var v$4741 = v$4739[0];
var v$4742 = v$4739[1];
(function(fp,s,v){fp[s] = v;})(v$4736,v$4741,v$4742);
t$10628 = v$4736;
var t$10629 = t$10628;
var t$10630 = v$4740;
var v$4736 = t$10629;
var v$4737 = t$10630;
continue lab$foldl;
};
};
};
var foldl$4735 = fix$10627.$foldl;
var v$10051 = (function(){return {};})();
t$10631 = (foldl$4735(v$10051,h$4730));
d$4734 = ((function(c,h){return new c(h);})(t$10632,t$10631));
(function(w,e){w.set('content', e);})(d$4734,content$2422);
return f$4732(d$4734);
});
});
dM$2423 = (function(c$4728){return v$6074(function(v$4729){js$0Js$1.installEventHandler$197(but$2421,4,function(v$6729){(function(obj){return obj.hide();})(v$4729);
f$2419(0);
return true;
});
js$0Js$1.installEventHandler$197(cancel$2420,4,function(v$6730){(function(obj){return obj.hide();})(v$4729);
return true;
});
(function(obj){return obj.show();})(v$4729);
var a$6731 = 0;
return c$4728(a$6731);
});
});
return dM$2423(function(x$4749){return x$4749;
});
};
smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443 = function(buttonlabel$2446,caption$2449,content$2452){var but$2453 = smltojs0$0SmlToJsCompApp$1$2.button$2346(buttonlabel$2446);
var content$2454;
var attrs$4751 = [["style","width:500px;"],null];
var elem$4752;
var v$6077;
var attrs$4764 = [["style","text-align:center;"],null];
var newelem$4766 = document.createElement("p");
var fix$10633 = {};
fix$10633.$app = function(v$4768){lab$app: while (true) {if (v$4768 == null) {return 0;
} else {var v$4769 = v$4768;
var v$4770 = v$4769[0];
var v$4771 = v$4769[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4766,v$4770[0],v$4770[1]);
var t$10634 = v$4771;
var v$4768 = t$10634;
continue lab$app;
};
};
};
var app$4767 = fix$10633.$app;
app$4767(attrs$4764);
(function(e,a){return e.appendChild(a);})(newelem$4766,but$2453);
v$6077 = newelem$4766;
var e$4762 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$4762,content$2452);
(function(e,a){return e.appendChild(a);})(e$4762,v$6077);
elem$4752 = e$4762;
var newelem$4753 = document.createElement("p");
var fix$10635 = {};
fix$10635.$app = function(v$4755){lab$app: while (true) {if (v$4755 == null) {return 0;
} else {var v$4756 = v$4755;
var v$4757 = v$4756[0];
var v$4758 = v$4756[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$4753,v$4757[0],v$4757[1]);
var t$10636 = v$4758;
var v$4755 = t$10636;
continue lab$app;
};
};
};
var app$4754 = fix$10635.$app;
app$4754(attrs$4751);
(function(e,a){return e.appendChild(a);})(newelem$4753,elem$4752);
content$2454 = newelem$4753;
var dM$2455;
var v$6078;
var h$4777 = [["title",caption$2449],null];
v$6078 = (function(f$4779){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/Dialog",function(D$4780){var d$4781;
var t$10642 = D$4780;
var t$10641;
var fix$10637 = {};
fix$10637.$foldl = function(v$4783,v$4784){lab$foldl: while (true) {if (v$4784 == null) {return v$4783;
} else {var v$4785 = v$4784;
var v$4786 = v$4785[0];
var v$4787 = v$4785[1];
var t$10638;
var v$4788 = v$4786[0];
var v$4789 = v$4786[1];
(function(fp,s,v){fp[s] = v;})(v$4783,v$4788,v$4789);
t$10638 = v$4783;
var t$10639 = t$10638;
var t$10640 = v$4787;
var v$4783 = t$10639;
var v$4784 = t$10640;
continue lab$foldl;
};
};
};
var foldl$4782 = fix$10637.$foldl;
var v$10053 = (function(){return {};})();
t$10641 = (foldl$4782(v$10053,h$4777));
d$4781 = ((function(c,h){return new c(h);})(t$10642,t$10641));
(function(w,e){w.set('content', e);})(d$4781,content$2454);
return f$4779(d$4781);
});
});
dM$2455 = (function(c$4775){return v$6078(function(v$4776){js$0Js$1.installEventHandler$197(but$2453,4,function(v$6738){(function(obj){return obj.hide();})(v$4776);
return true;
});
(function(obj){return obj.show();})(v$4776);
var a$6739 = 0;
return c$4775(a$6739);
});
});
return dM$2455(function(x$4795){return x$4795;
});
};
smltojs0$0SmlToJsCompApp$1$2.infoDialogOk$2467 = function(v$10056){return function(v$10057){return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok",v$10056,v$10057);
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_NewNamedFile$2468 = function(tabsmap$2471,fts$2474,v$2476){var content$2477;
var t$10647;
var t$10646 = "(* File created ";
var t$10645;
var t$10644 = basis$0Date$1.toString$826;
var t$10643;
var v$10011 = SmlPrims.getrealtime();
t$10643 = (basis$0Date$1.fromTimeLocal$512(v$10011[0],v$10011[1]));
t$10645 = (t$10644(t$10643));
t$10647 = (t$10646 + t$10645);
content$2477 = (t$10647 + " *)\n");
var t$10659 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2350;
var t$10658 = "Create";
var t$10657 = "New File";
var t$10656 = function(s$2480){return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabsmap$2471[0],tabsmap$2471[1]))(s$2480))(content$2477);
};
var t$10655 = [1];
var t$10654 = "Name";
var t$10653;
var fix$10648 = {};
fix$10648.$suggest = function(f$6743){lab$suggest: while (true) {var num$6744 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6745 = f$6743(num$6744);
var t$10651;
var fix$10649 = {};
fix$10649.$exists = function(v$6748){lab$exists: while (true) {if (v$6748 == null) {return false;
} else {var v$6749 = v$6748;
var v$6750 = v$6749[0];
var v$6751 = v$6749[1];
if (v$6750 == name$6745) {return true;
} else {var t$10650 = v$6751;
var v$6748 = t$10650;
continue lab$exists;
};
};
};
};
var exists$6747 = fix$10649.$exists;
t$10651 = (exists$6747(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10651) {var t$10652 = f$6743;
var f$6743 = t$10652;
continue lab$suggest;
} else {return name$6745;
};
};
};
var suggest$6742 = fix$10648.$suggest;
t$10653 = (suggest$6742(function(num$6752){return ("Untitled-" + (basis$0Int32$1.toString$458(num$6752))) + ".sml";
}));
return t$10659(t$10658,t$10657,t$10656,t$10655,t$10654,t$10653,function(v$10060){return smltojs0$0SmlToJsCompApp$1$2.newFile$1811(fts$2474,content$2477,v$10060);
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_MoveFile$2488 = function(tabsmap$2491,fts$2494,closetab$2497,v$2499){var path$2500 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var intro$2501 = document.createTextNode("Files can be renamed or moved either using relative paths ('..' is not supported) or using absolute paths (starting with '/').");
var v$2508 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(path$2500);
var v$2509 = v$2508[1];
switch (v$2509[0]) { case 0: {var v$2526 = v$2508[0];
var v$2527 = v$2509[1];
return smltojs0$0SmlToJsCompApp$1$2.withDialog$2350("Move","Move/Rename File",function(v$2514){var v$2517 = v$2514[0];
var v$2518 = v$2514[1];
closetab$2497(path$2500);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabsmap$2491[0],tabsmap$2491[1]))(v$2517))(v$2518);
},[0,intro$2501],"New name",v$2527,function(v$10064){return smltojs0$0SmlToJsCompApp$1$2.move$2109(fts$2494,v$2526,v$2527,v$10064);
});
 break; }default: {return notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Renaming of folders not supported");
} };
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_FilesDelete$2529 = function(fts$2532,closetab$2535,v$2537){var msg$2538;
var v$2543;
var t$10660;
var p$4804 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var fields$4805 = basis$0String$1.fields$231(function(c$4806){return c$4806 == 47;
},p$4804);
var v$4807 = basis$0List$1.rev$682(fields$4805);
if (v$4807 == null) {t$10660 = false;
} else {var v$4808 = v$4807;
var v$4809 = v$4808[0];
var v$4810 = v$4808[1];
var t$10663;
var v$6754 = basis$0String$1.fields$231(function(c$6755){return c$6755 == 46;
},v$4809);
if (v$6754 == null) {t$10663 = false;
} else {var v$6756 = v$6754;
var v$6757 = v$6756[1];
if (v$6757 == null) {t$10663 = false;
} else {var v$6758 = v$6757;
if (v$6758[1] == null) {var v$6759 = v$6756[0];
var v$6760 = v$6758[0];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$6759)) {var fix$10664 = {};
fix$10664.$exists = function(v$6762){lab$exists: while (true) {if (v$6762 == null) {return false;
} else {var v$6763 = v$6762;
var v$6764 = v$6763[0];
var v$6765 = v$6763[1];
if (v$6760 == v$6764) {return true;
} else {var t$10665 = v$6765;
var v$6762 = t$10665;
continue lab$exists;
};
};
};
};
var exists$6761 = fix$10664.$exists;
t$10663 = (exists$6761(smltojs0$0SmlToJsCompApp$1$1.fileExtensions$203));
} else {t$10663 = false;
};
} else {t$10663 = false;
};
};
};
if (t$10663) {var fix$10661 = {};
fix$10661.$all = function(v$4812){lab$all: while (true) {if (v$4812 == null) {return true;
} else {var v$4813 = v$4812;
var v$4814 = v$4813[0];
var v$4815 = v$4813[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4814)) {var t$10662 = v$4815;
var v$4812 = t$10662;
continue lab$all;
} else {return false;
};
};
};
};
var all$4811 = fix$10661.$all;
t$10660 = (all$4811(v$4810));
} else {t$10660 = false;
};
};
v$2543 = (t$10660?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$2543[0]) { case 0: {msg$2538 = (("Do you really want to delete the file " + (("'" + v$2543[1]) + "'")) + "?");
 break; }default: {var v$2550;
var t$10666;
var p$4822 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
if (p$4822 == "0") {t$10666 = true;
} else {var fields$4827 = basis$0String$1.fields$231(function(c$4828){return c$4828 == 47;
},p$4822);
var fix$10667 = {};
fix$10667.$all = function(v$4830){lab$all: while (true) {if (v$4830 == null) {return true;
} else {var v$4831 = v$4830;
var v$4832 = v$4831[0];
var v$4833 = v$4831[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4832)) {var t$10668 = v$4833;
var v$4830 = t$10668;
continue lab$all;
} else {return false;
};
};
};
};
var all$4829 = fix$10667.$all;
t$10666 = (all$4829(fields$4827));
};
v$2550 = (t$10666?[0,smltojs0$0SmlToJsCompApp$1$2.current$1394[0]]:[1]);
switch (v$2550[0]) { case 0: {msg$2538 = (("Do you really want to delete the folder " + (("'" + v$2550[1]) + "'")) + " and all its containing files?");
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"menuHandle_FilesDelete.impossible"];
} };
} };
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2407("Confirm Deletion","Delete",document.createTextNode(msg$2538),function(v$2554){return smltojs0$0SmlToJsCompApp$1$2.delete$1874(fts$2532,closetab$2535);
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_Export$2555 = function(v$2557){var v$10105 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Files Export to Zip",v$10105);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_Import$2558 = function(v$2560){var v$10107 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Files Import from Zip",v$10107);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_NewFolder$2561 = function(fts$2564,v$2566){var t$10680 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2350;
var t$10679 = "Create";
var t$10678 = "New Folder";
var t$10677 = function(s$2569){return 0;
};
var t$10676 = [1];
var t$10675 = "Name";
var t$10674;
var fix$10669 = {};
fix$10669.$suggest = function(f$6780){lab$suggest: while (true) {var num$6781 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6784 = f$6780(num$6781);
var t$10672;
var fix$10670 = {};
fix$10670.$exists = function(v$6787){lab$exists: while (true) {if (v$6787 == null) {return false;
} else {var v$6788 = v$6787;
var v$6789 = v$6788[0];
var v$6790 = v$6788[1];
if (v$6789 == name$6784) {return true;
} else {var t$10671 = v$6790;
var v$6787 = t$10671;
continue lab$exists;
};
};
};
};
var exists$6786 = fix$10670.$exists;
t$10672 = (exists$6786(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10672) {var t$10673 = f$6780;
var f$6780 = t$10673;
continue lab$suggest;
} else {return name$6784;
};
};
};
var suggest$6779 = fix$10669.$suggest;
t$10674 = (suggest$6779(function(num$4853){return "Folder-" + (basis$0Int32$1.toString$458(num$4853));
}));
return t$10680(t$10679,t$10678,t$10677,t$10676,t$10675,t$10674,function(v$10066){return smltojs0$0SmlToJsCompApp$1$2.newFolder$1829(fts$2564,v$10066);
});
};
smltojs0$0SmlToJsCompApp$1$2.treeHandle_LoadFile$2577 = function(tabsmap$2580,selecttab$2583,v$2587){var v$2599 = v$2587[0];
var t$10681;
if (v$2599 == "0") {t$10681 = true;
} else {var fields$4861 = basis$0String$1.fields$231(function(c$4862){return c$4862 == 47;
},v$2599);
var fix$10682 = {};
fix$10682.$all = function(v$4864){lab$all: while (true) {if (v$4864 == null) {return true;
} else {var v$4865 = v$4864;
var v$4866 = v$4865[0];
var v$4867 = v$4865[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$4866)) {var t$10683 = v$4867;
var v$4864 = t$10683;
continue lab$all;
} else {return false;
};
};
};
};
var all$4863 = fix$10682.$all;
t$10681 = (all$4863(fields$4861));
};
if (t$10681) {return (smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = v$2599,0);
} else {return smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1636(v$2599,function(v$2596){switch (v$2596[0]) { case 0: {var v$2598 = v$2596[1];
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabsmap$2580[0],tabsmap$2580[1]))(v$2599))(v$2598);
 break; }default: {return selecttab$2583(v$2599);
} };
});
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_OpenDemo$2601 = function(tabsmap$2604,fts$2607,demo$2610,v$2612){var name$2613;
var fix$10684 = {};
fix$10684.$suggest = function(f$6793){lab$suggest: while (true) {var num$6794 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$6795 = f$6793(num$6794);
var t$10687;
var fix$10685 = {};
fix$10685.$exists = function(v$6798){lab$exists: while (true) {if (v$6798 == null) {return false;
} else {var v$6799 = v$6798;
var v$6800 = v$6799[0];
var v$6801 = v$6799[1];
if (v$6800 == name$6795) {return true;
} else {var t$10686 = v$6801;
var v$6798 = t$10686;
continue lab$exists;
};
};
};
};
var exists$6797 = fix$10685.$exists;
t$10687 = (exists$6797(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10687) {var t$10688 = f$6793;
var f$6793 = t$10688;
continue lab$suggest;
} else {return name$6795;
};
};
};
var suggest$6792 = fix$10684.$suggest;
name$2613 = (suggest$6792(function(num$6802){return ("Demo-" + (basis$0Int32$1.toString$458(num$6802))) + ".sml";
}));
var path$2614 = smltojs0$0SmlToJsCompApp$1$2.newFile$1811(fts$2607,demo$2610,name$2613);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabsmap$2604[0],tabsmap$2604[1]))(path$2614))(demo$2610);
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignIn$2615 = function(key$2618,v$2620){var t$10697;
var t$10693;
var t$10689;
var v$6124 = smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0];
var v$6125 = null;
var fix$10690 = {};
fix$10690.$eq_list = function(v$10109,v$10110){lab$eq_list: while (true) {if (v$10109 == null) {return (v$10110 == null)?true:false;
} else {if (v$10110 == null) {return false;
} else {var v$10111 = v$10109;
var v$10112 = v$10110;
if (v$10111[0] == v$10112[0]) {var t$10691 = v$10111[1];
var t$10692 = v$10112[1];
var v$10109 = t$10691;
var v$10110 = t$10692;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$10108 = fix$10690.$eq_list;
t$10689 = (eq_list$10108(v$6124,v$6125));
if (t$10689) {var v$6130 = smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0];
var v$6131 = ["0",null];
var fix$10694 = {};
fix$10694.$eq_list = function(v$10115,v$10116){lab$eq_list: while (true) {if (v$10115 == null) {return (v$10116 == null)?true:false;
} else {if (v$10116 == null) {return false;
} else {var v$10117 = v$10115;
var v$10118 = v$10116;
if (v$10117[0] == v$10118[0]) {var t$10695 = v$10117[1];
var t$10696 = v$10118[1];
var v$10115 = t$10695;
var v$10116 = t$10696;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$10114 = fix$10694.$eq_list;
t$10693 = (eq_list$10114(v$6130,v$6131));
} else {t$10693 = false;
};
t$10697 = (t$10693?true:((basis$0Option$1.isSome$56(0))(smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0])));
if (t$10697) {var c$4902 = appfun2$0dropbox$1.client$91(key$2618);
return appfun2$0dropbox$1.authorize$95(c$4902);
} else {var msg$2629 = document.createTextNode("Signing in to Dropbox will delete all application data created in this session. If this is the first time you sign in to Dropbox from this application, you will be asked to allow the application to store data in a special area of your Dropbox account.");
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2407("Dropbox Sign In","Sign in",msg$2629,function(v$4904){var c$4905 = appfun2$0dropbox$1.client$91(key$2618);
return appfun2$0dropbox$1.authorize$95(c$4905);
});
};
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignOut$2638 = function(c$2641,fts$2644,closetab$2647,v$2649){var msg$2650 = document.createTextNode("Signing out of Dropbox will not delete any files in the Dropbox App folder. You will always be able to sign in again using the \"Sign in\" entry in the Dropbox menu.");
var fix$10698 = {};
fix$10698.$app = function(v$4909){lab$app: while (true) {if (v$4909 == null) {return 0;
} else {var v$4910 = v$4909;
var v$4911 = v$4910[0];
var v$4912 = v$4910[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021(v$4911[0],v$4911[1],v$4911[2]);
var t$10699 = v$4912;
var v$4909 = t$10699;
continue lab$app;
};
};
};
var app$4908 = fix$10698.$app;
app$4908(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
return smltojs0$0SmlToJsCompApp$1$2.confirmDialog$2407("Dropbox Sign Out","Sign out",msg$2650,function(v$2654){return appfun2$0dropbox$1.signOut$108(c$2641,function(v$2656){(smltojs0$0SmlToJsCompApp$1$2.fileStore$1393[0] = [1],0);
smltojs0$0SmlToJsCompApp$1$2.clear$1682(fts$2644,closetab$2647);
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Signed out of Dropbox");
var s$4916;
var t$10705;
var t$10704;
var t$10703;
var t$10702 = basis$0Date$1.fmt$816;
var t$10701 = "%H:%M:%S";
var t$10700;
var v$10014 = SmlPrims.getrealtime();
t$10700 = (basis$0Date$1.fromTimeLocal$512(v$10014[0],v$10014[1]));
t$10703 = (t$10702(t$10701,t$10700));
t$10704 = (t$10703 + ": ");
t$10705 = (t$10704 + "Signed out of Dropbox");
s$4916 = (t$10705 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4916));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
return (function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955,"src","nodropbox.png");
});
});
};
smltojs0$0SmlToJsCompApp$1$2.menuHandle_CompileAndRun$2663 = function(v$2665){var v$2671 = smltojs0$0SmlToJsCompApp$1$2.currentEditor$1844(0);
switch (v$2671[0]) { case 0: {var v$2673 = v$2671[1];
var v$2674 = v$2673[0];
var v$2675 = v$2673[1];
var res$4927;
var v$4929 = v$2675[0](0);
var p_old$4930 = basis$0Control$1.printer_get$55(0);
var buf$4931 = [null];
basis$0Control$1.printer_set$54(function(s$4932){return (buf$4931[0] = [s$4932,buf$4931[0]],0);
});
try {smltojs0$0SmlToJsCompApp$1$1.compute$94(v$2674,v$4929);
} catch(v$10706) {(function(v$4934){return 0;
})(v$10706);
};
var res$4935 = SmlPrims.concat(basis$0List$1.rev$682(buf$4931[0]));
basis$0Control$1.printer_set$54(p_old$4930);
res$4927 = res$4935;
return smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0](res$4927);
 break; }default: {notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"No file selected");
var s$4939;
var t$10712;
var t$10711;
var t$10710;
var t$10709 = basis$0Date$1.fmt$816;
var t$10708 = "%H:%M:%S";
var t$10707;
var v$10015 = SmlPrims.getrealtime();
t$10707 = (basis$0Date$1.fromTimeLocal$512(v$10015[0],v$10015[1]));
t$10710 = (t$10709(t$10708,t$10707));
t$10711 = (t$10710 + ": ");
t$10712 = (t$10711 + "No file selected");
s$4939 = (t$10712 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$4939));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
} };
};
smltojs0$0SmlToJsCompApp$1$2.poweredby$2676 = function(v$2678){var v$6154;
var attrs$5019 = null;
var elem$5020;
var v$6156;
var v$6158;
var v$6160;
var v$6162;
var v$6164;
var v$6166;
var v$6168;
var v$6170;
var v$6172 = document.createTextNode("This IDE is based on ");
var v$6173;
var attrs$6804 = [["href","http://www.smlserver.org/smltojs"],[["target","_blank"],null]];
var elem$6805 = document.createTextNode("SMLtoJs");
var newelem$6806 = document.createElement("a");
var fix$10713 = {};
fix$10713.$app = function(v$6808){lab$app: while (true) {if (v$6808 == null) {return 0;
} else {var v$6809 = v$6808;
var v$6810 = v$6809[0];
var v$6811 = v$6809[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6806,v$6810[0],v$6810[1]);
var t$10714 = v$6811;
var v$6808 = t$10714;
continue lab$app;
};
};
};
var app$6807 = fix$10713.$app;
app$6807(attrs$6804);
(function(e,a){return e.appendChild(a);})(newelem$6806,elem$6805);
v$6173 = newelem$6806;
var e$5062 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5062,v$6172);
(function(e,a){return e.appendChild(a);})(e$5062,v$6173);
v$6170 = e$5062;
var v$6171 = document.createTextNode(", a Standard ML to JavaScript compiler. The front-end uses ");
var e$5058 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5058,v$6170);
(function(e,a){return e.appendChild(a);})(e$5058,v$6171);
v$6168 = e$5058;
var v$6169;
var attrs$6813 = [["href","http://dojotoolkit.org/"],[["target","_blank"],null]];
var elem$6814 = document.createTextNode("Dojo");
var newelem$6815 = document.createElement("a");
var fix$10715 = {};
fix$10715.$app = function(v$6817){lab$app: while (true) {if (v$6817 == null) {return 0;
} else {var v$6818 = v$6817;
var v$6819 = v$6818[0];
var v$6820 = v$6818[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6815,v$6819[0],v$6819[1]);
var t$10716 = v$6820;
var v$6817 = t$10716;
continue lab$app;
};
};
};
var app$6816 = fix$10715.$app;
app$6816(attrs$6813);
(function(e,a){return e.appendChild(a);})(newelem$6815,elem$6814);
v$6169 = newelem$6815;
var e$5054 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5054,v$6168);
(function(e,a){return e.appendChild(a);})(e$5054,v$6169);
v$6166 = e$5054;
var v$6167 = document.createTextNode(" and ");
var e$5050 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5050,v$6166);
(function(e,a){return e.appendChild(a);})(e$5050,v$6167);
v$6164 = e$5050;
var v$6165;
var attrs$6822 = [["href","http://codemirror.net"],[["target","_blank"],null]];
var elem$6823 = document.createTextNode("CodeMirror");
var newelem$6824 = document.createElement("a");
var fix$10717 = {};
fix$10717.$app = function(v$6826){lab$app: while (true) {if (v$6826 == null) {return 0;
} else {var v$6827 = v$6826;
var v$6828 = v$6827[0];
var v$6829 = v$6827[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6824,v$6828[0],v$6828[1]);
var t$10718 = v$6829;
var v$6826 = t$10718;
continue lab$app;
};
};
};
var app$6825 = fix$10717.$app;
app$6825(attrs$6822);
(function(e,a){return e.appendChild(a);})(newelem$6824,elem$6823);
v$6165 = newelem$6824;
var e$5046 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5046,v$6164);
(function(e,a){return e.appendChild(a);})(e$5046,v$6165);
v$6162 = e$5046;
var v$6163 = document.createTextNode(". The IDE ");
var e$5042 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5042,v$6162);
(function(e,a){return e.appendChild(a);})(e$5042,v$6163);
v$6160 = e$5042;
var v$6161 = document.createTextNode(" allows for the user to save source files in a personal Dropbox App folder using ");
var e$5038 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5038,v$6160);
(function(e,a){return e.appendChild(a);})(e$5038,v$6161);
v$6158 = e$5038;
var v$6159;
var attrs$6831 = [["href","https://www.dropbox.com/developers/documentation/http/overview"],[["target","_blank"],null]];
var elem$6832 = document.createTextNode("Dropbox API v2");
var newelem$6833 = document.createElement("a");
var fix$10719 = {};
fix$10719.$app = function(v$6835){lab$app: while (true) {if (v$6835 == null) {return 0;
} else {var v$6836 = v$6835;
var v$6837 = v$6836[0];
var v$6838 = v$6836[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6833,v$6837[0],v$6837[1]);
var t$10720 = v$6838;
var v$6835 = t$10720;
continue lab$app;
};
};
};
var app$6834 = fix$10719.$app;
app$6834(attrs$6831);
(function(e,a){return e.appendChild(a);})(newelem$6833,elem$6832);
v$6159 = newelem$6833;
var e$5034 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5034,v$6158);
(function(e,a){return e.appendChild(a);})(e$5034,v$6159);
v$6156 = e$5034;
var v$6157 = document.createTextNode(".");
var e$5030 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5030,v$6156);
(function(e,a){return e.appendChild(a);})(e$5030,v$6157);
elem$5020 = e$5030;
var newelem$5021 = document.createElement("p");
var fix$10721 = {};
fix$10721.$app = function(v$5023){lab$app: while (true) {if (v$5023 == null) {return 0;
} else {var v$5024 = v$5023;
var v$5025 = v$5024[0];
var v$5026 = v$5024[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$5021,v$5025[0],v$5025[1]);
var t$10722 = v$5026;
var v$5023 = t$10722;
continue lab$app;
};
};
};
var app$5022 = fix$10721.$app;
app$5022(attrs$5019);
(function(e,a){return e.appendChild(a);})(newelem$5021,elem$5020);
v$6154 = newelem$5021;
var v$6155;
var attrs$5070 = null;
var elem$5071;
var v$6174;
var v$6176;
var v$6178;
var v$6180;
var v$6182;
var v$6184;
var v$6186 = document.createTextNode(" The sources for this IDE are");
var v$6187 = document.createTextNode(" available by download from the ");
var e$5105 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5105,v$6186);
(function(e,a){return e.appendChild(a);})(e$5105,v$6187);
v$6184 = e$5105;
var v$6185;
var attrs$6840 = [["href","https://github.com/melsman/mlkit"],[["target","_blank"],null]];
var elem$6841 = document.createTextNode("Github MLKit Repository");
var newelem$6842 = document.createElement("a");
var fix$10723 = {};
fix$10723.$app = function(v$6844){lab$app: while (true) {if (v$6844 == null) {return 0;
} else {var v$6845 = v$6844;
var v$6846 = v$6845[0];
var v$6847 = v$6845[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6842,v$6846[0],v$6846[1]);
var t$10724 = v$6847;
var v$6844 = t$10724;
continue lab$app;
};
};
};
var app$6843 = fix$10723.$app;
app$6843(attrs$6840);
(function(e,a){return e.appendChild(a);})(newelem$6842,elem$6841);
v$6185 = newelem$6842;
var e$5101 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5101,v$6184);
(function(e,a){return e.appendChild(a);})(e$5101,v$6185);
v$6182 = e$5101;
var v$6183 = document.createTextNode(" and are distributed");
var e$5097 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5097,v$6182);
(function(e,a){return e.appendChild(a);})(e$5097,v$6183);
v$6180 = e$5097;
var v$6181 = document.createTextNode(" under the GPL2 license; some parts of the sources are also available under the MIT license.");
var e$5093 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5093,v$6180);
(function(e,a){return e.appendChild(a);})(e$5093,v$6181);
v$6178 = e$5093;
var v$6179 = document.createTextNode(" For information about licenses, please consult the sources at the ");
var e$5089 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5089,v$6178);
(function(e,a){return e.appendChild(a);})(e$5089,v$6179);
v$6176 = e$5089;
var v$6177;
var attrs$6849 = [["href","https://github.com/melsman/mlkit"],[["target","_blank"],null]];
var elem$6850 = document.createTextNode("Github MLKit Repository");
var newelem$6851 = document.createElement("a");
var fix$10725 = {};
fix$10725.$app = function(v$6853){lab$app: while (true) {if (v$6853 == null) {return 0;
} else {var v$6854 = v$6853;
var v$6855 = v$6854[0];
var v$6856 = v$6854[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$6851,v$6855[0],v$6855[1]);
var t$10726 = v$6856;
var v$6853 = t$10726;
continue lab$app;
};
};
};
var app$6852 = fix$10725.$app;
app$6852(attrs$6849);
(function(e,a){return e.appendChild(a);})(newelem$6851,elem$6850);
v$6177 = newelem$6851;
var e$5085 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5085,v$6176);
(function(e,a){return e.appendChild(a);})(e$5085,v$6177);
v$6174 = e$5085;
var v$6175 = document.createTextNode(".");
var e$5081 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5081,v$6174);
(function(e,a){return e.appendChild(a);})(e$5081,v$6175);
elem$5071 = e$5081;
var newelem$5072 = document.createElement("p");
var fix$10727 = {};
fix$10727.$app = function(v$5074){lab$app: while (true) {if (v$5074 == null) {return 0;
} else {var v$5075 = v$5074;
var v$5076 = v$5075[0];
var v$5077 = v$5075[1];
(function(e,a,b){return e.setAttribute(a,b);})(newelem$5072,v$5076[0],v$5076[1]);
var t$10728 = v$5077;
var v$5074 = t$10728;
continue lab$app;
};
};
};
var app$5073 = fix$10727.$app;
app$5073(attrs$5070);
(function(e,a){return e.appendChild(a);})(newelem$5072,elem$5071);
v$6155 = newelem$5072;
var e$5017 = document.createDocumentFragment();
(function(e,a){return e.appendChild(a);})(e$5017,v$6154);
(function(e,a){return e.appendChild(a);})(e$5017,v$6155);
return e$5017;
};
smltojs0$0SmlToJsCompApp$1$2.menu$2693 = function(tabs$2696,fts$2699,closetab$2702){var v$6188;
var h$5117 = [["region","center"],[smltojs0$0SmlToJsCompApp$1$2.menuStyle$1280,null]];
v$6188 = (function(f$5118){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/MenuBar",function(MenuBar$5119){var menubar$5120;
var t$10734 = MenuBar$5119;
var t$10733;
var fix$10729 = {};
fix$10729.$foldl = function(v$5122,v$5123){lab$foldl: while (true) {if (v$5123 == null) {return v$5122;
} else {var v$5124 = v$5123;
var v$5125 = v$5124[0];
var v$5126 = v$5124[1];
var t$10730;
var v$5127 = v$5125[0];
var v$5128 = v$5125[1];
(function(fp,s,v){fp[s] = v;})(v$5122,v$5127,v$5128);
t$10730 = v$5122;
var t$10731 = t$10730;
var t$10732 = v$5126;
var v$5122 = t$10731;
var v$5123 = t$10732;
continue lab$foldl;
};
};
};
var foldl$5121 = fix$10729.$foldl;
var v$10069 = (function(){return {};})();
t$10733 = (foldl$5121(v$10069,h$5117));
menubar$5120 = ((function(c,h){return new c(h);})(t$10734,t$10733));
return f$5118([menubar$5120,[menubar$5120,true]]);
});
});
return function(c$5115){return v$6188(function(v$5116){var v$9012 = v$5116[0];
var v$9013 = v$5116[1];
var v$9014 = (dojo$0dojo$1.menu$801(v$9013[0],v$9013[1]))("File");
return v$9014(function(v$9016){var v$9017 = (dojo$0dojo$1.item$827(v$9016[0],v$9016[1]))(["New file",[0,dojo$0dojo$1.newPage$3265],function(v$9018){var content$9019;
var t$10739;
var t$10738 = "(* File created ";
var t$10737;
var t$10736 = basis$0Date$1.toString$826;
var t$10735;
var v$10016 = SmlPrims.getrealtime();
t$10735 = (basis$0Date$1.fromTimeLocal$512(v$10016[0],v$10016[1]));
t$10737 = (t$10736(t$10735));
t$10739 = (t$10738 + t$10737);
content$9019 = (t$10739 + " *)\n");
var t$10751 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2350;
var t$10750 = "Create";
var t$10749 = "New File";
var t$10748 = function(s$9020){return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabs$2696[0],tabs$2696[1]))(s$9020))(content$9019);
};
var t$10747 = [1];
var t$10746 = "Name";
var t$10745;
var fix$10740 = {};
fix$10740.$suggest = function(f$9022){lab$suggest: while (true) {var num$9023 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$9024 = f$9022(num$9023);
var t$10743;
var fix$10741 = {};
fix$10741.$exists = function(v$9026){lab$exists: while (true) {if (v$9026 == null) {return false;
} else {var v$9027 = v$9026;
var v$9028 = v$9027[0];
var v$9029 = v$9027[1];
if (v$9028 == name$9024) {return true;
} else {var t$10742 = v$9029;
var v$9026 = t$10742;
continue lab$exists;
};
};
};
};
var exists$9025 = fix$10741.$exists;
t$10743 = (exists$9025(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10743) {var t$10744 = f$9022;
var f$9022 = t$10744;
continue lab$suggest;
} else {return name$9024;
};
};
};
var suggest$9021 = fix$10740.$suggest;
t$10745 = (suggest$9021(function(num$9030){return ("Untitled-" + (basis$0Int32$1.toString$458(num$9030))) + ".sml";
}));
return t$10751(t$10750,t$10749,t$10748,t$10747,t$10746,t$10745,function(v$10073){return smltojs0$0SmlToJsCompApp$1$2.newFile$1811(fts$2699,content$9019,v$10073);
});
}]);
return v$9017(function(v$9031){var v$9032 = (dojo$0dojo$1.item$827(v$9016[0],v$9016[1]))(["New folder",[0,dojo$0dojo$1.folderClosed$3224],function(v$9978){var t$10763 = smltojs0$0SmlToJsCompApp$1$2.withDialog$2350;
var t$10762 = "Create";
var t$10761 = "New Folder";
var t$10760 = function(s$9979){return 0;
};
var t$10759 = [1];
var t$10758 = "Name";
var t$10757;
var fix$10752 = {};
fix$10752.$suggest = function(f$9981){lab$suggest: while (true) {var num$9982 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$9983 = f$9981(num$9982);
var t$10755;
var fix$10753 = {};
fix$10753.$exists = function(v$9985){lab$exists: while (true) {if (v$9985 == null) {return false;
} else {var v$9986 = v$9985;
var v$9987 = v$9986[0];
var v$9988 = v$9986[1];
if (v$9987 == name$9983) {return true;
} else {var t$10754 = v$9988;
var v$9985 = t$10754;
continue lab$exists;
};
};
};
};
var exists$9984 = fix$10753.$exists;
t$10755 = (exists$9984(smltojs0$0SmlToJsCompApp$1$2.alldirs$1392[0]));
if (t$10755) {var t$10756 = f$9981;
var f$9981 = t$10756;
continue lab$suggest;
} else {return name$9983;
};
};
};
var suggest$9980 = fix$10752.$suggest;
t$10757 = (suggest$9980(function(num$9989){return "Folder-" + (basis$0Int32$1.toString$458(num$9989));
}));
return t$10763(t$10762,t$10761,t$10760,t$10759,t$10758,t$10757,function(v$10075){return smltojs0$0SmlToJsCompApp$1$2.newFolder$1829(fts$2699,v$10075);
});
}]);
return v$9032(function(v$9033){var v$9034 = (dojo$0dojo$1.item$827(v$9016[0],v$9016[1]))(["Move",[0,dojo$0dojo$1.paste$3236],function(v$9035){var path$9036 = smltojs0$0SmlToJsCompApp$1$2.current$1394[0];
var intro$9037 = document.createTextNode("Files can be renamed or moved either using relative paths ('..' is not supported) or using absolute paths (starting with '/').");
var v$9038 = smltojs0$0SmlToJsCompApp$1$2.splitPath$1396(path$9036);
var v$9039 = v$9038[1];
switch (v$9039[0]) { case 0: {var v$9040 = v$9038[0];
var v$9041 = v$9039[1];
return smltojs0$0SmlToJsCompApp$1$2.withDialog$2350("Move","Move/Rename File",function(v$9042){var v$9043 = v$9042[0];
var v$9044 = v$9042[1];
closetab$2702(path$9036);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabs$2696[0],tabs$2696[1]))(v$9043))(v$9044);
},[0,intro$9037],"New name",v$9041,function(v$10079){return smltojs0$0SmlToJsCompApp$1$2.move$2109(fts$2699,v$9040,v$9041,v$10079);
});
 break; }default: {return notify0$1000("#dd8888",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Renaming of folders not supported");
} };
}]);
return v$9034(function(v$9045){var v$9046 = (dojo$0dojo$1.item$827(v$9016[0],v$9016[1]))(["Delete",[0,dojo$0dojo$1.delete$3237],function(v$10082){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_FilesDelete$2529(fts$2699,closetab$2702,v$10082);
}]);
return v$9046(function(v$9047){var v$9048 = (dojo$0dojo$1.item$827(v$9016[0],v$9016[1]))(["Export (zip)",[0,dojo$0dojo$1.indent$3252],function(v$9049){var v$10122 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Files Export to Zip",v$10122);
}]);
return v$9048(function(v$9050){var v$9051 = (dojo$0dojo$1.item$827(v$9016[0],v$9016[1]))(["Import (zip)",[0,dojo$0dojo$1.outdent$3253],function(v$9052){var v$10124 = document.createTextNode("Not yet implemented");
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Files Import from Zip",v$10124);
}]);
return v$9051(function(v$9053){var v$9054;
switch (smltojs0$0SmlToJsCompApp$1$1.demoinput$76[0]) { case 1: {var a$9055 = 0;
v$9054 = (function(f$9056){return f$9056(a$9055);
});
 break; }default: {var v$9057 = smltojs0$0SmlToJsCompApp$1$1.demoinput$76[1];
v$9054 = ((dojo$0dojo$1.item$827(v$9016[0],v$9016[1]))(["Open Demo File",[1],function(v$9058){var name$9059;
var fix$10764 = {};
fix$10764.$suggest = function(f$9061){lab$suggest: while (true) {var num$9062 = [count$1721[0],(count$1721[0] = (SmlPrims.chk_ovf_i32(count$1721[0] + 1)),0)][0];
var name$9063 = f$9061(num$9062);
var t$10767;
var fix$10765 = {};
fix$10765.$exists = function(v$9065){lab$exists: while (true) {if (v$9065 == null) {return false;
} else {var v$9066 = v$9065;
var v$9067 = v$9066[0];
var v$9068 = v$9066[1];
if (v$9067 == name$9063) {return true;
} else {var t$10766 = v$9068;
var v$9065 = t$10766;
continue lab$exists;
};
};
};
};
var exists$9064 = fix$10765.$exists;
t$10767 = (exists$9064(smltojs0$0SmlToJsCompApp$1$2.allfiles$1391[0]));
if (t$10767) {var t$10768 = f$9061;
var f$9061 = t$10768;
continue lab$suggest;
} else {return name$9063;
};
};
};
var suggest$9060 = fix$10764.$suggest;
name$9059 = (suggest$9060(function(num$9069){return ("Demo-" + (basis$0Int32$1.toString$458(num$9069))) + ".sml";
}));
var path$9070 = smltojs0$0SmlToJsCompApp$1$2.newFile$1811(fts$2699,v$9057,name$9059);
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(tabs$2696[0],tabs$2696[1]))(path$9070))(v$9057);
}]));
} };
return v$9054(function(v$9071){var v$9072;
switch (smltojs0$0SmlToJsCompApp$1$1.dropboxKey$202[0]) { case 1: {var a$9073 = 0;
v$9072 = (function(f$9074){return f$9074(a$9073);
});
 break; }default: {var v$9075 = smltojs0$0SmlToJsCompApp$1$1.dropboxKey$202[1];
var v$9076 = (dojo$0dojo$1.menu$801(v$9013[0],v$9013[1]))("Dropbox");
v$9072 = (function(c$9077){return v$9076(function(v$9078){var c$9079 = appfun2$0dropbox$1.client$91(v$9075);
if (appfun2$0dropbox$1.isAuthorized$99(c$9079)) {smltojs0$0SmlToJsCompApp$1$2.load$1608(c$9079,fts$2699);
appfun2$0dropbox$1.dropboxUid$212(c$9079,function(uid$9080){var s$9081 = ("Authorized to use " + uid$9080) + "'s Dropbox App Folder";
notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,s$9081);
var s$9082;
var t$10774;
var t$10773;
var t$10772;
var t$10771 = basis$0Date$1.fmt$816;
var t$10770 = "%H:%M:%S";
var t$10769;
var v$10017 = SmlPrims.getrealtime();
t$10769 = (basis$0Date$1.fromTimeLocal$512(v$10017[0],v$10017[1]));
t$10772 = (t$10771(t$10770,t$10769));
t$10773 = (t$10772 + ": ");
t$10774 = (t$10773 + s$9081);
s$9082 = (t$10774 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$9082));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
});
(function(e,a,b){return e.setAttribute(a,b);})(smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955,"src","dropbox.png");
} else {notify0$1000("#88dd88",smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954,"Not Dropbox authorized");
var s$9083;
var t$10780;
var t$10779;
var t$10778;
var t$10777 = basis$0Date$1.fmt$816;
var t$10776 = "%H:%M:%S";
var t$10775;
var v$10018 = SmlPrims.getrealtime();
t$10775 = (basis$0Date$1.fromTimeLocal$512(v$10018[0],v$10018[1]));
t$10778 = (t$10777(t$10776,t$10775));
t$10779 = (t$10778 + ": ");
t$10780 = (t$10779 + "Not Dropbox authorized");
s$9083 = (t$10780 + "\n");
(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.logarea$949,document.createTextNode(s$9083));
(function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.logarea$949);
};
var m$9084;
var v$9085 = (dojo$0dojo$1.item$827(v$9078[0],v$9078[1]))(["Sign in",[0,dojo$0dojo$1.createLink$3272],function(v$10084){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignIn$2615(v$9075,v$10084);
}]);
m$9084 = (function(c$9086){return v$9085(function(v$9087){return ((dojo$0dojo$1.item$827(v$9078[0],v$9078[1]))(["Sign out",[0,dojo$0dojo$1.unlink$3273],function(v$10088){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_DropboxSignOut$2638(c$9079,fts$2699,closetab$2702,v$10088);
}]))(c$9086);
});
});
m$9084(function(x$9088){return x$9088;
});
var a$9089 = 0;
return c$9077(a$9089);
});
});
} };
return v$9072(function(v$9090){var v$9091 = (dojo$0dojo$1.item$827(v$9013[0],v$9013[1]))(["Compile->Run",[1],function(v$10159){return smltojs0$0SmlToJsCompApp$1$2.menuHandle_CompileAndRun$2663(v$10159);
}]);
return v$9091(function(v$9092){var v$9093 = (dojo$0dojo$1.item$827(v$9013[0],v$9013[1]))(["Clear output",[1],function(v$9094){var fix$10781 = {};
fix$10781.$whileSome = function(g$9096){lab$whileSome: while (true) {var v$9097 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
switch (v$9097[0]) { case 0: {var v$9098 = v$9097[1];
g$9096(v$9098);
var t$10782 = g$9096;
var g$9096 = t$10782;
continue lab$whileSome;
 break; }default: {return 0;
} };
};
};
var whileSome$9095 = fix$10781.$whileSome;
return whileSome$9095(function(e$9099){return (function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,e$9099);
});
}]);
return v$9093(function(v$9100){var v$9101;
var h$9102 = [["region","left"],[["style","padding:0;padding-right:10;background-color:#eeeeee;"],null]];
v$9101 = (function(f$9103){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9104){var p$9105;
var t$10788 = Cp$9104;
var t$10787;
var fix$10783 = {};
fix$10783.$foldl = function(v$9107,v$9108){lab$foldl: while (true) {if (v$9108 == null) {return v$9107;
} else {var v$9109 = v$9108;
var v$9110 = v$9109[0];
var v$9111 = v$9109[1];
var t$10784;
var v$9112 = v$9110[0];
var v$9113 = v$9110[1];
(function(fp,s,v){fp[s] = v;})(v$9107,v$9112,v$9113);
t$10784 = v$9107;
var t$10785 = t$10784;
var t$10786 = v$9111;
var v$9107 = t$10785;
var v$9108 = t$10786;
continue lab$foldl;
};
};
};
var foldl$9106 = fix$10783.$foldl;
var v$10089 = (function(){return {};})();
t$10787 = (foldl$9106(v$10089,h$9102));
p$9105 = ((function(c,h){return new c(h);})(t$10788,t$10787));
(function(w,e){w.set('content', e);})(p$9105,smltojs0$0SmlToJsCompApp$1$2.logo$1279);
return f$9103(p$9105);
});
});
return v$9101(function(v$9114){var v$9115;
var h$9116 = [["region","right"],[smltojs0$0SmlToJsCompApp$1$2.menuStyle$1280,null]];
v$9115 = (function(f$9117){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/MenuBar",function(MenuBar$9118){var menubar$9119;
var t$10794 = MenuBar$9118;
var t$10793;
var fix$10789 = {};
fix$10789.$foldl = function(v$9121,v$9122){lab$foldl: while (true) {if (v$9122 == null) {return v$9121;
} else {var v$9123 = v$9122;
var v$9124 = v$9123[0];
var v$9125 = v$9123[1];
var t$10790;
var v$9126 = v$9124[0];
var v$9127 = v$9124[1];
(function(fp,s,v){fp[s] = v;})(v$9121,v$9126,v$9127);
t$10790 = v$9121;
var t$10791 = t$10790;
var t$10792 = v$9125;
var v$9121 = t$10791;
var v$9122 = t$10792;
continue lab$foldl;
};
};
};
var foldl$9120 = fix$10789.$foldl;
var v$10091 = (function(){return {};})();
t$10793 = (foldl$9120(v$10091,h$9116));
menubar$9119 = ((function(c,h){return new c(h);})(t$10794,t$10793));
return f$9117([menubar$9119,[menubar$9119,true]]);
});
});
return v$9115(function(v$9128){var v$9129 = v$9128[0];
var v$9130 = v$9128[1];
var v$9131 = (dojo$0dojo$1.menu$801(v$9130[0],v$9130[1]))("Help");
return v$9131(function(v$9132){var v$9133 = (dojo$0dojo$1.item$827(v$9132[0],v$9132[1]))(["About",[0,dojo$0dojo$1.newPage$3265],function(v$9134){var v$10126 = smltojs0$0SmlToJsCompApp$1$1.about$58(0);
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","About SMLtoJs Online",v$10126);
}]);
return v$9133(function(v$9135){var v$9136 = (dojo$0dojo$1.item$827(v$9132[0],v$9132[1]))(["Powered by...",[0,dojo$0dojo$1.newPage$3265],function(v$9137){var v$10128 = smltojs0$0SmlToJsCompApp$1$2.poweredby$2676(0);
return smltojs0$0SmlToJsCompApp$1$2.infoDialog$2443("Ok","Powered by...",v$10128);
}]);
return v$9136(function(v$9138){return ((dojo$0dojo$1.layoutContainer$316([["region","top"],[["style","height:30px;"],null]]))([v$9114,[v$9012,[v$9129,null]]]))(c$5115);
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
});
};
};
smltojs0$0SmlToJsCompApp$1$2.everything$2786;
var v$6254 = dojo$0dojo$1.advTabContainer$571([["region","top"],[["splitter","true"],[["style","height:70%;border:0;"],[["tabPosition","bottom"],null]]]]);
smltojs0$0SmlToJsCompApp$1$2.everything$2786 = (function(c$5296){return v$6254(function(v$5297){var v$9867 = v$5297[0];
var v$9868 = v$5297[1];
var v$9869 = v$9868[1];
var v$9870 = v$9868[0];
var v$9871;
var v$10093 = [[["id","0"],[["name","/"],[["kind","folder"],null]]],smltojs0$0SmlToJsCompApp$1$2.ftsServer$2246];
v$9871 = (function(v$10094){return dojo$0dojo$1.treeStore$481(v$10093,v$10094);
});
return v$9871(function(v$9873){var v$9874 = (((dojo$0dojo$1.tree$567([["region","left"],[["splitter","true"],[["style","width:20%;"],null]]]))("0"))(function(v$9875){var v$9876 = v$9875[0];
var t$10795;
if (v$9876 == "0") {t$10795 = true;
} else {var fields$9877 = basis$0String$1.fields$231(function(c$9878){return c$9878 == 47;
},v$9876);
var fix$10796 = {};
fix$10796.$all = function(v$9880){lab$all: while (true) {if (v$9880 == null) {return true;
} else {var v$9881 = v$9880;
var v$9882 = v$9881[0];
var v$9883 = v$9881[1];
if (smltojs0$0SmlToJsCompApp$1$2.okFolderName$1306(v$9882)) {var t$10797 = v$9883;
var v$9880 = t$10797;
continue lab$all;
} else {return false;
};
};
};
};
var all$9879 = fix$10796.$all;
t$10795 = (all$9879(fields$9877));
};
if (t$10795) {return (smltojs0$0SmlToJsCompApp$1$2.current$1394[0] = v$9876,0);
} else {return smltojs0$0SmlToJsCompApp$1$2.loadFileContent$1636(v$9876,function(v$9884){switch (v$9884[0]) { case 0: {var v$9885 = v$9884[1];
return ((smltojs0$0SmlToJsCompApp$1$2.addEditorTab$2308(v$9867[0],v$9867[1]))(v$9876))(v$9885);
 break; }default: {return v$9869(v$9876);
} };
});
};
}))(v$9873);
return v$9874(function(v$9886){var v$9887 = smltojs0$0SmlToJsCompApp$1$2.menu$2693(v$9867,v$9873,v$9870);
return v$9887(function(v$9888){var v$9889;
var h$9890 = [["title","Output"],null];
v$9889 = (function(f$9891){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9892){var p$9893;
var t$10803 = Cp$9892;
var t$10802;
var fix$10798 = {};
fix$10798.$foldl = function(v$9895,v$9896){lab$foldl: while (true) {if (v$9896 == null) {return v$9895;
} else {var v$9897 = v$9896;
var v$9898 = v$9897[0];
var v$9899 = v$9897[1];
var t$10799;
var v$9900 = v$9898[0];
var v$9901 = v$9898[1];
(function(fp,s,v){fp[s] = v;})(v$9895,v$9900,v$9901);
t$10799 = v$9895;
var t$10800 = t$10799;
var t$10801 = v$9899;
var v$9895 = t$10800;
var v$9896 = t$10801;
continue lab$foldl;
};
};
};
var foldl$9894 = fix$10798.$foldl;
var v$10095 = (function(){return {};})();
t$10802 = (foldl$9894(v$10095,h$9890));
p$9893 = ((function(c,h){return new c(h);})(t$10803,t$10802));
(function(w,e){w.set('content', e);})(p$9893,smltojs0$0SmlToJsCompApp$1$2.outareaDiv$948);
return f$9891(p$9893);
});
});
return v$9889(function(v$9902){var v$9903;
var h$9904 = [["title","Message Log"],null];
v$9903 = (function(f$9905){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9906){var p$9907;
var t$10809 = Cp$9906;
var t$10808;
var fix$10804 = {};
fix$10804.$foldl = function(v$9909,v$9910){lab$foldl: while (true) {if (v$9910 == null) {return v$9909;
} else {var v$9911 = v$9910;
var v$9912 = v$9911[0];
var v$9913 = v$9911[1];
var t$10805;
var v$9914 = v$9912[0];
var v$9915 = v$9912[1];
(function(fp,s,v){fp[s] = v;})(v$9909,v$9914,v$9915);
t$10805 = v$9909;
var t$10806 = t$10805;
var t$10807 = v$9913;
var v$9909 = t$10806;
var v$9910 = t$10807;
continue lab$foldl;
};
};
};
var foldl$9908 = fix$10804.$foldl;
var v$10097 = (function(){return {};})();
t$10808 = (foldl$9908(v$10097,h$9904));
p$9907 = ((function(c,h){return new c(h);})(t$10809,t$10808));
(function(w,e){w.set('content', e);})(p$9907,smltojs0$0SmlToJsCompApp$1$2.logareaDiv$950);
return f$9905(p$9907);
});
});
return v$9903(function(v$9916){var v$9917 = (dojo$0dojo$1.tabContainer$314([["region","center"],[["style","height:30%;"],[["tabPosition","bottom"],null]]]))([v$9902,[v$9916,null]]);
return v$9917(function(v$9918){var v$9919 = (dojo$0dojo$1.borderContainer$315([["region","center"],null]))([v$9867[0],[v$9918,null]]);
return v$9919(function(v$9920){var v$9921;
switch (smltojs0$0SmlToJsCompApp$1$1.rightPane$204[0]) { case 0: {var v$9922 = smltojs0$0SmlToJsCompApp$1$1.rightPane$204[1];
var v$9923;
var h$9924 = [["region","right"],[["splitter","true"],null]];
var e$9925 = v$9922(0);
v$9923 = (function(f$9926){return (function(s,f){require([s,'dojo/domReady!'],f);})("dijit/layout/ContentPane",function(Cp$9927){var p$9928;
var t$10815 = Cp$9927;
var t$10814;
var fix$10810 = {};
fix$10810.$foldl = function(v$9930,v$9931){lab$foldl: while (true) {if (v$9931 == null) {return v$9930;
} else {var v$9932 = v$9931;
var v$9933 = v$9932[0];
var v$9934 = v$9932[1];
var t$10811;
var v$9935 = v$9933[0];
var v$9936 = v$9933[1];
(function(fp,s,v){fp[s] = v;})(v$9930,v$9935,v$9936);
t$10811 = v$9930;
var t$10812 = t$10811;
var t$10813 = v$9934;
var v$9930 = t$10812;
var v$9931 = t$10813;
continue lab$foldl;
};
};
};
var foldl$9929 = fix$10810.$foldl;
var v$10099 = (function(){return {};})();
t$10814 = (foldl$9929(v$10099,h$9924));
p$9928 = ((function(c,h){return new c(h);})(t$10815,t$10814));
(function(w,e){w.set('content', e);})(p$9928,e$9925);
return f$9926(p$9928);
});
});
v$9921 = (function(c$9937){return v$9923(function(v$9938){var a$9939 = [v$9938,null];
return c$9937(a$9939);
});
});
 break; }default: {var a$9940 = null;
v$9921 = (function(f$9941){return f$9941(a$9940);
});
} };
return v$9921(function(v$9942){return ((dojo$0dojo$1.borderContainer$315([["style","height: 100%; width: 100%;"],null]))(basis$0List$1.s$n$686([v$9886,[v$9888,[v$9920,null]]],v$9942)))(c$5296);
});
});
});
});
});
});
});
});
});
});
var t$10816;
var v$5389 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5389[0]) { case 0: {t$10816 = v$5389[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
(function(e,a){return e.appendChild(a);})(t$10816,smltojs0$0SmlToJsCompApp$1$2.notifyAreaElem$954);
var t$10817;
var v$5395 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5395[0]) { case 0: {t$10817 = v$5395[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
(function(e,a){return e.appendChild(a);})(t$10817,smltojs0$0SmlToJsCompApp$1$2.dropboxAreaElem$955);
var t$10819 = dojo$0dojo$1.attachToElement$201;
var t$10818;
var v$5399 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(js$0Js$1.document$88,"body");
switch (v$5399[0]) { case 0: {t$10818 = v$5399[1];
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"getElem"];
} };
t$10819(t$10818,smltojs0$0SmlToJsCompApp$1$2.everything$2786,function(v$2857){return 0;
});
smltojs0$0SmlToJsCompApp$1$2.onload$2837 = function(v$2839){var v$5403 = (function(e){return SmlPrims.option(e.firstChild);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097);
switch (v$5403[0]) { case 0: {var v$5404 = v$5403[1];
var v$5405 = (function(e){return SmlPrims.option(e.nextSibling);})(v$5404);
switch (v$5405[0]) { case 0: {var v$5406 = v$5405[1];
var v$5407 = (function(e){return SmlPrims.option(e.nextSibling);})(v$5406);
switch (v$5407[0]) { case 0: {(function(e,a){return e.removeChild(a);})(smltojs0$0SmlToJsCompApp$1$2.topelem$1097,v$5407[1]);
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody2"];
} };
 break; }default: {throw [basis$0Initial$1.en$Fail$54,"cleanupBody3"];
} };
(smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0] = (function(s$5412){(function(e,a){return e.appendChild(a);})(smltojs0$0SmlToJsCompApp$1$2.outarea$947,document.createTextNode(s$5412));
return (function(t){t.scrollTop = t.scrollHeight;})(smltojs0$0SmlToJsCompApp$1$2.outarea$947);
}),0);
smltojs0$0SmlToJsCompApp$1$1.onloadhook$147(function(s$5417){return smltojs0$0SmlToJsCompApp$1$2.outRef$1027[0](s$5417);
});
(function(i,f){return setInterval(f,i);})(10000,function(v$5420){var fix$10820 = {};
fix$10820.$app = function(v$5422){lab$app: while (true) {if (v$5422 == null) {return 0;
} else {var v$5423 = v$5422;
var v$5424 = v$5423[0];
var v$5425 = v$5423[1];
smltojs0$0SmlToJsCompApp$1$2.saveFile$2021(v$5424[0],v$5424[1],v$5424[2]);
var t$10821 = v$5425;
var v$5422 = t$10821;
continue lab$app;
};
};
};
var app$5421 = fix$10820.$app;
return app$5421(smltojs0$0SmlToJsCompApp$1$2.filesInTabs$1395[0]);
});
return 0;
};
smltojs0$0SmlToJsCompApp$1$2.setWindowOnload$2846 = function(f$2849){return (function(a){return window.onload=a;})(f$2849);
};
(function(a){return window.onload=a;})(function(v$10160){return smltojs0$0SmlToJsCompApp$1$2.onload$2837(v$10160);
});
return 0;
})();
