if ((typeof(compiler0$0CompileDec$1$1)) == "undefined") {compiler0$0CompileDec$1$1 = {};
};
(function(){compiler0$0CompileDec$1$1.report_SourceInfo_in_ElabInfo$79 = function(x$1013){var x$1601 = basics$0ElabInfo$1.to_ParseInfo$192(x$1013);
return basics$0SourceInfo$1.report$78(basics$0ParseInfo$1.to_SourceInfo$93(x$1601));
};
compiler0$0CompileDec$1$1.tag_values$80 = tools$0Flags$1$6.is_on0$5161("tag_values");
compiler0$0CompileDec$1$1.values_64bit$81 = tools$0Flags$1$6.is_on0$5161("values_64bit");
compiler0$0CompileDec$1$1.chat$82 = function(s$85){if (tools$0Flags$1$1.chat$86[0]) {return basis$0General$1.print$163(s$85 + "\n");
} else {return 0;
};
};
compiler0$0CompileDec$1$1.plus$90 = function(v$1782){return compiler_objects$0CompilerEnv$1$7.plus$4867(v$1782[0],v$1782[1]);
};
compiler0$0CompileDec$1$1.die$91 = function(s$94){return tools$0Crash$1.impossible$59("CompileDec." + s$94);
};
compiler0$0CompileDec$1$1.pr$95 = function(s$98){return basis$0TextIO$1.output$110([0],s$98);
};
compiler0$0CompileDec$1$1.pr_st$99 = function(st$102){tools$0PrettyPrint$1.outputTree$1072([function(v$1835){return basis$0General$1.print$163(v$1835);
},st$102,100]);
return basis$0General$1.print$163("\n");
};
compiler0$0CompileDec$1$1.region_profiling$105 = tools$0Flags$1$6.lookup_flag_entry$5164("region_profiling");
compiler0$0CompileDec$1$1.line$106 = function(v$1836){return tools$0Report$1.line$60(v$1836);
};
compiler0$0CompileDec$1$1.s$hh$107 = function(v$1783){return tools$0Report$1.s$hh$64(v$1783[0],v$1783[1]);
};
compiler0$0CompileDec$1$1.report_SourceInfo$108 = function(x$1024){var x$1603 = basics$0ElabInfo$1.to_ParseInfo$192(x$1024);
return basics$0SourceInfo$1.report$78(basics$0ParseInfo$1.to_SourceInfo$93(x$1603));
};
compiler0$0CompileDec$1$1.declareExcon$109 = function(v$116,v$117,v$1784){var v$118 = v$117[0];
var v$119 = v$117[1];
return compiler_objects$0CompilerEnv$1$7.declareExcon$4790(v$116,[v$118,v$119],v$1784);
};
compiler0$0CompileDec$1$1.declareCon$121 = function(v$129,v$130,v$1785){var v$131 = v$130[0];
var v$132 = v$130[1];
var v$133 = v$130[2];
return compiler_objects$0CompilerEnv$1$7.declareCon$4759(v$129,[v$131,v$132,v$133],v$1785);
};
compiler0$0CompileDec$1$1.lookup_error$137 = function(v$176,v$177,v$178,v$179){basis$0General$1.print$163("\n.............");
switch (v$179[0]) { case 1: {var v$1038 = v$179[1];
var st$1039 = basics$0ElabInfo$1.layout$289(v$1038);
tools$0PrettyPrint$1.outputTree$1072([function(s$1040){return basis$0General$1.print$163(s$1040);
},st$1039,tools$0Flags$1$1.colwidth$100[0]]);
 break; }default: {var v$1041 = v$179[1];
basis$0General$1.print$163(v$1041);
} };
var s$1043 = ((("Cannot find " + v$176) + " ") + (syntax_objects$0Ident$1.pr_longid$71(v$178))) + " in compiler environment:\n";
basis$0General$1.print$163(s$1043);
var st$1049 = compiler_objects$0CompilerEnv$1$7.layoutCEnv$6237(v$177);
tools$0PrettyPrint$1.outputTree$1072([function(s$1050){return basis$0General$1.print$163(s$1050);
},st$1049,tools$0Flags$1$1.colwidth$100[0]]);
return tools$0Crash$1.impossible$59("CompileDec.lookup_error");
};
compiler0$0CompileDec$1$1.lookupLongexcon$180 = function(CE$183,longid$186,info$189){var v$196 = compiler_objects$0CompilerEnv$1$7.lookup_longid$4971(CE$183,longid$186);
switch (v$196[0]) { case 0: {var v$198 = v$196[1];
switch (v$198[0]) { case 15: {var v$200 = v$198[1];
return [v$200[0],v$200[1]];
 break; }default: {return compiler0$0CompileDec$1$1.lookup_error$137("long exception constructor",CE$183,longid$186,info$189);
} };
 break; }default: {return compiler0$0CompileDec$1$1.lookup_error$137("long exception constructor",CE$183,longid$186,info$189);
} };
};
compiler0$0CompileDec$1$1.lookupLongcon$204 = function(CE$207,longid$210,info$213){var v$219 = compiler_objects$0CompilerEnv$1$7.lookup_longid$4971(CE$207,longid$210);
switch (v$219[0]) { case 0: {var v$221 = v$219[1];
switch (v$221[0]) { case 17: {return v$221[1][0];
 break; }default: {return compiler0$0CompileDec$1$1.lookup_error$137("long value constructor",CE$207,longid$210,info$213);
} };
 break; }default: {return compiler0$0CompileDec$1$1.lookup_error$137("long value constructor",CE$207,longid$210,info$213);
} };
};
compiler0$0CompileDec$1$1.lookupLongid$226 = function(CE$229,longid$232,info$235){var v$240 = compiler_objects$0CompilerEnv$1$7.lookup_longid$4971(CE$229,longid$232);
switch (v$240[0]) { case 0: {return v$240[1];
 break; }default: {return compiler0$0CompileDec$1$1.lookup_error$137("long value variable",CE$229,longid$232,info$235);
} };
};
compiler0$0CompileDec$1$1.lookup_longstrid$243 = function(ce$246,longstrid$249){return compiler_objects$0CompilerEnv$1$7.lookup_longstrid$5006(ce$246,longstrid$249);
};
compiler0$0CompileDec$1$1.TLEunit$250 = [10,[[5,[1]],null]];
compiler0$0CompileDec$1$1.monoLet$251 = function(v$261,v$1786){return [12,[v$261[2],[[v$261[0],null,v$261[1]],null],v$1786]];
};
compiler0$0CompileDec$1$1.If$266 = function(v$1787,v$1788,v$1789){return [6,[0,[v$1787,[[[compiler_objects$0Con$1$1.con_TRUE$127,[1]],v$1788],null],[0,v$1789]]]];
};
compiler0$0CompileDec$1$1.new_lvar_from_string_opt$275 = function(v$278){switch (v$278[0]) { case 1: {return compiler_objects$0Lvars$1$1.newLvar$75(0);
 break; }default: {var v$284 = v$278[1];
return compiler_objects$0Lvars$1$1.new_named_lvar$65(v$284);
} };
};
compiler0$0CompileDec$1$1.new_lvar_from_id$285 = function(x$1060){return compiler_objects$0Lvars$1$1.new_named_lvar$65(syntax_objects$0Ident$1.pr_id$62(x$1060));
};
compiler0$0CompileDec$1$1.new_lvar_from_pat$286 = function(x$1064){var v$1606 = basics$0PostElabGrammar$1$2.find_topmost_id_in_pat$1831(x$1064);
switch (v$1606[0]) { case 1: {return compiler_objects$0Lvars$1$1.newLvar$75(0);
 break; }default: {var v$1607 = v$1606[1];
return compiler_objects$0Lvars$1$1.new_named_lvar$65(v$1607);
} };
};
compiler0$0CompileDec$1$1.new_lvar_from_pats$287 = function(v$290){if (v$290 == null) {return compiler_objects$0Lvars$1$1.newLvar$75(0);
} else {var v$298 = v$290;
if (v$298[1] == null) {var v$300 = v$298[0];
var v$1609 = basics$0PostElabGrammar$1$2.find_topmost_id_in_pat$1831(v$300);
switch (v$1609[0]) { case 1: {return compiler_objects$0Lvars$1$1.newLvar$75(0);
 break; }default: {var v$1610 = v$1609[1];
return compiler_objects$0Lvars$1$1.new_named_lvar$65(v$1610);
} };
} else {return compiler_objects$0Lvars$1$1.newLvar$75(0);
};
};
};
var datbindss$302 = [null];
compiler0$0CompileDec$1$1.add$303 = function(datbinds$306){return (datbindss$302[0] = [datbinds$306,datbindss$302[0]],0);
};
compiler0$0CompileDec$1$1.extract$307 = function(v$309){return basis$0List$1.rev$682(datbindss$302[0]);
};
compiler0$0CompileDec$1$1.reset$310 = function(v$312){return (datbindss$302[0] = null,0);
};
compiler0$0CompileDec$1$1.unbox_datbinds$344 = function(datbinds$347){var bucket$348 = [null];
var fix$1838 = {};
fix$1838.$app = function(v$1151){lab$app: while (true) {if (v$1151 == null) {return 0;
} else {var v$1152 = v$1151;
var v$1153 = v$1152[0];
var v$1154 = v$1152[1];
var v$1622 = v$1153[1];
var v$1623 = v$1153[2];
var t$1846;
var fix$1843 = {};
fix$1843.$all = function(v$1625){lab$all: while (true) {if (v$1625 == null) {return true;
} else {var v$1626 = v$1625;
var v$1627 = v$1626[0];
var v$1628 = v$1626[1];
var t$1844;
switch (v$1627[1][0]) { case 1: {t$1844 = true;
 break; }default: {t$1844 = false;
} };
if (t$1844) {var t$1845 = v$1628;
var v$1625 = t$1845;
continue lab$all;
} else {return false;
};
};
};
};
var all$1624 = fix$1843.$all;
t$1846 = (all$1624(v$1623));
if (t$1846) {var t$1842;
var fix$1839 = {};
fix$1839.$exists = function(v$1631){lab$exists: while (true) {if (v$1631 == null) {return false;
} else {var v$1632 = v$1631;
var v$1633 = v$1632[0];
var v$1634 = v$1632[1];
var t$1840;
var v$1635 = v$1633[2];
var v$1636 = v$1622[2];
var v$1637 = v$1635[0][1];
var v$1638 = v$1636[0][1];
t$1840 = ((v$1637[0] == v$1638[0])?(v$1637[1] == v$1638[1]):false);
if (t$1840) {return true;
} else {var t$1841 = v$1634;
var v$1631 = t$1841;
continue lab$exists;
};
};
};
};
var exists$1630 = fix$1839.$exists;
t$1842 = (exists$1630(bucket$348[0]));
t$1842?0:(bucket$348[0] = [v$1622,bucket$348[0]],0);
} else {0;
};
var t$1847 = v$1154;
var v$1151 = t$1847;
continue lab$app;
};
};
};
var app$1150 = fix$1838.$app;
app$1150(datbinds$347);
var fix$1848 = {};
fix$1848.$app = function(v$1167){lab$app: while (true) {if (v$1167 == null) {return 0;
} else {var v$1168 = v$1167;
var v$1169 = v$1168[0];
var v$1170 = v$1168[1];
var v$1650 = v$1169[1];
var v$1651 = v$1169[2];
var tns$1652 = basis$0List$1.map$697((function(env$1849){return function(v$1653){return v$1653[1];
};
})([]),datbinds$347);
var fix$1850 = {};
fix$1850.$one_datbind = function(n$1655,tn$1656,cns$1657){lab$one_datbind: while (true) {if (cns$1657 == null) {var t$1854;
var fix$1851 = {};
fix$1851.$exists = function(v$1660){lab$exists: while (true) {if (v$1660 == null) {return false;
} else {var v$1661 = v$1660;
var v$1662 = v$1661[0];
var v$1663 = v$1661[1];
var t$1852;
var v$1664 = v$1662[2];
var v$1665 = tn$1656[2];
var v$1666 = v$1664[0][1];
var v$1667 = v$1665[0][1];
t$1852 = ((v$1666[0] == v$1667[0])?(v$1666[1] == v$1667[1]):false);
if (t$1852) {return true;
} else {var t$1853 = v$1663;
var v$1660 = t$1853;
continue lab$exists;
};
};
};
};
var exists$1659 = fix$1851.$exists;
t$1854 = (exists$1659(bucket$348[0]));
return t$1854?0:(bucket$348[0] = [tn$1656,bucket$348[0]],0);
} else {var v$1668 = cns$1657;
var v$1669 = v$1668[0];
var v$1670 = v$1669[1];
switch (v$1670[0]) { case 1: {var v$1671 = v$1668[1];
var t$1855 = n$1655;
var t$1856 = tn$1656;
var t$1857 = v$1671;
var n$1655 = t$1855;
var tn$1656 = t$1856;
var cns$1657 = t$1857;
continue lab$one_datbind;
 break; }default: {var v$1672 = v$1670[1];
var v$1673 = v$1668[1];
var t$1863;
var t$1862;
var t$1858;
switch (v$1672[0]) { case 2: {var v$1674 = v$1672[1];
var v$1675 = v$1674[1];
if (special_objects$0TyName$1$1.unboxed$398(v$1675[0],v$1675[1],v$1675[2],v$1675[3],v$1675[4],v$1675[5])) {t$1858 = true;
} else {var fix$1859 = {};
fix$1859.$exists = function(v$1677){lab$exists: while (true) {if (v$1677 == null) {return false;
} else {var v$1678 = v$1677;
var v$1679 = v$1678[0];
var v$1680 = v$1678[1];
var t$1860;
var v$1681 = v$1679[2];
var v$1682 = v$1675[2];
var v$1683 = v$1681[0][1];
var v$1684 = v$1682[0][1];
t$1860 = ((v$1683[0] == v$1684[0])?(v$1683[1] == v$1684[1]):false);
if (t$1860) {return true;
} else {var t$1861 = v$1680;
var v$1677 = t$1861;
continue lab$exists;
};
};
};
};
var exists$1676 = fix$1859.$exists;
t$1858 = (exists$1676(tns$1652));
};
 break; }case 0: {t$1858 = true;
 break; }case 1: {t$1858 = ((v$1672[1] == null)?true:false);
 break; }default: {t$1858 = false;
} };
t$1862 = (t$1858?false:true);
t$1863 = (t$1862?(n$1655 < 1):false);
if (t$1863) {var t$1864 = SmlPrims.chk_ovf_i32(n$1655 + 1);
var t$1865 = tn$1656;
var t$1866 = v$1673;
var n$1655 = t$1864;
var tn$1656 = t$1865;
var cns$1657 = t$1866;
continue lab$one_datbind;
} else {return 0;
};
} };
};
};
};
var one_datbind$1654 = fix$1850.$one_datbind;
one_datbind$1654(0,v$1650,v$1651);
var t$1867 = v$1170;
var v$1167 = t$1867;
continue lab$app;
};
};
};
var app$1166 = fix$1848.$app;
app$1166(datbinds$347);
var t$1876;
var t$1872;
var a$1230 = bucket$348[0];
var fix$1873 = {};
fix$1873.$acc = function(v$1232,v$1233){lab$acc: while (true) {if (v$1232 == null) {return v$1233;
} else {var v$1234 = v$1232;
var v$1235 = v$1234[1];
var t$1874 = v$1235;
var t$1875 = SmlPrims.chk_ovf_i32(v$1233 + 1);
var v$1232 = t$1874;
var v$1233 = t$1875;
continue lab$acc;
};
};
};
var acc$1231 = fix$1873.$acc;
t$1872 = (acc$1231(a$1230,0));
var t$1871;
var fix$1868 = {};
fix$1868.$acc = function(v$1239,v$1240){lab$acc: while (true) {if (v$1239 == null) {return v$1240;
} else {var v$1241 = v$1239;
var v$1242 = v$1241[1];
var t$1869 = v$1242;
var t$1870 = SmlPrims.chk_ovf_i32(v$1240 + 1);
var v$1239 = t$1869;
var v$1240 = t$1870;
continue lab$acc;
};
};
};
var acc$1238 = fix$1868.$acc;
t$1871 = (acc$1238(datbinds$347,0));
t$1876 = (t$1872 == t$1871);
if (t$1876) {var l$1244 = bucket$348[0];
var fix$1877 = {};
fix$1877.$app = function(v$1246){lab$app: while (true) {if (v$1246 == null) {return 0;
} else {var v$1247 = v$1246;
var v$1248 = v$1247[0];
var v$1249 = v$1247[1];
special_objects$0TyName$1$1.setUnboxed$414(v$1248);
var t$1878 = v$1249;
var v$1246 = t$1878;
continue lab$app;
};
};
};
var app$1245 = fix$1877.$app;
return app$1245(l$1244);
} else {return 0;
};
};
var env$456 = [tools$0FinMapEq$1.empty$57(0)];
compiler0$0CompileDec$1$1.lookup$465 = function(s$468,tv$471){try {var v$476;
var a$1251 = env$456[0];
v$476 = (tools$0FinMapEq$1.lookup$70(function(v$1829){return basics$0StatObject$1.eq$465(v$1829[0],v$1829[1]);
},a$1251,tv$471));
switch (v$476[0]) { case 0: {return v$476[1];
 break; }default: {var tv$$479 = (basics$0StatObject$1.equality$450(tv$471))?(compiler_objects$0LambdaExp$1$4.fresh_eqtyvar$1579(0)):(compiler_objects$0LambdaExp$1$4.fresh_tyvar$1576(0));
var t$1881 = env$456;
var t$1880;
var a$1254 = [tv$471,tv$$479,env$456[0]];
t$1880 = (tools$0FinMapEq$1.add$176(function(v$1791){return basics$0StatObject$1.eq$465(v$1791[0],v$1791[1]);
},a$1254));
(t$1881[0] = t$1880,0);
return tv$$479;
} };
} catch(v$1879) {return (function(s$m$488){basis$0TextIO$1.output$110([0],("  [TV.lookup " + s$468) + "]  ");
throw s$m$488;
})(v$1879);
};
};
compiler0$0CompileDec$1$1.reset$491 = function(v$493){return (env$456[0] = (tools$0FinMapEq$1.empty$57(0)),0);
};
compiler0$0CompileDec$1$1.to_TypeInfo$494 = function(i$497){var v$502 = basics$0ElabInfo$1.to_TypeInfo$202(i$497);
switch (v$502[0]) { case 0: {var v$504 = v$502[1];
return [0,basics$0TypeInfo$1.normalise$310(v$504)];
 break; }default: {return [1];
} };
};
var fix$1882 = {};
fix$1882.$makeList = function(f$508,x$511){var t$1945;
var t$1944 = x$511;
var t$1943;
var v$516 = f$508(x$511);
switch (v$516[0]) { case 0: {var v$518 = v$516[1];
t$1943 = (fix$1882.$makeList(f$508,v$518));
 break; }default: {t$1943 = null;
} };
t$1945 = [t$1944,t$1943];
return t$1945;
};
compiler0$0CompileDec$1$1.makeList$505 = fix$1882.$makeList;
compiler0$0CompileDec$1$1.type_of_exp$519 = function(exp$522){var v$528;
var i$1259 = basics$0PostElabGrammar$1$2.get_info_exp$244(exp$522);
var v$1260 = basics$0ElabInfo$1.to_TypeInfo$202(i$1259);
switch (v$1260[0]) { case 0: {var v$1261 = v$1260[1];
v$528 = [0,basics$0TypeInfo$1.normalise$310(v$1261)];
 break; }default: {v$528 = [1];
} };
switch (v$528[0]) { case 0: {var v$530 = v$528[1];
switch (v$530[0]) { case 14: {return v$530[1][0];
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.type_of_exp");
} };
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.type_of_exp");
} };
};
compiler0$0CompileDec$1$1.type_of_match$535 = function(match$538){var v$544;
var i$1270 = basics$0PostElabGrammar$1$2.get_info_match$243(match$538);
var v$1271 = basics$0ElabInfo$1.to_TypeInfo$202(i$1270);
switch (v$1271[0]) { case 0: {var v$1272 = v$1271[1];
v$544 = [0,basics$0TypeInfo$1.normalise$310(v$1272)];
 break; }default: {v$544 = [1];
} };
switch (v$544[0]) { case 0: {var v$546 = v$544[1];
switch (v$546[0]) { case 9: {return v$546[1][0];
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.type_of_match");
} };
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.type_of_match");
} };
};
compiler0$0CompileDec$1$1.map_opt$551 = function(v$554,v$557){switch (v$557[0]) { case 0: {var v$568 = v$557[1];
return [0,v$554(v$568)];
 break; }default: {return [1];
} };
};
compiler0$0CompileDec$1$1.app_opt$570 = function(v$573,v$576){switch (v$576[0]) { case 0: {var v$587 = v$576[1];
return v$573(v$587);
 break; }default: {return 0;
} };
};
compiler0$0CompileDec$1$1.NoSome$589 = function(errmsg$592,x$595){switch (x$595[0]) { case 1: {return tools$0Crash$1.impossible$59("CompileDec." + errmsg$592);
 break; }default: {return x$595[1];
} };
};
var fix$1883 = {};
fix$1883.$zip3 = function(v$621,v$1792,v$1793){if (v$621 == null) {if (v$1792 == null) {if (v$1793 == null) {return null;
} else {return tools$0Crash$1.impossible$59("CompileDec.zip3");
};
} else {return tools$0Crash$1.impossible$59("CompileDec.zip3");
};
} else {if (v$1792 == null) {return tools$0Crash$1.impossible$59("CompileDec.zip3");
} else {if (v$1793 == null) {return tools$0Crash$1.impossible$59("CompileDec.zip3");
} else {var v$627 = v$621;
var v$628 = v$627[0];
var v$629 = v$627[1];
var v$630 = v$1792;
var v$631 = v$630[0];
var v$632 = v$630[1];
var v$633 = v$1793;
var v$634 = v$633[0];
var v$635 = v$633[1];
return [[v$628,v$631,v$634],fix$1883.$zip3(v$629,v$632,v$635)];
};
};
};
};
compiler0$0CompileDec$1$1.zip3$602 = fix$1883.$zip3;
compiler0$0CompileDec$1$1.mk_env$639 = function(declare$642,v$646){var v$656 = v$646[0];
var v$657 = v$646[1];
var c$1299 = basis$0ListPair$1.zip$55(v$656,v$657);
var fix$1884 = {};
fix$1884.$foldr = function(v$1301){if (v$1301 == null) {return compiler_objects$0CompilerEnv$1$7.emptyCEnv$4595;
} else {var v$1302 = v$1301;
var v$1303 = v$1302[0];
var v$1304 = v$1302[1];
var v$1774 = fix$1884.$foldr(v$1304);
var v$1687 = v$1303[0];
var v$1688 = v$1303[1];
return declare$642([v$1687,v$1688,v$1774]);
};
};
var foldr$1300 = fix$1884.$foldr;
return foldr$1300(c$1299);
};
compiler0$0CompileDec$1$1.pr_list$658 = function(pr$661,l$664){var fix$1885 = {};
fix$1885.$pr_l = function(v$668){if (v$668 == null) {return "";
} else {var v$679 = v$668;
var v$680 = v$679[1];
if (v$680 == null) {var v$686 = v$679[0];
return pr$661(v$686);
} else {var v$682 = v$679[0];
var v$683 = v$680;
var v$684 = v$683[0];
var v$685 = v$683[1];
return ((pr$661(v$682)) + ",") + (fix$1885.$pr_l([v$684,v$685]));
};
};
};
var pr_l$665 = fix$1885.$pr_l;
return ("[" + (pr_l$665(l$664))) + "]";
};
compiler0$0CompileDec$1$1.compileExCon$687 = function(id$690){return compiler_objects$0Excon$1$1.mk_excon$61(syntax_objects$0Ident$1.pr_id$62(id$690));
};
compiler0$0CompileDec$1$1.compileCon$691 = function(id$694){return compiler_objects$0Con$1$1.mk_con$64(syntax_objects$0Ident$1.pr_id$62(id$694));
};
compiler0$0CompileDec$1$1.compileTyName$695 = function(tyname$698){var t$1887;
var t$1886;
var v$1312 = tyname$698[2];
var v$1313 = special_objects$0TyName$1$1.tyName_CHAR$268[2];
var v$1314 = v$1312[0][1];
var v$1315 = v$1313[0][1];
t$1886 = ((v$1314[0] == v$1315[0])?(v$1314[1] == v$1315[1]):false);
if (t$1886) {t$1887 = true;
} else {var v$1319 = tyname$698[2];
var v$1320 = special_objects$0TyName$1$1.tyName_WORD8$236[2];
var v$1321 = v$1319[0][1];
var v$1322 = v$1320[0][1];
t$1887 = ((v$1321[0] == v$1322[0])?(v$1321[1] == v$1322[1]):false);
};
if (t$1887) {return special_objects$0TyName$1$1.tyName_WordDefault$319(0);
} else {return tyname$698;
};
};
var fix$1888 = {};
fix$1888.$compileType = function(typ$710){lab$compileType: while (true) {var v$715 = basics$0StatObject$1.to_RecType$1543(typ$710);
switch (v$715[0]) { case 1: {var v$720 = basics$0StatObject$1.to_ConsType$2041(typ$710);
switch (v$720[0]) { case 1: {var v$725 = basics$0StatObject$1.to_FunType$1994(typ$710);
switch (v$725[0]) { case 1: {var v$730 = basics$0StatObject$1.to_TyVar$1522(typ$710);
switch (v$730[0]) { case 1: {return tools$0Crash$1.impossible$59("CompileDec.compileType(1)");
 break; }default: {var v$731 = v$730[1];
var t$1890;
try {var v$1692;
var a$1693 = env$456[0];
v$1692 = (tools$0FinMapEq$1.lookup$70((function(env$1892){return function(v$1830){var v$1891 = env$1892[0];
return v$1891(v$1830[0],v$1830[1]);
};
})([basics$0StatObject$1.eq$465]),a$1693,v$731));
switch (v$1692[0]) { case 0: {t$1890 = v$1692[1];
 break; }default: {var tv$$1694 = (basics$0StatObject$1.equality$450(v$731))?(compiler_objects$0LambdaExp$1$4.fresh_eqtyvar$1579(0)):(compiler_objects$0LambdaExp$1$4.fresh_tyvar$1576(0));
var t$1896 = env$456;
var t$1893;
var a$1695 = [v$731,tv$$1694,env$456[0]];
t$1893 = (tools$0FinMapEq$1.add$176((function(env$1895){return function(v$1795){var v$1894 = env$1895[0];
return v$1894(v$1795[0],v$1795[1]);
};
})([basics$0StatObject$1.eq$465]),a$1695));
(t$1896[0] = t$1893,0);
t$1890 = tv$$1694;
} };
} catch(v$1889) {t$1890 = (((function(env$1898){return function(s$m$1696){var v$1897 = env$1898[0];
v$1897([0],"  [TV.lookup compileType]  ");
throw s$m$1696;
};
})([basis$0TextIO$1.output$110]))(v$1889));
};
return [0,t$1890];
} };
 break; }default: {var v$740 = v$725[1];
var v$737;
var x$1326 = basics$0StatObject$1.un_FunType$2019(v$740);
switch (x$1326[0]) { case 1: {v$737 = (tools$0Crash$1.impossible$59("CompileDec.compileType(2)"));
 break; }default: {v$737 = x$1326[1];
} };
var v$738 = v$737[0];
var v$739 = v$737[1];
return [3,[[fix$1888.$compileType(v$738),null],[fix$1888.$compileType(v$739),null]]];
} };
 break; }default: {var v$748 = v$720[1];
var v$745;
var x$1330 = basics$0StatObject$1.un_ConsType$2066(v$748);
switch (x$1330[0]) { case 1: {v$745 = (tools$0Crash$1.impossible$59("CompileDec.compileType(3)"));
 break; }default: {v$745 = x$1330[1];
} };
var v$746 = v$745[0];
var v$747 = v$745[1];
var t$1905;
var t$1904 = basis$0List$1.map$697((function(env$1903){return function(v$1837){var v$1902 = env$1903[0];
return v$1902(v$1837);
};
})([fix$1888.$compileType]),v$746);
var t$1901;
var t$1900;
var t$1899;
var v$1698 = v$747[2];
var v$1699 = special_objects$0TyName$1$1.tyName_CHAR$268[2];
var v$1700 = v$1698[0][1];
var v$1701 = v$1699[0][1];
t$1899 = ((v$1700[0] == v$1701[0])?(v$1700[1] == v$1701[1]):false);
if (t$1899) {t$1900 = true;
} else {var v$1702 = v$747[2];
var v$1703 = special_objects$0TyName$1$1.tyName_WORD8$236[2];
var v$1704 = v$1702[0][1];
var v$1705 = v$1703[0][1];
t$1900 = ((v$1704[0] == v$1705[0])?(v$1704[1] == v$1705[1]):false);
};
t$1901 = (t$1900?(special_objects$0TyName$1$1.tyName_WordDefault$319(0)):v$747);
t$1905 = [t$1904,t$1901];
return [2,t$1905];
} };
 break; }default: {var v$755 = v$715[1];
var labtys$749 = basics$0StatObject$1.to_list$1762(v$755);
var tys$$750 = basis$0List$1.map$697((function(env$1907){return function(x$1336){var v$1906 = env$1907[0];
return v$1906(x$1336[1]);
};
})([fix$1888.$compileType]),labtys$749);
return [1,tys$$750];
} };
};
};
compiler0$0CompileDec$1$1.compileType$707 = fix$1888.$compileType;
compiler0$0CompileDec$1$1.domType$756 = function(x$1340){var x$1726 = basics$0StatObject$1.to_FunType$1994(x$1340);
var x$1727;
switch (x$1726[0]) { case 1: {x$1727 = (tools$0Crash$1.impossible$59("CompileDec.domType(1)"));
 break; }default: {x$1727 = x$1726[1];
} };
var x$1728 = basics$0StatObject$1.un_FunType$2019(x$1727);
var t$1908;
switch (x$1728[0]) { case 1: {t$1908 = (tools$0Crash$1.impossible$59("CompileDec.domType(2)"));
 break; }default: {t$1908 = x$1728[1];
} };
return t$1908[0];
};
compiler0$0CompileDec$1$1.compileTypeScheme$761 = function(v$779,v$780){try {return [basis$0List$1.map$697(function(tv$1730){try {var v$1731;
var a$1732 = env$456[0];
v$1731 = (tools$0FinMapEq$1.lookup$70(function(v$1831){return basics$0StatObject$1.eq$465(v$1831[0],v$1831[1]);
},a$1732,tv$1730));
switch (v$1731[0]) { case 0: {return v$1731[1];
 break; }default: {var tv$$1733 = (basics$0StatObject$1.equality$450(tv$1730))?(compiler_objects$0LambdaExp$1$4.fresh_eqtyvar$1579(0)):(compiler_objects$0LambdaExp$1$4.fresh_tyvar$1576(0));
var t$1912 = env$456;
var t$1911;
var a$1734 = [tv$1730,tv$$1733,env$456[0]];
t$1911 = (tools$0FinMapEq$1.add$176(function(v$1797){return basics$0StatObject$1.eq$465(v$1797[0],v$1797[1]);
},a$1734));
(t$1912[0] = t$1911,0);
return tv$$1733;
} };
} catch(v$1910) {return (function(s$m$1735){basis$0TextIO$1.output$110([0],"  [TV.lookup compileTypeScheme]  ");
throw s$m$1735;
})(v$1910);
};
},v$779),compiler0$0CompileDec$1$1.compileType$707(v$780)];
} catch(v$1909) {return (function(s$m$770){basis$0General$1.print$163(((("type scheme is all[" + (SmlPrims.concat(basis$0List$1.map$697(function(tv$775){return (basics$0StatObject$1.string$$744(function(ty$778){return "inst=" + (basics$0StatObject$1.string$1517(ty$778));
},tv$775)) + ", ";
},v$779)))) + "].") + (basics$0StatObject$1.string$1517(v$780))) + "\n");
throw s$m$770;
})(v$1909);
};
};
compiler0$0CompileDec$1$1.compileTyVar$781 = function(tyvar$784){try {var v$1738;
var a$1739 = env$456[0];
v$1738 = (tools$0FinMapEq$1.lookup$70(function(v$1832){return basics$0StatObject$1.eq$465(v$1832[0],v$1832[1]);
},a$1739,tyvar$784));
switch (v$1738[0]) { case 0: {return v$1738[1];
 break; }default: {var tv$$1740 = (basics$0StatObject$1.equality$450(tyvar$784))?(compiler_objects$0LambdaExp$1$4.fresh_eqtyvar$1579(0)):(compiler_objects$0LambdaExp$1$4.fresh_tyvar$1576(0));
var t$1915 = env$456;
var t$1914;
var a$1741 = [tyvar$784,tv$$1740,env$456[0]];
t$1914 = (tools$0FinMapEq$1.add$176(function(v$1799){return basics$0StatObject$1.eq$465(v$1799[0],v$1799[1]);
},a$1741));
(t$1915[0] = t$1914,0);
return tv$$1740;
} };
} catch(v$1913) {return (function(s$m$1742){basis$0TextIO$1.output$110([0],"  [TV.lookup compileTyVar]  ");
throw s$m$1742;
})(v$1913);
};
};
compiler0$0CompileDec$1$1.on_Type$785 = function(S$788,tau$791){return compiler_objects$0LambdaBasics$1.on_Type$2574(S$788,tau$791);
};
compiler0$0CompileDec$1$1.unTyVarType$792 = function(v$795){switch (v$795[0]) { case 0: {return v$795[1];
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.unTyVarType");
} };
};
compiler0$0CompileDec$1$1.mk_subst$803 = function(a$806){return function(v$1819){return compiler_objects$0LambdaBasics$1.mk_subst$2569(a$806,v$1819);
};
};
compiler0$0CompileDec$1$1.on_il$807 = function(v$812,v$813){return basis$0List$1.map$697(function(v$1821){return compiler_objects$0LambdaBasics$1.on_Type$2574(v$812,v$1821);
},v$813);
};
compiler0$0CompileDec$1$1.pr_tvs$814 = function(tvs$817){var fix$1916 = {};
fix$1916.$pr_l = function(v$1746){if (v$1746 == null) {return "";
} else {var v$1747 = v$1746;
var v$1748 = v$1747[1];
if (v$1748 == null) {var v$1753 = v$1747[0];
return compiler_objects$0LambdaExp$1$4.pr_tyvar$1555(v$1753);
} else {var v$1749 = v$1747[0];
var v$1750 = v$1748;
var v$1751 = v$1750[0];
var v$1752 = v$1750[1];
return ((compiler_objects$0LambdaExp$1$4.pr_tyvar$1555(v$1749)) + ",") + (fix$1916.$pr_l([v$1751,v$1752]));
};
};
};
var pr_l$1745 = fix$1916.$pr_l;
return ("[" + (pr_l$1745(tvs$817))) + "]";
};
compiler0$0CompileDec$1$1.compile_cb$818 = function(tyvars0$821,v$827){var v$872 = v$827[0];
var v$873 = v$872[0];
var v$874 = v$872[1];
var v$875 = v$827[1];
var v$876 = v$875[0];
var v$877 = v$875[1];
var con$$828 = compiler_objects$0Con$1$1.mk_con$64(syntax_objects$0Ident$1.pr_id$62(v$873));
var v$832;
switch (v$874[0]) { case 3: {var v$856 = v$874[1];
var v$857 = v$856[0];
if (v$857 == null) {v$832 = (tools$0Crash$1.impossible$59("CompileDec.compile_cb: wrong type"));
} else {var v$859 = v$857;
if (v$859[1] == null) {var v$861 = v$856[1];
if (v$861 == null) {v$832 = (tools$0Crash$1.impossible$59("CompileDec.compile_cb: wrong type"));
} else {var v$863 = v$861;
var v$864 = v$863[0];
switch (v$864[0]) { case 2: {if (v$863[1] == null) {var v$867 = v$859[0];
var v$868 = v$864[1];
var v$869 = v$868[0];
v$832 = [basis$0List$1.map$697(function(v$1373){switch (v$1373[0]) { case 0: {return v$1373[1];
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.unTyVarType");
} };
},v$869),[0,v$867]];
} else {v$832 = (tools$0Crash$1.impossible$59("CompileDec.compile_cb: wrong type"));
};
 break; }default: {v$832 = (tools$0Crash$1.impossible$59("CompileDec.compile_cb: wrong type"));
} };
};
} else {v$832 = (tools$0Crash$1.impossible$59("CompileDec.compile_cb: wrong type"));
};
};
 break; }case 2: {var v$852 = v$874[1];
var v$853 = v$852[0];
v$832 = [basis$0List$1.map$697(function(v$1391){switch (v$1391[0]) { case 0: {return v$1391[1];
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.unTyVarType");
} };
},v$853),[1]];
 break; }default: {v$832 = (tools$0Crash$1.impossible$59("CompileDec.compile_cb: wrong type"));
} };
var v$834 = v$832[1];
return [compiler_objects$0CompilerEnv$1$7.declareCon$4759(v$873,[con$$828,tyvars0$821,v$874],v$876),[[con$$828,v$834],v$877]];
};
compiler0$0CompileDec$1$1.compile$TyStr$$878 = function(v$1800,v$922){var tyvars$883;
var en$H$884 = new String("H");
try {tyvars$883 = (basics$0Environments$1.CEfold$1363(function(typescheme$887){return function(cbs$890){var v$894 = typescheme$887[0];
throw [en$H$884,v$894];
};
},null,v$922));
} catch(v$1917) {tyvars$883 = ((function(v$898){var t$1918 = v$898;
if (t$1918[0] == en$H$884) {return v$898[1];
} else {throw v$898;
};
})(v$1917));
};
var tyvars$$899 = basis$0List$1.map$697(function(tv$1755){try {var v$1756;
var a$1757 = env$456[0];
v$1756 = (tools$0FinMapEq$1.lookup$70(function(v$1833){return basics$0StatObject$1.eq$465(v$1833[0],v$1833[1]);
},a$1757,tv$1755));
switch (v$1756[0]) { case 0: {return v$1756[1];
 break; }default: {var tv$$1758 = (basics$0StatObject$1.equality$450(tv$1755))?(compiler_objects$0LambdaExp$1$4.fresh_eqtyvar$1579(0)):(compiler_objects$0LambdaExp$1$4.fresh_tyvar$1576(0));
var t$1921 = env$456;
var t$1920;
var a$1759 = [tv$1755,tv$$1758,env$456[0]];
t$1920 = (tools$0FinMapEq$1.add$176(function(v$1802){return basics$0StatObject$1.eq$465(v$1802[0],v$1802[1]);
},a$1759));
(t$1921[0] = t$1920,0);
return tv$$1758;
} };
} catch(v$1919) {return (function(s$m$1760){basis$0TextIO$1.output$110([0],"  [TV.lookup compile'TyStr']  ");
throw s$m$1760;
})(v$1919);
};
},tyvars$883);
var cbs$900 = basics$0Environments$1.CEFold$1380(function(v$904){var v$913 = v$904[0];
var v$914 = v$904[1];
return function(cbs$907){var v$912 = v$914[1];
return [[v$913,compiler0$0CompileDec$1$1.compileType$707(v$912)],cbs$907];
};
},null,v$922);
var v$918;
var b$1407 = [compiler_objects$0CompilerEnv$1$7.emptyCEnv$4595,null];
var c$1408 = basis$0List$1.rev$682(cbs$900);
var fix$1922 = {};
fix$1922.$foldl = function(v$1410,v$1411){lab$foldl: while (true) {if (v$1411 == null) {return v$1410;
} else {var v$1412 = v$1411;
var v$1413 = v$1412[0];
var v$1414 = v$1412[1];
var t$1923;
var v$1834 = [v$1413,v$1410];
t$1923 = (compiler0$0CompileDec$1$1.compile_cb$818(tyvars$$899,v$1834));
var t$1924 = t$1923;
var t$1925 = v$1414;
var v$1410 = t$1924;
var v$1411 = t$1925;
continue lab$foldl;
};
};
};
var foldl$1409 = fix$1922.$foldl;
v$918 = (foldl$1409(b$1407,c$1408));
return [v$918[0],tyvars$$899,v$918[1]];
};
compiler0$0CompileDec$1$1.typeScon$923 = function(i$926){var v$935;
var v$1416 = basics$0ElabInfo$1.to_TypeInfo$202(i$926);
switch (v$1416[0]) { case 0: {var v$1417 = v$1416[1];
v$935 = [0,basics$0TypeInfo$1.normalise$310(v$1417)];
 break; }default: {v$935 = [1];
} };
switch (v$935[0]) { case 0: {var v$937 = v$935[1];
switch (v$937[0]) { case 9: {var v$942 = v$937[1];
var v$943 = v$942[0];
return compiler0$0CompileDec$1$1.compileType$707(v$943);
 break; }case 14: {var v$939 = v$937[1];
var v$940 = v$939[0];
return compiler0$0CompileDec$1$1.compileType$707(v$940);
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.typeScon.wrong type info");
} };
 break; }default: {return tools$0Crash$1.impossible$59("CompileDec.typeScon.wrong type info");
} };
};
var fix$1926 = {};
fix$1926.$digits = function(x$948){var t$1938;
var v$1599 = basis$0IntInf$1.fromInt$1829(0);
switch (v$1599[0]) { case 0: {var v$1764 = x$948[1];
var v$1765 = v$1599[1];
var t$1942;
var fix$1939 = {};
fix$1939.$eq_list = function(v$1768,v$1769){lab$eq_list: while (true) {if (v$1768 == null) {return (v$1769 == null)?true:false;
} else {if (v$1769 == null) {return false;
} else {var v$1770 = v$1768;
var v$1771 = v$1769;
if (v$1770[0] == v$1771[0]) {var t$1940 = v$1770[1];
var t$1941 = v$1771[1];
var v$1768 = t$1940;
var v$1769 = t$1941;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$1766 = fix$1939.$eq_list;
t$1942 = (eq_list$1766(v$1764[0],v$1765[0]));
t$1938 = (t$1942?(v$1764[1] == v$1765[1]):false);
 break; }default: {t$1938 = false;
} };
if (t$1938) {return null;
} else {var maxdigit$953 = [0,[[0,[1,null]],false]];
var rest$954 = basis$0IntInf$1.div$2161([x$948,maxdigit$953]);
return [basis$0IntInf$1.mod$2169([x$948,maxdigit$953]),fix$1926.$digits(rest$954)];
};
};
compiler0$0CompileDec$1$1.digits$945 = fix$1926.$digits;
compiler0$0CompileDec$1$1.buildIntInf$956 = function(x$959){var a$960 = basis$0IntInf$1.abs$2254(x$959);
var t$1937;
var t$1936 = [14,[compiler_objects$0Con$1$1.con_INTINF$133,null,[1]]];
var t$1935;
var t$1934;
var t$1933;
var t$1932;
var t$1931 = [5,[1]];
var t$1930;
var t$1929;
var t$1927;
var b$1446 = [10,[[14,[compiler_objects$0Con$1$1.con_NIL$129,[compiler_objects$0LambdaExp$1$4.int31Type$1669,null],[1]]],null]];
var c$1447 = compiler0$0CompileDec$1$1.digits$945(a$960);
var fix$1928 = {};
fix$1928.$foldr = function(v$1449){if (v$1449 == null) {return b$1446;
} else {var v$1450 = v$1449;
var v$1451 = v$1450[0];
var v$1452 = v$1450[1];
return [10,[[14,[compiler_objects$0Con$1$1.con_CONS$130,[compiler_objects$0LambdaExp$1$4.int31Type$1669,null],[1]]],[[10,[[5,[1]],[[13,[v$1451,compiler_objects$0LambdaExp$1$4.int31Type$1669]],[fix$1928.$foldr(v$1452),null]]]],null]]];
};
};
var foldr$1448 = fix$1928.$foldr;
t$1927 = (foldr$1448(c$1447));
t$1929 = [t$1927,[[10,[[14,[(basis$0IntInf$1.s$j$2222(x$959,basis$0IntInf$1.fromInt$1829(0)))?compiler_objects$0Con$1$1.con_TRUE$127:compiler_objects$0Con$1$1.con_FALSE$128,null,[1]]],null]],null]];
t$1930 = t$1929;
t$1932 = [t$1931,t$1930];
t$1933 = [10,t$1932];
t$1934 = [t$1933,null];
t$1935 = t$1934;
t$1937 = [t$1936,t$1935];
return [10,t$1937];
};
return 0;
})();
