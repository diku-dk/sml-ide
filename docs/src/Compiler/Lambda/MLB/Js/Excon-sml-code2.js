if ((typeof(compiler_objects$0Excon$1$2)) == "undefined") {compiler_objects$0Excon$1$2 = {};
};
(function(){compiler_objects$0Excon$1$2.die$304 = function(s$307){return tools$0Crash$1.impossible$59("QuasiMap2." + s$307);
};
compiler_objects$0Excon$1$2.key$308 = function(v$1674,v$1675){return v$1674[0][1];
};
compiler_objects$0Excon$1$2.rigid$312 = function(v$1676,v$1677){return v$1676[0][2];
};
compiler_objects$0Excon$1$2.empty$320 = function(v$1700){return null;
};
compiler_objects$0Excon$1$2.singleton$321 = function(v$332,v$333){var nd$326 = v$332[0];
var k$327 = nd$326[0][1];
return nd$326[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$327,[v$332,v$333])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$327,[v$332,v$333]),special_objects$0Name$1.current_matchcount$69(0)]]];
};
compiler_objects$0Excon$1$2.isEmpty$334 = function(v$337){return (v$337 == null)?true:false;
};
compiler_objects$0Excon$1$2.imap$342 = function(v$345){if (v$345 == null) {return [1];
} else {var v$354 = v$345;
switch (v$354[0][0]) { case 0: {var v$356 = v$354[0][1];
return [0,v$356];
 break; }default: {var v$357 = v$354[0][1];
var v$358 = v$357[0];
return [0,v$358];
} };
};
};
compiler_objects$0Excon$1$2.imap$$359 = function(v$362){if (v$362 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible");
} else {var v$372 = v$362;
switch (v$372[0][0]) { case 0: {return v$372[0][1];
 break; }default: {return v$372[0][1][0];
} };
};
};
compiler_objects$0Excon$1$2.ensure_consistent_imap$377 = function(imap$380){var v$400 = tools$0IntStringFinMap$1.Fold$78(function(v$408){var v$417 = v$408[0];
var v$418 = v$417[0];
var v$419 = v$417[1];
var v$420 = v$419[0];
var v$421 = v$408[1];
var v$422 = v$421[0];
var v$423 = v$421[1];
var t$1701;
if (v$422) {var v$1363 = v$420[0][0][1];
t$1701 = ((v$1363[0] == v$418[0])?(v$1363[1] == v$418[1]):false);
} else {t$1701 = false;
};
return [t$1701,v$423?v$420[0][0][2]:false];
},[true,true],imap$380);
var v$401 = v$400[0];
var v$402 = v$400[1];
return [v$401?imap$380:(tools$0IntStringFinMap$1.fold$62(function(v$393){var v$394 = v$393[0];
var v$395 = v$394[0];
var v$396 = v$394[1];
var v$397 = v$393[1];
return tools$0IntStringFinMap$1.add$237(v$395[0][0][1],[v$395,v$396],v$397);
},tools$0IntStringFinMap$1.empty$117(0),imap$380)),v$402];
};
compiler_objects$0Excon$1$2.ensure_consistent$424 = function(v$427){if (v$427 == null) {return v$427;
} else {var v$440 = v$427;
switch (v$440[0][0]) { case 0: {return v$427;
 break; }default: {var v$460 = v$440[0][1];
var v$461 = v$460[0];
var v$462 = v$460[1];
if (v$462 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$457 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$461);
var v$458 = v$457[1];
var v$459 = v$457[0];
if (v$458) {(v$440[0] = [0,v$459],0);
return v$427;
} else {(v$440[0] = [1,[v$459,special_objects$0Name$1.current_matchcount$69(0)]],0);
return v$427;
};
} else {return v$427;
};
} };
};
};
compiler_objects$0Excon$1$2.mk_flex$463 = function(imap$466){return [[1,[imap$466,special_objects$0Name$1.current_matchcount$69(0)]]];
};
compiler_objects$0Excon$1$2.mk_rigid$467 = function(imap$470){return [[0,imap$470]];
};
compiler_objects$0Excon$1$2.lookup$471 = function(m$474,d$477){var v$482;
if (m$474 == null) {m$474;
} else {var v$1442 = m$474;
switch (v$1442[0][0]) { case 0: {m$474;
 break; }default: {var v$1443 = v$1442[0][1];
var v$1444 = v$1443[0];
var v$1445 = v$1443[1];
if (v$1445 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1446 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1444);
var v$1447 = v$1446[1];
var v$1448 = v$1446[0];
if (v$1447) {(v$1442[0] = [0,v$1448],0);
m$474;
} else {(v$1442[0] = [1,[v$1448,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$474;
};
} else {m$474;
};
} };
};
if (m$474 == null) {v$482 = [1];
} else {var v$1143 = m$474;
switch (v$1143[0][0]) { case 0: {var v$1144 = v$1143[0][1];
v$482 = [0,v$1144];
 break; }default: {var v$1145 = v$1143[0][1];
var v$1146 = v$1145[0];
v$482 = [0,v$1146];
} };
};
switch (v$482[0]) { case 0: {var v$492 = v$482[1];
var v$488 = tools$0IntStringFinMap$1.lookup$129(v$492,d$477[0][0][1]);
switch (v$488[0]) { case 0: {var v$490 = v$488[1];
var v$491 = v$490[1];
return [0,v$491];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
compiler_objects$0Excon$1$2.add$493 = function(v$518,v$519,v$520){if (v$520 == null) {v$520;
} else {var v$1450 = v$520;
switch (v$1450[0][0]) { case 0: {v$520;
 break; }default: {var v$1451 = v$1450[0][1];
var v$1452 = v$1451[0];
var v$1453 = v$1451[1];
if (v$1453 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1454 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1452);
var v$1455 = v$1454[1];
var v$1456 = v$1454[0];
if (v$1455) {(v$1450[0] = [0,v$1456],0);
v$520;
} else {(v$1450[0] = [1,[v$1456,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$520;
};
} else {v$520;
};
} };
};
if (v$520 == null) {var nd$1151 = v$518[0];
var k$1152 = nd$1151[0][1];
return nd$1151[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$1152,[v$518,v$519])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$1152,[v$518,v$519]),special_objects$0Name$1.current_matchcount$69(0)]]];
} else {var v$507 = v$520;
switch (v$507[0][0]) { case 0: {var v$515 = v$507[0][1];
var nd$509 = v$518[0];
var i$510 = nd$509[0][1];
return nd$509[0][2]?[[0,tools$0IntStringFinMap$1.add$237(i$510,[v$518,v$519],v$515)]]:[[1,[tools$0IntStringFinMap$1.add$237(i$510,[v$518,v$519],v$515),special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {var v$516 = v$507[0][1];
var v$517 = v$516[0];
return [[1,[tools$0IntStringFinMap$1.add$237(v$518[0][0][1],[v$518,v$519],v$517),special_objects$0Name$1.current_matchcount$69(0)]]];
} };
};
};
compiler_objects$0Excon$1$2.plus$521 = function(v$555,v$556){if (v$555 == null) {v$555;
} else {var v$1458 = v$555;
switch (v$1458[0][0]) { case 0: {v$555;
 break; }default: {var v$1459 = v$1458[0][1];
var v$1460 = v$1459[0];
var v$1461 = v$1459[1];
if (v$1461 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1462 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1460);
var v$1463 = v$1462[1];
var v$1464 = v$1462[0];
if (v$1463) {(v$1458[0] = [0,v$1464],0);
v$555;
} else {(v$1458[0] = [1,[v$1464,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$555;
};
} else {v$555;
};
} };
};
if (v$556 == null) {v$556;
} else {var v$1466 = v$556;
switch (v$1466[0][0]) { case 0: {v$556;
 break; }default: {var v$1467 = v$1466[0][1];
var v$1468 = v$1467[0];
var v$1469 = v$1467[1];
if (v$1469 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1470 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1468);
var v$1471 = v$1470[1];
var v$1472 = v$1470[0];
if (v$1471) {(v$1466[0] = [0,v$1472],0);
v$556;
} else {(v$1466[0] = [1,[v$1472,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$556;
};
} else {v$556;
};
} };
};
if (v$555 == null) {return v$556;
} else {if (v$556 == null) {return v$555;
} else {var v$546 = v$555;
switch (v$546[0][0]) { case 0: {var v$548 = v$556;
switch (v$548[0][0]) { case 0: {var v$550 = v$546[0][1];
var v$551 = v$548[0][1];
return [[0,tools$0IntStringFinMap$1.plus$255(v$550,v$551)]];
 break; }default: {var t$1708;
var t$1707;
var t$1706;
var t$1705;
var t$1704 = tools$0IntStringFinMap$1.plus$255;
var t$1703;
if (v$555 == null) {t$1703 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1474 = v$555;
switch (v$1474[0][0]) { case 0: {t$1703 = v$1474[0][1];
 break; }default: {t$1703 = v$1474[0][1][0];
} };
};
var t$1702;
if (v$556 == null) {t$1702 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1475 = v$556;
switch (v$1475[0][0]) { case 0: {t$1702 = v$1475[0][1];
 break; }default: {t$1702 = v$1475[0][1][0];
} };
};
t$1705 = (t$1704(t$1703,t$1702));
t$1706 = [t$1705,special_objects$0Name$1.current_matchcount$69(0)];
t$1707 = [1,t$1706];
t$1708 = [t$1707];
return t$1708;
} };
 break; }default: {var t$1715;
var t$1714;
var t$1713;
var t$1712;
var t$1711 = tools$0IntStringFinMap$1.plus$255;
var t$1710;
if (v$555 == null) {t$1710 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1477 = v$555;
switch (v$1477[0][0]) { case 0: {t$1710 = v$1477[0][1];
 break; }default: {t$1710 = v$1477[0][1][0];
} };
};
var t$1709;
if (v$556 == null) {t$1709 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1478 = v$556;
switch (v$1478[0][0]) { case 0: {t$1709 = v$1478[0][1];
 break; }default: {t$1709 = v$1478[0][1][0];
} };
};
t$1712 = (t$1711(t$1710,t$1709));
t$1713 = [t$1712,special_objects$0Name$1.current_matchcount$69(0)];
t$1714 = [1,t$1713];
t$1715 = [t$1714];
return t$1715;
} };
};
};
};
compiler_objects$0Excon$1$2.remove$557 = function(v$598,v$599){if (v$599 == null) {v$599;
} else {var v$1480 = v$599;
switch (v$1480[0][0]) { case 0: {v$599;
 break; }default: {var v$1481 = v$1480[0][1];
var v$1482 = v$1481[0];
var v$1483 = v$1481[1];
if (v$1483 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1484 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1482);
var v$1485 = v$1484[1];
var v$1486 = v$1484[0];
if (v$1485) {(v$1480[0] = [0,v$1486],0);
v$599;
} else {(v$1480[0] = [1,[v$1486,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$599;
};
} else {v$599;
};
} };
};
if (v$599 == null) {return [1];
} else {var v$571 = v$599;
switch (v$571[0][0]) { case 0: {var v$584 = v$571[0][1];
var v$577 = tools$0IntStringFinMap$1.remove$262(v$598[0][0][1],v$584);
switch (v$577[0]) { case 0: {var v$583 = v$577[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$583))?[0,null]:[0,[[0,v$583]]];
 break; }default: {return [1];
} };
 break; }default: {var v$596 = v$571[0][1];
var v$597 = v$596[0];
var v$589 = tools$0IntStringFinMap$1.remove$262(v$598[0][0][1],v$597);
switch (v$589[0]) { case 0: {var v$595 = v$589[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$595))?[0,null]:[0,[[1,[v$595,special_objects$0Name$1.current_matchcount$69(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
compiler_objects$0Excon$1$2.dom$600 = function(v$603){if (v$603 == null) {return null;
} else {var t$1720 = basis$0List$1.map$697;
var t$1719 = function(v$611){return v$611[0];
};
var t$1718;
var t$1717 = tools$0IntStringFinMap$1.range$284;
var t$1716;
if (v$603 == null) {v$603;
} else {var v$1488 = v$603;
switch (v$1488[0][0]) { case 0: {v$603;
 break; }default: {var v$1489 = v$1488[0][1];
var v$1490 = v$1489[0];
var v$1491 = v$1489[1];
if (v$1491 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1492 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1490);
var v$1493 = v$1492[1];
var v$1494 = v$1492[0];
if (v$1493) {(v$1488[0] = [0,v$1494],0);
v$603;
} else {(v$1488[0] = [1,[v$1494,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$603;
};
} else {v$603;
};
} };
};
if (v$603 == null) {t$1716 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1175 = v$603;
switch (v$1175[0][0]) { case 0: {t$1716 = v$1175[0][1];
 break; }default: {t$1716 = v$1175[0][1][0];
} };
};
t$1718 = (t$1717(t$1716));
return t$1720(t$1719,t$1718);
};
};
compiler_objects$0Excon$1$2.range$613 = function(v$616){if (v$616 == null) {return null;
} else {var t$1725 = basis$0List$1.map$697;
var t$1724 = function(v$624){return v$624[1];
};
var t$1723;
var t$1722 = tools$0IntStringFinMap$1.range$284;
var t$1721;
if (v$616 == null) {v$616;
} else {var v$1496 = v$616;
switch (v$1496[0][0]) { case 0: {v$616;
 break; }default: {var v$1497 = v$1496[0][1];
var v$1498 = v$1497[0];
var v$1499 = v$1497[1];
if (v$1499 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1500 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1498);
var v$1501 = v$1500[1];
var v$1502 = v$1500[0];
if (v$1501) {(v$1496[0] = [0,v$1502],0);
v$616;
} else {(v$1496[0] = [1,[v$1502,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$616;
};
} else {v$616;
};
} };
};
if (v$616 == null) {t$1721 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1179 = v$616;
switch (v$1179[0][0]) { case 0: {t$1721 = v$1179[0][1];
 break; }default: {t$1721 = v$1179[0][1][0];
} };
};
t$1723 = (t$1722(t$1721));
return t$1725(t$1724,t$1723);
};
};
compiler_objects$0Excon$1$2.list$626 = function(v$629){if (v$629 == null) {return null;
} else {var t$1727 = tools$0IntStringFinMap$1.range$284;
var t$1726;
if (v$629 == null) {v$629;
} else {var v$1504 = v$629;
switch (v$1504[0][0]) { case 0: {v$629;
 break; }default: {var v$1505 = v$1504[0][1];
var v$1506 = v$1505[0];
var v$1507 = v$1505[1];
if (v$1507 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1508 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1506);
var v$1509 = v$1508[1];
var v$1510 = v$1508[0];
if (v$1509) {(v$1504[0] = [0,v$1510],0);
v$629;
} else {(v$1504[0] = [1,[v$1510,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$629;
};
} else {v$629;
};
} };
};
if (v$629 == null) {t$1726 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1183 = v$629;
switch (v$1183[0][0]) { case 0: {t$1726 = v$1183[0][1];
 break; }default: {t$1726 = v$1183[0][1][0];
} };
};
return t$1727(t$1726);
};
};
compiler_objects$0Excon$1$2.fromList$635 = function(v$638){if (v$638 == null) {return null;
} else {var v$651;
var b$1187 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1728 = {};
fix$1728.$foldl = function(v$1190,v$1191){lab$foldl: while (true) {if (v$1191 == null) {return v$1190;
} else {var v$1192 = v$1191;
var v$1193 = v$1192[0];
var v$1194 = v$1192[1];
var t$1729;
var v$1513 = v$1193[0];
var v$1514 = v$1193[1];
var v$1516 = v$1190[0];
var v$1517 = v$1190[1];
t$1729 = [tools$0IntStringFinMap$1.add$237(v$1513[0][0][1],[v$1513,v$1514],v$1516),v$1517?v$1513[0][0][2]:false];
var t$1730 = t$1729;
var t$1731 = v$1194;
var v$1190 = t$1730;
var v$1191 = t$1731;
continue lab$foldl;
};
};
};
var foldl$1189 = fix$1728.$foldl;
v$651 = (foldl$1189(b$1187,v$638));
var v$652 = v$651[0];
return v$651[1]?[[0,v$652]]:[[1,[v$652,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Excon$1$2.composemap$670 = function(f$673,m$676){var v$681;
if (m$676 == null) {v$681 = null;
} else {var t$1733 = tools$0IntStringFinMap$1.range$284;
var t$1732;
if (m$676 == null) {m$676;
} else {var v$1519 = m$676;
switch (v$1519[0][0]) { case 0: {m$676;
 break; }default: {var v$1520 = v$1519[0][1];
var v$1521 = v$1520[0];
var v$1522 = v$1520[1];
if (v$1522 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1523 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1521);
var v$1524 = v$1523[1];
var v$1525 = v$1523[0];
if (v$1524) {(v$1519[0] = [0,v$1525],0);
m$676;
} else {(v$1519[0] = [1,[v$1525,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$676;
};
} else {m$676;
};
} };
};
if (m$676 == null) {t$1732 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1201 = m$676;
switch (v$1201[0][0]) { case 0: {t$1732 = v$1201[0][1];
 break; }default: {t$1732 = v$1201[0][1][0];
} };
};
v$681 = (t$1733(t$1732));
};
if (v$681 == null) {return null;
} else {var v$689;
var b$1204 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1734 = {};
fix$1734.$foldl = function(v$1207,v$1208){lab$foldl: while (true) {if (v$1208 == null) {return v$1207;
} else {var v$1209 = v$1208;
var v$1210 = v$1209[0];
var v$1211 = v$1209[1];
var t$1735;
var v$1528 = v$1210[0];
var v$1529 = v$1210[1];
var v$1531 = v$1207[0];
var v$1532 = v$1207[1];
t$1735 = [tools$0IntStringFinMap$1.add$237(v$1528[0][0][1],[v$1528,f$673(v$1529)],v$1531),v$1532?v$1528[0][0][2]:false];
var t$1736 = t$1735;
var t$1737 = v$1211;
var v$1207 = t$1736;
var v$1208 = t$1737;
continue lab$foldl;
};
};
};
var foldl$1206 = fix$1734.$foldl;
v$689 = (foldl$1206(b$1204,v$681));
var v$690 = v$689[0];
return v$689[1]?[[0,v$690]]:[[1,[v$690,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Excon$1$2.ComposeMap$708 = function(f$711,m$714){var v$719;
if (m$714 == null) {v$719 = null;
} else {var t$1739 = tools$0IntStringFinMap$1.range$284;
var t$1738;
if (m$714 == null) {m$714;
} else {var v$1534 = m$714;
switch (v$1534[0][0]) { case 0: {m$714;
 break; }default: {var v$1535 = v$1534[0][1];
var v$1536 = v$1535[0];
var v$1537 = v$1535[1];
if (v$1537 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1538 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1536);
var v$1539 = v$1538[1];
var v$1540 = v$1538[0];
if (v$1539) {(v$1534[0] = [0,v$1540],0);
m$714;
} else {(v$1534[0] = [1,[v$1540,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$714;
};
} else {m$714;
};
} };
};
if (m$714 == null) {t$1738 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1218 = m$714;
switch (v$1218[0][0]) { case 0: {t$1738 = v$1218[0][1];
 break; }default: {t$1738 = v$1218[0][1][0];
} };
};
v$719 = (t$1739(t$1738));
};
if (v$719 == null) {return null;
} else {var v$727;
var b$1221 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1740 = {};
fix$1740.$foldl = function(v$1224,v$1225){lab$foldl: while (true) {if (v$1225 == null) {return v$1224;
} else {var v$1226 = v$1225;
var v$1227 = v$1226[0];
var v$1228 = v$1226[1];
var t$1741;
var v$1543 = v$1227[0];
var v$1544 = v$1227[1];
var v$1546 = v$1224[0];
var v$1547 = v$1224[1];
t$1741 = [tools$0IntStringFinMap$1.add$237(v$1543[0][0][1],[v$1543,f$711([v$1543,v$1544])],v$1546),v$1547?v$1543[0][0][2]:false];
var t$1742 = t$1741;
var t$1743 = v$1228;
var v$1224 = t$1742;
var v$1225 = t$1743;
continue lab$foldl;
};
};
};
var foldl$1223 = fix$1740.$foldl;
v$727 = (foldl$1223(b$1221,v$719));
var v$728 = v$727[0];
return v$727[1]?[[0,v$728]]:[[1,[v$728,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Excon$1$2.fold$746 = function(f$749,b$752,m$755){var c$1235;
if (m$755 == null) {c$1235 = null;
} else {var t$1748 = basis$0List$1.map$697;
var t$1747 = function(v$1243){return v$1243[1];
};
var t$1746;
var t$1745 = tools$0IntStringFinMap$1.range$284;
var t$1744;
if (m$755 == null) {m$755;
} else {var v$1549 = m$755;
switch (v$1549[0][0]) { case 0: {m$755;
 break; }default: {var v$1550 = v$1549[0][1];
var v$1551 = v$1550[0];
var v$1552 = v$1550[1];
if (v$1552 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1553 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1551);
var v$1554 = v$1553[1];
var v$1555 = v$1553[0];
if (v$1554) {(v$1549[0] = [0,v$1555],0);
m$755;
} else {(v$1549[0] = [1,[v$1555,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$755;
};
} else {m$755;
};
} };
};
if (m$755 == null) {t$1744 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1245 = m$755;
switch (v$1245[0][0]) { case 0: {t$1744 = v$1245[0][1];
 break; }default: {t$1744 = v$1245[0][1][0];
} };
};
t$1746 = (t$1745(t$1744));
c$1235 = (t$1748(t$1747,t$1746));
};
var fix$1749 = {};
fix$1749.$foldl = function(v$1237,v$1238){lab$foldl: while (true) {if (v$1238 == null) {return v$1237;
} else {var v$1239 = v$1238;
var v$1240 = v$1239[0];
var v$1241 = v$1239[1];
var t$1750 = f$749([v$1240,v$1237]);
var t$1751 = v$1241;
var v$1237 = t$1750;
var v$1238 = t$1751;
continue lab$foldl;
};
};
};
var foldl$1236 = fix$1749.$foldl;
return foldl$1236(b$752,c$1235);
};
compiler_objects$0Excon$1$2.Fold$756 = function(f$759,b$762,m$765){var c$1249;
if (m$765 == null) {c$1249 = null;
} else {var t$1753 = tools$0IntStringFinMap$1.range$284;
var t$1752;
if (m$765 == null) {m$765;
} else {var v$1557 = m$765;
switch (v$1557[0][0]) { case 0: {m$765;
 break; }default: {var v$1558 = v$1557[0][1];
var v$1559 = v$1558[0];
var v$1560 = v$1558[1];
if (v$1560 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1561 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1559);
var v$1562 = v$1561[1];
var v$1563 = v$1561[0];
if (v$1562) {(v$1557[0] = [0,v$1563],0);
m$765;
} else {(v$1557[0] = [1,[v$1563,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$765;
};
} else {m$765;
};
} };
};
if (m$765 == null) {t$1752 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1258 = m$765;
switch (v$1258[0][0]) { case 0: {t$1752 = v$1258[0][1];
 break; }default: {t$1752 = v$1258[0][1][0];
} };
};
c$1249 = (t$1753(t$1752));
};
var fix$1754 = {};
fix$1754.$foldl = function(v$1251,v$1252){lab$foldl: while (true) {if (v$1252 == null) {return v$1251;
} else {var v$1253 = v$1252;
var v$1254 = v$1253[0];
var v$1255 = v$1253[1];
var t$1755 = f$759([v$1254,v$1251]);
var t$1756 = v$1255;
var v$1251 = t$1755;
var v$1252 = t$1756;
continue lab$foldl;
};
};
};
var foldl$1250 = fix$1754.$foldl;
return foldl$1250(b$762,c$1249);
};
compiler_objects$0Excon$1$2.filter$766 = function(f$769,m$772){var l$773;
if (m$772 == null) {l$773 = null;
} else {var t$1758 = tools$0IntStringFinMap$1.range$284;
var t$1757;
if (m$772 == null) {m$772;
} else {var v$1565 = m$772;
switch (v$1565[0][0]) { case 0: {m$772;
 break; }default: {var v$1566 = v$1565[0][1];
var v$1567 = v$1566[0];
var v$1568 = v$1566[1];
if (v$1568 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1569 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1567);
var v$1570 = v$1569[1];
var v$1571 = v$1569[0];
if (v$1570) {(v$1565[0] = [0,v$1571],0);
m$772;
} else {(v$1565[0] = [1,[v$1571,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$772;
};
} else {m$772;
};
} };
};
if (m$772 == null) {t$1757 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1262 = m$772;
switch (v$1262[0][0]) { case 0: {t$1757 = v$1262[0][1];
 break; }default: {t$1757 = v$1262[0][1][0];
} };
};
l$773 = (t$1758(t$1757));
};
var l$$774 = basis$0List$1.filter$417(f$769,l$773);
return compiler_objects$0Excon$1$2.fromList$635(l$$774);
};
compiler_objects$0Excon$1$2.addList$775 = function(l$778,m1$781){var m2$782 = compiler_objects$0Excon$1$2.fromList$635(l$778);
return compiler_objects$0Excon$1$2.plus$521(m1$781,m2$782);
};
compiler_objects$0Excon$1$2.mergeMap$783 = function(f$786,m1$789,m2$792){if (m1$789 == null) {m1$789;
} else {var v$1573 = m1$789;
switch (v$1573[0][0]) { case 0: {m1$789;
 break; }default: {var v$1574 = v$1573[0][1];
var v$1575 = v$1574[0];
var v$1576 = v$1574[1];
if (v$1576 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1577 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1575);
var v$1578 = v$1577[1];
var v$1579 = v$1577[0];
if (v$1578) {(v$1573[0] = [0,v$1579],0);
m1$789;
} else {(v$1573[0] = [1,[v$1579,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$789;
};
} else {m1$789;
};
} };
};
if (m2$792 == null) {m2$792;
} else {var v$1581 = m2$792;
switch (v$1581[0][0]) { case 0: {m2$792;
 break; }default: {var v$1582 = v$1581[0][1];
var v$1583 = v$1582[0];
var v$1584 = v$1582[1];
if (v$1584 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1585 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1583);
var v$1586 = v$1585[1];
var v$1587 = v$1585[0];
if (v$1586) {(v$1581[0] = [0,v$1587],0);
m2$792;
} else {(v$1581[0] = [1,[v$1587,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$792;
};
} else {m2$792;
};
} };
};
var rhs3$821 = function(obj$838){var t$1767;
var t$1766;
var t$1765;
var t$1764;
var t$1763 = tools$0IntStringFinMap$1.mergeMap$374;
var t$1762 = function(v$1589){var v$1590 = v$1589[0];
var v$1591 = v$1590[0];
var v$1592 = v$1590[1];
var v$1593 = v$1589[1];
var v$1594 = v$1593[0];
var v$1595 = v$1593[1];
var t$1761;
var v$1596 = v$1591[0][0][1];
var v$1597 = v$1594[0][0][1];
t$1761 = ((v$1596[0] == v$1597[0])?(v$1596[1] == v$1597[1]):false);
if (t$1761) {return [v$1591,f$786([v$1592,v$1595])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
};
var t$1760;
if (m1$789 == null) {t$1760 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1274 = m1$789;
switch (v$1274[0][0]) { case 0: {t$1760 = v$1274[0][1];
 break; }default: {t$1760 = v$1274[0][1][0];
} };
};
var t$1759;
if (m2$792 == null) {t$1759 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1278 = m2$792;
switch (v$1278[0][0]) { case 0: {t$1759 = v$1278[0][1];
 break; }default: {t$1759 = v$1278[0][1][0];
} };
};
t$1764 = (t$1763(t$1762,t$1760,t$1759));
t$1765 = [t$1764,special_objects$0Name$1.current_matchcount$69(0)];
t$1766 = [1,t$1765];
t$1767 = [t$1766];
return t$1767;
};
if (m1$789 == null) {return m2$792;
} else {if (m2$792 == null) {return m1$789;
} else {var v$830 = m1$789;
switch (v$830[0][0]) { case 0: {var v$832 = m2$792;
switch (v$832[0][0]) { case 0: {var v$834 = v$830[0][1];
var v$835 = v$832[0][1];
return [[0,tools$0IntStringFinMap$1.mergeMap$374(function(v$1599){var v$1600 = v$1599[0];
var v$1601 = v$1600[0];
var v$1602 = v$1600[1];
var v$1603 = v$1599[1];
var v$1604 = v$1603[0];
var v$1605 = v$1603[1];
var t$1768;
var v$1606 = v$1601[0][0][1];
var v$1607 = v$1604[0][0][1];
t$1768 = ((v$1606[0] == v$1607[0])?(v$1606[1] == v$1607[1]):false);
if (t$1768) {return [v$1601,f$786([v$1602,v$1605])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
},v$834,v$835)]];
 break; }default: {return rhs3$821(0);
} };
 break; }default: {return rhs3$821(0);
} };
};
};
};
var fix$1769 = {};
fix$1769.$pp_lookup = function(v$842,v$845,v$848){lab$pp_lookup: while (true) {if (v$845 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$867 = v$845;
var v$868 = v$867[0];
var v$869 = v$867[1];
var t$1770;
var v$1419 = v$868[0][0][1];
t$1770 = ((v$848[0] == v$1419[0])?(v$848[1] == v$1419[1]):false);
if (t$1770) {return v$842(v$868);
} else {var t$1771 = v$842;
var t$1772 = v$869;
var t$1773 = v$848;
var v$842 = t$1771;
var v$845 = t$1772;
var v$848 = t$1773;
continue lab$pp_lookup;
};
};
};
};
compiler_objects$0Excon$1$2.pp_lookup$839 = fix$1769.$pp_lookup;
compiler_objects$0Excon$1$2.en$Restrict$871 = new String("Restrict");
compiler_objects$0Excon$1$2.restrict$872 = function(v$1678,v$1679,v$885){if (v$885 == null) {return null;
} else {if (v$1679 == null) {v$1679;
} else {var v$1611 = v$1679;
switch (v$1611[0][0]) { case 0: {v$1679;
 break; }default: {var v$1612 = v$1611[0][1];
var v$1613 = v$1612[0];
var v$1614 = v$1612[1];
if (v$1614 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1615 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1613);
var v$1616 = v$1615[1];
var v$1617 = v$1615[0];
if (v$1616) {(v$1611[0] = [0,v$1617],0);
v$1679;
} else {(v$1611[0] = [1,[v$1617,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1679;
};
} else {v$1679;
};
} };
};
if (v$1679 == null) {throw [compiler_objects$0Excon$1$2.en$Restrict$871,"[empty map]"];
} else {var im$893;
if (v$1679 == null) {im$893 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1290 = v$1679;
switch (v$1290[0][0]) { case 0: {im$893 = v$1290[0][1];
 break; }default: {im$893 = v$1290[0][1][0];
} };
};
var ns$894 = basis$0List$1.map$697(function(d$1293){return d$1293[0][0][1];
},v$885);
var im$$896;
try {var t$1780 = tools$0IntStringFinMap$1.restrict$391;
var t$1779;
var fix$1775 = {};
fix$1775.$pp_lookup = function(v$1693,v$1694){lab$pp_lookup: while (true) {if (v$1693 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$1695 = v$1693;
var v$1696 = v$1695[0];
var v$1697 = v$1695[1];
var t$1776;
var v$1698 = v$1696[0][0][1];
t$1776 = ((v$1694[0] == v$1698[0])?(v$1694[1] == v$1698[1]):false);
if (t$1776) {return v$1678(v$1696);
} else {var t$1777 = v$1697;
var t$1778 = v$1694;
var v$1693 = t$1777;
var v$1694 = t$1778;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$1692 = fix$1775.$pp_lookup;
t$1779 = (function(v$1699){return pp_lookup$1692(v$885,v$1699);
});
im$$896 = (t$1780(t$1779,im$893,ns$894));
} catch(v$1774) {im$$896 = ((function(v$900){var t$1781 = v$900;
if (t$1781[0] == tools$0IntStringFinMap$1.en$Restrict$390) {var s$897 = v$900[1];
throw [compiler_objects$0Excon$1$2.en$Restrict$871,s$897];
} else {throw v$900;
};
})(v$1774));
};
return (tools$0IntStringFinMap$1.fold$62(function(v$905){var v$910 = v$905[0];
var v$911 = v$910[0];
return v$905[1]?v$911[0][0][2]:false;
},true,im$$896))?[[0,im$$896]]:[[1,[im$$896,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
};
compiler_objects$0Excon$1$2.enrich$919 = function(f$922,v$926){var v$950 = v$926[0];
var v$951 = v$926[1];
if (v$950 == null) {v$950;
} else {var v$1619 = v$950;
switch (v$1619[0][0]) { case 0: {v$950;
 break; }default: {var v$1620 = v$1619[0][1];
var v$1621 = v$1620[0];
var v$1622 = v$1620[1];
if (v$1622 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1623 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1621);
var v$1624 = v$1623[1];
var v$1625 = v$1623[0];
if (v$1624) {(v$1619[0] = [0,v$1625],0);
v$950;
} else {(v$1619[0] = [1,[v$1625,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$950;
};
} else {v$950;
};
} };
};
if (v$951 == null) {v$951;
} else {var v$1627 = v$951;
switch (v$1627[0][0]) { case 0: {v$951;
 break; }default: {var v$1628 = v$1627[0][1];
var v$1629 = v$1628[0];
var v$1630 = v$1628[1];
if (v$1630 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1631 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1629);
var v$1632 = v$1631[1];
var v$1633 = v$1631[0];
if (v$1632) {(v$1627[0] = [0,v$1633],0);
v$951;
} else {(v$1627[0] = [1,[v$1633,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$951;
};
} else {v$951;
};
} };
};
if (v$951 == null) {return true;
} else {if (v$950 == null) {return false;
} else {var im1$939;
if (v$950 == null) {im1$939 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1298 = v$950;
switch (v$1298[0][0]) { case 0: {im1$939 = v$1298[0][1];
 break; }default: {im1$939 = v$1298[0][1][0];
} };
};
var im2$940;
if (v$951 == null) {im2$940 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1302 = v$951;
switch (v$1302[0][0]) { case 0: {im2$940 = v$1302[0][1];
 break; }default: {im2$940 = v$1302[0][1][0];
} };
};
return tools$0IntStringFinMap$1.enrich$414(function(v$1305){var v$1306 = v$1305[0];
var v$1307 = v$1306[1];
var v$1308 = v$1305[1];
var v$1309 = v$1308[1];
return f$922([v$1307,v$1309]);
},[im1$939,im2$940]);
};
};
};
compiler_objects$0Excon$1$2.layoutMap$952 = function(v$986,v$988,v$987,v$985){return function(pp_dom$961){return function(pp_range$964){return function(m$967){var t$1782;
var v$983 = [0,v$987];
var t$1789;
var t$1788 = basis$0List$1.map$697;
var t$1787 = function(v$1310){var v$1311 = v$1310[0];
var v$1312 = v$1310[1];
var t$1786;
var v$1313 = [0,v$986];
t$1786 = [[pp_dom$961(v$1311),[pp_range$964(v$1312),null]],v$1313,"",1,""];
return [0,t$1786];
};
var t$1785;
if (m$967 == null) {t$1785 = null;
} else {var t$1784 = tools$0IntStringFinMap$1.range$284;
var t$1783;
if (m$967 == null) {m$967;
} else {var v$1635 = m$967;
switch (v$1635[0][0]) { case 0: {m$967;
 break; }default: {var v$1636 = v$1635[0][1];
var v$1637 = v$1636[0];
var v$1638 = v$1636[1];
if (v$1638 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1639 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1637);
var v$1640 = v$1639[1];
var v$1641 = v$1639[0];
if (v$1640) {(v$1635[0] = [0,v$1641],0);
m$967;
} else {(v$1635[0] = [1,[v$1641,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$967;
};
} else {m$967;
};
} };
};
if (m$967 == null) {t$1783 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1316 = m$967;
switch (v$1316[0][0]) { case 0: {t$1783 = v$1316[0][1];
 break; }default: {t$1783 = v$1316[0][1][0];
} };
};
t$1785 = (t$1784(t$1783));
};
t$1789 = (t$1788(t$1787,t$1785));
t$1782 = [t$1789,v$983,v$988,1,v$985];
return [0,t$1782];
};
};
};
};
compiler_objects$0Excon$1$2.reportMap$989 = function(f$992,m$995){var t$1796 = tools$0Report$1.flatten$87;
var t$1795;
var t$1794 = basis$0List$1.map$697;
var t$1793 = f$992;
var t$1792;
if (m$995 == null) {t$1792 = null;
} else {var t$1791 = tools$0IntStringFinMap$1.range$284;
var t$1790;
if (m$995 == null) {m$995;
} else {var v$1643 = m$995;
switch (v$1643[0][0]) { case 0: {m$995;
 break; }default: {var v$1644 = v$1643[0][1];
var v$1645 = v$1644[0];
var v$1646 = v$1644[1];
if (v$1646 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1647 = compiler_objects$0Excon$1$2.ensure_consistent_imap$377(v$1645);
var v$1648 = v$1647[1];
var v$1649 = v$1647[0];
if (v$1648) {(v$1643[0] = [0,v$1649],0);
m$995;
} else {(v$1643[0] = [1,[v$1649,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$995;
};
} else {m$995;
};
} };
};
if (m$995 == null) {t$1790 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1320 = m$995;
switch (v$1320[0][0]) { case 0: {t$1790 = v$1320[0][1];
 break; }default: {t$1790 = v$1320[0][1][0];
} };
};
t$1792 = (t$1791(t$1790));
};
t$1795 = (t$1794(t$1793,t$1792));
return t$1796(t$1795);
};
compiler_objects$0Excon$1$2.pu_map0$996 = function(pu_d$999,pu_a$1002){var pu_m$1011 = pickle$0pickle$1.combHash$2090(function(m$1322){return tools$0IntStringFinMap$1.fold$62(function(v$1323){return SmlPrims.chk_ovf_i32(v$1323[1] + 1);
},0,m$1322);
},tools$0IntStringFinMap$1.pu$488(pickle$0pickle$1.pairGen$1053([pickle$0pickle$1.int$729,pickle$0pickle$1.string$909]),pickle$0pickle$1.pairGen$1053([pu_d$999,pu_a$1002])));
return pickle$0pickle$1.dataGen$1488(["QuasiMap.map0",function(v$1328){switch (v$1328[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$1329){return pickle$0pickle$1.con1$2014(function(v$1330){return [0,v$1330];
},function(v$1331){switch (v$1331[0]) { case 0: {return v$1331[1];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$1011);
},[function(v$1334){return pickle$0pickle$1.con1$2014(function(v$1335){return [1,[v$1335[1],-1]];
},function(v$1336){switch (v$1336[0]) { case 1: {var v$1337 = v$1336[1];
return [v$1337[1],v$1337[0]];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Flexible");
} };
},pickle$0pickle$1.pairGen0$983(special_objects$0Name$1.pu_matchcount$298,pu_m$1011));
},null]]]);
};
compiler_objects$0Excon$1$2.pu$1053 = function(pu_d$1056,pu_a$1059){return pickle$0pickle$1.convert$2342([function(v$1346){switch (v$1346[0]) { case 0: {var v$1347 = v$1346[1];
return v$1347;
 break; }default: {return null;
} };
},function(v$1348){if (v$1348 == null) {return [1];
} else {var v$1349 = v$1348;
var t$1799;
var t$1798 = tools$0IntStringFinMap$1.isEmpty$128(0);
var t$1797;
if (v$1348 == null) {t$1797 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1351 = v$1348;
switch (v$1351[0][0]) { case 0: {t$1797 = v$1351[0][1];
 break; }default: {t$1797 = v$1351[0][1][0];
} };
};
t$1799 = (t$1798(t$1797));
if (t$1799) {return tools$0Crash$1.impossible$59("QuasiMap2.pu.hmmm");
} else {return [0,v$1349];
};
};
}],pickle$0pickle$1.optionGen$2134(pickle$0pickle$1.ref0ShGen$1268(compiler_objects$0Excon$1$2.pu_map0$996(pu_d$1056,pu_a$1059))));
};
return 0;
})();
