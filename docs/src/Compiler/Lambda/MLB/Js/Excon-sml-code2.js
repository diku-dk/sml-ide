if ((typeof(compiler_objects$0Excon$1$2)) == "undefined") {compiler_objects$0Excon$1$2 = {};
};
(function(){compiler_objects$0Excon$1$2.die$320 = function(s$323){return tools$0Crash$1.impossible$59("QuasiMap2." + s$323);
};
compiler_objects$0Excon$1$2.key$324 = function(v$1694,v$1695){return v$1694[0][1];
};
compiler_objects$0Excon$1$2.rigid$328 = function(v$1696,v$1697){return v$1696[0][2];
};
compiler_objects$0Excon$1$2.empty$336 = function(v$1731){return null;
};
compiler_objects$0Excon$1$2.singleton$337 = function(v$348,v$349){var nd$342 = v$348[0];
var k$343 = nd$342[0][1];
return nd$342[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$343,[v$348,v$349])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$343,[v$348,v$349]),special_objects$0Name$1.current_matchcount$69(0)]]];
};
compiler_objects$0Excon$1$2.isEmpty$350 = function(v$353){return (v$353 == null)?true:false;
};
compiler_objects$0Excon$1$2.imap$358 = function(v$361){if (v$361 == null) {return [1];
} else {var v$370 = v$361;
switch (v$370[0][0]) { case 0: {var v$372 = v$370[0][1];
return [0,v$372];
 break; }default: {var v$373 = v$370[0][1];
var v$374 = v$373[0];
return [0,v$374];
} };
};
};
compiler_objects$0Excon$1$2.imap$$375 = function(v$378){if (v$378 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible");
} else {var v$388 = v$378;
switch (v$388[0][0]) { case 0: {return v$388[0][1];
 break; }default: {return v$388[0][1][0];
} };
};
};
compiler_objects$0Excon$1$2.ensure_consistent_imap$393 = function(imap$396){var v$416 = tools$0IntStringFinMap$1.Fold$78(function(v$424){var v$433 = v$424[0];
var v$434 = v$433[0];
var v$435 = v$433[1];
var v$436 = v$435[0];
var v$437 = v$424[1];
var v$438 = v$437[0];
var v$439 = v$437[1];
var t$1732;
if (v$438) {var v$1383 = v$436[0][0][1];
t$1732 = ((v$1383[0] == v$434[0])?(v$1383[1] == v$434[1]):false);
} else {t$1732 = false;
};
return [t$1732,v$439?v$436[0][0][2]:false];
},[true,true],imap$396);
var v$417 = v$416[0];
var v$418 = v$416[1];
return [v$417?imap$396:(tools$0IntStringFinMap$1.fold$62(function(v$409){var v$410 = v$409[0];
var v$411 = v$410[0];
var v$412 = v$410[1];
var v$413 = v$409[1];
return tools$0IntStringFinMap$1.add$237(v$411[0][0][1],[v$411,v$412],v$413);
},tools$0IntStringFinMap$1.empty$117(0),imap$396)),v$418];
};
compiler_objects$0Excon$1$2.ensure_consistent$440 = function(v$443){if (v$443 == null) {return v$443;
} else {var v$456 = v$443;
switch (v$456[0][0]) { case 0: {return v$443;
 break; }default: {var v$476 = v$456[0][1];
var v$477 = v$476[0];
var v$478 = v$476[1];
if (v$478 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$473 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$477);
var v$474 = v$473[1];
var v$475 = v$473[0];
if (v$474) {(v$456[0] = [0,v$475],0);
return v$443;
} else {(v$456[0] = [1,[v$475,special_objects$0Name$1.current_matchcount$69(0)]],0);
return v$443;
};
} else {return v$443;
};
} };
};
};
compiler_objects$0Excon$1$2.mk_flex$479 = function(imap$482){return [[1,[imap$482,special_objects$0Name$1.current_matchcount$69(0)]]];
};
compiler_objects$0Excon$1$2.mk_rigid$483 = function(imap$486){return [[0,imap$486]];
};
compiler_objects$0Excon$1$2.lookup$487 = function(m$490,d$493){var v$498;
if (m$490 == null) {m$490;
} else {var v$1462 = m$490;
switch (v$1462[0][0]) { case 0: {m$490;
 break; }default: {var v$1463 = v$1462[0][1];
var v$1464 = v$1463[0];
var v$1465 = v$1463[1];
if (v$1465 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1466 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1464);
var v$1467 = v$1466[1];
var v$1468 = v$1466[0];
if (v$1467) {(v$1462[0] = [0,v$1468],0);
m$490;
} else {(v$1462[0] = [1,[v$1468,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$490;
};
} else {m$490;
};
} };
};
if (m$490 == null) {v$498 = [1];
} else {var v$1159 = m$490;
switch (v$1159[0][0]) { case 0: {var v$1160 = v$1159[0][1];
v$498 = [0,v$1160];
 break; }default: {var v$1161 = v$1159[0][1];
var v$1162 = v$1161[0];
v$498 = [0,v$1162];
} };
};
switch (v$498[0]) { case 0: {var v$508 = v$498[1];
var v$504 = tools$0IntStringFinMap$1.lookup$129(v$508,d$493[0][0][1]);
switch (v$504[0]) { case 0: {var v$506 = v$504[1];
var v$507 = v$506[1];
return [0,v$507];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
compiler_objects$0Excon$1$2.add$509 = function(v$534,v$535,v$536){if (v$536 == null) {v$536;
} else {var v$1470 = v$536;
switch (v$1470[0][0]) { case 0: {v$536;
 break; }default: {var v$1471 = v$1470[0][1];
var v$1472 = v$1471[0];
var v$1473 = v$1471[1];
if (v$1473 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1474 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1472);
var v$1475 = v$1474[1];
var v$1476 = v$1474[0];
if (v$1475) {(v$1470[0] = [0,v$1476],0);
v$536;
} else {(v$1470[0] = [1,[v$1476,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$536;
};
} else {v$536;
};
} };
};
if (v$536 == null) {var nd$1167 = v$534[0];
var k$1168 = nd$1167[0][1];
return nd$1167[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$1168,[v$534,v$535])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$1168,[v$534,v$535]),special_objects$0Name$1.current_matchcount$69(0)]]];
} else {var v$523 = v$536;
switch (v$523[0][0]) { case 0: {var v$531 = v$523[0][1];
var nd$525 = v$534[0];
var i$526 = nd$525[0][1];
return nd$525[0][2]?[[0,tools$0IntStringFinMap$1.add$237(i$526,[v$534,v$535],v$531)]]:[[1,[tools$0IntStringFinMap$1.add$237(i$526,[v$534,v$535],v$531),special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {var v$532 = v$523[0][1];
var v$533 = v$532[0];
return [[1,[tools$0IntStringFinMap$1.add$237(v$534[0][0][1],[v$534,v$535],v$533),special_objects$0Name$1.current_matchcount$69(0)]]];
} };
};
};
compiler_objects$0Excon$1$2.plus$537 = function(v$571,v$572){if (v$571 == null) {v$571;
} else {var v$1478 = v$571;
switch (v$1478[0][0]) { case 0: {v$571;
 break; }default: {var v$1479 = v$1478[0][1];
var v$1480 = v$1479[0];
var v$1481 = v$1479[1];
if (v$1481 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1482 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1480);
var v$1483 = v$1482[1];
var v$1484 = v$1482[0];
if (v$1483) {(v$1478[0] = [0,v$1484],0);
v$571;
} else {(v$1478[0] = [1,[v$1484,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$571;
};
} else {v$571;
};
} };
};
if (v$572 == null) {v$572;
} else {var v$1486 = v$572;
switch (v$1486[0][0]) { case 0: {v$572;
 break; }default: {var v$1487 = v$1486[0][1];
var v$1488 = v$1487[0];
var v$1489 = v$1487[1];
if (v$1489 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1490 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1488);
var v$1491 = v$1490[1];
var v$1492 = v$1490[0];
if (v$1491) {(v$1486[0] = [0,v$1492],0);
v$572;
} else {(v$1486[0] = [1,[v$1492,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$572;
};
} else {v$572;
};
} };
};
if (v$571 == null) {return v$572;
} else {if (v$572 == null) {return v$571;
} else {var v$562 = v$571;
switch (v$562[0][0]) { case 0: {var v$564 = v$572;
switch (v$564[0][0]) { case 0: {var v$566 = v$562[0][1];
var v$567 = v$564[0][1];
return [[0,tools$0IntStringFinMap$1.plus$255(v$566,v$567)]];
 break; }default: {var t$1739;
var t$1738;
var t$1737;
var t$1736;
var t$1735 = tools$0IntStringFinMap$1.plus$255;
var t$1734;
if (v$571 == null) {t$1734 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1494 = v$571;
switch (v$1494[0][0]) { case 0: {t$1734 = v$1494[0][1];
 break; }default: {t$1734 = v$1494[0][1][0];
} };
};
var t$1733;
if (v$572 == null) {t$1733 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1495 = v$572;
switch (v$1495[0][0]) { case 0: {t$1733 = v$1495[0][1];
 break; }default: {t$1733 = v$1495[0][1][0];
} };
};
t$1736 = (t$1735(t$1734,t$1733));
t$1737 = [t$1736,special_objects$0Name$1.current_matchcount$69(0)];
t$1738 = [1,t$1737];
t$1739 = [t$1738];
return t$1739;
} };
 break; }default: {var t$1746;
var t$1745;
var t$1744;
var t$1743;
var t$1742 = tools$0IntStringFinMap$1.plus$255;
var t$1741;
if (v$571 == null) {t$1741 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1497 = v$571;
switch (v$1497[0][0]) { case 0: {t$1741 = v$1497[0][1];
 break; }default: {t$1741 = v$1497[0][1][0];
} };
};
var t$1740;
if (v$572 == null) {t$1740 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1498 = v$572;
switch (v$1498[0][0]) { case 0: {t$1740 = v$1498[0][1];
 break; }default: {t$1740 = v$1498[0][1][0];
} };
};
t$1743 = (t$1742(t$1741,t$1740));
t$1744 = [t$1743,special_objects$0Name$1.current_matchcount$69(0)];
t$1745 = [1,t$1744];
t$1746 = [t$1745];
return t$1746;
} };
};
};
};
compiler_objects$0Excon$1$2.remove$573 = function(v$614,v$615){if (v$615 == null) {v$615;
} else {var v$1500 = v$615;
switch (v$1500[0][0]) { case 0: {v$615;
 break; }default: {var v$1501 = v$1500[0][1];
var v$1502 = v$1501[0];
var v$1503 = v$1501[1];
if (v$1503 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1504 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1502);
var v$1505 = v$1504[1];
var v$1506 = v$1504[0];
if (v$1505) {(v$1500[0] = [0,v$1506],0);
v$615;
} else {(v$1500[0] = [1,[v$1506,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$615;
};
} else {v$615;
};
} };
};
if (v$615 == null) {return [1];
} else {var v$587 = v$615;
switch (v$587[0][0]) { case 0: {var v$600 = v$587[0][1];
var v$593 = tools$0IntStringFinMap$1.remove$262(v$614[0][0][1],v$600);
switch (v$593[0]) { case 0: {var v$599 = v$593[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$599))?[0,null]:[0,[[0,v$599]]];
 break; }default: {return [1];
} };
 break; }default: {var v$612 = v$587[0][1];
var v$613 = v$612[0];
var v$605 = tools$0IntStringFinMap$1.remove$262(v$614[0][0][1],v$613);
switch (v$605[0]) { case 0: {var v$611 = v$605[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$611))?[0,null]:[0,[[1,[v$611,special_objects$0Name$1.current_matchcount$69(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
compiler_objects$0Excon$1$2.dom$616 = function(v$619){if (v$619 == null) {return null;
} else {var t$1751 = basis$0List$1.map$697;
var t$1750 = function(v$627){return v$627[0];
};
var t$1749;
var t$1748 = tools$0IntStringFinMap$1.range$284;
var t$1747;
if (v$619 == null) {v$619;
} else {var v$1508 = v$619;
switch (v$1508[0][0]) { case 0: {v$619;
 break; }default: {var v$1509 = v$1508[0][1];
var v$1510 = v$1509[0];
var v$1511 = v$1509[1];
if (v$1511 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1512 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1510);
var v$1513 = v$1512[1];
var v$1514 = v$1512[0];
if (v$1513) {(v$1508[0] = [0,v$1514],0);
v$619;
} else {(v$1508[0] = [1,[v$1514,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$619;
};
} else {v$619;
};
} };
};
if (v$619 == null) {t$1747 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1191 = v$619;
switch (v$1191[0][0]) { case 0: {t$1747 = v$1191[0][1];
 break; }default: {t$1747 = v$1191[0][1][0];
} };
};
t$1749 = (t$1748(t$1747));
return t$1751(t$1750,t$1749);
};
};
compiler_objects$0Excon$1$2.range$629 = function(v$632){if (v$632 == null) {return null;
} else {var t$1756 = basis$0List$1.map$697;
var t$1755 = function(v$640){return v$640[1];
};
var t$1754;
var t$1753 = tools$0IntStringFinMap$1.range$284;
var t$1752;
if (v$632 == null) {v$632;
} else {var v$1516 = v$632;
switch (v$1516[0][0]) { case 0: {v$632;
 break; }default: {var v$1517 = v$1516[0][1];
var v$1518 = v$1517[0];
var v$1519 = v$1517[1];
if (v$1519 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1520 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1518);
var v$1521 = v$1520[1];
var v$1522 = v$1520[0];
if (v$1521) {(v$1516[0] = [0,v$1522],0);
v$632;
} else {(v$1516[0] = [1,[v$1522,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$632;
};
} else {v$632;
};
} };
};
if (v$632 == null) {t$1752 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1195 = v$632;
switch (v$1195[0][0]) { case 0: {t$1752 = v$1195[0][1];
 break; }default: {t$1752 = v$1195[0][1][0];
} };
};
t$1754 = (t$1753(t$1752));
return t$1756(t$1755,t$1754);
};
};
compiler_objects$0Excon$1$2.list$642 = function(v$645){if (v$645 == null) {return null;
} else {var t$1758 = tools$0IntStringFinMap$1.range$284;
var t$1757;
if (v$645 == null) {v$645;
} else {var v$1524 = v$645;
switch (v$1524[0][0]) { case 0: {v$645;
 break; }default: {var v$1525 = v$1524[0][1];
var v$1526 = v$1525[0];
var v$1527 = v$1525[1];
if (v$1527 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1528 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1526);
var v$1529 = v$1528[1];
var v$1530 = v$1528[0];
if (v$1529) {(v$1524[0] = [0,v$1530],0);
v$645;
} else {(v$1524[0] = [1,[v$1530,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$645;
};
} else {v$645;
};
} };
};
if (v$645 == null) {t$1757 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1199 = v$645;
switch (v$1199[0][0]) { case 0: {t$1757 = v$1199[0][1];
 break; }default: {t$1757 = v$1199[0][1][0];
} };
};
return t$1758(t$1757);
};
};
compiler_objects$0Excon$1$2.fromList$651 = function(v$654){if (v$654 == null) {return null;
} else {var v$667;
var b$1203 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1759 = {};
fix$1759.$foldl = function(v$1206,v$1207){lab$foldl: while (true) {if (v$1207 == null) {return v$1206;
} else {var v$1208 = v$1207;
var v$1209 = v$1208[0];
var v$1210 = v$1208[1];
var t$1760;
var v$1533 = v$1209[0];
var v$1534 = v$1209[1];
var v$1536 = v$1206[0];
var v$1537 = v$1206[1];
t$1760 = [tools$0IntStringFinMap$1.add$237(v$1533[0][0][1],[v$1533,v$1534],v$1536),v$1537?v$1533[0][0][2]:false];
var t$1761 = t$1760;
var t$1762 = v$1210;
var v$1206 = t$1761;
var v$1207 = t$1762;
continue lab$foldl;
};
};
};
var foldl$1205 = fix$1759.$foldl;
v$667 = (foldl$1205(b$1203,v$654));
var v$668 = v$667[0];
return v$667[1]?[[0,v$668]]:[[1,[v$668,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Excon$1$2.composemap$686 = function(f$689,m$692){var v$697;
if (m$692 == null) {v$697 = null;
} else {var t$1764 = tools$0IntStringFinMap$1.range$284;
var t$1763;
if (m$692 == null) {m$692;
} else {var v$1539 = m$692;
switch (v$1539[0][0]) { case 0: {m$692;
 break; }default: {var v$1540 = v$1539[0][1];
var v$1541 = v$1540[0];
var v$1542 = v$1540[1];
if (v$1542 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1543 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1541);
var v$1544 = v$1543[1];
var v$1545 = v$1543[0];
if (v$1544) {(v$1539[0] = [0,v$1545],0);
m$692;
} else {(v$1539[0] = [1,[v$1545,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$692;
};
} else {m$692;
};
} };
};
if (m$692 == null) {t$1763 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1217 = m$692;
switch (v$1217[0][0]) { case 0: {t$1763 = v$1217[0][1];
 break; }default: {t$1763 = v$1217[0][1][0];
} };
};
v$697 = (t$1764(t$1763));
};
if (v$697 == null) {return null;
} else {var v$705;
var b$1220 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1765 = {};
fix$1765.$foldl = function(v$1223,v$1224){lab$foldl: while (true) {if (v$1224 == null) {return v$1223;
} else {var v$1225 = v$1224;
var v$1226 = v$1225[0];
var v$1227 = v$1225[1];
var t$1766;
var v$1548 = v$1226[0];
var v$1549 = v$1226[1];
var v$1551 = v$1223[0];
var v$1552 = v$1223[1];
t$1766 = [tools$0IntStringFinMap$1.add$237(v$1548[0][0][1],[v$1548,f$689(v$1549)],v$1551),v$1552?v$1548[0][0][2]:false];
var t$1767 = t$1766;
var t$1768 = v$1227;
var v$1223 = t$1767;
var v$1224 = t$1768;
continue lab$foldl;
};
};
};
var foldl$1222 = fix$1765.$foldl;
v$705 = (foldl$1222(b$1220,v$697));
var v$706 = v$705[0];
return v$705[1]?[[0,v$706]]:[[1,[v$706,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Excon$1$2.ComposeMap$724 = function(f$727,m$730){var v$735;
if (m$730 == null) {v$735 = null;
} else {var t$1770 = tools$0IntStringFinMap$1.range$284;
var t$1769;
if (m$730 == null) {m$730;
} else {var v$1554 = m$730;
switch (v$1554[0][0]) { case 0: {m$730;
 break; }default: {var v$1555 = v$1554[0][1];
var v$1556 = v$1555[0];
var v$1557 = v$1555[1];
if (v$1557 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1558 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1556);
var v$1559 = v$1558[1];
var v$1560 = v$1558[0];
if (v$1559) {(v$1554[0] = [0,v$1560],0);
m$730;
} else {(v$1554[0] = [1,[v$1560,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$730;
};
} else {m$730;
};
} };
};
if (m$730 == null) {t$1769 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1234 = m$730;
switch (v$1234[0][0]) { case 0: {t$1769 = v$1234[0][1];
 break; }default: {t$1769 = v$1234[0][1][0];
} };
};
v$735 = (t$1770(t$1769));
};
if (v$735 == null) {return null;
} else {var v$743;
var b$1237 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1771 = {};
fix$1771.$foldl = function(v$1240,v$1241){lab$foldl: while (true) {if (v$1241 == null) {return v$1240;
} else {var v$1242 = v$1241;
var v$1243 = v$1242[0];
var v$1244 = v$1242[1];
var t$1772;
var v$1563 = v$1243[0];
var v$1564 = v$1243[1];
var v$1566 = v$1240[0];
var v$1567 = v$1240[1];
t$1772 = [tools$0IntStringFinMap$1.add$237(v$1563[0][0][1],[v$1563,f$727([v$1563,v$1564])],v$1566),v$1567?v$1563[0][0][2]:false];
var t$1773 = t$1772;
var t$1774 = v$1244;
var v$1240 = t$1773;
var v$1241 = t$1774;
continue lab$foldl;
};
};
};
var foldl$1239 = fix$1771.$foldl;
v$743 = (foldl$1239(b$1237,v$735));
var v$744 = v$743[0];
return v$743[1]?[[0,v$744]]:[[1,[v$744,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Excon$1$2.fold$762 = function(f$765,b$768,m$771){var c$1251;
if (m$771 == null) {c$1251 = null;
} else {var t$1779 = basis$0List$1.map$697;
var t$1778 = function(v$1259){return v$1259[1];
};
var t$1777;
var t$1776 = tools$0IntStringFinMap$1.range$284;
var t$1775;
if (m$771 == null) {m$771;
} else {var v$1569 = m$771;
switch (v$1569[0][0]) { case 0: {m$771;
 break; }default: {var v$1570 = v$1569[0][1];
var v$1571 = v$1570[0];
var v$1572 = v$1570[1];
if (v$1572 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1573 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1571);
var v$1574 = v$1573[1];
var v$1575 = v$1573[0];
if (v$1574) {(v$1569[0] = [0,v$1575],0);
m$771;
} else {(v$1569[0] = [1,[v$1575,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$771;
};
} else {m$771;
};
} };
};
if (m$771 == null) {t$1775 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1261 = m$771;
switch (v$1261[0][0]) { case 0: {t$1775 = v$1261[0][1];
 break; }default: {t$1775 = v$1261[0][1][0];
} };
};
t$1777 = (t$1776(t$1775));
c$1251 = (t$1779(t$1778,t$1777));
};
var fix$1780 = {};
fix$1780.$foldl = function(v$1253,v$1254){lab$foldl: while (true) {if (v$1254 == null) {return v$1253;
} else {var v$1255 = v$1254;
var v$1256 = v$1255[0];
var v$1257 = v$1255[1];
var t$1781 = f$765([v$1256,v$1253]);
var t$1782 = v$1257;
var v$1253 = t$1781;
var v$1254 = t$1782;
continue lab$foldl;
};
};
};
var foldl$1252 = fix$1780.$foldl;
return foldl$1252(b$768,c$1251);
};
compiler_objects$0Excon$1$2.Fold$772 = function(f$775,b$778,m$781){var c$1265;
if (m$781 == null) {c$1265 = null;
} else {var t$1784 = tools$0IntStringFinMap$1.range$284;
var t$1783;
if (m$781 == null) {m$781;
} else {var v$1577 = m$781;
switch (v$1577[0][0]) { case 0: {m$781;
 break; }default: {var v$1578 = v$1577[0][1];
var v$1579 = v$1578[0];
var v$1580 = v$1578[1];
if (v$1580 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1581 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1579);
var v$1582 = v$1581[1];
var v$1583 = v$1581[0];
if (v$1582) {(v$1577[0] = [0,v$1583],0);
m$781;
} else {(v$1577[0] = [1,[v$1583,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$781;
};
} else {m$781;
};
} };
};
if (m$781 == null) {t$1783 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1274 = m$781;
switch (v$1274[0][0]) { case 0: {t$1783 = v$1274[0][1];
 break; }default: {t$1783 = v$1274[0][1][0];
} };
};
c$1265 = (t$1784(t$1783));
};
var fix$1785 = {};
fix$1785.$foldl = function(v$1267,v$1268){lab$foldl: while (true) {if (v$1268 == null) {return v$1267;
} else {var v$1269 = v$1268;
var v$1270 = v$1269[0];
var v$1271 = v$1269[1];
var t$1786 = f$775([v$1270,v$1267]);
var t$1787 = v$1271;
var v$1267 = t$1786;
var v$1268 = t$1787;
continue lab$foldl;
};
};
};
var foldl$1266 = fix$1785.$foldl;
return foldl$1266(b$778,c$1265);
};
compiler_objects$0Excon$1$2.filter$782 = function(f$785,m$788){var l$789;
if (m$788 == null) {l$789 = null;
} else {var t$1789 = tools$0IntStringFinMap$1.range$284;
var t$1788;
if (m$788 == null) {m$788;
} else {var v$1585 = m$788;
switch (v$1585[0][0]) { case 0: {m$788;
 break; }default: {var v$1586 = v$1585[0][1];
var v$1587 = v$1586[0];
var v$1588 = v$1586[1];
if (v$1588 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1589 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1587);
var v$1590 = v$1589[1];
var v$1591 = v$1589[0];
if (v$1590) {(v$1585[0] = [0,v$1591],0);
m$788;
} else {(v$1585[0] = [1,[v$1591,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$788;
};
} else {m$788;
};
} };
};
if (m$788 == null) {t$1788 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1278 = m$788;
switch (v$1278[0][0]) { case 0: {t$1788 = v$1278[0][1];
 break; }default: {t$1788 = v$1278[0][1][0];
} };
};
l$789 = (t$1789(t$1788));
};
var l$$790 = basis$0List$1.filter$417(f$785,l$789);
return compiler_objects$0Excon$1$2.fromList$651(l$$790);
};
compiler_objects$0Excon$1$2.addList$791 = function(l$794,m1$797){var m2$798 = compiler_objects$0Excon$1$2.fromList$651(l$794);
return compiler_objects$0Excon$1$2.plus$537(m1$797,m2$798);
};
compiler_objects$0Excon$1$2.mergeMap$799 = function(f$802,m1$805,m2$808){if (m1$805 == null) {m1$805;
} else {var v$1593 = m1$805;
switch (v$1593[0][0]) { case 0: {m1$805;
 break; }default: {var v$1594 = v$1593[0][1];
var v$1595 = v$1594[0];
var v$1596 = v$1594[1];
if (v$1596 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1597 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1595);
var v$1598 = v$1597[1];
var v$1599 = v$1597[0];
if (v$1598) {(v$1593[0] = [0,v$1599],0);
m1$805;
} else {(v$1593[0] = [1,[v$1599,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$805;
};
} else {m1$805;
};
} };
};
if (m2$808 == null) {m2$808;
} else {var v$1601 = m2$808;
switch (v$1601[0][0]) { case 0: {m2$808;
 break; }default: {var v$1602 = v$1601[0][1];
var v$1603 = v$1602[0];
var v$1604 = v$1602[1];
if (v$1604 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1605 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1603);
var v$1606 = v$1605[1];
var v$1607 = v$1605[0];
if (v$1606) {(v$1601[0] = [0,v$1607],0);
m2$808;
} else {(v$1601[0] = [1,[v$1607,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$808;
};
} else {m2$808;
};
} };
};
var rhs3$837 = function(obj$854){var t$1798;
var t$1797;
var t$1796;
var t$1795;
var t$1794 = tools$0IntStringFinMap$1.mergeMap$374;
var t$1793 = function(v$1609){var v$1610 = v$1609[0];
var v$1611 = v$1610[0];
var v$1612 = v$1610[1];
var v$1613 = v$1609[1];
var v$1614 = v$1613[0];
var v$1615 = v$1613[1];
var t$1792;
var v$1616 = v$1611[0][0][1];
var v$1617 = v$1614[0][0][1];
t$1792 = ((v$1616[0] == v$1617[0])?(v$1616[1] == v$1617[1]):false);
if (t$1792) {return [v$1611,f$802([v$1612,v$1615])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
};
var t$1791;
if (m1$805 == null) {t$1791 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1290 = m1$805;
switch (v$1290[0][0]) { case 0: {t$1791 = v$1290[0][1];
 break; }default: {t$1791 = v$1290[0][1][0];
} };
};
var t$1790;
if (m2$808 == null) {t$1790 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1294 = m2$808;
switch (v$1294[0][0]) { case 0: {t$1790 = v$1294[0][1];
 break; }default: {t$1790 = v$1294[0][1][0];
} };
};
t$1795 = (t$1794(t$1793,t$1791,t$1790));
t$1796 = [t$1795,special_objects$0Name$1.current_matchcount$69(0)];
t$1797 = [1,t$1796];
t$1798 = [t$1797];
return t$1798;
};
if (m1$805 == null) {return m2$808;
} else {if (m2$808 == null) {return m1$805;
} else {var v$846 = m1$805;
switch (v$846[0][0]) { case 0: {var v$848 = m2$808;
switch (v$848[0][0]) { case 0: {var v$850 = v$846[0][1];
var v$851 = v$848[0][1];
return [[0,tools$0IntStringFinMap$1.mergeMap$374(function(v$1619){var v$1620 = v$1619[0];
var v$1621 = v$1620[0];
var v$1622 = v$1620[1];
var v$1623 = v$1619[1];
var v$1624 = v$1623[0];
var v$1625 = v$1623[1];
var t$1799;
var v$1626 = v$1621[0][0][1];
var v$1627 = v$1624[0][0][1];
t$1799 = ((v$1626[0] == v$1627[0])?(v$1626[1] == v$1627[1]):false);
if (t$1799) {return [v$1621,f$802([v$1622,v$1625])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
},v$850,v$851)]];
 break; }default: {return rhs3$837(0);
} };
 break; }default: {return rhs3$837(0);
} };
};
};
};
var fix$1800 = {};
fix$1800.$pp_lookup = function(v$858,v$861,v$864){lab$pp_lookup: while (true) {if (v$861 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$883 = v$861;
var v$884 = v$883[0];
var v$885 = v$883[1];
var t$1801;
var v$1439 = v$884[0][0][1];
t$1801 = ((v$864[0] == v$1439[0])?(v$864[1] == v$1439[1]):false);
if (t$1801) {return v$858(v$884);
} else {var t$1802 = v$858;
var t$1803 = v$885;
var t$1804 = v$864;
var v$858 = t$1802;
var v$861 = t$1803;
var v$864 = t$1804;
continue lab$pp_lookup;
};
};
};
};
compiler_objects$0Excon$1$2.pp_lookup$855 = fix$1800.$pp_lookup;
compiler_objects$0Excon$1$2.en$Restrict$887 = new String("Restrict");
compiler_objects$0Excon$1$2.restrict$888 = function(v$1698,v$1699,v$901){if (v$901 == null) {return null;
} else {if (v$1699 == null) {v$1699;
} else {var v$1631 = v$1699;
switch (v$1631[0][0]) { case 0: {v$1699;
 break; }default: {var v$1632 = v$1631[0][1];
var v$1633 = v$1632[0];
var v$1634 = v$1632[1];
if (v$1634 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1635 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1633);
var v$1636 = v$1635[1];
var v$1637 = v$1635[0];
if (v$1636) {(v$1631[0] = [0,v$1637],0);
v$1699;
} else {(v$1631[0] = [1,[v$1637,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1699;
};
} else {v$1699;
};
} };
};
if (v$1699 == null) {throw [compiler_objects$0Excon$1$2.en$Restrict$887,"[empty map]"];
} else {var im$909;
if (v$1699 == null) {im$909 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1306 = v$1699;
switch (v$1306[0][0]) { case 0: {im$909 = v$1306[0][1];
 break; }default: {im$909 = v$1306[0][1][0];
} };
};
var ns$910 = basis$0List$1.map$697(function(d$1309){return d$1309[0][0][1];
},v$901);
var im$$912;
try {var t$1811 = tools$0IntStringFinMap$1.restrict$391;
var t$1810;
var fix$1806 = {};
fix$1806.$pp_lookup = function(v$1713,v$1714){lab$pp_lookup: while (true) {if (v$1713 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$1715 = v$1713;
var v$1716 = v$1715[0];
var v$1717 = v$1715[1];
var t$1807;
var v$1718 = v$1716[0][0][1];
t$1807 = ((v$1714[0] == v$1718[0])?(v$1714[1] == v$1718[1]):false);
if (t$1807) {return v$1698(v$1716);
} else {var t$1808 = v$1717;
var t$1809 = v$1714;
var v$1713 = t$1808;
var v$1714 = t$1809;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$1712 = fix$1806.$pp_lookup;
t$1810 = (function(v$1719){return pp_lookup$1712(v$901,v$1719);
});
im$$912 = (t$1811(t$1810,im$909,ns$910));
} catch(v$1805) {im$$912 = ((function(v$916){var t$1812 = v$916;
if (t$1812[0] == tools$0IntStringFinMap$1.en$Restrict$390) {var s$913 = v$916[1];
throw [compiler_objects$0Excon$1$2.en$Restrict$887,s$913];
} else {throw v$916;
};
})(v$1805));
};
return (tools$0IntStringFinMap$1.fold$62(function(v$921){var v$926 = v$921[0];
var v$927 = v$926[0];
return v$921[1]?v$927[0][0][2]:false;
},true,im$$912))?[[0,im$$912]]:[[1,[im$$912,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
};
compiler_objects$0Excon$1$2.enrich$935 = function(f$938,v$942){var v$966 = v$942[0];
var v$967 = v$942[1];
if (v$966 == null) {v$966;
} else {var v$1639 = v$966;
switch (v$1639[0][0]) { case 0: {v$966;
 break; }default: {var v$1640 = v$1639[0][1];
var v$1641 = v$1640[0];
var v$1642 = v$1640[1];
if (v$1642 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1643 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1641);
var v$1644 = v$1643[1];
var v$1645 = v$1643[0];
if (v$1644) {(v$1639[0] = [0,v$1645],0);
v$966;
} else {(v$1639[0] = [1,[v$1645,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$966;
};
} else {v$966;
};
} };
};
if (v$967 == null) {v$967;
} else {var v$1647 = v$967;
switch (v$1647[0][0]) { case 0: {v$967;
 break; }default: {var v$1648 = v$1647[0][1];
var v$1649 = v$1648[0];
var v$1650 = v$1648[1];
if (v$1650 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1651 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1649);
var v$1652 = v$1651[1];
var v$1653 = v$1651[0];
if (v$1652) {(v$1647[0] = [0,v$1653],0);
v$967;
} else {(v$1647[0] = [1,[v$1653,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$967;
};
} else {v$967;
};
} };
};
if (v$967 == null) {return true;
} else {if (v$966 == null) {return false;
} else {var im1$955;
if (v$966 == null) {im1$955 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1314 = v$966;
switch (v$1314[0][0]) { case 0: {im1$955 = v$1314[0][1];
 break; }default: {im1$955 = v$1314[0][1][0];
} };
};
var im2$956;
if (v$967 == null) {im2$956 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1318 = v$967;
switch (v$1318[0][0]) { case 0: {im2$956 = v$1318[0][1];
 break; }default: {im2$956 = v$1318[0][1][0];
} };
};
return tools$0IntStringFinMap$1.enrich$414(function(v$1321){var v$1322 = v$1321[0];
var v$1323 = v$1322[1];
var v$1324 = v$1321[1];
var v$1325 = v$1324[1];
return f$938([v$1323,v$1325]);
},[im1$955,im2$956]);
};
};
};
compiler_objects$0Excon$1$2.layoutMap$968 = function(v$1002,v$1004,v$1003,v$1001){return function(pp_dom$977){return function(pp_range$980){return function(m$983){var t$1813;
var v$999 = [0,v$1003];
var t$1820;
var t$1819 = basis$0List$1.map$697;
var t$1818 = function(v$1326){var v$1327 = v$1326[0];
var v$1328 = v$1326[1];
var t$1817;
var v$1329 = [0,v$1002];
t$1817 = [[pp_dom$977(v$1327),[pp_range$980(v$1328),null]],v$1329,"",1,""];
return [0,t$1817];
};
var t$1816;
if (m$983 == null) {t$1816 = null;
} else {var t$1815 = tools$0IntStringFinMap$1.range$284;
var t$1814;
if (m$983 == null) {m$983;
} else {var v$1655 = m$983;
switch (v$1655[0][0]) { case 0: {m$983;
 break; }default: {var v$1656 = v$1655[0][1];
var v$1657 = v$1656[0];
var v$1658 = v$1656[1];
if (v$1658 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1659 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1657);
var v$1660 = v$1659[1];
var v$1661 = v$1659[0];
if (v$1660) {(v$1655[0] = [0,v$1661],0);
m$983;
} else {(v$1655[0] = [1,[v$1661,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$983;
};
} else {m$983;
};
} };
};
if (m$983 == null) {t$1814 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1332 = m$983;
switch (v$1332[0][0]) { case 0: {t$1814 = v$1332[0][1];
 break; }default: {t$1814 = v$1332[0][1][0];
} };
};
t$1816 = (t$1815(t$1814));
};
t$1820 = (t$1819(t$1818,t$1816));
t$1813 = [t$1820,v$999,v$1004,1,v$1001];
return [0,t$1813];
};
};
};
};
compiler_objects$0Excon$1$2.reportMap$1005 = function(f$1008,m$1011){var t$1827 = tools$0Report$1.flatten$87;
var t$1826;
var t$1825 = basis$0List$1.map$697;
var t$1824 = f$1008;
var t$1823;
if (m$1011 == null) {t$1823 = null;
} else {var t$1822 = tools$0IntStringFinMap$1.range$284;
var t$1821;
if (m$1011 == null) {m$1011;
} else {var v$1663 = m$1011;
switch (v$1663[0][0]) { case 0: {m$1011;
 break; }default: {var v$1664 = v$1663[0][1];
var v$1665 = v$1664[0];
var v$1666 = v$1664[1];
if (v$1666 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1667 = compiler_objects$0Excon$1$2.ensure_consistent_imap$393(v$1665);
var v$1668 = v$1667[1];
var v$1669 = v$1667[0];
if (v$1668) {(v$1663[0] = [0,v$1669],0);
m$1011;
} else {(v$1663[0] = [1,[v$1669,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1011;
};
} else {m$1011;
};
} };
};
if (m$1011 == null) {t$1821 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1336 = m$1011;
switch (v$1336[0][0]) { case 0: {t$1821 = v$1336[0][1];
 break; }default: {t$1821 = v$1336[0][1][0];
} };
};
t$1823 = (t$1822(t$1821));
};
t$1826 = (t$1825(t$1824,t$1823));
return t$1827(t$1826);
};
compiler_objects$0Excon$1$2.pu_map0$1012 = function(pu_d$1015,pu_a$1018){var pu_m$1027 = pickle$0pickle$1.combHash$2090(function(m$1338){return tools$0IntStringFinMap$1.fold$62(function(v$1339){return SmlPrims.chk_ovf_i32(v$1339[1] + 1);
},0,m$1338);
},tools$0IntStringFinMap$1.pu$488(pickle$0pickle$1.shareGen$878(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.int$729,pickle$0pickle$1.string$909)),pickle$0pickle$1.shareGen$878(pickle$0pickle$1.pairGen0$983(pu_d$1015,pu_a$1018))));
return pickle$0pickle$1.dataGen$1488(["QuasiMap.map0",function(v$1346){switch (v$1346[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$1347){return pickle$0pickle$1.con1$2014(function(v$1348){return [0,v$1348];
},function(v$1349){switch (v$1349[0]) { case 0: {return v$1349[1];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$1027);
},[function(v$1352){return pickle$0pickle$1.con1$2014(function(v$1353){return [1,[v$1353[1],-1]];
},function(v$1354){switch (v$1354[0]) { case 1: {var v$1355 = v$1354[1];
return [v$1355[1],v$1355[0]];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Flexible");
} };
},pickle$0pickle$1.pairGen0$983(special_objects$0Name$1.pu_matchcount$298,pu_m$1027));
},null]]]);
};
compiler_objects$0Excon$1$2.pu$1069 = function(pu_d$1072,pu_a$1075){var b$1365 = pickle$0pickle$1.optionGen$2134(pickle$0pickle$1.ref0ShGen$1268(compiler_objects$0Excon$1$2.pu_map0$1012(pu_d$1072,pu_a$1075)));
return pickle$0pickle$1.shareGen$878((pickle$0pickle$1.convert0$2299(function(v$1726){switch (v$1726[0]) { case 0: {var v$1727 = v$1726[1];
return v$1727;
 break; }default: {return null;
} };
},function(v$1728){if (v$1728 == null) {return [1];
} else {var v$1729 = v$1728;
var t$1830;
var t$1829 = tools$0IntStringFinMap$1.isEmpty$128(0);
var t$1828;
if (v$1728 == null) {t$1828 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1730 = v$1728;
switch (v$1730[0][0]) { case 0: {t$1828 = v$1730[0][1];
 break; }default: {t$1828 = v$1730[0][1][0];
} };
};
t$1830 = (t$1829(t$1828));
if (t$1830) {return tools$0Crash$1.impossible$59("QuasiMap2.pu.hmmm");
} else {return [0,v$1729];
};
};
}))(b$1365));
};
return 0;
})();
