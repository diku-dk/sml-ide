if ((typeof(compiler_objects$0Con$1$2)) == "undefined") {compiler_objects$0Con$1$2 = {};
};
(function(){compiler_objects$0Con$1$2.die$348 = function(s$351){return tools$0Crash$1.impossible$59("QuasiMap2." + s$351);
};
compiler_objects$0Con$1$2.key$352 = function(v$1722,v$1723){return v$1722[0][1];
};
compiler_objects$0Con$1$2.rigid$356 = function(v$1724,v$1725){return v$1724[0][2];
};
compiler_objects$0Con$1$2.empty$364 = function(v$1759){return null;
};
compiler_objects$0Con$1$2.singleton$365 = function(v$376,v$377){var nd$370 = v$376[0];
var k$371 = nd$370[0][1];
return nd$370[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$371,[v$376,v$377])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$371,[v$376,v$377]),special_objects$0Name$1.current_matchcount$69(0)]]];
};
compiler_objects$0Con$1$2.isEmpty$378 = function(v$381){return (v$381 == null)?true:false;
};
compiler_objects$0Con$1$2.imap$386 = function(v$389){if (v$389 == null) {return [1];
} else {var v$398 = v$389;
switch (v$398[0][0]) { case 0: {var v$400 = v$398[0][1];
return [0,v$400];
 break; }default: {var v$401 = v$398[0][1];
var v$402 = v$401[0];
return [0,v$402];
} };
};
};
compiler_objects$0Con$1$2.imap$$403 = function(v$406){if (v$406 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible");
} else {var v$416 = v$406;
switch (v$416[0][0]) { case 0: {return v$416[0][1];
 break; }default: {return v$416[0][1][0];
} };
};
};
compiler_objects$0Con$1$2.ensure_consistent_imap$421 = function(imap$424){var v$444 = tools$0IntStringFinMap$1.Fold$78(function(v$452){var v$461 = v$452[0];
var v$462 = v$461[0];
var v$463 = v$461[1];
var v$464 = v$463[0];
var v$465 = v$452[1];
var v$466 = v$465[0];
var v$467 = v$465[1];
var t$1760;
if (v$466) {var v$1411 = v$464[0][0][1];
t$1760 = ((v$1411[0] == v$462[0])?(v$1411[1] == v$462[1]):false);
} else {t$1760 = false;
};
return [t$1760,v$467?v$464[0][0][2]:false];
},[true,true],imap$424);
var v$445 = v$444[0];
var v$446 = v$444[1];
return [v$445?imap$424:(tools$0IntStringFinMap$1.fold$62(function(v$437){var v$438 = v$437[0];
var v$439 = v$438[0];
var v$440 = v$438[1];
var v$441 = v$437[1];
return tools$0IntStringFinMap$1.add$237(v$439[0][0][1],[v$439,v$440],v$441);
},tools$0IntStringFinMap$1.empty$117(0),imap$424)),v$446];
};
compiler_objects$0Con$1$2.ensure_consistent$468 = function(v$471){if (v$471 == null) {return v$471;
} else {var v$484 = v$471;
switch (v$484[0][0]) { case 0: {return v$471;
 break; }default: {var v$504 = v$484[0][1];
var v$505 = v$504[0];
var v$506 = v$504[1];
if (v$506 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$501 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$505);
var v$502 = v$501[1];
var v$503 = v$501[0];
if (v$502) {(v$484[0] = [0,v$503],0);
return v$471;
} else {(v$484[0] = [1,[v$503,special_objects$0Name$1.current_matchcount$69(0)]],0);
return v$471;
};
} else {return v$471;
};
} };
};
};
compiler_objects$0Con$1$2.mk_flex$507 = function(imap$510){return [[1,[imap$510,special_objects$0Name$1.current_matchcount$69(0)]]];
};
compiler_objects$0Con$1$2.mk_rigid$511 = function(imap$514){return [[0,imap$514]];
};
compiler_objects$0Con$1$2.lookup$515 = function(m$518,d$521){var v$526;
if (m$518 == null) {m$518;
} else {var v$1490 = m$518;
switch (v$1490[0][0]) { case 0: {m$518;
 break; }default: {var v$1491 = v$1490[0][1];
var v$1492 = v$1491[0];
var v$1493 = v$1491[1];
if (v$1493 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1494 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1492);
var v$1495 = v$1494[1];
var v$1496 = v$1494[0];
if (v$1495) {(v$1490[0] = [0,v$1496],0);
m$518;
} else {(v$1490[0] = [1,[v$1496,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$518;
};
} else {m$518;
};
} };
};
if (m$518 == null) {v$526 = [1];
} else {var v$1187 = m$518;
switch (v$1187[0][0]) { case 0: {var v$1188 = v$1187[0][1];
v$526 = [0,v$1188];
 break; }default: {var v$1189 = v$1187[0][1];
var v$1190 = v$1189[0];
v$526 = [0,v$1190];
} };
};
switch (v$526[0]) { case 0: {var v$536 = v$526[1];
var v$532 = tools$0IntStringFinMap$1.lookup$129(v$536,d$521[0][0][1]);
switch (v$532[0]) { case 0: {var v$534 = v$532[1];
var v$535 = v$534[1];
return [0,v$535];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
compiler_objects$0Con$1$2.add$537 = function(v$562,v$563,v$564){if (v$564 == null) {v$564;
} else {var v$1498 = v$564;
switch (v$1498[0][0]) { case 0: {v$564;
 break; }default: {var v$1499 = v$1498[0][1];
var v$1500 = v$1499[0];
var v$1501 = v$1499[1];
if (v$1501 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1502 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1500);
var v$1503 = v$1502[1];
var v$1504 = v$1502[0];
if (v$1503) {(v$1498[0] = [0,v$1504],0);
v$564;
} else {(v$1498[0] = [1,[v$1504,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$564;
};
} else {v$564;
};
} };
};
if (v$564 == null) {var nd$1195 = v$562[0];
var k$1196 = nd$1195[0][1];
return nd$1195[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$1196,[v$562,v$563])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$1196,[v$562,v$563]),special_objects$0Name$1.current_matchcount$69(0)]]];
} else {var v$551 = v$564;
switch (v$551[0][0]) { case 0: {var v$559 = v$551[0][1];
var nd$553 = v$562[0];
var i$554 = nd$553[0][1];
return nd$553[0][2]?[[0,tools$0IntStringFinMap$1.add$237(i$554,[v$562,v$563],v$559)]]:[[1,[tools$0IntStringFinMap$1.add$237(i$554,[v$562,v$563],v$559),special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {var v$560 = v$551[0][1];
var v$561 = v$560[0];
return [[1,[tools$0IntStringFinMap$1.add$237(v$562[0][0][1],[v$562,v$563],v$561),special_objects$0Name$1.current_matchcount$69(0)]]];
} };
};
};
compiler_objects$0Con$1$2.plus$565 = function(v$599,v$600){if (v$599 == null) {v$599;
} else {var v$1506 = v$599;
switch (v$1506[0][0]) { case 0: {v$599;
 break; }default: {var v$1507 = v$1506[0][1];
var v$1508 = v$1507[0];
var v$1509 = v$1507[1];
if (v$1509 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1510 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1508);
var v$1511 = v$1510[1];
var v$1512 = v$1510[0];
if (v$1511) {(v$1506[0] = [0,v$1512],0);
v$599;
} else {(v$1506[0] = [1,[v$1512,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$599;
};
} else {v$599;
};
} };
};
if (v$600 == null) {v$600;
} else {var v$1514 = v$600;
switch (v$1514[0][0]) { case 0: {v$600;
 break; }default: {var v$1515 = v$1514[0][1];
var v$1516 = v$1515[0];
var v$1517 = v$1515[1];
if (v$1517 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1518 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1516);
var v$1519 = v$1518[1];
var v$1520 = v$1518[0];
if (v$1519) {(v$1514[0] = [0,v$1520],0);
v$600;
} else {(v$1514[0] = [1,[v$1520,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$600;
};
} else {v$600;
};
} };
};
if (v$599 == null) {return v$600;
} else {if (v$600 == null) {return v$599;
} else {var v$590 = v$599;
switch (v$590[0][0]) { case 0: {var v$592 = v$600;
switch (v$592[0][0]) { case 0: {var v$594 = v$590[0][1];
var v$595 = v$592[0][1];
return [[0,tools$0IntStringFinMap$1.plus$255(v$594,v$595)]];
 break; }default: {var t$1767;
var t$1766;
var t$1765;
var t$1764;
var t$1763 = tools$0IntStringFinMap$1.plus$255;
var t$1762;
if (v$599 == null) {t$1762 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1522 = v$599;
switch (v$1522[0][0]) { case 0: {t$1762 = v$1522[0][1];
 break; }default: {t$1762 = v$1522[0][1][0];
} };
};
var t$1761;
if (v$600 == null) {t$1761 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1523 = v$600;
switch (v$1523[0][0]) { case 0: {t$1761 = v$1523[0][1];
 break; }default: {t$1761 = v$1523[0][1][0];
} };
};
t$1764 = (t$1763(t$1762,t$1761));
t$1765 = [t$1764,special_objects$0Name$1.current_matchcount$69(0)];
t$1766 = [1,t$1765];
t$1767 = [t$1766];
return t$1767;
} };
 break; }default: {var t$1774;
var t$1773;
var t$1772;
var t$1771;
var t$1770 = tools$0IntStringFinMap$1.plus$255;
var t$1769;
if (v$599 == null) {t$1769 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1525 = v$599;
switch (v$1525[0][0]) { case 0: {t$1769 = v$1525[0][1];
 break; }default: {t$1769 = v$1525[0][1][0];
} };
};
var t$1768;
if (v$600 == null) {t$1768 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1526 = v$600;
switch (v$1526[0][0]) { case 0: {t$1768 = v$1526[0][1];
 break; }default: {t$1768 = v$1526[0][1][0];
} };
};
t$1771 = (t$1770(t$1769,t$1768));
t$1772 = [t$1771,special_objects$0Name$1.current_matchcount$69(0)];
t$1773 = [1,t$1772];
t$1774 = [t$1773];
return t$1774;
} };
};
};
};
compiler_objects$0Con$1$2.remove$601 = function(v$642,v$643){if (v$643 == null) {v$643;
} else {var v$1528 = v$643;
switch (v$1528[0][0]) { case 0: {v$643;
 break; }default: {var v$1529 = v$1528[0][1];
var v$1530 = v$1529[0];
var v$1531 = v$1529[1];
if (v$1531 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1532 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1530);
var v$1533 = v$1532[1];
var v$1534 = v$1532[0];
if (v$1533) {(v$1528[0] = [0,v$1534],0);
v$643;
} else {(v$1528[0] = [1,[v$1534,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$643;
};
} else {v$643;
};
} };
};
if (v$643 == null) {return [1];
} else {var v$615 = v$643;
switch (v$615[0][0]) { case 0: {var v$628 = v$615[0][1];
var v$621 = tools$0IntStringFinMap$1.remove$262(v$642[0][0][1],v$628);
switch (v$621[0]) { case 0: {var v$627 = v$621[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$627))?[0,null]:[0,[[0,v$627]]];
 break; }default: {return [1];
} };
 break; }default: {var v$640 = v$615[0][1];
var v$641 = v$640[0];
var v$633 = tools$0IntStringFinMap$1.remove$262(v$642[0][0][1],v$641);
switch (v$633[0]) { case 0: {var v$639 = v$633[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$639))?[0,null]:[0,[[1,[v$639,special_objects$0Name$1.current_matchcount$69(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
compiler_objects$0Con$1$2.dom$644 = function(v$647){if (v$647 == null) {return null;
} else {var t$1779 = basis$0List$1.map$697;
var t$1778 = function(v$655){return v$655[0];
};
var t$1777;
var t$1776 = tools$0IntStringFinMap$1.range$284;
var t$1775;
if (v$647 == null) {v$647;
} else {var v$1536 = v$647;
switch (v$1536[0][0]) { case 0: {v$647;
 break; }default: {var v$1537 = v$1536[0][1];
var v$1538 = v$1537[0];
var v$1539 = v$1537[1];
if (v$1539 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1540 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1538);
var v$1541 = v$1540[1];
var v$1542 = v$1540[0];
if (v$1541) {(v$1536[0] = [0,v$1542],0);
v$647;
} else {(v$1536[0] = [1,[v$1542,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$647;
};
} else {v$647;
};
} };
};
if (v$647 == null) {t$1775 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1219 = v$647;
switch (v$1219[0][0]) { case 0: {t$1775 = v$1219[0][1];
 break; }default: {t$1775 = v$1219[0][1][0];
} };
};
t$1777 = (t$1776(t$1775));
return t$1779(t$1778,t$1777);
};
};
compiler_objects$0Con$1$2.range$657 = function(v$660){if (v$660 == null) {return null;
} else {var t$1784 = basis$0List$1.map$697;
var t$1783 = function(v$668){return v$668[1];
};
var t$1782;
var t$1781 = tools$0IntStringFinMap$1.range$284;
var t$1780;
if (v$660 == null) {v$660;
} else {var v$1544 = v$660;
switch (v$1544[0][0]) { case 0: {v$660;
 break; }default: {var v$1545 = v$1544[0][1];
var v$1546 = v$1545[0];
var v$1547 = v$1545[1];
if (v$1547 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1548 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1546);
var v$1549 = v$1548[1];
var v$1550 = v$1548[0];
if (v$1549) {(v$1544[0] = [0,v$1550],0);
v$660;
} else {(v$1544[0] = [1,[v$1550,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$660;
};
} else {v$660;
};
} };
};
if (v$660 == null) {t$1780 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1223 = v$660;
switch (v$1223[0][0]) { case 0: {t$1780 = v$1223[0][1];
 break; }default: {t$1780 = v$1223[0][1][0];
} };
};
t$1782 = (t$1781(t$1780));
return t$1784(t$1783,t$1782);
};
};
compiler_objects$0Con$1$2.list$670 = function(v$673){if (v$673 == null) {return null;
} else {var t$1786 = tools$0IntStringFinMap$1.range$284;
var t$1785;
if (v$673 == null) {v$673;
} else {var v$1552 = v$673;
switch (v$1552[0][0]) { case 0: {v$673;
 break; }default: {var v$1553 = v$1552[0][1];
var v$1554 = v$1553[0];
var v$1555 = v$1553[1];
if (v$1555 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1556 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1554);
var v$1557 = v$1556[1];
var v$1558 = v$1556[0];
if (v$1557) {(v$1552[0] = [0,v$1558],0);
v$673;
} else {(v$1552[0] = [1,[v$1558,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$673;
};
} else {v$673;
};
} };
};
if (v$673 == null) {t$1785 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1227 = v$673;
switch (v$1227[0][0]) { case 0: {t$1785 = v$1227[0][1];
 break; }default: {t$1785 = v$1227[0][1][0];
} };
};
return t$1786(t$1785);
};
};
compiler_objects$0Con$1$2.fromList$679 = function(v$682){if (v$682 == null) {return null;
} else {var v$695;
var b$1231 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1787 = {};
fix$1787.$foldl = function(v$1234,v$1235){lab$foldl: while (true) {if (v$1235 == null) {return v$1234;
} else {var v$1236 = v$1235;
var v$1237 = v$1236[0];
var v$1238 = v$1236[1];
var t$1788;
var v$1561 = v$1237[0];
var v$1562 = v$1237[1];
var v$1564 = v$1234[0];
var v$1565 = v$1234[1];
t$1788 = [tools$0IntStringFinMap$1.add$237(v$1561[0][0][1],[v$1561,v$1562],v$1564),v$1565?v$1561[0][0][2]:false];
var t$1789 = t$1788;
var t$1790 = v$1238;
var v$1234 = t$1789;
var v$1235 = t$1790;
continue lab$foldl;
};
};
};
var foldl$1233 = fix$1787.$foldl;
v$695 = (foldl$1233(b$1231,v$682));
var v$696 = v$695[0];
return v$695[1]?[[0,v$696]]:[[1,[v$696,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Con$1$2.composemap$714 = function(f$717,m$720){var v$725;
if (m$720 == null) {v$725 = null;
} else {var t$1792 = tools$0IntStringFinMap$1.range$284;
var t$1791;
if (m$720 == null) {m$720;
} else {var v$1567 = m$720;
switch (v$1567[0][0]) { case 0: {m$720;
 break; }default: {var v$1568 = v$1567[0][1];
var v$1569 = v$1568[0];
var v$1570 = v$1568[1];
if (v$1570 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1571 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1569);
var v$1572 = v$1571[1];
var v$1573 = v$1571[0];
if (v$1572) {(v$1567[0] = [0,v$1573],0);
m$720;
} else {(v$1567[0] = [1,[v$1573,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$720;
};
} else {m$720;
};
} };
};
if (m$720 == null) {t$1791 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1245 = m$720;
switch (v$1245[0][0]) { case 0: {t$1791 = v$1245[0][1];
 break; }default: {t$1791 = v$1245[0][1][0];
} };
};
v$725 = (t$1792(t$1791));
};
if (v$725 == null) {return null;
} else {var v$733;
var b$1248 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1793 = {};
fix$1793.$foldl = function(v$1251,v$1252){lab$foldl: while (true) {if (v$1252 == null) {return v$1251;
} else {var v$1253 = v$1252;
var v$1254 = v$1253[0];
var v$1255 = v$1253[1];
var t$1794;
var v$1576 = v$1254[0];
var v$1577 = v$1254[1];
var v$1579 = v$1251[0];
var v$1580 = v$1251[1];
t$1794 = [tools$0IntStringFinMap$1.add$237(v$1576[0][0][1],[v$1576,f$717(v$1577)],v$1579),v$1580?v$1576[0][0][2]:false];
var t$1795 = t$1794;
var t$1796 = v$1255;
var v$1251 = t$1795;
var v$1252 = t$1796;
continue lab$foldl;
};
};
};
var foldl$1250 = fix$1793.$foldl;
v$733 = (foldl$1250(b$1248,v$725));
var v$734 = v$733[0];
return v$733[1]?[[0,v$734]]:[[1,[v$734,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Con$1$2.ComposeMap$752 = function(f$755,m$758){var v$763;
if (m$758 == null) {v$763 = null;
} else {var t$1798 = tools$0IntStringFinMap$1.range$284;
var t$1797;
if (m$758 == null) {m$758;
} else {var v$1582 = m$758;
switch (v$1582[0][0]) { case 0: {m$758;
 break; }default: {var v$1583 = v$1582[0][1];
var v$1584 = v$1583[0];
var v$1585 = v$1583[1];
if (v$1585 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1586 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1584);
var v$1587 = v$1586[1];
var v$1588 = v$1586[0];
if (v$1587) {(v$1582[0] = [0,v$1588],0);
m$758;
} else {(v$1582[0] = [1,[v$1588,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$758;
};
} else {m$758;
};
} };
};
if (m$758 == null) {t$1797 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1262 = m$758;
switch (v$1262[0][0]) { case 0: {t$1797 = v$1262[0][1];
 break; }default: {t$1797 = v$1262[0][1][0];
} };
};
v$763 = (t$1798(t$1797));
};
if (v$763 == null) {return null;
} else {var v$771;
var b$1265 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1799 = {};
fix$1799.$foldl = function(v$1268,v$1269){lab$foldl: while (true) {if (v$1269 == null) {return v$1268;
} else {var v$1270 = v$1269;
var v$1271 = v$1270[0];
var v$1272 = v$1270[1];
var t$1800;
var v$1591 = v$1271[0];
var v$1592 = v$1271[1];
var v$1594 = v$1268[0];
var v$1595 = v$1268[1];
t$1800 = [tools$0IntStringFinMap$1.add$237(v$1591[0][0][1],[v$1591,f$755([v$1591,v$1592])],v$1594),v$1595?v$1591[0][0][2]:false];
var t$1801 = t$1800;
var t$1802 = v$1272;
var v$1268 = t$1801;
var v$1269 = t$1802;
continue lab$foldl;
};
};
};
var foldl$1267 = fix$1799.$foldl;
v$771 = (foldl$1267(b$1265,v$763));
var v$772 = v$771[0];
return v$771[1]?[[0,v$772]]:[[1,[v$772,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Con$1$2.fold$790 = function(f$793,b$796,m$799){var c$1279;
if (m$799 == null) {c$1279 = null;
} else {var t$1807 = basis$0List$1.map$697;
var t$1806 = function(v$1287){return v$1287[1];
};
var t$1805;
var t$1804 = tools$0IntStringFinMap$1.range$284;
var t$1803;
if (m$799 == null) {m$799;
} else {var v$1597 = m$799;
switch (v$1597[0][0]) { case 0: {m$799;
 break; }default: {var v$1598 = v$1597[0][1];
var v$1599 = v$1598[0];
var v$1600 = v$1598[1];
if (v$1600 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1601 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1599);
var v$1602 = v$1601[1];
var v$1603 = v$1601[0];
if (v$1602) {(v$1597[0] = [0,v$1603],0);
m$799;
} else {(v$1597[0] = [1,[v$1603,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$799;
};
} else {m$799;
};
} };
};
if (m$799 == null) {t$1803 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1289 = m$799;
switch (v$1289[0][0]) { case 0: {t$1803 = v$1289[0][1];
 break; }default: {t$1803 = v$1289[0][1][0];
} };
};
t$1805 = (t$1804(t$1803));
c$1279 = (t$1807(t$1806,t$1805));
};
var fix$1808 = {};
fix$1808.$foldl = function(v$1281,v$1282){lab$foldl: while (true) {if (v$1282 == null) {return v$1281;
} else {var v$1283 = v$1282;
var v$1284 = v$1283[0];
var v$1285 = v$1283[1];
var t$1809 = f$793([v$1284,v$1281]);
var t$1810 = v$1285;
var v$1281 = t$1809;
var v$1282 = t$1810;
continue lab$foldl;
};
};
};
var foldl$1280 = fix$1808.$foldl;
return foldl$1280(b$796,c$1279);
};
compiler_objects$0Con$1$2.Fold$800 = function(f$803,b$806,m$809){var c$1293;
if (m$809 == null) {c$1293 = null;
} else {var t$1812 = tools$0IntStringFinMap$1.range$284;
var t$1811;
if (m$809 == null) {m$809;
} else {var v$1605 = m$809;
switch (v$1605[0][0]) { case 0: {m$809;
 break; }default: {var v$1606 = v$1605[0][1];
var v$1607 = v$1606[0];
var v$1608 = v$1606[1];
if (v$1608 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1609 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1607);
var v$1610 = v$1609[1];
var v$1611 = v$1609[0];
if (v$1610) {(v$1605[0] = [0,v$1611],0);
m$809;
} else {(v$1605[0] = [1,[v$1611,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$809;
};
} else {m$809;
};
} };
};
if (m$809 == null) {t$1811 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1302 = m$809;
switch (v$1302[0][0]) { case 0: {t$1811 = v$1302[0][1];
 break; }default: {t$1811 = v$1302[0][1][0];
} };
};
c$1293 = (t$1812(t$1811));
};
var fix$1813 = {};
fix$1813.$foldl = function(v$1295,v$1296){lab$foldl: while (true) {if (v$1296 == null) {return v$1295;
} else {var v$1297 = v$1296;
var v$1298 = v$1297[0];
var v$1299 = v$1297[1];
var t$1814 = f$803([v$1298,v$1295]);
var t$1815 = v$1299;
var v$1295 = t$1814;
var v$1296 = t$1815;
continue lab$foldl;
};
};
};
var foldl$1294 = fix$1813.$foldl;
return foldl$1294(b$806,c$1293);
};
compiler_objects$0Con$1$2.filter$810 = function(f$813,m$816){var l$817;
if (m$816 == null) {l$817 = null;
} else {var t$1817 = tools$0IntStringFinMap$1.range$284;
var t$1816;
if (m$816 == null) {m$816;
} else {var v$1613 = m$816;
switch (v$1613[0][0]) { case 0: {m$816;
 break; }default: {var v$1614 = v$1613[0][1];
var v$1615 = v$1614[0];
var v$1616 = v$1614[1];
if (v$1616 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1617 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1615);
var v$1618 = v$1617[1];
var v$1619 = v$1617[0];
if (v$1618) {(v$1613[0] = [0,v$1619],0);
m$816;
} else {(v$1613[0] = [1,[v$1619,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$816;
};
} else {m$816;
};
} };
};
if (m$816 == null) {t$1816 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1306 = m$816;
switch (v$1306[0][0]) { case 0: {t$1816 = v$1306[0][1];
 break; }default: {t$1816 = v$1306[0][1][0];
} };
};
l$817 = (t$1817(t$1816));
};
var l$$818 = basis$0List$1.filter$417(f$813,l$817);
return compiler_objects$0Con$1$2.fromList$679(l$$818);
};
compiler_objects$0Con$1$2.addList$819 = function(l$822,m1$825){var m2$826 = compiler_objects$0Con$1$2.fromList$679(l$822);
return compiler_objects$0Con$1$2.plus$565(m1$825,m2$826);
};
compiler_objects$0Con$1$2.mergeMap$827 = function(f$830,m1$833,m2$836){if (m1$833 == null) {m1$833;
} else {var v$1621 = m1$833;
switch (v$1621[0][0]) { case 0: {m1$833;
 break; }default: {var v$1622 = v$1621[0][1];
var v$1623 = v$1622[0];
var v$1624 = v$1622[1];
if (v$1624 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1625 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1623);
var v$1626 = v$1625[1];
var v$1627 = v$1625[0];
if (v$1626) {(v$1621[0] = [0,v$1627],0);
m1$833;
} else {(v$1621[0] = [1,[v$1627,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$833;
};
} else {m1$833;
};
} };
};
if (m2$836 == null) {m2$836;
} else {var v$1629 = m2$836;
switch (v$1629[0][0]) { case 0: {m2$836;
 break; }default: {var v$1630 = v$1629[0][1];
var v$1631 = v$1630[0];
var v$1632 = v$1630[1];
if (v$1632 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1633 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1631);
var v$1634 = v$1633[1];
var v$1635 = v$1633[0];
if (v$1634) {(v$1629[0] = [0,v$1635],0);
m2$836;
} else {(v$1629[0] = [1,[v$1635,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$836;
};
} else {m2$836;
};
} };
};
var rhs3$865 = function(obj$882){var t$1826;
var t$1825;
var t$1824;
var t$1823;
var t$1822 = tools$0IntStringFinMap$1.mergeMap$374;
var t$1821 = function(v$1637){var v$1638 = v$1637[0];
var v$1639 = v$1638[0];
var v$1640 = v$1638[1];
var v$1641 = v$1637[1];
var v$1642 = v$1641[0];
var v$1643 = v$1641[1];
var t$1820;
var v$1644 = v$1639[0][0][1];
var v$1645 = v$1642[0][0][1];
t$1820 = ((v$1644[0] == v$1645[0])?(v$1644[1] == v$1645[1]):false);
if (t$1820) {return [v$1639,f$830([v$1640,v$1643])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
};
var t$1819;
if (m1$833 == null) {t$1819 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1318 = m1$833;
switch (v$1318[0][0]) { case 0: {t$1819 = v$1318[0][1];
 break; }default: {t$1819 = v$1318[0][1][0];
} };
};
var t$1818;
if (m2$836 == null) {t$1818 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1322 = m2$836;
switch (v$1322[0][0]) { case 0: {t$1818 = v$1322[0][1];
 break; }default: {t$1818 = v$1322[0][1][0];
} };
};
t$1823 = (t$1822(t$1821,t$1819,t$1818));
t$1824 = [t$1823,special_objects$0Name$1.current_matchcount$69(0)];
t$1825 = [1,t$1824];
t$1826 = [t$1825];
return t$1826;
};
if (m1$833 == null) {return m2$836;
} else {if (m2$836 == null) {return m1$833;
} else {var v$874 = m1$833;
switch (v$874[0][0]) { case 0: {var v$876 = m2$836;
switch (v$876[0][0]) { case 0: {var v$878 = v$874[0][1];
var v$879 = v$876[0][1];
return [[0,tools$0IntStringFinMap$1.mergeMap$374(function(v$1647){var v$1648 = v$1647[0];
var v$1649 = v$1648[0];
var v$1650 = v$1648[1];
var v$1651 = v$1647[1];
var v$1652 = v$1651[0];
var v$1653 = v$1651[1];
var t$1827;
var v$1654 = v$1649[0][0][1];
var v$1655 = v$1652[0][0][1];
t$1827 = ((v$1654[0] == v$1655[0])?(v$1654[1] == v$1655[1]):false);
if (t$1827) {return [v$1649,f$830([v$1650,v$1653])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
},v$878,v$879)]];
 break; }default: {return rhs3$865(0);
} };
 break; }default: {return rhs3$865(0);
} };
};
};
};
var fix$1828 = {};
fix$1828.$pp_lookup = function(v$886,v$889,v$892){lab$pp_lookup: while (true) {if (v$889 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$911 = v$889;
var v$912 = v$911[0];
var v$913 = v$911[1];
var t$1829;
var v$1467 = v$912[0][0][1];
t$1829 = ((v$892[0] == v$1467[0])?(v$892[1] == v$1467[1]):false);
if (t$1829) {return v$886(v$912);
} else {var t$1830 = v$886;
var t$1831 = v$913;
var t$1832 = v$892;
var v$886 = t$1830;
var v$889 = t$1831;
var v$892 = t$1832;
continue lab$pp_lookup;
};
};
};
};
compiler_objects$0Con$1$2.pp_lookup$883 = fix$1828.$pp_lookup;
compiler_objects$0Con$1$2.en$Restrict$915 = new String("Restrict");
compiler_objects$0Con$1$2.restrict$916 = function(v$1726,v$1727,v$929){if (v$929 == null) {return null;
} else {if (v$1727 == null) {v$1727;
} else {var v$1659 = v$1727;
switch (v$1659[0][0]) { case 0: {v$1727;
 break; }default: {var v$1660 = v$1659[0][1];
var v$1661 = v$1660[0];
var v$1662 = v$1660[1];
if (v$1662 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1663 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1661);
var v$1664 = v$1663[1];
var v$1665 = v$1663[0];
if (v$1664) {(v$1659[0] = [0,v$1665],0);
v$1727;
} else {(v$1659[0] = [1,[v$1665,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1727;
};
} else {v$1727;
};
} };
};
if (v$1727 == null) {throw [compiler_objects$0Con$1$2.en$Restrict$915,"[empty map]"];
} else {var im$937;
if (v$1727 == null) {im$937 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1334 = v$1727;
switch (v$1334[0][0]) { case 0: {im$937 = v$1334[0][1];
 break; }default: {im$937 = v$1334[0][1][0];
} };
};
var ns$938 = basis$0List$1.map$697(function(d$1337){return d$1337[0][0][1];
},v$929);
var im$$940;
try {var t$1839 = tools$0IntStringFinMap$1.restrict$391;
var t$1838;
var fix$1834 = {};
fix$1834.$pp_lookup = function(v$1741,v$1742){lab$pp_lookup: while (true) {if (v$1741 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$1743 = v$1741;
var v$1744 = v$1743[0];
var v$1745 = v$1743[1];
var t$1835;
var v$1746 = v$1744[0][0][1];
t$1835 = ((v$1742[0] == v$1746[0])?(v$1742[1] == v$1746[1]):false);
if (t$1835) {return v$1726(v$1744);
} else {var t$1836 = v$1745;
var t$1837 = v$1742;
var v$1741 = t$1836;
var v$1742 = t$1837;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$1740 = fix$1834.$pp_lookup;
t$1838 = (function(v$1747){return pp_lookup$1740(v$929,v$1747);
});
im$$940 = (t$1839(t$1838,im$937,ns$938));
} catch(v$1833) {im$$940 = ((function(v$944){var t$1840 = v$944;
if (t$1840[0] == tools$0IntStringFinMap$1.en$Restrict$390) {var s$941 = v$944[1];
throw [compiler_objects$0Con$1$2.en$Restrict$915,s$941];
} else {throw v$944;
};
})(v$1833));
};
return (tools$0IntStringFinMap$1.fold$62(function(v$949){var v$954 = v$949[0];
var v$955 = v$954[0];
return v$949[1]?v$955[0][0][2]:false;
},true,im$$940))?[[0,im$$940]]:[[1,[im$$940,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
};
compiler_objects$0Con$1$2.enrich$963 = function(f$966,v$970){var v$994 = v$970[0];
var v$995 = v$970[1];
if (v$994 == null) {v$994;
} else {var v$1667 = v$994;
switch (v$1667[0][0]) { case 0: {v$994;
 break; }default: {var v$1668 = v$1667[0][1];
var v$1669 = v$1668[0];
var v$1670 = v$1668[1];
if (v$1670 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1671 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1669);
var v$1672 = v$1671[1];
var v$1673 = v$1671[0];
if (v$1672) {(v$1667[0] = [0,v$1673],0);
v$994;
} else {(v$1667[0] = [1,[v$1673,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$994;
};
} else {v$994;
};
} };
};
if (v$995 == null) {v$995;
} else {var v$1675 = v$995;
switch (v$1675[0][0]) { case 0: {v$995;
 break; }default: {var v$1676 = v$1675[0][1];
var v$1677 = v$1676[0];
var v$1678 = v$1676[1];
if (v$1678 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1679 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1677);
var v$1680 = v$1679[1];
var v$1681 = v$1679[0];
if (v$1680) {(v$1675[0] = [0,v$1681],0);
v$995;
} else {(v$1675[0] = [1,[v$1681,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$995;
};
} else {v$995;
};
} };
};
if (v$995 == null) {return true;
} else {if (v$994 == null) {return false;
} else {var im1$983;
if (v$994 == null) {im1$983 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1342 = v$994;
switch (v$1342[0][0]) { case 0: {im1$983 = v$1342[0][1];
 break; }default: {im1$983 = v$1342[0][1][0];
} };
};
var im2$984;
if (v$995 == null) {im2$984 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1346 = v$995;
switch (v$1346[0][0]) { case 0: {im2$984 = v$1346[0][1];
 break; }default: {im2$984 = v$1346[0][1][0];
} };
};
return tools$0IntStringFinMap$1.enrich$414(function(v$1349){var v$1350 = v$1349[0];
var v$1351 = v$1350[1];
var v$1352 = v$1349[1];
var v$1353 = v$1352[1];
return f$966([v$1351,v$1353]);
},[im1$983,im2$984]);
};
};
};
compiler_objects$0Con$1$2.layoutMap$996 = function(v$1030,v$1032,v$1031,v$1029){return function(pp_dom$1005){return function(pp_range$1008){return function(m$1011){var t$1841;
var v$1027 = [0,v$1031];
var t$1848;
var t$1847 = basis$0List$1.map$697;
var t$1846 = function(v$1354){var v$1355 = v$1354[0];
var v$1356 = v$1354[1];
var t$1845;
var v$1357 = [0,v$1030];
t$1845 = [[pp_dom$1005(v$1355),[pp_range$1008(v$1356),null]],v$1357,"",1,""];
return [0,t$1845];
};
var t$1844;
if (m$1011 == null) {t$1844 = null;
} else {var t$1843 = tools$0IntStringFinMap$1.range$284;
var t$1842;
if (m$1011 == null) {m$1011;
} else {var v$1683 = m$1011;
switch (v$1683[0][0]) { case 0: {m$1011;
 break; }default: {var v$1684 = v$1683[0][1];
var v$1685 = v$1684[0];
var v$1686 = v$1684[1];
if (v$1686 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1687 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1685);
var v$1688 = v$1687[1];
var v$1689 = v$1687[0];
if (v$1688) {(v$1683[0] = [0,v$1689],0);
m$1011;
} else {(v$1683[0] = [1,[v$1689,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1011;
};
} else {m$1011;
};
} };
};
if (m$1011 == null) {t$1842 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1360 = m$1011;
switch (v$1360[0][0]) { case 0: {t$1842 = v$1360[0][1];
 break; }default: {t$1842 = v$1360[0][1][0];
} };
};
t$1844 = (t$1843(t$1842));
};
t$1848 = (t$1847(t$1846,t$1844));
t$1841 = [t$1848,v$1027,v$1032,1,v$1029];
return [0,t$1841];
};
};
};
};
compiler_objects$0Con$1$2.reportMap$1033 = function(f$1036,m$1039){var t$1855 = tools$0Report$1.flatten$87;
var t$1854;
var t$1853 = basis$0List$1.map$697;
var t$1852 = f$1036;
var t$1851;
if (m$1039 == null) {t$1851 = null;
} else {var t$1850 = tools$0IntStringFinMap$1.range$284;
var t$1849;
if (m$1039 == null) {m$1039;
} else {var v$1691 = m$1039;
switch (v$1691[0][0]) { case 0: {m$1039;
 break; }default: {var v$1692 = v$1691[0][1];
var v$1693 = v$1692[0];
var v$1694 = v$1692[1];
if (v$1694 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1695 = compiler_objects$0Con$1$2.ensure_consistent_imap$421(v$1693);
var v$1696 = v$1695[1];
var v$1697 = v$1695[0];
if (v$1696) {(v$1691[0] = [0,v$1697],0);
m$1039;
} else {(v$1691[0] = [1,[v$1697,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1039;
};
} else {m$1039;
};
} };
};
if (m$1039 == null) {t$1849 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1364 = m$1039;
switch (v$1364[0][0]) { case 0: {t$1849 = v$1364[0][1];
 break; }default: {t$1849 = v$1364[0][1][0];
} };
};
t$1851 = (t$1850(t$1849));
};
t$1854 = (t$1853(t$1852,t$1851));
return t$1855(t$1854);
};
compiler_objects$0Con$1$2.pu_map0$1040 = function(pu_d$1043,pu_a$1046){var pu_m$1055 = pickle$0pickle$1.combHash$2090(function(m$1366){return tools$0IntStringFinMap$1.fold$62(function(v$1367){return SmlPrims.chk_ovf_i32(v$1367[1] + 1);
},0,m$1366);
},tools$0IntStringFinMap$1.pu$488(pickle$0pickle$1.shareGen$878(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.int$729,pickle$0pickle$1.string$909)),pickle$0pickle$1.shareGen$878(pickle$0pickle$1.pairGen0$983(pu_d$1043,pu_a$1046))));
return pickle$0pickle$1.dataGen$1488(["QuasiMap.map0",function(v$1374){switch (v$1374[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$1375){return pickle$0pickle$1.con1$2014(function(v$1376){return [0,v$1376];
},function(v$1377){switch (v$1377[0]) { case 0: {return v$1377[1];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$1055);
},[function(v$1380){return pickle$0pickle$1.con1$2014(function(v$1381){return [1,[v$1381[1],-1]];
},function(v$1382){switch (v$1382[0]) { case 1: {var v$1383 = v$1382[1];
return [v$1383[1],v$1383[0]];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Flexible");
} };
},pickle$0pickle$1.pairGen0$983(special_objects$0Name$1.pu_matchcount$298,pu_m$1055));
},null]]]);
};
compiler_objects$0Con$1$2.pu$1097 = function(pu_d$1100,pu_a$1103){var b$1393 = pickle$0pickle$1.optionGen$2134(pickle$0pickle$1.ref0ShGen$1268(compiler_objects$0Con$1$2.pu_map0$1040(pu_d$1100,pu_a$1103)));
return pickle$0pickle$1.shareGen$878((pickle$0pickle$1.convert0$2299(function(v$1754){switch (v$1754[0]) { case 0: {var v$1755 = v$1754[1];
return v$1755;
 break; }default: {return null;
} };
},function(v$1756){if (v$1756 == null) {return [1];
} else {var v$1757 = v$1756;
var t$1858;
var t$1857 = tools$0IntStringFinMap$1.isEmpty$128(0);
var t$1856;
if (v$1756 == null) {t$1856 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1758 = v$1756;
switch (v$1758[0][0]) { case 0: {t$1856 = v$1758[0][1];
 break; }default: {t$1856 = v$1758[0][1][0];
} };
};
t$1858 = (t$1857(t$1856));
if (t$1858) {return tools$0Crash$1.impossible$59("QuasiMap2.pu.hmmm");
} else {return [0,v$1757];
};
};
}))(b$1393));
};
return 0;
})();
