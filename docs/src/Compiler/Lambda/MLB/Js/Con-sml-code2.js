if ((typeof(compiler_objects$0Con$1$2)) == "undefined") {compiler_objects$0Con$1$2 = {};
};
(function(){compiler_objects$0Con$1$2.die$332 = function(s$335){return tools$0Crash$1.impossible$59("QuasiMap2." + s$335);
};
compiler_objects$0Con$1$2.key$336 = function(v$1702,v$1703){return v$1702[0][1];
};
compiler_objects$0Con$1$2.rigid$340 = function(v$1704,v$1705){return v$1704[0][2];
};
compiler_objects$0Con$1$2.empty$348 = function(v$1728){return null;
};
compiler_objects$0Con$1$2.singleton$349 = function(v$360,v$361){var nd$354 = v$360[0];
var k$355 = nd$354[0][1];
return nd$354[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$355,[v$360,v$361])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$355,[v$360,v$361]),special_objects$0Name$1.current_matchcount$69(0)]]];
};
compiler_objects$0Con$1$2.isEmpty$362 = function(v$365){return (v$365 == null)?true:false;
};
compiler_objects$0Con$1$2.imap$370 = function(v$373){if (v$373 == null) {return [1];
} else {var v$382 = v$373;
switch (v$382[0][0]) { case 0: {var v$384 = v$382[0][1];
return [0,v$384];
 break; }default: {var v$385 = v$382[0][1];
var v$386 = v$385[0];
return [0,v$386];
} };
};
};
compiler_objects$0Con$1$2.imap$$387 = function(v$390){if (v$390 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible");
} else {var v$400 = v$390;
switch (v$400[0][0]) { case 0: {return v$400[0][1];
 break; }default: {return v$400[0][1][0];
} };
};
};
compiler_objects$0Con$1$2.ensure_consistent_imap$405 = function(imap$408){var v$428 = tools$0IntStringFinMap$1.Fold$78(function(v$436){var v$445 = v$436[0];
var v$446 = v$445[0];
var v$447 = v$445[1];
var v$448 = v$447[0];
var v$449 = v$436[1];
var v$450 = v$449[0];
var v$451 = v$449[1];
var t$1729;
if (v$450) {var v$1391 = v$448[0][0][1];
t$1729 = ((v$1391[0] == v$446[0])?(v$1391[1] == v$446[1]):false);
} else {t$1729 = false;
};
return [t$1729,v$451?v$448[0][0][2]:false];
},[true,true],imap$408);
var v$429 = v$428[0];
var v$430 = v$428[1];
return [v$429?imap$408:(tools$0IntStringFinMap$1.fold$62(function(v$421){var v$422 = v$421[0];
var v$423 = v$422[0];
var v$424 = v$422[1];
var v$425 = v$421[1];
return tools$0IntStringFinMap$1.add$237(v$423[0][0][1],[v$423,v$424],v$425);
},tools$0IntStringFinMap$1.empty$117(0),imap$408)),v$430];
};
compiler_objects$0Con$1$2.ensure_consistent$452 = function(v$455){if (v$455 == null) {return v$455;
} else {var v$468 = v$455;
switch (v$468[0][0]) { case 0: {return v$455;
 break; }default: {var v$488 = v$468[0][1];
var v$489 = v$488[0];
var v$490 = v$488[1];
if (v$490 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$485 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$489);
var v$486 = v$485[1];
var v$487 = v$485[0];
if (v$486) {(v$468[0] = [0,v$487],0);
return v$455;
} else {(v$468[0] = [1,[v$487,special_objects$0Name$1.current_matchcount$69(0)]],0);
return v$455;
};
} else {return v$455;
};
} };
};
};
compiler_objects$0Con$1$2.mk_flex$491 = function(imap$494){return [[1,[imap$494,special_objects$0Name$1.current_matchcount$69(0)]]];
};
compiler_objects$0Con$1$2.mk_rigid$495 = function(imap$498){return [[0,imap$498]];
};
compiler_objects$0Con$1$2.lookup$499 = function(m$502,d$505){var v$510;
if (m$502 == null) {m$502;
} else {var v$1470 = m$502;
switch (v$1470[0][0]) { case 0: {m$502;
 break; }default: {var v$1471 = v$1470[0][1];
var v$1472 = v$1471[0];
var v$1473 = v$1471[1];
if (v$1473 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1474 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1472);
var v$1475 = v$1474[1];
var v$1476 = v$1474[0];
if (v$1475) {(v$1470[0] = [0,v$1476],0);
m$502;
} else {(v$1470[0] = [1,[v$1476,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$502;
};
} else {m$502;
};
} };
};
if (m$502 == null) {v$510 = [1];
} else {var v$1171 = m$502;
switch (v$1171[0][0]) { case 0: {var v$1172 = v$1171[0][1];
v$510 = [0,v$1172];
 break; }default: {var v$1173 = v$1171[0][1];
var v$1174 = v$1173[0];
v$510 = [0,v$1174];
} };
};
switch (v$510[0]) { case 0: {var v$520 = v$510[1];
var v$516 = tools$0IntStringFinMap$1.lookup$129(v$520,d$505[0][0][1]);
switch (v$516[0]) { case 0: {var v$518 = v$516[1];
var v$519 = v$518[1];
return [0,v$519];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
compiler_objects$0Con$1$2.add$521 = function(v$546,v$547,v$548){if (v$548 == null) {v$548;
} else {var v$1478 = v$548;
switch (v$1478[0][0]) { case 0: {v$548;
 break; }default: {var v$1479 = v$1478[0][1];
var v$1480 = v$1479[0];
var v$1481 = v$1479[1];
if (v$1481 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1482 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1480);
var v$1483 = v$1482[1];
var v$1484 = v$1482[0];
if (v$1483) {(v$1478[0] = [0,v$1484],0);
v$548;
} else {(v$1478[0] = [1,[v$1484,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$548;
};
} else {v$548;
};
} };
};
if (v$548 == null) {var nd$1179 = v$546[0];
var k$1180 = nd$1179[0][1];
return nd$1179[0][2]?[[0,tools$0IntStringFinMap$1.singleton$118(k$1180,[v$546,v$547])]]:[[1,[tools$0IntStringFinMap$1.singleton$118(k$1180,[v$546,v$547]),special_objects$0Name$1.current_matchcount$69(0)]]];
} else {var v$535 = v$548;
switch (v$535[0][0]) { case 0: {var v$543 = v$535[0][1];
var nd$537 = v$546[0];
var i$538 = nd$537[0][1];
return nd$537[0][2]?[[0,tools$0IntStringFinMap$1.add$237(i$538,[v$546,v$547],v$543)]]:[[1,[tools$0IntStringFinMap$1.add$237(i$538,[v$546,v$547],v$543),special_objects$0Name$1.current_matchcount$69(0)]]];
 break; }default: {var v$544 = v$535[0][1];
var v$545 = v$544[0];
return [[1,[tools$0IntStringFinMap$1.add$237(v$546[0][0][1],[v$546,v$547],v$545),special_objects$0Name$1.current_matchcount$69(0)]]];
} };
};
};
compiler_objects$0Con$1$2.plus$549 = function(v$583,v$584){if (v$583 == null) {v$583;
} else {var v$1486 = v$583;
switch (v$1486[0][0]) { case 0: {v$583;
 break; }default: {var v$1487 = v$1486[0][1];
var v$1488 = v$1487[0];
var v$1489 = v$1487[1];
if (v$1489 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1490 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1488);
var v$1491 = v$1490[1];
var v$1492 = v$1490[0];
if (v$1491) {(v$1486[0] = [0,v$1492],0);
v$583;
} else {(v$1486[0] = [1,[v$1492,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$583;
};
} else {v$583;
};
} };
};
if (v$584 == null) {v$584;
} else {var v$1494 = v$584;
switch (v$1494[0][0]) { case 0: {v$584;
 break; }default: {var v$1495 = v$1494[0][1];
var v$1496 = v$1495[0];
var v$1497 = v$1495[1];
if (v$1497 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1498 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1496);
var v$1499 = v$1498[1];
var v$1500 = v$1498[0];
if (v$1499) {(v$1494[0] = [0,v$1500],0);
v$584;
} else {(v$1494[0] = [1,[v$1500,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$584;
};
} else {v$584;
};
} };
};
if (v$583 == null) {return v$584;
} else {if (v$584 == null) {return v$583;
} else {var v$574 = v$583;
switch (v$574[0][0]) { case 0: {var v$576 = v$584;
switch (v$576[0][0]) { case 0: {var v$578 = v$574[0][1];
var v$579 = v$576[0][1];
return [[0,tools$0IntStringFinMap$1.plus$255(v$578,v$579)]];
 break; }default: {var t$1736;
var t$1735;
var t$1734;
var t$1733;
var t$1732 = tools$0IntStringFinMap$1.plus$255;
var t$1731;
if (v$583 == null) {t$1731 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1502 = v$583;
switch (v$1502[0][0]) { case 0: {t$1731 = v$1502[0][1];
 break; }default: {t$1731 = v$1502[0][1][0];
} };
};
var t$1730;
if (v$584 == null) {t$1730 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1503 = v$584;
switch (v$1503[0][0]) { case 0: {t$1730 = v$1503[0][1];
 break; }default: {t$1730 = v$1503[0][1][0];
} };
};
t$1733 = (t$1732(t$1731,t$1730));
t$1734 = [t$1733,special_objects$0Name$1.current_matchcount$69(0)];
t$1735 = [1,t$1734];
t$1736 = [t$1735];
return t$1736;
} };
 break; }default: {var t$1743;
var t$1742;
var t$1741;
var t$1740;
var t$1739 = tools$0IntStringFinMap$1.plus$255;
var t$1738;
if (v$583 == null) {t$1738 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1505 = v$583;
switch (v$1505[0][0]) { case 0: {t$1738 = v$1505[0][1];
 break; }default: {t$1738 = v$1505[0][1][0];
} };
};
var t$1737;
if (v$584 == null) {t$1737 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1506 = v$584;
switch (v$1506[0][0]) { case 0: {t$1737 = v$1506[0][1];
 break; }default: {t$1737 = v$1506[0][1][0];
} };
};
t$1740 = (t$1739(t$1738,t$1737));
t$1741 = [t$1740,special_objects$0Name$1.current_matchcount$69(0)];
t$1742 = [1,t$1741];
t$1743 = [t$1742];
return t$1743;
} };
};
};
};
compiler_objects$0Con$1$2.remove$585 = function(v$626,v$627){if (v$627 == null) {v$627;
} else {var v$1508 = v$627;
switch (v$1508[0][0]) { case 0: {v$627;
 break; }default: {var v$1509 = v$1508[0][1];
var v$1510 = v$1509[0];
var v$1511 = v$1509[1];
if (v$1511 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1512 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1510);
var v$1513 = v$1512[1];
var v$1514 = v$1512[0];
if (v$1513) {(v$1508[0] = [0,v$1514],0);
v$627;
} else {(v$1508[0] = [1,[v$1514,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$627;
};
} else {v$627;
};
} };
};
if (v$627 == null) {return [1];
} else {var v$599 = v$627;
switch (v$599[0][0]) { case 0: {var v$612 = v$599[0][1];
var v$605 = tools$0IntStringFinMap$1.remove$262(v$626[0][0][1],v$612);
switch (v$605[0]) { case 0: {var v$611 = v$605[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$611))?[0,null]:[0,[[0,v$611]]];
 break; }default: {return [1];
} };
 break; }default: {var v$624 = v$599[0][1];
var v$625 = v$624[0];
var v$617 = tools$0IntStringFinMap$1.remove$262(v$626[0][0][1],v$625);
switch (v$617[0]) { case 0: {var v$623 = v$617[1];
return ((tools$0IntStringFinMap$1.isEmpty$128(0))(v$623))?[0,null]:[0,[[1,[v$623,special_objects$0Name$1.current_matchcount$69(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
compiler_objects$0Con$1$2.dom$628 = function(v$631){if (v$631 == null) {return null;
} else {var t$1748 = basis$0List$1.map$697;
var t$1747 = function(v$639){return v$639[0];
};
var t$1746;
var t$1745 = tools$0IntStringFinMap$1.range$284;
var t$1744;
if (v$631 == null) {v$631;
} else {var v$1516 = v$631;
switch (v$1516[0][0]) { case 0: {v$631;
 break; }default: {var v$1517 = v$1516[0][1];
var v$1518 = v$1517[0];
var v$1519 = v$1517[1];
if (v$1519 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1520 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1518);
var v$1521 = v$1520[1];
var v$1522 = v$1520[0];
if (v$1521) {(v$1516[0] = [0,v$1522],0);
v$631;
} else {(v$1516[0] = [1,[v$1522,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$631;
};
} else {v$631;
};
} };
};
if (v$631 == null) {t$1744 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1203 = v$631;
switch (v$1203[0][0]) { case 0: {t$1744 = v$1203[0][1];
 break; }default: {t$1744 = v$1203[0][1][0];
} };
};
t$1746 = (t$1745(t$1744));
return t$1748(t$1747,t$1746);
};
};
compiler_objects$0Con$1$2.range$641 = function(v$644){if (v$644 == null) {return null;
} else {var t$1753 = basis$0List$1.map$697;
var t$1752 = function(v$652){return v$652[1];
};
var t$1751;
var t$1750 = tools$0IntStringFinMap$1.range$284;
var t$1749;
if (v$644 == null) {v$644;
} else {var v$1524 = v$644;
switch (v$1524[0][0]) { case 0: {v$644;
 break; }default: {var v$1525 = v$1524[0][1];
var v$1526 = v$1525[0];
var v$1527 = v$1525[1];
if (v$1527 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1528 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1526);
var v$1529 = v$1528[1];
var v$1530 = v$1528[0];
if (v$1529) {(v$1524[0] = [0,v$1530],0);
v$644;
} else {(v$1524[0] = [1,[v$1530,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$644;
};
} else {v$644;
};
} };
};
if (v$644 == null) {t$1749 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1207 = v$644;
switch (v$1207[0][0]) { case 0: {t$1749 = v$1207[0][1];
 break; }default: {t$1749 = v$1207[0][1][0];
} };
};
t$1751 = (t$1750(t$1749));
return t$1753(t$1752,t$1751);
};
};
compiler_objects$0Con$1$2.list$654 = function(v$657){if (v$657 == null) {return null;
} else {var t$1755 = tools$0IntStringFinMap$1.range$284;
var t$1754;
if (v$657 == null) {v$657;
} else {var v$1532 = v$657;
switch (v$1532[0][0]) { case 0: {v$657;
 break; }default: {var v$1533 = v$1532[0][1];
var v$1534 = v$1533[0];
var v$1535 = v$1533[1];
if (v$1535 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1536 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1534);
var v$1537 = v$1536[1];
var v$1538 = v$1536[0];
if (v$1537) {(v$1532[0] = [0,v$1538],0);
v$657;
} else {(v$1532[0] = [1,[v$1538,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$657;
};
} else {v$657;
};
} };
};
if (v$657 == null) {t$1754 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1211 = v$657;
switch (v$1211[0][0]) { case 0: {t$1754 = v$1211[0][1];
 break; }default: {t$1754 = v$1211[0][1][0];
} };
};
return t$1755(t$1754);
};
};
compiler_objects$0Con$1$2.fromList$663 = function(v$666){if (v$666 == null) {return null;
} else {var v$679;
var b$1215 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1756 = {};
fix$1756.$foldl = function(v$1218,v$1219){lab$foldl: while (true) {if (v$1219 == null) {return v$1218;
} else {var v$1220 = v$1219;
var v$1221 = v$1220[0];
var v$1222 = v$1220[1];
var t$1757;
var v$1541 = v$1221[0];
var v$1542 = v$1221[1];
var v$1544 = v$1218[0];
var v$1545 = v$1218[1];
t$1757 = [tools$0IntStringFinMap$1.add$237(v$1541[0][0][1],[v$1541,v$1542],v$1544),v$1545?v$1541[0][0][2]:false];
var t$1758 = t$1757;
var t$1759 = v$1222;
var v$1218 = t$1758;
var v$1219 = t$1759;
continue lab$foldl;
};
};
};
var foldl$1217 = fix$1756.$foldl;
v$679 = (foldl$1217(b$1215,v$666));
var v$680 = v$679[0];
return v$679[1]?[[0,v$680]]:[[1,[v$680,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Con$1$2.composemap$698 = function(f$701,m$704){var v$709;
if (m$704 == null) {v$709 = null;
} else {var t$1761 = tools$0IntStringFinMap$1.range$284;
var t$1760;
if (m$704 == null) {m$704;
} else {var v$1547 = m$704;
switch (v$1547[0][0]) { case 0: {m$704;
 break; }default: {var v$1548 = v$1547[0][1];
var v$1549 = v$1548[0];
var v$1550 = v$1548[1];
if (v$1550 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1551 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1549);
var v$1552 = v$1551[1];
var v$1553 = v$1551[0];
if (v$1552) {(v$1547[0] = [0,v$1553],0);
m$704;
} else {(v$1547[0] = [1,[v$1553,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$704;
};
} else {m$704;
};
} };
};
if (m$704 == null) {t$1760 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1229 = m$704;
switch (v$1229[0][0]) { case 0: {t$1760 = v$1229[0][1];
 break; }default: {t$1760 = v$1229[0][1][0];
} };
};
v$709 = (t$1761(t$1760));
};
if (v$709 == null) {return null;
} else {var v$717;
var b$1232 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1762 = {};
fix$1762.$foldl = function(v$1235,v$1236){lab$foldl: while (true) {if (v$1236 == null) {return v$1235;
} else {var v$1237 = v$1236;
var v$1238 = v$1237[0];
var v$1239 = v$1237[1];
var t$1763;
var v$1556 = v$1238[0];
var v$1557 = v$1238[1];
var v$1559 = v$1235[0];
var v$1560 = v$1235[1];
t$1763 = [tools$0IntStringFinMap$1.add$237(v$1556[0][0][1],[v$1556,f$701(v$1557)],v$1559),v$1560?v$1556[0][0][2]:false];
var t$1764 = t$1763;
var t$1765 = v$1239;
var v$1235 = t$1764;
var v$1236 = t$1765;
continue lab$foldl;
};
};
};
var foldl$1234 = fix$1762.$foldl;
v$717 = (foldl$1234(b$1232,v$709));
var v$718 = v$717[0];
return v$717[1]?[[0,v$718]]:[[1,[v$718,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Con$1$2.ComposeMap$736 = function(f$739,m$742){var v$747;
if (m$742 == null) {v$747 = null;
} else {var t$1767 = tools$0IntStringFinMap$1.range$284;
var t$1766;
if (m$742 == null) {m$742;
} else {var v$1562 = m$742;
switch (v$1562[0][0]) { case 0: {m$742;
 break; }default: {var v$1563 = v$1562[0][1];
var v$1564 = v$1563[0];
var v$1565 = v$1563[1];
if (v$1565 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1566 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1564);
var v$1567 = v$1566[1];
var v$1568 = v$1566[0];
if (v$1567) {(v$1562[0] = [0,v$1568],0);
m$742;
} else {(v$1562[0] = [1,[v$1568,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$742;
};
} else {m$742;
};
} };
};
if (m$742 == null) {t$1766 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1246 = m$742;
switch (v$1246[0][0]) { case 0: {t$1766 = v$1246[0][1];
 break; }default: {t$1766 = v$1246[0][1][0];
} };
};
v$747 = (t$1767(t$1766));
};
if (v$747 == null) {return null;
} else {var v$755;
var b$1249 = [tools$0IntStringFinMap$1.empty$117(0),true];
var fix$1768 = {};
fix$1768.$foldl = function(v$1252,v$1253){lab$foldl: while (true) {if (v$1253 == null) {return v$1252;
} else {var v$1254 = v$1253;
var v$1255 = v$1254[0];
var v$1256 = v$1254[1];
var t$1769;
var v$1571 = v$1255[0];
var v$1572 = v$1255[1];
var v$1574 = v$1252[0];
var v$1575 = v$1252[1];
t$1769 = [tools$0IntStringFinMap$1.add$237(v$1571[0][0][1],[v$1571,f$739([v$1571,v$1572])],v$1574),v$1575?v$1571[0][0][2]:false];
var t$1770 = t$1769;
var t$1771 = v$1256;
var v$1252 = t$1770;
var v$1253 = t$1771;
continue lab$foldl;
};
};
};
var foldl$1251 = fix$1768.$foldl;
v$755 = (foldl$1251(b$1249,v$747));
var v$756 = v$755[0];
return v$755[1]?[[0,v$756]]:[[1,[v$756,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
compiler_objects$0Con$1$2.fold$774 = function(f$777,b$780,m$783){var c$1263;
if (m$783 == null) {c$1263 = null;
} else {var t$1776 = basis$0List$1.map$697;
var t$1775 = function(v$1271){return v$1271[1];
};
var t$1774;
var t$1773 = tools$0IntStringFinMap$1.range$284;
var t$1772;
if (m$783 == null) {m$783;
} else {var v$1577 = m$783;
switch (v$1577[0][0]) { case 0: {m$783;
 break; }default: {var v$1578 = v$1577[0][1];
var v$1579 = v$1578[0];
var v$1580 = v$1578[1];
if (v$1580 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1581 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1579);
var v$1582 = v$1581[1];
var v$1583 = v$1581[0];
if (v$1582) {(v$1577[0] = [0,v$1583],0);
m$783;
} else {(v$1577[0] = [1,[v$1583,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$783;
};
} else {m$783;
};
} };
};
if (m$783 == null) {t$1772 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1273 = m$783;
switch (v$1273[0][0]) { case 0: {t$1772 = v$1273[0][1];
 break; }default: {t$1772 = v$1273[0][1][0];
} };
};
t$1774 = (t$1773(t$1772));
c$1263 = (t$1776(t$1775,t$1774));
};
var fix$1777 = {};
fix$1777.$foldl = function(v$1265,v$1266){lab$foldl: while (true) {if (v$1266 == null) {return v$1265;
} else {var v$1267 = v$1266;
var v$1268 = v$1267[0];
var v$1269 = v$1267[1];
var t$1778 = f$777([v$1268,v$1265]);
var t$1779 = v$1269;
var v$1265 = t$1778;
var v$1266 = t$1779;
continue lab$foldl;
};
};
};
var foldl$1264 = fix$1777.$foldl;
return foldl$1264(b$780,c$1263);
};
compiler_objects$0Con$1$2.Fold$784 = function(f$787,b$790,m$793){var c$1277;
if (m$793 == null) {c$1277 = null;
} else {var t$1781 = tools$0IntStringFinMap$1.range$284;
var t$1780;
if (m$793 == null) {m$793;
} else {var v$1585 = m$793;
switch (v$1585[0][0]) { case 0: {m$793;
 break; }default: {var v$1586 = v$1585[0][1];
var v$1587 = v$1586[0];
var v$1588 = v$1586[1];
if (v$1588 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1589 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1587);
var v$1590 = v$1589[1];
var v$1591 = v$1589[0];
if (v$1590) {(v$1585[0] = [0,v$1591],0);
m$793;
} else {(v$1585[0] = [1,[v$1591,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$793;
};
} else {m$793;
};
} };
};
if (m$793 == null) {t$1780 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1286 = m$793;
switch (v$1286[0][0]) { case 0: {t$1780 = v$1286[0][1];
 break; }default: {t$1780 = v$1286[0][1][0];
} };
};
c$1277 = (t$1781(t$1780));
};
var fix$1782 = {};
fix$1782.$foldl = function(v$1279,v$1280){lab$foldl: while (true) {if (v$1280 == null) {return v$1279;
} else {var v$1281 = v$1280;
var v$1282 = v$1281[0];
var v$1283 = v$1281[1];
var t$1783 = f$787([v$1282,v$1279]);
var t$1784 = v$1283;
var v$1279 = t$1783;
var v$1280 = t$1784;
continue lab$foldl;
};
};
};
var foldl$1278 = fix$1782.$foldl;
return foldl$1278(b$790,c$1277);
};
compiler_objects$0Con$1$2.filter$794 = function(f$797,m$800){var l$801;
if (m$800 == null) {l$801 = null;
} else {var t$1786 = tools$0IntStringFinMap$1.range$284;
var t$1785;
if (m$800 == null) {m$800;
} else {var v$1593 = m$800;
switch (v$1593[0][0]) { case 0: {m$800;
 break; }default: {var v$1594 = v$1593[0][1];
var v$1595 = v$1594[0];
var v$1596 = v$1594[1];
if (v$1596 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1597 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1595);
var v$1598 = v$1597[1];
var v$1599 = v$1597[0];
if (v$1598) {(v$1593[0] = [0,v$1599],0);
m$800;
} else {(v$1593[0] = [1,[v$1599,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$800;
};
} else {m$800;
};
} };
};
if (m$800 == null) {t$1785 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1290 = m$800;
switch (v$1290[0][0]) { case 0: {t$1785 = v$1290[0][1];
 break; }default: {t$1785 = v$1290[0][1][0];
} };
};
l$801 = (t$1786(t$1785));
};
var l$$802 = basis$0List$1.filter$417(f$797,l$801);
return compiler_objects$0Con$1$2.fromList$663(l$$802);
};
compiler_objects$0Con$1$2.addList$803 = function(l$806,m1$809){var m2$810 = compiler_objects$0Con$1$2.fromList$663(l$806);
return compiler_objects$0Con$1$2.plus$549(m1$809,m2$810);
};
compiler_objects$0Con$1$2.mergeMap$811 = function(f$814,m1$817,m2$820){if (m1$817 == null) {m1$817;
} else {var v$1601 = m1$817;
switch (v$1601[0][0]) { case 0: {m1$817;
 break; }default: {var v$1602 = v$1601[0][1];
var v$1603 = v$1602[0];
var v$1604 = v$1602[1];
if (v$1604 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1605 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1603);
var v$1606 = v$1605[1];
var v$1607 = v$1605[0];
if (v$1606) {(v$1601[0] = [0,v$1607],0);
m1$817;
} else {(v$1601[0] = [1,[v$1607,special_objects$0Name$1.current_matchcount$69(0)]],0);
m1$817;
};
} else {m1$817;
};
} };
};
if (m2$820 == null) {m2$820;
} else {var v$1609 = m2$820;
switch (v$1609[0][0]) { case 0: {m2$820;
 break; }default: {var v$1610 = v$1609[0][1];
var v$1611 = v$1610[0];
var v$1612 = v$1610[1];
if (v$1612 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1613 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1611);
var v$1614 = v$1613[1];
var v$1615 = v$1613[0];
if (v$1614) {(v$1609[0] = [0,v$1615],0);
m2$820;
} else {(v$1609[0] = [1,[v$1615,special_objects$0Name$1.current_matchcount$69(0)]],0);
m2$820;
};
} else {m2$820;
};
} };
};
var rhs3$849 = function(obj$866){var t$1795;
var t$1794;
var t$1793;
var t$1792;
var t$1791 = tools$0IntStringFinMap$1.mergeMap$374;
var t$1790 = function(v$1617){var v$1618 = v$1617[0];
var v$1619 = v$1618[0];
var v$1620 = v$1618[1];
var v$1621 = v$1617[1];
var v$1622 = v$1621[0];
var v$1623 = v$1621[1];
var t$1789;
var v$1624 = v$1619[0][0][1];
var v$1625 = v$1622[0][0][1];
t$1789 = ((v$1624[0] == v$1625[0])?(v$1624[1] == v$1625[1]):false);
if (t$1789) {return [v$1619,f$814([v$1620,v$1623])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
};
var t$1788;
if (m1$817 == null) {t$1788 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1302 = m1$817;
switch (v$1302[0][0]) { case 0: {t$1788 = v$1302[0][1];
 break; }default: {t$1788 = v$1302[0][1][0];
} };
};
var t$1787;
if (m2$820 == null) {t$1787 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1306 = m2$820;
switch (v$1306[0][0]) { case 0: {t$1787 = v$1306[0][1];
 break; }default: {t$1787 = v$1306[0][1][0];
} };
};
t$1792 = (t$1791(t$1790,t$1788,t$1787));
t$1793 = [t$1792,special_objects$0Name$1.current_matchcount$69(0)];
t$1794 = [1,t$1793];
t$1795 = [t$1794];
return t$1795;
};
if (m1$817 == null) {return m2$820;
} else {if (m2$820 == null) {return m1$817;
} else {var v$858 = m1$817;
switch (v$858[0][0]) { case 0: {var v$860 = m2$820;
switch (v$860[0][0]) { case 0: {var v$862 = v$858[0][1];
var v$863 = v$860[0][1];
return [[0,tools$0IntStringFinMap$1.mergeMap$374(function(v$1627){var v$1628 = v$1627[0];
var v$1629 = v$1628[0];
var v$1630 = v$1628[1];
var v$1631 = v$1627[1];
var v$1632 = v$1631[0];
var v$1633 = v$1631[1];
var t$1796;
var v$1634 = v$1629[0][0][1];
var v$1635 = v$1632[0][0][1];
t$1796 = ((v$1634[0] == v$1635[0])?(v$1634[1] == v$1635[1]):false);
if (t$1796) {return [v$1629,f$814([v$1630,v$1633])];
} else {return tools$0Crash$1.impossible$59("QuasiMap2.mergeMap, f'");
};
},v$862,v$863)]];
 break; }default: {return rhs3$849(0);
} };
 break; }default: {return rhs3$849(0);
} };
};
};
};
var fix$1797 = {};
fix$1797.$pp_lookup = function(v$870,v$873,v$876){lab$pp_lookup: while (true) {if (v$873 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$895 = v$873;
var v$896 = v$895[0];
var v$897 = v$895[1];
var t$1798;
var v$1447 = v$896[0][0][1];
t$1798 = ((v$876[0] == v$1447[0])?(v$876[1] == v$1447[1]):false);
if (t$1798) {return v$870(v$896);
} else {var t$1799 = v$870;
var t$1800 = v$897;
var t$1801 = v$876;
var v$870 = t$1799;
var v$873 = t$1800;
var v$876 = t$1801;
continue lab$pp_lookup;
};
};
};
};
compiler_objects$0Con$1$2.pp_lookup$867 = fix$1797.$pp_lookup;
compiler_objects$0Con$1$2.en$Restrict$899 = new String("Restrict");
compiler_objects$0Con$1$2.restrict$900 = function(v$1706,v$1707,v$913){if (v$913 == null) {return null;
} else {if (v$1707 == null) {v$1707;
} else {var v$1639 = v$1707;
switch (v$1639[0][0]) { case 0: {v$1707;
 break; }default: {var v$1640 = v$1639[0][1];
var v$1641 = v$1640[0];
var v$1642 = v$1640[1];
if (v$1642 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1643 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1641);
var v$1644 = v$1643[1];
var v$1645 = v$1643[0];
if (v$1644) {(v$1639[0] = [0,v$1645],0);
v$1707;
} else {(v$1639[0] = [1,[v$1645,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$1707;
};
} else {v$1707;
};
} };
};
if (v$1707 == null) {throw [compiler_objects$0Con$1$2.en$Restrict$899,"[empty map]"];
} else {var im$921;
if (v$1707 == null) {im$921 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1318 = v$1707;
switch (v$1318[0][0]) { case 0: {im$921 = v$1318[0][1];
 break; }default: {im$921 = v$1318[0][1][0];
} };
};
var ns$922 = basis$0List$1.map$697(function(d$1321){return d$1321[0][0][1];
},v$913);
var im$$924;
try {var t$1808 = tools$0IntStringFinMap$1.restrict$391;
var t$1807;
var fix$1803 = {};
fix$1803.$pp_lookup = function(v$1721,v$1722){lab$pp_lookup: while (true) {if (v$1721 == null) {return tools$0Crash$1.impossible$59("QuasiMap2.pp_lookup; element not there");
} else {var v$1723 = v$1721;
var v$1724 = v$1723[0];
var v$1725 = v$1723[1];
var t$1804;
var v$1726 = v$1724[0][0][1];
t$1804 = ((v$1722[0] == v$1726[0])?(v$1722[1] == v$1726[1]):false);
if (t$1804) {return v$1706(v$1724);
} else {var t$1805 = v$1725;
var t$1806 = v$1722;
var v$1721 = t$1805;
var v$1722 = t$1806;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$1720 = fix$1803.$pp_lookup;
t$1807 = (function(v$1727){return pp_lookup$1720(v$913,v$1727);
});
im$$924 = (t$1808(t$1807,im$921,ns$922));
} catch(v$1802) {im$$924 = ((function(v$928){var t$1809 = v$928;
if (t$1809[0] == tools$0IntStringFinMap$1.en$Restrict$390) {var s$925 = v$928[1];
throw [compiler_objects$0Con$1$2.en$Restrict$899,s$925];
} else {throw v$928;
};
})(v$1802));
};
return (tools$0IntStringFinMap$1.fold$62(function(v$933){var v$938 = v$933[0];
var v$939 = v$938[0];
return v$933[1]?v$939[0][0][2]:false;
},true,im$$924))?[[0,im$$924]]:[[1,[im$$924,special_objects$0Name$1.current_matchcount$69(0)]]];
};
};
};
compiler_objects$0Con$1$2.enrich$947 = function(f$950,v$954){var v$978 = v$954[0];
var v$979 = v$954[1];
if (v$978 == null) {v$978;
} else {var v$1647 = v$978;
switch (v$1647[0][0]) { case 0: {v$978;
 break; }default: {var v$1648 = v$1647[0][1];
var v$1649 = v$1648[0];
var v$1650 = v$1648[1];
if (v$1650 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1651 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1649);
var v$1652 = v$1651[1];
var v$1653 = v$1651[0];
if (v$1652) {(v$1647[0] = [0,v$1653],0);
v$978;
} else {(v$1647[0] = [1,[v$1653,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$978;
};
} else {v$978;
};
} };
};
if (v$979 == null) {v$979;
} else {var v$1655 = v$979;
switch (v$1655[0][0]) { case 0: {v$979;
 break; }default: {var v$1656 = v$1655[0][1];
var v$1657 = v$1656[0];
var v$1658 = v$1656[1];
if (v$1658 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1659 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1657);
var v$1660 = v$1659[1];
var v$1661 = v$1659[0];
if (v$1660) {(v$1655[0] = [0,v$1661],0);
v$979;
} else {(v$1655[0] = [1,[v$1661,special_objects$0Name$1.current_matchcount$69(0)]],0);
v$979;
};
} else {v$979;
};
} };
};
if (v$979 == null) {return true;
} else {if (v$978 == null) {return false;
} else {var im1$967;
if (v$978 == null) {im1$967 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1326 = v$978;
switch (v$1326[0][0]) { case 0: {im1$967 = v$1326[0][1];
 break; }default: {im1$967 = v$1326[0][1][0];
} };
};
var im2$968;
if (v$979 == null) {im2$968 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1330 = v$979;
switch (v$1330[0][0]) { case 0: {im2$968 = v$1330[0][1];
 break; }default: {im2$968 = v$1330[0][1][0];
} };
};
return tools$0IntStringFinMap$1.enrich$414(function(v$1333){var v$1334 = v$1333[0];
var v$1335 = v$1334[1];
var v$1336 = v$1333[1];
var v$1337 = v$1336[1];
return f$950([v$1335,v$1337]);
},[im1$967,im2$968]);
};
};
};
compiler_objects$0Con$1$2.layoutMap$980 = function(v$1014,v$1016,v$1015,v$1013){return function(pp_dom$989){return function(pp_range$992){return function(m$995){var t$1810;
var v$1011 = [0,v$1015];
var t$1817;
var t$1816 = basis$0List$1.map$697;
var t$1815 = function(v$1338){var v$1339 = v$1338[0];
var v$1340 = v$1338[1];
var t$1814;
var v$1341 = [0,v$1014];
t$1814 = [[pp_dom$989(v$1339),[pp_range$992(v$1340),null]],v$1341,"",1,""];
return [0,t$1814];
};
var t$1813;
if (m$995 == null) {t$1813 = null;
} else {var t$1812 = tools$0IntStringFinMap$1.range$284;
var t$1811;
if (m$995 == null) {m$995;
} else {var v$1663 = m$995;
switch (v$1663[0][0]) { case 0: {m$995;
 break; }default: {var v$1664 = v$1663[0][1];
var v$1665 = v$1664[0];
var v$1666 = v$1664[1];
if (v$1666 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1667 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1665);
var v$1668 = v$1667[1];
var v$1669 = v$1667[0];
if (v$1668) {(v$1663[0] = [0,v$1669],0);
m$995;
} else {(v$1663[0] = [1,[v$1669,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$995;
};
} else {m$995;
};
} };
};
if (m$995 == null) {t$1811 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1344 = m$995;
switch (v$1344[0][0]) { case 0: {t$1811 = v$1344[0][1];
 break; }default: {t$1811 = v$1344[0][1][0];
} };
};
t$1813 = (t$1812(t$1811));
};
t$1817 = (t$1816(t$1815,t$1813));
t$1810 = [t$1817,v$1011,v$1016,1,v$1013];
return [0,t$1810];
};
};
};
};
compiler_objects$0Con$1$2.reportMap$1017 = function(f$1020,m$1023){var t$1824 = tools$0Report$1.flatten$87;
var t$1823;
var t$1822 = basis$0List$1.map$697;
var t$1821 = f$1020;
var t$1820;
if (m$1023 == null) {t$1820 = null;
} else {var t$1819 = tools$0IntStringFinMap$1.range$284;
var t$1818;
if (m$1023 == null) {m$1023;
} else {var v$1671 = m$1023;
switch (v$1671[0][0]) { case 0: {m$1023;
 break; }default: {var v$1672 = v$1671[0][1];
var v$1673 = v$1672[0];
var v$1674 = v$1672[1];
if (v$1674 < (special_objects$0Name$1.current_matchcount$69(0))) {var v$1675 = compiler_objects$0Con$1$2.ensure_consistent_imap$405(v$1673);
var v$1676 = v$1675[1];
var v$1677 = v$1675[0];
if (v$1676) {(v$1671[0] = [0,v$1677],0);
m$1023;
} else {(v$1671[0] = [1,[v$1677,special_objects$0Name$1.current_matchcount$69(0)]],0);
m$1023;
};
} else {m$1023;
};
} };
};
if (m$1023 == null) {t$1818 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1348 = m$1023;
switch (v$1348[0][0]) { case 0: {t$1818 = v$1348[0][1];
 break; }default: {t$1818 = v$1348[0][1][0];
} };
};
t$1820 = (t$1819(t$1818));
};
t$1823 = (t$1822(t$1821,t$1820));
return t$1824(t$1823);
};
compiler_objects$0Con$1$2.pu_map0$1024 = function(pu_d$1027,pu_a$1030){var pu_m$1039 = pickle$0pickle$1.combHash$2090(function(m$1350){return tools$0IntStringFinMap$1.fold$62(function(v$1351){return SmlPrims.chk_ovf_i32(v$1351[1] + 1);
},0,m$1350);
},tools$0IntStringFinMap$1.pu$488(pickle$0pickle$1.pairGen$1053([pickle$0pickle$1.int$729,pickle$0pickle$1.string$909]),pickle$0pickle$1.pairGen$1053([pu_d$1027,pu_a$1030])));
return pickle$0pickle$1.dataGen$1488(["QuasiMap.map0",function(v$1356){switch (v$1356[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$1357){return pickle$0pickle$1.con1$2014(function(v$1358){return [0,v$1358];
},function(v$1359){switch (v$1359[0]) { case 0: {return v$1359[1];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$1039);
},[function(v$1362){return pickle$0pickle$1.con1$2014(function(v$1363){return [1,[v$1363[1],-1]];
},function(v$1364){switch (v$1364[0]) { case 1: {var v$1365 = v$1364[1];
return [v$1365[1],v$1365[0]];
 break; }default: {return tools$0Crash$1.impossible$59("QuasiMap2.pu_map0.Flexible");
} };
},pickle$0pickle$1.pairGen0$983(special_objects$0Name$1.pu_matchcount$298,pu_m$1039));
},null]]]);
};
compiler_objects$0Con$1$2.pu$1081 = function(pu_d$1084,pu_a$1087){return pickle$0pickle$1.convert$2342([function(v$1374){switch (v$1374[0]) { case 0: {var v$1375 = v$1374[1];
return v$1375;
 break; }default: {return null;
} };
},function(v$1376){if (v$1376 == null) {return [1];
} else {var v$1377 = v$1376;
var t$1827;
var t$1826 = tools$0IntStringFinMap$1.isEmpty$128(0);
var t$1825;
if (v$1376 == null) {t$1825 = (tools$0Crash$1.impossible$59("QuasiMap2.imap': impossible"));
} else {var v$1379 = v$1376;
switch (v$1379[0][0]) { case 0: {t$1825 = v$1379[0][1];
 break; }default: {t$1825 = v$1379[0][1][0];
} };
};
t$1827 = (t$1826(t$1825));
if (t$1827) {return tools$0Crash$1.impossible$59("QuasiMap2.pu.hmmm");
} else {return [0,v$1377];
};
};
}],pickle$0pickle$1.optionGen$2134(pickle$0pickle$1.ref0ShGen$1268(compiler_objects$0Con$1$2.pu_map0$1024(pu_d$1084,pu_a$1087))));
};
return 0;
})();
