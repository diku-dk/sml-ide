if ((typeof(basics$0OpacityEnv$1$3)) == "undefined") {basics$0OpacityEnv$1$3 = {};
};
(function(){basics$0OpacityEnv$1$3.eq_bal$1407 = function(v$1409,v$1410){switch (v$1409) { case 0: {switch (v$1410) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1410) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1410) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
var fix$2084 = {};
fix$2084.$eq_tree = function(v$1415,v$1416,v$1412){lab$eq_tree: while (true) {var v$1413 = v$1412[0];
var v$1414 = v$1412[1];
if (v$1413 == null) {return (v$1414 == null)?true:false;
} else {if (v$1414 == null) {return false;
} else {var v$1417 = v$1413;
var v$1418 = v$1414;
if (v$1415([v$1417[0],v$1418[0]])) {if (v$1416([v$1417[1],v$1418[1]])) {if (fix$2084.$eq_tree(v$1415,v$1416,[v$1417[2],v$1418[2]])) {var t$2085 = v$1415;
var t$2086 = v$1416;
var t$2087 = [v$1417[3],v$1418[3]];
var v$1415 = t$2085;
var v$1416 = t$2086;
var v$1412 = t$2087;
continue lab$eq_tree;
} else {return false;
};
} else {return false;
};
} else {return false;
};
};
};
};
};
basics$0OpacityEnv$1$3.eq_tree$1411 = fix$2084.$eq_tree;
basics$0OpacityEnv$1$3.die$138 = function(s$141){return tools$0Crash$1.impossible$59("OrderFinMap." + s$141);
};
basics$0OpacityEnv$1$3.s$j$142 = function(v$147,v$148){return basics$0OpacityEnv$1$2.lt$96(v$147,v$148);
};
basics$0OpacityEnv$1$3.lt$149 = function(v$1422,v$1423){return basics$0OpacityEnv$1$2.lt$96(v$1422,v$1423);
};
basics$0OpacityEnv$1$3.eq$150 = function(v$159,v$160){return ((basics$0OpacityEnv$1$2.lt$96(v$159,v$160))?true:(basics$0OpacityEnv$1$2.lt$96(v$160,v$159)))?false:true;
};
basics$0OpacityEnv$1$3.empty$166 = function(v$2083){return null;
};
basics$0OpacityEnv$1$3.singleton$167 = function(v$2075,v$2076){return [v$2075,v$2076,null,null,2];
};
basics$0OpacityEnv$1$3.isEmpty$174 = function(v$177){return (v$177 == null)?true:false;
};
basics$0OpacityEnv$1$3.lookup$182 = function(t$185,key$188){var fix$2088 = {};
fix$2088.$search = function(v$192){lab$search: while (true) {if (v$192 == null) {return [1];
} else {var v$209 = v$192;
var v$210 = v$209[0];
var v$211 = v$209[1];
var v$212 = v$209[2];
var v$213 = v$209[3];
if (basics$0OpacityEnv$1$2.lt$96(key$188,v$210)) {var t$2089 = v$212;
var v$192 = t$2089;
continue lab$search;
} else {if (basics$0OpacityEnv$1$2.lt$96(v$210,key$188)) {var t$2090 = v$213;
var v$192 = t$2090;
continue lab$search;
} else {return [0,v$211];
};
};
};
};
};
var search$189 = fix$2088.$search;
return search$189(t$185);
};
basics$0OpacityEnv$1$3.en$Impossible$214 = new String("Impossible");
basics$0OpacityEnv$1$3.impossible$215 = function(s$218){throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMap" + s$218];
};
var en$ALREADYTHERE$219 = new String("ALREADYTHERE");
var exn$ALREADYTHERE$219 = [en$ALREADYTHERE$219];
basics$0OpacityEnv$1$3.add$442 = function(v$451,v$452,v$453){try {var fix$2092 = {};
fix$2092.$ins = function(v$1508){if (v$1508 == null) {return [true,[v$451,v$452,null,null,2]];
} else {var v$1509 = v$1508;
var v$1510 = v$1509[0];
var v$1511 = v$1509[1];
var v$1512 = v$1509[2];
var v$1513 = v$1509[3];
var v$1514 = v$1509[4];
if (basics$0OpacityEnv$1$2.lt$96(v$451,v$1510)) {var v$1518 = fix$2092.$ins(v$1512);
var v$1519 = v$1518[0];
var v$1520 = v$1518[1];
switch (v$1514) { case 2: {return v$1519?[true,[v$1510,v$1511,v$1520,v$1513,1]]:[false,[v$1510,v$1511,v$1520,v$1513,2]];
 break; }case 0: {return v$1519?[false,[v$1510,v$1511,v$1520,v$1513,2]]:[false,[v$1510,v$1511,v$1520,v$1513,0]];
 break; }default: {if (v$1519) {var v$1522;
if (v$1520 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLfinmap 1"];
} else {v$1522 = v$1520;
};
var v$1525 = v$1522[0];
var v$1526 = v$1522[1];
var v$1527 = v$1522[2];
var v$1528 = v$1522[3];
var v$1529 = v$1522[4];
var t$2093;
var v$1894 = 1;
switch (v$1529) { case 0: {switch (v$1894) { case 0: {t$2093 = true;
 break; }default: {t$2093 = false;
} };
 break; }case 1: {switch (v$1894) { case 1: {t$2093 = true;
 break; }default: {t$2093 = false;
} };
 break; }case 2: {switch (v$1894) { case 2: {t$2093 = true;
 break; }default: {t$2093 = false;
} };
 break; } };
if (t$2093) {return [false,[v$1525,v$1526,v$1527,[v$1510,v$1511,v$1528,v$1513,2],2]];
} else {var v$1537;
if (v$1528 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLfinmap 2"];
} else {v$1537 = v$1528;
};
var v$1540 = v$1537[0];
var v$1541 = v$1537[1];
var v$1542 = v$1537[2];
var v$1543 = v$1537[3];
var v$1544 = v$1537[4];
var t$2114 = false;
var t$2113;
var t$2112;
var t$2111 = v$1540;
var t$2110 = v$1541;
var t$2109;
var t$2108;
var t$2107 = v$1525;
var t$2106 = v$1526;
var t$2105 = v$1527;
var t$2104 = v$1542;
var t$2103;
var t$2102;
var v$1900 = 0;
switch (v$1544) { case 0: {switch (v$1900) { case 0: {t$2102 = true;
 break; }default: {t$2102 = false;
} };
 break; }case 1: {switch (v$1900) { case 1: {t$2102 = true;
 break; }default: {t$2102 = false;
} };
 break; }case 2: {switch (v$1900) { case 2: {t$2102 = true;
 break; }default: {t$2102 = false;
} };
 break; } };
t$2103 = (t$2102?1:2);
t$2108 = [t$2107,t$2106,t$2105,t$2104,t$2103];
t$2109 = t$2108;
var t$2101;
var t$2100;
var t$2099 = v$1510;
var t$2098 = v$1511;
var t$2097 = v$1543;
var t$2096 = v$1513;
var t$2095;
var t$2094;
var v$1904 = 1;
switch (v$1544) { case 0: {switch (v$1904) { case 0: {t$2094 = true;
 break; }default: {t$2094 = false;
} };
 break; }case 1: {switch (v$1904) { case 1: {t$2094 = true;
 break; }default: {t$2094 = false;
} };
 break; }case 2: {switch (v$1904) { case 2: {t$2094 = true;
 break; }default: {t$2094 = false;
} };
 break; } };
t$2095 = (t$2094?0:2);
t$2100 = [t$2099,t$2098,t$2097,t$2096,t$2095];
t$2101 = t$2100;
t$2112 = [t$2111,t$2110,t$2109,t$2101,2];
t$2113 = t$2112;
return [t$2114,t$2113];
};
} else {return [false,[v$1510,v$1511,v$1520,v$1513,1]];
};
} };
} else {if (basics$0OpacityEnv$1$2.lt$96(v$1510,v$451)) {var v$1562 = fix$2092.$ins(v$1513);
var v$1563 = v$1562[0];
var v$1564 = v$1562[1];
switch (v$1514) { case 2: {return v$1563?[true,[v$1510,v$1511,v$1512,v$1564,0]]:[false,[v$1510,v$1511,v$1512,v$1564,2]];
 break; }case 1: {return v$1563?[false,[v$1510,v$1511,v$1512,v$1564,2]]:[false,[v$1510,v$1511,v$1512,v$1564,1]];
 break; }default: {if (v$1563) {var v$1566;
if (v$1564 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLfinmap 3"];
} else {v$1566 = v$1564;
};
var v$1569 = v$1566[0];
var v$1570 = v$1566[1];
var v$1571 = v$1566[2];
var v$1572 = v$1566[3];
var v$1573 = v$1566[4];
var t$2115;
var v$1914 = 0;
switch (v$1573) { case 0: {switch (v$1914) { case 0: {t$2115 = true;
 break; }default: {t$2115 = false;
} };
 break; }case 1: {switch (v$1914) { case 1: {t$2115 = true;
 break; }default: {t$2115 = false;
} };
 break; }case 2: {switch (v$1914) { case 2: {t$2115 = true;
 break; }default: {t$2115 = false;
} };
 break; } };
if (t$2115) {return [false,[v$1569,v$1570,[v$1510,v$1511,v$1512,v$1571,2],v$1572,2]];
} else {var v$1581;
if (v$1571 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLfinmap 4"];
} else {v$1581 = v$1571;
};
var v$1584 = v$1581[0];
var v$1585 = v$1581[1];
var v$1586 = v$1581[2];
var v$1587 = v$1581[3];
var v$1588 = v$1581[4];
var t$2136 = false;
var t$2135;
var t$2134;
var t$2133 = v$1584;
var t$2132 = v$1585;
var t$2131;
var t$2130;
var t$2129 = v$1510;
var t$2128 = v$1511;
var t$2127 = v$1512;
var t$2126 = v$1586;
var t$2125;
var t$2124;
var v$1920 = 0;
switch (v$1588) { case 0: {switch (v$1920) { case 0: {t$2124 = true;
 break; }default: {t$2124 = false;
} };
 break; }case 1: {switch (v$1920) { case 1: {t$2124 = true;
 break; }default: {t$2124 = false;
} };
 break; }case 2: {switch (v$1920) { case 2: {t$2124 = true;
 break; }default: {t$2124 = false;
} };
 break; } };
t$2125 = (t$2124?1:2);
t$2130 = [t$2129,t$2128,t$2127,t$2126,t$2125];
t$2131 = t$2130;
var t$2123;
var t$2122;
var t$2121 = v$1569;
var t$2120 = v$1570;
var t$2119 = v$1587;
var t$2118 = v$1572;
var t$2117;
var t$2116;
var v$1924 = 1;
switch (v$1588) { case 0: {switch (v$1924) { case 0: {t$2116 = true;
 break; }default: {t$2116 = false;
} };
 break; }case 1: {switch (v$1924) { case 1: {t$2116 = true;
 break; }default: {t$2116 = false;
} };
 break; }case 2: {switch (v$1924) { case 2: {t$2116 = true;
 break; }default: {t$2116 = false;
} };
 break; } };
t$2117 = (t$2116?0:2);
t$2122 = [t$2121,t$2120,t$2119,t$2118,t$2117];
t$2123 = t$2122;
t$2134 = [t$2133,t$2132,t$2131,t$2123,2];
t$2135 = t$2134;
return [t$2136,t$2135];
};
} else {return [false,[v$1510,v$1511,v$1512,v$1564,0]];
};
} };
} else {throw exn$ALREADYTHERE$219;
};
};
};
};
var ins$1507 = fix$2092.$ins;
return (ins$1507(v$453))[1];
} catch(v$2091) {return (function(ALREADYTHERE$450){var t$2137 = ALREADYTHERE$450;
if (t$2137[0] == en$ALREADYTHERE$219) {var fix$2138 = {};
fix$2138.$repl = function(v$1627){if (v$1627 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLupdate.repl"];
} else {var v$1630 = v$1627;
var v$1631 = v$1630[0];
var v$1632 = v$1630[1];
var v$1633 = v$1630[2];
var v$1634 = v$1630[3];
var v$1635 = v$1630[4];
return (basics$0OpacityEnv$1$2.lt$96(v$451,v$1631))?[v$1631,v$1632,fix$2138.$repl(v$1633),v$1634,v$1635]:((basics$0OpacityEnv$1$2.lt$96(v$1631,v$451))?[v$1631,v$1632,v$1633,fix$2138.$repl(v$1634),v$1635]:[v$1631,v$452,v$1633,v$1634,v$1635]);
};
};
var repl$1626 = fix$2138.$repl;
return repl$1626(v$453);
} else {throw ALREADYTHERE$450;
};
})(v$2091);
};
};
var fix$2139 = {};
fix$2139.$plus = function(v$472,v$473){lab$plus: while (true) {if (v$473 == null) {return v$472;
} else {var v$467 = v$473;
var v$468 = v$467[0];
var v$469 = v$467[1];
var v$470 = v$467[2];
var v$471 = v$467[3];
var t$2140 = fix$2139.$plus(basics$0OpacityEnv$1$3.add$442(v$468,v$469,v$472),v$470);
var t$2141 = v$471;
var v$472 = t$2140;
var v$473 = t$2141;
continue lab$plus;
};
};
};
basics$0OpacityEnv$1$3.plus$454 = fix$2139.$plus;
var en$NOTFOUND$474 = new String("NOTFOUND");
var exn$NOTFOUND$474 = [en$NOTFOUND$474];
var delete$475 = function(v$760,v$761){var balance1$480 = function(v$483){if (v$483 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMap(balance1 on an empty map)"];
} else {var v$553 = v$483;
var v$554 = v$553[0];
var v$555 = v$553[1];
var v$556 = v$553[2];
var v$557 = v$553[3];
switch (v$553[4]) { case 1: {return [[v$554,v$555,v$556,v$557,2],true];
 break; }case 2: {return [[v$554,v$555,v$556,v$557,0],false];
 break; }default: {var v$540;
if (v$557 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLfinmap 5"];
} else {v$540 = v$557;
};
var v$541 = v$540[0];
var v$542 = v$540[1];
var v$543 = v$540[2];
var v$544 = v$540[3];
switch (v$540[4]) { case 1: {var v$527;
if (v$543 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLfinmap 6"];
} else {v$527 = v$543;
};
var v$528 = v$527[0];
var v$529 = v$527[1];
var v$530 = v$527[2];
var v$531 = v$527[3];
var v$532 = v$527[4];
var t$2161;
var t$2160;
var t$2159 = v$528;
var t$2158 = v$529;
var t$2157;
var t$2156;
var t$2155 = v$554;
var t$2154 = v$555;
var t$2153 = v$556;
var t$2152 = v$530;
var t$2151;
var t$2150;
var v$1942 = 0;
switch (v$532) { case 0: {switch (v$1942) { case 0: {t$2150 = true;
 break; }default: {t$2150 = false;
} };
 break; }case 1: {switch (v$1942) { case 1: {t$2150 = true;
 break; }default: {t$2150 = false;
} };
 break; }case 2: {switch (v$1942) { case 2: {t$2150 = true;
 break; }default: {t$2150 = false;
} };
 break; } };
t$2151 = (t$2150?1:2);
t$2156 = [t$2155,t$2154,t$2153,t$2152,t$2151];
t$2157 = t$2156;
var t$2149;
var t$2148;
var t$2147 = v$541;
var t$2146 = v$542;
var t$2145 = v$531;
var t$2144 = v$544;
var t$2143;
var t$2142;
var v$1944 = 1;
switch (v$532) { case 0: {switch (v$1944) { case 0: {t$2142 = true;
 break; }default: {t$2142 = false;
} };
 break; }case 1: {switch (v$1944) { case 1: {t$2142 = true;
 break; }default: {t$2142 = false;
} };
 break; }case 2: {switch (v$1944) { case 2: {t$2142 = true;
 break; }default: {t$2142 = false;
} };
 break; } };
t$2143 = (t$2142?0:2);
t$2148 = [t$2147,t$2146,t$2145,t$2144,t$2143];
t$2149 = t$2148;
t$2160 = [t$2159,t$2158,t$2157,t$2149,2];
t$2161 = t$2160;
return [t$2161,true];
 break; }case 2: {return [[v$541,v$542,[v$554,v$555,v$556,v$543,0],v$544,1],false];
 break; }default: {return [[v$541,v$542,[v$554,v$555,v$556,v$543,2],v$544,2],true];
} };
} };
};
};
var balance2$559 = function(v$562){if (v$562 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMap(balance2 on an empty map)"];
} else {var v$632 = v$562;
var v$633 = v$632[0];
var v$634 = v$632[1];
var v$635 = v$632[2];
var v$636 = v$632[3];
switch (v$632[4]) { case 0: {return [[v$633,v$634,v$635,v$636,2],true];
 break; }case 2: {return [[v$633,v$634,v$635,v$636,1],false];
 break; }default: {var v$619;
if (v$635 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLfinmap 7"];
} else {v$619 = v$635;
};
var v$620 = v$619[0];
var v$621 = v$619[1];
var v$622 = v$619[2];
var v$623 = v$619[3];
switch (v$619[4]) { case 0: {var v$606;
if (v$623 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapAVLfinmap 8"];
} else {v$606 = v$623;
};
var v$607 = v$606[0];
var v$608 = v$606[1];
var v$609 = v$606[2];
var v$610 = v$606[3];
var v$611 = v$606[4];
var t$2181;
var t$2180;
var t$2179 = v$607;
var t$2178 = v$608;
var t$2177;
var t$2176;
var t$2175 = v$620;
var t$2174 = v$621;
var t$2173 = v$622;
var t$2172 = v$609;
var t$2171;
var t$2170;
var v$1954 = 0;
switch (v$611) { case 0: {switch (v$1954) { case 0: {t$2170 = true;
 break; }default: {t$2170 = false;
} };
 break; }case 1: {switch (v$1954) { case 1: {t$2170 = true;
 break; }default: {t$2170 = false;
} };
 break; }case 2: {switch (v$1954) { case 2: {t$2170 = true;
 break; }default: {t$2170 = false;
} };
 break; } };
t$2171 = (t$2170?1:2);
t$2176 = [t$2175,t$2174,t$2173,t$2172,t$2171];
t$2177 = t$2176;
var t$2169;
var t$2168;
var t$2167 = v$633;
var t$2166 = v$634;
var t$2165 = v$610;
var t$2164 = v$636;
var t$2163;
var t$2162;
var v$1952 = 1;
switch (v$611) { case 0: {switch (v$1952) { case 0: {t$2162 = true;
 break; }default: {t$2162 = false;
} };
 break; }case 1: {switch (v$1952) { case 1: {t$2162 = true;
 break; }default: {t$2162 = false;
} };
 break; }case 2: {switch (v$1952) { case 2: {t$2162 = true;
 break; }default: {t$2162 = false;
} };
 break; } };
t$2163 = (t$2162?0:2);
t$2168 = [t$2167,t$2166,t$2165,t$2164,t$2163];
t$2169 = t$2168;
t$2180 = [t$2179,t$2178,t$2177,t$2169,2];
t$2181 = t$2180;
return [t$2181,true];
 break; }case 2: {return [[v$620,v$621,v$622,[v$633,v$634,v$623,v$636,1],0],false];
 break; }default: {return [[v$620,v$621,v$622,[v$633,v$634,v$623,v$636,2],2],true];
} };
} };
};
};
var fix$2182 = {};
fix$2182.$remove_rightmost = function(v$641){if (v$641 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMap(remove_rightmost on empty map)"];
} else {var v$657 = v$641;
var v$658 = v$657[3];
if (v$658 == null) {return [v$657[2],v$657[0],v$657[1],true];
} else {var v$683 = v$657[0];
var v$684 = v$657[1];
var v$685 = v$657[2];
var v$686 = v$657[4];
var v$678 = fix$2182.$remove_rightmost(v$658);
var v$679 = v$678[0];
var v$680 = v$678[1];
var v$681 = v$678[2];
if (v$678[3]) {var v$675 = balance2$559([v$683,v$684,v$685,v$679,v$686]);
return [v$675[0],v$680,v$681,v$675[1]];
} else {return [[v$683,v$684,v$685,v$679,v$686],v$680,v$681,false];
};
};
};
};
var remove_rightmost$638 = fix$2182.$remove_rightmost;
var fix$2183 = {};
fix$2183.$del = function(v$690){if (v$690 == null) {throw exn$NOTFOUND$474;
} else {var v$750 = v$690;
var v$751 = v$750[0];
var v$752 = v$750[1];
var v$753 = v$750[2];
var v$754 = v$750[3];
var v$755 = v$750[4];
if (basics$0OpacityEnv$1$2.lt$96(v$760,v$751)) {var v$711 = fix$2183.$del(v$753);
var v$712 = v$711[0];
if (v$711[1]) {return balance1$480([v$751,v$752,v$712,v$754,v$755]);
} else {return [[v$751,v$752,v$712,v$754,v$755],false];
};
} else {if (basics$0OpacityEnv$1$2.lt$96(v$751,v$760)) {var v$725 = fix$2183.$del(v$754);
var v$726 = v$725[0];
if (v$725[1]) {return balance2$559([v$751,v$752,v$753,v$726,v$755]);
} else {return [[v$751,v$752,v$753,v$726,v$755],false];
};
} else {if (v$754 == null) {return [v$753,true];
} else {if (v$753 == null) {return [v$754,true];
} else {var v$745 = remove_rightmost$638(v$753);
var v$746 = v$745[0];
var v$747 = v$745[1];
var v$748 = v$745[2];
if (v$745[3]) {return balance1$480([v$747,v$748,v$746,v$754,v$755]);
} else {return [[v$747,v$748,v$746,v$754,v$755],false];
};
};
};
};
};
};
};
var del$687 = fix$2183.$del;
return (del$687(v$761))[0];
};
basics$0OpacityEnv$1$3.remove$762 = function(v$770,v$771){try {return [0,delete$475(v$770,v$771)];
} catch(v$2184) {return (function(NOTFOUND$769){var t$2185 = NOTFOUND$769;
if (t$2185[0] == en$NOTFOUND$474) {return [1];
} else {throw NOTFOUND$769;
};
})(v$2184);
};
};
basics$0OpacityEnv$1$3.delete$772 = function(v$780,v$781){try {return delete$475(v$780,v$781);
} catch(v$2186) {return (function(NOTFOUND$779){var t$2187 = NOTFOUND$779;
if (t$2187[0] == en$NOTFOUND$474) {return v$781;
} else {throw NOTFOUND$779;
};
})(v$2186);
};
};
basics$0OpacityEnv$1$3.dom$782 = function(m$785){var fix$2188 = {};
fix$2188.$dom$ = function(v$789,v$792){lab$dom$: while (true) {if (v$789 == null) {return v$792;
} else {var v$804 = v$789;
var v$805 = v$804[0];
var v$806 = v$804[2];
var v$807 = v$804[3];
var t$2189 = v$806;
var t$2190 = [v$805,fix$2188.$dom$(v$807,v$792)];
var v$789 = t$2189;
var v$792 = t$2190;
continue lab$dom$;
};
};
};
var dom$$786 = fix$2188.$dom$;
return dom$$786(m$785,null);
};
basics$0OpacityEnv$1$3.range$809 = function(m$812){var fix$2191 = {};
fix$2191.$ran = function(v$816,v$819){lab$ran: while (true) {if (v$816 == null) {return v$819;
} else {var v$831 = v$816;
var v$832 = v$831[1];
var v$833 = v$831[2];
var v$834 = v$831[3];
var t$2192 = v$833;
var t$2193 = [v$832,fix$2191.$ran(v$834,v$819)];
var v$816 = t$2192;
var v$819 = t$2193;
continue lab$ran;
};
};
};
var ran$813 = fix$2191.$ran;
return ran$813(m$812,null);
};
basics$0OpacityEnv$1$3.list$836 = function(m$839){var fix$2194 = {};
fix$2194.$li = function(v$843,v$846){lab$li: while (true) {if (v$843 == null) {return v$846;
} else {var v$859 = v$843;
var v$860 = v$859[0];
var v$861 = v$859[1];
var v$862 = v$859[2];
var v$863 = v$859[3];
var t$2195 = v$862;
var t$2196 = [[v$860,v$861],fix$2194.$li(v$863,v$846)];
var v$843 = t$2195;
var v$846 = t$2196;
continue lab$li;
};
};
};
var li$840 = fix$2194.$li;
return li$840(m$839,null);
};
var fix$2197 = {};
fix$2197.$composemap = function(f$868,t$871){if (t$871 == null) {return null;
} else {var v$882 = t$871;
var v$883 = v$882[0];
var v$884 = v$882[1];
var v$885 = v$882[2];
var v$886 = v$882[3];
var v$887 = v$882[4];
var l$$881 = fix$2197.$composemap(f$868,v$885);
return [v$883,f$868(v$884),l$$881,fix$2197.$composemap(f$868,v$886),v$887];
};
};
basics$0OpacityEnv$1$3.composemap$865 = fix$2197.$composemap;
var fix$2198 = {};
fix$2198.$ComposeMap = function(f$891,t$894){if (t$894 == null) {return null;
} else {var v$905 = t$894;
var v$906 = v$905[0];
var v$907 = v$905[1];
var v$908 = v$905[2];
var v$909 = v$905[3];
var v$910 = v$905[4];
var l$$904 = fix$2198.$ComposeMap(f$891,v$908);
return [v$906,f$891([v$906,v$907]),l$$904,fix$2198.$ComposeMap(f$891,v$909),v$910];
};
};
basics$0OpacityEnv$1$3.ComposeMap$888 = fix$2198.$ComposeMap;
basics$0OpacityEnv$1$3.fold$911 = function(f$914,e$917,t$920){var fix$2199 = {};
fix$2199.$fold$ = function(v$924,v$927){lab$fold$: while (true) {if (v$924 == null) {return v$927;
} else {var v$939 = v$924;
var v$940 = v$939[1];
var v$941 = v$939[2];
var v$942 = v$939[3];
var t$2200 = v$942;
var t$2201 = f$914([v$940,fix$2199.$fold$(v$941,v$927)]);
var v$924 = t$2200;
var v$927 = t$2201;
continue lab$fold$;
};
};
};
var fold$$921 = fix$2199.$fold$;
return fold$$921(t$920,e$917);
};
basics$0OpacityEnv$1$3.Fold$944 = function(f$947,e$950,t$953){var fix$2202 = {};
fix$2202.$fold$ = function(v$957,v$960){lab$fold$: while (true) {if (v$957 == null) {return v$960;
} else {var v$973 = v$957;
var v$974 = v$973[0];
var v$975 = v$973[1];
var v$976 = v$973[2];
var v$977 = v$973[3];
var t$2203 = v$977;
var t$2204 = f$947([[v$974,v$975],fix$2202.$fold$(v$976,v$960)]);
var v$957 = t$2203;
var v$960 = t$2204;
continue lab$fold$;
};
};
};
var fold$$954 = fix$2202.$fold$;
return fold$$954(t$953,e$950);
};
basics$0OpacityEnv$1$3.filter$979 = function(f$982,t$985){var fix$2205 = {};
fix$2205.$fold$ = function(v$1694,v$1695){lab$fold$: while (true) {if (v$1694 == null) {return v$1695;
} else {var v$1698 = v$1694;
var v$1699 = v$1698[0];
var v$1700 = v$1698[1];
var v$1701 = v$1698[2];
var v$1702 = v$1698[3];
var t$2207 = v$1702;
var t$2206;
var v$2066 = fix$2205.$fold$(v$1701,v$1695);
t$2206 = ((f$982([v$1699,v$1700]))?(basics$0OpacityEnv$1$3.add$442(v$1699,v$1700,v$2066)):v$2066);
var t$2208 = t$2207;
var t$2209 = t$2206;
var v$1694 = t$2208;
var v$1695 = t$2209;
continue lab$fold$;
};
};
};
var fold$$1693 = fix$2205.$fold$;
return fold$$1693(t$985,basics$0OpacityEnv$1$3.empty$166(0));
};
var fix$2210 = {};
fix$2210.$addList = function(v$1002,v$1005){lab$addList: while (true) {if (v$1002 == null) {return v$1005;
} else {var v$1017 = v$1002;
var v$1018 = v$1017[0];
var v$1019 = v$1018[0];
var v$1020 = v$1018[1];
var v$1021 = v$1017[1];
var t$2211 = v$1021;
var t$2212 = basics$0OpacityEnv$1$3.add$442(v$1019,v$1020,v$1005);
var v$1002 = t$2211;
var v$1005 = t$2212;
continue lab$addList;
};
};
};
basics$0OpacityEnv$1$3.addList$999 = fix$2210.$addList;
basics$0OpacityEnv$1$3.fromList$1023 = function(l$1026){return basics$0OpacityEnv$1$3.addList$999(l$1026,basics$0OpacityEnv$1$3.empty$166(0));
};
basics$0OpacityEnv$1$3.fromSortedList$1027 = function(l$1030){var fix$2213 = {};
fix$2213.$build = function(v$1059,v$2077){switch (v$1059) { case 0: {return [v$2077,null];
 break; }default: {var n$$1061 = SmlPrims.div_i32(v$1059,2,CompilerInitial.exn$Div$47);
var v$1092 = fix$2213.$build(n$$1061,v$2077);
var v$1093 = v$1092[0];
var v$1094 = v$1092[1];
var v$1075;
if (v$1093 == null) {throw [basics$0OpacityEnv$1$3.en$Impossible$214,"OrderFinMapbuild"];
} else {var v$1087 = v$1093;
var v$1088 = v$1087[0];
v$1075 = [v$1088[0],v$1088[1],v$1087[1]];
};
var v$1076 = v$1075[0];
var v$1077 = v$1075[1];
var v$1078 = v$1075[2];
var v$1072 = fix$2213.$build(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$1059 - n$$1061)) - 1),v$1078);
return [v$1072[0],[v$1076,v$1077,v$1094,v$1072[1]]];
} };
};
var build$1048 = fix$2213.$build;
var fix$2214 = {};
fix$2214.$mk_avl = function(v$1110){if (v$1110 == null) {return [null,0];
} else {var v$1139 = v$1110;
var v$1140 = v$1139[0];
var v$1141 = v$1139[1];
var v$1142 = v$1139[2];
var v$1143 = v$1139[3];
var v$1136 = fix$2214.$mk_avl(v$1142);
var v$1137 = v$1136[0];
var v$1138 = v$1136[1];
var v$1133 = fix$2214.$mk_avl(v$1143);
var v$1134 = v$1133[0];
var v$1135 = v$1133[1];
return [[v$1140,v$1141,v$1137,v$1134,(v$1138 == v$1135)?2:((v$1138 > v$1135)?1:0)],SmlPrims.chk_ovf_i32(1 + ((v$1138 > v$1135)?v$1138:v$1135))];
};
};
var mk_avl$1107 = fix$2214.$mk_avl;
var t$2223;
var t$2222 = mk_avl$1107;
var t$2221;
var t$2220;
var t$2219 = build$1048;
var t$2218;
var fix$2215 = {};
fix$2215.$acc = function(v$1711,v$1712){lab$acc: while (true) {if (v$1711 == null) {return v$1712;
} else {var v$1713 = v$1711;
var v$1714 = v$1713[1];
var t$2216 = v$1714;
var t$2217 = SmlPrims.chk_ovf_i32(v$1712 + 1);
var v$1711 = t$2216;
var v$1712 = t$2217;
continue lab$acc;
};
};
};
var acc$1710 = fix$2215.$acc;
t$2218 = (acc$1710(l$1030,0));
t$2220 = (t$2219(t$2218,l$1030));
t$2221 = t$2220[1];
t$2223 = (t$2222(t$2221));
return t$2223[0];
};
basics$0OpacityEnv$1$3.mergeMap$1152 = function(f$1155,t1$1158,t2$1161){var fix$2224 = {};
fix$2224.$merge = function(v$1182,v$2078){if (v$1182 == null) {return v$2078;
} else {if (v$2078 == null) {return v$1182;
} else {var v$1193 = v$1182;
var v$1194 = v$1193[0];
var v$1195 = v$1194[0];
var v$1196 = v$1194[1];
var v$1197 = v$1193[1];
var v$1198 = v$2078;
var v$1199 = v$1198[0];
var v$1200 = v$1199[0];
var v$1201 = v$1199[1];
var v$1202 = v$1198[1];
return (basics$0OpacityEnv$1$2.lt$96(v$1195,v$1200))?[[v$1195,v$1196],fix$2224.$merge(v$1197,v$2078)]:((basics$0OpacityEnv$1$2.lt$96(v$1200,v$1195))?[[v$1200,v$1201],fix$2224.$merge(v$1182,v$1202)]:[[v$1195,f$1155([v$1196,v$1201])],fix$2224.$merge(v$1197,v$1202)]);
};
};
};
var merge$1162 = fix$2224.$merge;
var t$2235 = basics$0OpacityEnv$1$3.fromSortedList$1027;
var t$2234;
var t$2233 = merge$1162;
var t$2232;
var fix$2229 = {};
fix$2229.$li = function(v$1723,v$1724){lab$li: while (true) {if (v$1723 == null) {return v$1724;
} else {var v$1727 = v$1723;
var v$1728 = v$1727[0];
var v$1729 = v$1727[1];
var v$1730 = v$1727[2];
var v$1731 = v$1727[3];
var t$2230 = v$1730;
var t$2231 = [[v$1728,v$1729],fix$2229.$li(v$1731,v$1724)];
var v$1723 = t$2230;
var v$1724 = t$2231;
continue lab$li;
};
};
};
var li$1722 = fix$2229.$li;
t$2232 = (li$1722(t1$1158,null));
var t$2228;
var fix$2225 = {};
fix$2225.$li = function(v$1735,v$1736){lab$li: while (true) {if (v$1735 == null) {return v$1736;
} else {var v$1739 = v$1735;
var v$1740 = v$1739[0];
var v$1741 = v$1739[1];
var v$1742 = v$1739[2];
var v$1743 = v$1739[3];
var t$2226 = v$1742;
var t$2227 = [[v$1740,v$1741],fix$2225.$li(v$1743,v$1736)];
var v$1735 = t$2226;
var v$1736 = t$2227;
continue lab$li;
};
};
};
var li$1734 = fix$2225.$li;
t$2228 = (li$1734(t2$1161,null));
t$2234 = (t$2233(t$2232,t$2228));
return t$2235(t$2234);
};
var fix$2236 = {};
fix$2236.$oneForWhich = function(f$1206,t$1209){lab$oneForWhich: while (true) {if (t$1209 == null) {return [1];
} else {var v$1229 = t$1209;
var v$1230 = v$1229[0];
var v$1231 = v$1229[1];
var v$1232 = v$1229[2];
var v$1233 = v$1229[3];
if (f$1206([v$1230,v$1231])) {return [0,[v$1230,v$1231]];
} else {var v$1226 = fix$2236.$oneForWhich(f$1206,v$1232);
switch (v$1226[0]) { case 0: {var v$1228 = v$1226[1];
return [0,v$1228];
 break; }default: {var t$2237 = f$1206;
var t$2238 = v$1233;
var f$1206 = t$2237;
var t$1209 = t$2238;
continue lab$oneForWhich;
} };
};
};
};
};
basics$0OpacityEnv$1$3.oneForWhich$1203 = fix$2236.$oneForWhich;
basics$0OpacityEnv$1$3.en$Restrict$1234 = new String("Restrict");
basics$0OpacityEnv$1$3.restrict$1235 = function(v$1254,v$1255,v$1256){var fix$2239 = {};
fix$2239.$foldl = function(v$1749,v$1750){lab$foldl: while (true) {if (v$1750 == null) {return v$1749;
} else {var v$1751 = v$1750;
var v$1752 = v$1751[0];
var v$1753 = v$1751[1];
var t$2243;
var v$2031;
var fix$2240 = {};
fix$2240.$search = function(v$2033){lab$search: while (true) {if (v$2033 == null) {return [1];
} else {var v$2034 = v$2033;
var v$2035 = v$2034[0];
var v$2036 = v$2034[1];
var v$2037 = v$2034[2];
var v$2038 = v$2034[3];
if (basics$0OpacityEnv$1$2.lt$96(v$1752,v$2035)) {var t$2241 = v$2037;
var v$2033 = t$2241;
continue lab$search;
} else {if (basics$0OpacityEnv$1$2.lt$96(v$2035,v$1752)) {var t$2242 = v$2038;
var v$2033 = t$2242;
continue lab$search;
} else {return [0,v$2036];
};
};
};
};
};
var search$2032 = fix$2240.$search;
v$2031 = (search$2032(v$1255));
switch (v$2031[0]) { case 0: {var v$2039 = v$2031[1];
t$2243 = (basics$0OpacityEnv$1$3.add$442(v$1752,v$2039,v$1749));
 break; }default: {throw [basics$0OpacityEnv$1$3.en$Restrict$1234,v$1254(v$1752)];
} };
var t$2244 = t$2243;
var t$2245 = v$1753;
var v$1749 = t$2244;
var v$1750 = t$2245;
continue lab$foldl;
};
};
};
var foldl$1748 = fix$2239.$foldl;
return foldl$1748(basics$0OpacityEnv$1$3.empty$166(0),v$1256);
};
basics$0OpacityEnv$1$3.enrich$1257 = function(en$1260,v$1264){var v$1285 = v$1264[0];
var v$1286 = v$1264[1];
var fix$2246 = {};
fix$2246.$fold$ = function(v$1773,v$1774){lab$fold$: while (true) {if (v$1773 == null) {return v$1774;
} else {var v$1777 = v$1773;
var v$1778 = v$1777[0];
var v$1779 = v$1777[1];
var v$1780 = v$1777[2];
var v$1781 = v$1777[3];
var t$2251 = v$1781;
var t$2250;
if (fix$2246.$fold$(v$1780,v$1774)) {var v$2044;
var fix$2247 = {};
fix$2247.$search = function(v$2046){lab$search: while (true) {if (v$2046 == null) {return [1];
} else {var v$2047 = v$2046;
var v$2048 = v$2047[0];
var v$2049 = v$2047[1];
var v$2050 = v$2047[2];
var v$2051 = v$2047[3];
if (basics$0OpacityEnv$1$2.lt$96(v$1778,v$2048)) {var t$2248 = v$2050;
var v$2046 = t$2248;
continue lab$search;
} else {if (basics$0OpacityEnv$1$2.lt$96(v$2048,v$1778)) {var t$2249 = v$2051;
var v$2046 = t$2249;
continue lab$search;
} else {return [0,v$2049];
};
};
};
};
};
var search$2045 = fix$2247.$search;
v$2044 = (search$2045(v$1285));
switch (v$2044[0]) { case 0: {var v$2052 = v$2044[1];
t$2250 = (en$1260([v$2052,v$1779]));
 break; }default: {t$2250 = false;
} };
} else {t$2250 = false;
};
var t$2252 = t$2251;
var t$2253 = t$2250;
var v$1773 = t$2252;
var v$1774 = t$2253;
continue lab$fold$;
};
};
};
var fold$$1772 = fix$2246.$fold$;
return fold$$1772(v$1286,true);
};
basics$0OpacityEnv$1$3.layoutMap$1287 = function(v$1320,v$1322,v$1321,v$1319){return function(layoutDom$1296){return function(layoutRan$1299){return function(m$1302){var t$2261;
var t$2260;
var t$2259 = basis$0List$1.map$697;
var t$2258 = function(v$1306){var v$1312 = v$1306[0];
var v$1313 = v$1306[1];
return [0,[[layoutDom$1296(v$1312),[layoutRan$1299(v$1313),null]],[0,v$1320],"",3,""]];
};
var t$2257;
var fix$2254 = {};
fix$2254.$li = function(v$1800,v$1801){lab$li: while (true) {if (v$1800 == null) {return v$1801;
} else {var v$1804 = v$1800;
var v$1805 = v$1804[0];
var v$1806 = v$1804[1];
var v$1807 = v$1804[2];
var v$1808 = v$1804[3];
var t$2255 = v$1807;
var t$2256 = [[v$1805,v$1806],fix$2254.$li(v$1808,v$1801)];
var v$1800 = t$2255;
var v$1801 = t$2256;
continue lab$li;
};
};
};
var li$1799 = fix$2254.$li;
t$2257 = (li$1799(m$1302,null));
t$2260 = (t$2259(t$2258,t$2257));
t$2261 = [t$2260,[0,v$1321],v$1322,3,v$1319];
return [0,t$2261];
};
};
};
};
basics$0OpacityEnv$1$3.reportMap$1323 = function(f$1326,t$1329){var t$2269 = tools$0Report$1.flatten$87;
var t$2268;
var t$2267 = basis$0List$1.map$697;
var t$2266 = f$1326;
var t$2265;
var fix$2262 = {};
fix$2262.$li = function(v$1812,v$1813){lab$li: while (true) {if (v$1812 == null) {return v$1813;
} else {var v$1816 = v$1812;
var v$1817 = v$1816[0];
var v$1818 = v$1816[1];
var v$1819 = v$1816[2];
var v$1820 = v$1816[3];
var t$2263 = v$1819;
var t$2264 = [[v$1817,v$1818],fix$2262.$li(v$1820,v$1813)];
var v$1812 = t$2263;
var v$1813 = t$2264;
continue lab$li;
};
};
};
var li$1811 = fix$2262.$li;
t$2265 = (li$1811(t$1329,null));
t$2268 = (t$2267(t$2266,t$2265));
return t$2269(t$2268);
};
basics$0OpacityEnv$1$3.reportMapSORTED$1330 = function(f$1822,t$1823){var t$2277 = tools$0Report$1.flatten$87;
var t$2276;
var t$2275 = basis$0List$1.map$697;
var t$2274 = f$1822;
var t$2273;
var fix$2270 = {};
fix$2270.$li = function(v$1826,v$1827){lab$li: while (true) {if (v$1826 == null) {return v$1827;
} else {var v$1830 = v$1826;
var v$1831 = v$1830[0];
var v$1832 = v$1830[1];
var v$1833 = v$1830[2];
var v$1834 = v$1830[3];
var t$2271 = v$1833;
var t$2272 = [[v$1831,v$1832],fix$2270.$li(v$1834,v$1827)];
var v$1826 = t$2271;
var v$1827 = t$2272;
continue lab$li;
};
};
};
var li$1825 = fix$2270.$li;
t$2273 = (li$1825(t$1823,null));
t$2276 = (t$2275(t$2274,t$2273));
return t$2277(t$2276);
};
basics$0OpacityEnv$1$3.pu_bal$1331 = pickle$0pickle$1.enumGen$2158(function(v$1836){var v$1837 = v$1836[0];
var v$1838 = v$1836[1];
switch (v$1837) { case 0: {switch (v$1838) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1838) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1838) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderFinMap.bal",[1,[2,[0,null]]]]);
basics$0OpacityEnv$1$3.pu$1332 = function(pu_dom$1335,pu_r$1338){var fun_E$1347;
var v$2081 = null;
fun_E$1347 = (function(v$2082){return pickle$0pickle$1.con0$1988(v$2081,v$2082);
});
return pickle$0pickle$1.dataGen$1488(["OrderFinMap.map",function(v$1852){return (v$1852 == null)?0:1;
},[fun_E$1347,[function(pu$1853){return pickle$0pickle$1.con1$2014(function(v$1854){var v$1855 = v$1854[0];
return [v$1855[0],v$1855[1],v$1855[2],v$1855[3],v$1854[1]];
},function(v$1856){if (v$1856 == null) {return tools$0Crash$1.impossible$59("OrderFinMap.pu.fun_N");
} else {var v$1857 = v$1856;
return [[v$1857[0],v$1857[1],v$1857[2],v$1857[3]],v$1857[4]];
};
},pickle$0pickle$1.pairGen0$983((pickle$0pickle$1.convert0$2299(function(v$1865){var v$1866 = v$1865[0];
var v$1867 = v$1866[0];
var v$1868 = v$1866[1];
var v$1869 = v$1865[1];
return [v$1867,v$1868,v$1869[0],v$1869[1]];
},function(v$1870){return [[v$1870[0],v$1870[1]],[v$1870[2],v$1870[3]]];
}))(pickle$0pickle$1.pairGen0$983(pickle$0pickle$1.pairGen0$983(pu_dom$1335,pu_r$1338),pickle$0pickle$1.pairGen0$983(pu$1853,pu$1853))),basics$0OpacityEnv$1$3.pu_bal$1331));
},null]]]);
};
return 0;
})();
